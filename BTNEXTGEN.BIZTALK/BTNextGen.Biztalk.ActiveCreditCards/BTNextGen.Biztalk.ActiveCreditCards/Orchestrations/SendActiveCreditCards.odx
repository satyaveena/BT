#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="e4739bfa-4ab2-4338-8a9c-8b8176d6670a" LowerBound="1.1" HigherBound="450.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ActiveCreditCards" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="96ef4668-5861-40c7-a4ab-2f1a065be9f6" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="rcvCreditCardsCSPortType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="4e45af9e-4281-4fa1-90f3-c9d8ddb986ae" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="5f7660c2-a86a-4676-af85-dabd09842de1" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="5eb959a4-8c84-4570-92f9-633d76ccf867" ParentLink="Module_PortType" LowerBound="11.1" HigherBound="18.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendToERPPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="23f6d14a-c6dd-44f0-b6a0-be904f5e31e4" ParentLink="PortType_OperationDeclaration" LowerBound="13.1" HigherBound="17.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="6a9ec08e-6d72-4e61-a35f-f04661eec208" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="15.13" HigherBound="15.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="f0ca9827-1cc0-47da-a38d-bdddc42beac1" ParentLink="Module_PortType" LowerBound="18.1" HigherBound="25.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archivePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="e1f83507-93e7-4e8e-ad18-d5aa431eb298" ParentLink="PortType_OperationDeclaration" LowerBound="20.1" HigherBound="24.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="818e40e4-f85b-400b-a999-21d3370f5a75" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="22.13" HigherBound="22.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="f21cbfc5-2a4f-4424-9a2f-f1fe14fcbfda" ParentLink="Module_PortType" LowerBound="25.1" HigherBound="32.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendSOPPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="5aad3b4e-5808-4b49-8cf3-0d5b41e86b9b" ParentLink="PortType_OperationDeclaration" LowerBound="27.1" HigherBound="31.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="48336cd9-3c6b-4059-a293-fd0c729bd3af" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="29.13" HigherBound="29.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0d8fc6ce-a479-43e8-943b-b0331f199e12" ParentLink="Module_PortType" LowerBound="32.1" HigherBound="39.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendFaultPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="002882ae-ae81-4255-b2b3-b68c7f81fac3" ParentLink="PortType_OperationDeclaration" LowerBound="34.1" HigherBound="38.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="edf4bf44-f1f0-4d47-8b0b-232151512e1a" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="36.13" HigherBound="36.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="d8c0af75-f76d-478b-8a1d-7b1836a5dbd0" ParentLink="Module_PortType" LowerBound="39.1" HigherBound="46.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archiveBulkRespPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="89870cf7-8d7a-4382-8dfe-edb614e50503" ParentLink="PortType_OperationDeclaration" LowerBound="41.1" HigherBound="45.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="63d40395-cabe-40d6-b4ff-2832b2c52cda" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="43.13" HigherBound="43.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="44cfb690-6b8b-4708-a414-3115255c510b" ParentLink="Module_PortType" LowerBound="46.1" HigherBound="53.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="rcvCreditCardsCS_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="589b08ac-ca40-4df0-996b-ad0e2c3678df" ParentLink="PortType_OperationDeclaration" LowerBound="48.1" HigherBound="52.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="59dea552-f8b5-4c32-a2a6-ede09c04d77e" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="50.13" HigherBound="50.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0df7d7eb-dd36-4ea3-a54c-c7f467f8d6cf" ParentLink="Module_PortType" LowerBound="53.1" HigherBound="60.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Single" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="5f05c97f-ce32-4e57-99fc-793e5f791442" ParentLink="PortType_OperationDeclaration" LowerBound="55.1" HigherBound="59.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="51d470dd-b421-4399-b9f4-54b1bb3eb67b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="57.13" HigherBound="57.39">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SingleCreditCardCS" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="d882a395-7793-4185-93c1-b23a6e31015d" ParentLink="Module_PortType" LowerBound="60.1" HigherBound="67.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_TESTERPFF" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="bd7c7f43-c045-4a7e-b15a-1aa81e8378e5" ParentLink="PortType_OperationDeclaration" LowerBound="62.1" HigherBound="66.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="b5377e3d-e570-4e96-9764-e039674ebc40" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="64.13" HigherBound="64.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="fa325070-fe8a-46ef-8154-6e148de564b0" ParentLink="Module_PortType" LowerBound="67.1" HigherBound="74.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Test" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="bcdf801e-2a75-4421-adb4-a52085759c93" ParentLink="PortType_OperationDeclaration" LowerBound="69.1" HigherBound="73.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="ecf98c30-3661-45b6-87ff-44bb38638703" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="71.13" HigherBound="71.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="5a750d8f-5fe7-40f1-a745-ba9b9fac02df" ParentLink="Module_PortType" LowerBound="74.1" HigherBound="81.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ERPTest2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="2dc718d6-662d-45f0-9c57-7a83ab86c12a" ParentLink="PortType_OperationDeclaration" LowerBound="76.1" HigherBound="80.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="d4a8f563-f96e-4bae-b390-d74b93a12a96" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="78.13" HigherBound="78.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="897d5996-0ea0-487e-8569-ea42268f9462" ParentLink="Module_PortType" LowerBound="81.1" HigherBound="88.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_1" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="875eb9eb-a73d-4cc7-9612-bdc8b13ec793" ParentLink="PortType_OperationDeclaration" LowerBound="83.1" HigherBound="87.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="c2fbd1a9-a811-488a-93ec-35c844ef6a46" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="85.13" HigherBound="85.39">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SingleCreditCardCS" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="314ce679-c09c-4138-8ace-2a7a10eb8a7a" ParentLink="Module_PortType" LowerBound="88.1" HigherBound="95.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f2ef3874-ae85-4d7e-90a6-5e419b8bffb6" ParentLink="PortType_OperationDeclaration" LowerBound="90.1" HigherBound="94.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="db6678e7-b9cb-4f1a-bc87-a3f894126cf1" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="92.13" HigherBound="92.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="bdf72687-24b9-4abc-bb79-fcdad2fe2d5b" ParentLink="Module_PortType" LowerBound="95.1" HigherBound="102.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_3" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="eb22f6bc-f3fc-4d04-813a-be44c7f766a2" ParentLink="PortType_OperationDeclaration" LowerBound="97.1" HigherBound="101.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="cfe7346a-2cb5-4040-9867-20bc1b7fc84c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="99.13" HigherBound="99.39">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SingleCreditCardCS" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="e9fcf2d9-261b-42bf-b21d-df44d9b84636" ParentLink="Module_ServiceDeclaration" LowerBound="102.1" HigherBound="449.1">
            <om:Property Name="InitializedTransactionType" Value="True" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendActiveCreditCards" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="391e1d5b-346d-4eb3-a2ae-1f7be014a1cd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="133.1" HigherBound="134.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="activityID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fa83fa41-012e-426c-8b4b-15bdd1e2a2fa" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="134.1" HigherBound="135.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="activityName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cd1cd78f-4d66-4fde-ba2d-6d2548db8652" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="135.1" HigherBound="136.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="isArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="10d255e6-4bd2-4d50-8239-dc1fa1b27d70" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="136.1" HigherBound="137.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="isTolas" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3ae26bff-30fe-4446-92c7-dcd5558d5ff2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="137.1" HigherBound="138.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlListResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6bca8008-77e5-4a92-8db0-580baaf07251" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="138.1" HigherBound="139.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="cardID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d92b3704-9b38-411e-9a5b-208c5577b051" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="139.1" HigherBound="140.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlquery" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="45aa778a-f5c2-4e30-83b0-aed17c9b357e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="140.1" HigherBound="141.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="erpAccountNo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c5d13df1-db52-4409-a59e-93cfc057b69a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="141.1" HigherBound="142.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmldocUpdateProfile" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="28664f81-0cb4-444e-a842-1cabc74f68c3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="142.1" HigherBound="143.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="cntCards" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b5fa53fa-149c-47da-85d0-04b0f63abe4f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="143.1" HigherBound="144.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="counter" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="15ab03f5-45bb-4494-b75f-2fe53148cbe4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="144.1" HigherBound="145.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strCounter" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4354eec3-2fe6-45cb-9e36-d854f77c0b86" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="145.1" HigherBound="146.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="severity" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7a87b461-eeac-4491-bc91-5ab2f1540783" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="146.1" HigherBound="147.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="enableBam" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c0a47c8b-9f43-4998-821c-77cbea60ff40" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="147.1" HigherBound="148.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="targetERP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6c0f8fc9-3262-4394-aad3-c2c7a9eed8d7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="148.1" HigherBound="149.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="alias" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d220ba5f-497e-41bb-8fa0-d50f5a9a736e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="149.1" HigherBound="150.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Guid" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="guid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5f46c2a7-ab9b-4c97-9a6f-e2deceb5445d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="150.1" HigherBound="151.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sXpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d009bbfd-00c0-4069-bd51-6ee9db9f2d23" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="151.1" HigherBound="152.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="myXPath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4412b901-6373-4eec-bddb-e45749488b60" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="152.1" HigherBound="153.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="myValue" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="LongRunningTransaction" OID="a0003e31-876a-42da-a3f1-711455691a89" ParentLink="ServiceDeclaration_Transaction" LowerBound="103.21" HigherBound="103.67">
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Transaction_Orch" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2383dbcf-0c1f-4ac1-b2ea-19e36eb5414d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="119.1" HigherBound="120.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SingleCreditCardCS" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CreditCardCSSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="b049cfbb-c600-416e-8a4d-88274d0476dc" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="120.1" HigherBound="121.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveBulkRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c3a24367-19a4-4e8f-a0c4-59f61eb4f2c7" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="121.1" HigherBound="122.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveERPSend" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e55d3825-e8e6-452a-8a34-941abdc3af82" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="122.1" HigherBound="123.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.CreditCardToERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sendToERP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e5b59846-582a-4f4f-bedf-9def520678ed" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="123.1" HigherBound="124.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CreditCardCS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9d062884-11d1-4cba-a207-f159cd51c552" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="124.1" HigherBound="125.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SingleCardCS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="f97ea0f2-9e6a-447b-ab71-9ca14cea5801" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="125.1" HigherBound="126.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="faultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9cfda369-5a45-4d71-95c1-b3aa18958372" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="126.1" HigherBound="127.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CardCS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="39f56c35-9852-4211-94a6-d96bdbbfd65d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="127.1" HigherBound="128.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_XML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="be182562-970b-42f0-8804-5b8fe64ea13e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="128.1" HigherBound="129.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SingleCreditCardCS" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SingleCreditCardCS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2aa98559-cc42-4dad-8d94-4309b2ee640d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="129.1" HigherBound="130.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_XMLWork1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4e6d67d1-9b92-42a2-8147-3da3e226dfb6" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="130.1" HigherBound="131.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_XMLWork2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="3b45d9c9-89d6-45dd-9bea-40d939822456" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="131.1" HigherBound="132.1">
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vsb" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9eafc600-6036-43c6-afeb-a1f8fbc6fcf2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="132.1" HigherBound="133.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.Schemas.SendCreditCardERPXXX" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CreditCardCSXXX" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="1ef7a254-08de-4a4b-a7e5-afd491d7c3dc" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="fa25754c-5b5f-4fb5-9a64-f90e4a515ade" ParentLink="ServiceBody_Statement" LowerBound="155.1" HigherBound="173.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="rcvCreditCardsCS" />
                    <om:Property Name="MessageName" Value="CreditCardCS" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="rcv_CreditCardsCS" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="0fdfc699-3edb-4b79-b90e-63aeaf8c8082" ParentLink="ServiceBody_Statement" LowerBound="173.1" HigherBound="447.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Outer" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="LongRunningTransaction" OID="35775d73-c529-4f6a-b44e-d9bf38419caf" ParentLink="Scope_Transaction" LowerBound="174.18" HigherBound="174.56">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Transaction_1" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="bd7c90b5-82d4-4e67-a8fa-05c045d90165" ParentLink="ComplexStatement_Statement" LowerBound="178.1" HigherBound="191.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ARCHIVE" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="9add2bd5-4f0b-4a01-ac81-37ad5493ea2e" ParentLink="ReallyComplexStatement_Branch" LowerBound="179.21" HigherBound="191.1">
                            <om:Property Name="Expression" Value="isArchive == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="YES" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="c220132f-b6fe-44bb-ac96-76a1a3661a1d" ParentLink="ComplexStatement_Statement" LowerBound="181.1" HigherBound="188.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Construct_ArchiveResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="1e18f116-0c64-4902-aa14-1656f8adbd29" ParentLink="Construct_MessageRef" LowerBound="182.35" HigherBound="182.53">
                                    <om:Property Name="Ref" Value="archiveBulkRequest" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="3edfbdd4-b8be-400e-a8e5-b31b842fddc8" ParentLink="ComplexStatement_Statement" LowerBound="184.1" HigherBound="187.1">
                                    <om:Property Name="Expression" Value="archiveBulkRequest = CreditCardCS;&#xD;&#xA;archiveBulkRequest(FILE.ReceivedFileName)=&quot;ActiveCreditCardRecord&quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="assign filename" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="ad43eb13-831b-4c1b-8736-1bf30e590503" ParentLink="ComplexStatement_Statement" LowerBound="188.1" HigherBound="190.1">
                                <om:Property Name="PortName" Value="archiveBulkRespPort" />
                                <om:Property Name="MessageName" Value="archiveBulkRequest" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_ArchiveResponse" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="7dd9575a-598b-4422-99c3-38d67371d470" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="39fa9f3e-d576-43fb-91a9-78523653cb5f" ParentLink="ComplexStatement_Statement" LowerBound="191.1" HigherBound="197.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_1" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="Transform" OID="77298b23-e73d-4dec-8d5d-971eff11a82d" ParentLink="ComplexStatement_Statement" LowerBound="194.1" HigherBound="196.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ActiveCreditCards.Transform_CSXXX1" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_CSXXX" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="c743ec32-b141-4a86-a011-41e4adaf2a19" ParentLink="Transform_InputMessagePartRef" LowerBound="195.109" HigherBound="195.121">
                                <om:Property Name="MessageRef" Value="CreditCardCS" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_3" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="e55f1942-93be-4480-9aac-7322ade08ac8" ParentLink="Transform_OutputMessagePartRef" LowerBound="195.36" HigherBound="195.51">
                                <om:Property Name="MessageRef" Value="CreditCardCSXXX" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_4" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageRef" OID="96655c67-91b6-457b-8662-ea475d1d5661" ParentLink="Construct_MessageRef" LowerBound="192.31" HigherBound="192.46">
                            <om:Property Name="Ref" Value="CreditCardCSXXX" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="21895dd3-e9f1-497c-bd1c-c3c1844dacd3" ParentLink="ComplexStatement_Statement" LowerBound="197.1" HigherBound="201.1">
                        <om:Property Name="Expression" Value="isArchive=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ActiveCreditCards&quot;,&quot;isArchive&quot;));&#xD;&#xA;enableBam=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ActiveCreditCards&quot;,&quot;bamEnabled&quot;));&#xD;&#xA;severity=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ActiveCreditCards&quot;,&quot;faultSeverity&quot;));" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="extract sso values" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="7979b07c-28cb-4d4c-abfa-1b59c6e45243" ParentLink="ComplexStatement_Statement" LowerBound="201.1" HigherBound="215.1">
                        <om:Property Name="Expression" Value="cntCards= 0;&#xD;&#xA;cntCards= System.Convert.ToInt32(xpath(CreditCardCS,                &quot;count(/*[local-name()='SendCreditCardERP']/*[local-name()='SendCreditCardERPDetails']/*[local-name()='ActiveCreditCards'])&quot;));&#xD;&#xA;&#xD;&#xA;counter=1;&#xD;&#xA;strCounter=&quot;1&quot;;&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;No of active cards&quot;, cntCards.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;No of active xxxx&quot;, cntCards.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="SET Counters" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="While" OID="6059eaf4-c222-4ed9-aa02-6acc95ea03ba" ParentLink="ComplexStatement_Statement" LowerBound="215.1" HigherBound="421.1">
                        <om:Property Name="Expression" Value="counter &lt;= cntCards" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Loop_1" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Scope" OID="46826616-3228-44e5-9ede-f6d470159d39" ParentLink="ComplexStatement_Statement" LowerBound="218.1" HigherBound="420.1">
                            <om:Property Name="InitializedTransactionType" Value="True" />
                            <om:Property Name="IsSynchronized" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Scope_Inner" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="LongRunningTransaction" OID="7c2fe387-7c31-48bf-b0ff-81a5af27ff74" ParentLink="Scope_Transaction" LowerBound="219.30" HigherBound="219.68">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Transaction_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Construct" OID="99908a79-dd01-4feb-8243-513cabe58b9a" ParentLink="ComplexStatement_Statement" LowerBound="223.1" HigherBound="237.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Construct_SingCardsCS" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="0a67b75e-5edc-4a3f-826e-b3a0e1ca7294" ParentLink="Construct_MessageRef" LowerBound="224.43" HigherBound="224.61">
                                    <om:Property Name="Ref" Value="CreditCardCSSingle" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="734d82e3-9908-4ca7-b938-4d67cf70742e" ParentLink="ComplexStatement_Statement" LowerBound="226.1" HigherBound="236.1">
                                    <om:Property Name="Expression" Value="//CreditCardCSSingle= xpath(CardsDetailsReqResponseMultiPart.parameters,&quot;/*[local-name()='GetCreditCardDetailsResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='GetCreditCardDetailsResult' and namespace-uri()='http://tempuri.org/']/*[local-name()='ActiveCreditCards' and namespace-uri()='http://schemas.datacontract.org/2004/07/IProfiles'][&quot;+strCounter+&quot;]&quot;);&#xD;&#xA;//CreditCardCSSingle= xpath(CreditCardCS,&quot;/*[local-name()='SendCreditCardERP']/*[local-name()='SendCreditCardERPDetails']/*[local-name()='ActiveCreditCards'][&quot;+strCounter+&quot;]&quot;);&#xD;&#xA;//sXpath = System.String.Format(&quot;(/*[local-name()='SendCreditCardERP']/*[local-name()='SendCreditCardERPDetails']/*[local-name()='ActiveCreditCards'])[{0}]&quot;,counter);&#xD;&#xA;//CreditCardCSSingle = xpath(CreditCardCSXXX,sXpath); &#xD;&#xA;&#xD;&#xA;sXpath = System.String.Format(&quot;//ActiveCreditCards[{0}]&quot;,counter);&#xD;&#xA;CreditCardCSSingle = xpath(CreditCardCSXXX,sXpath); &#xD;&#xA;&#xD;&#xA;alias= xpath(CreditCardCSSingle,&quot;string(//alias)&quot;);" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="Assign SingleCard" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="b8319383-2b83-458e-abfb-f9fec69008ed" ParentLink="ComplexStatement_Statement" LowerBound="237.1" HigherBound="256.1">
                                <om:Property Name="Expression" Value="&#xD;&#xA;cardID= xpath(CreditCardCSSingle,  &quot;string(//cardID)&quot;);&#xD;&#xA;isTolas= xpath(CreditCardCSSingle,&quot;string(//is_Tolas)&quot;);&#xD;&#xA;erpAccountNo= xpath(CreditCardCSSingle,&quot;string(//erp_account_id)&quot;);&#xD;&#xA;alias= xpath(CreditCardCSSingle,&quot;string(//alias)&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;in loopa&quot;, isTolas);&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;in loop&quot;, cntCards.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Extract Key values" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="cb8667b5-f84e-4046-a9a8-9ffd1a998010" ParentLink="ComplexStatement_Statement" LowerBound="256.1" HigherBound="286.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="isBAM" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="16ad29be-04fc-4a21-9d12-7abacc5c2975" ParentLink="ReallyComplexStatement_Branch" LowerBound="257.33" HigherBound="286.1">
                                    <om:Property Name="Expression" Value="enableBam" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="YES" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="VariableAssignment" OID="d1e2dfcd-6547-4bdd-8083-7cbec20b9b58" ParentLink="ComplexStatement_Statement" LowerBound="259.1" HigherBound="285.1">
                                        <om:Property Name="Expression" Value="// set bam variables&#xD;&#xA;activityName= &quot;active_credit_cards&quot;;&#xD;&#xA;guid= System.Guid.NewGuid();&#xD;&#xA;activityID= guid.ToString()+ &quot;_&quot;+ System.DateTime.Now.ToString();&#xD;&#xA;&#xD;&#xA;if (isTolas.ToLower()==&quot;false&quot;)&#xD;&#xA;{&#xD;&#xA;targetERP= &quot;SOP&quot;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (isTolas.ToLower()==&quot;true&quot;)&#xD;&#xA;{&#xD;&#xA;targetERP= &quot;TOLAS&quot;;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.BeginActivity(activityName,activityID);&#xD;&#xA;Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(activityName,activityID,&quot;CSCardRcv&quot;,System.DateTime.UtcNow,&#xD;&#xA;&quot;CardID&quot;,cardID,&#xD;&#xA;&quot;Destination&quot;,targetERP,&#xD;&#xA;&quot;Alias&quot;,alias,&#xD;&#xA;&quot;ERPAccountNo&quot;,erpAccountNo);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Track BAM 1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="a49e1fcf-5c3c-4c02-892b-7bf86a4e1faf" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="a68d1f5f-05d2-4ad6-b968-3f113d01e1a3" ParentLink="ComplexStatement_Statement" LowerBound="286.1" HigherBound="292.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Construct_sendERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="7a01a610-3cdb-4ac1-ba5b-9e1b38cad7b0" ParentLink="Construct_MessageRef" LowerBound="287.43" HigherBound="287.52">
                                    <om:Property Name="Ref" Value="sendToERP" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="8dd8a925-28a7-4370-bac8-c11366c358a0" ParentLink="ComplexStatement_Statement" LowerBound="289.1" HigherBound="291.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ActiveCreditCards.Maps.CreditCardCS_ToCreditCardERP" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_ERPMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="fac52cd9-3695-41ec-9cd8-b75a6ad9248a" ParentLink="Transform_OutputMessagePartRef" LowerBound="290.48" HigherBound="290.57">
                                        <om:Property Name="MessageRef" Value="sendToERP" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="76c40807-d2dc-44d8-bc86-b7a932d84d48" ParentLink="Transform_InputMessagePartRef" LowerBound="290.132" HigherBound="290.150">
                                        <om:Property Name="MessageRef" Value="CreditCardCSSingle" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="3e9c60da-80f4-45af-a0ce-25da4f62a9d8" ParentLink="ComplexStatement_Statement" LowerBound="292.1" HigherBound="305.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ARCHIVE" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="b6f93666-3733-4c9c-96fb-d86668bcc9bd" ParentLink="ReallyComplexStatement_Branch" LowerBound="293.33" HigherBound="305.1">
                                    <om:Property Name="Expression" Value="isArchive == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="TRUE" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="c687818a-879f-4642-af68-107e57791f6e" ParentLink="ComplexStatement_Statement" LowerBound="295.1" HigherBound="302.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Construct_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="073df8a8-5bf6-4caa-8c5b-9a6aff36a924" ParentLink="ComplexStatement_Statement" LowerBound="298.1" HigherBound="301.1">
                                            <om:Property Name="Expression" Value="archiveERPSend= sendToERP;&#xD;&#xA;archiveERPSend(FILE.ReceivedFileName)=&quot;ActiveCardsERPMsg_&quot;+targetERP+&quot;_&quot;+erpAccountNo ;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_2" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="6198ed8d-0c6e-45de-b490-4e7dcbaeb5ab" ParentLink="Construct_MessageRef" LowerBound="296.47" HigherBound="296.61">
                                            <om:Property Name="Ref" Value="archiveERPSend" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="f5bd66cf-84b8-44e1-85f1-ac03c86becce" ParentLink="ComplexStatement_Statement" LowerBound="302.1" HigherBound="304.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveERPFF" />
                                        <om:Property Name="MessageName" Value="archiveERPSend" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="30c52653-9768-48b1-b484-db5b6b292e50" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="b42fd64d-ae55-40bf-a0cc-54047fac4910" ParentLink="ComplexStatement_Statement" LowerBound="305.1" HigherBound="388.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="check for Null" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="340bfc2e-8b41-4a9b-951c-a1e50dc7f82d" ParentLink="ReallyComplexStatement_Branch" LowerBound="306.33" HigherBound="377.1">
                                    <om:Property Name="Expression" Value="isTolas!=null &amp;&amp; ( isTolas!= System.String.Empty)" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="not null " />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Scope" OID="e6da235c-d05a-4339-8fed-c770756f34b4" ParentLink="ComplexStatement_Statement" LowerBound="308.1" HigherBound="363.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Scope_MQDelivery" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="2152d3ef-52a8-45a8-bd5a-0f8230583724" ParentLink="ComplexStatement_Statement" LowerBound="313.1" HigherBound="321.1">
                                            <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;in loopx&quot;, cntCards.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Extract Key values" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Decision" OID="a3884813-23e7-4339-9fad-c746ece6aa51" ParentLink="ComplexStatement_Statement" LowerBound="321.1" HigherBound="332.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Decide_ERPTarget" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="DecisionBranch" OID="d45a5b10-9304-48bc-96a2-a374ce4714e0" ParentLink="ReallyComplexStatement_Branch" LowerBound="322.45" HigherBound="327.1">
                                                <om:Property Name="Expression" Value="System.Convert.ToBoolean(isTolas)" />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="TOLAS" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="Send" OID="9d611df6-4bb1-4d45-8d6e-4753077e08da" ParentLink="ComplexStatement_Statement" LowerBound="324.1" HigherBound="326.1">
                                                    <om:Property Name="PortName" Value="SendTOLAS" />
                                                    <om:Property Name="MessageName" Value="sendToERP" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Send_TOLAS" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="d002a05c-e5d0-4eac-b175-fd70f2e6c792" ParentLink="ReallyComplexStatement_Branch">
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="SOP" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="Send" OID="c2dad4fa-289d-48d6-ac55-047708f6f035" ParentLink="ComplexStatement_Statement" LowerBound="329.1" HigherBound="331.1">
                                                    <om:Property Name="PortName" Value="SendSOPPort" />
                                                    <om:Property Name="MessageName" Value="sendToERP" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Send_SOP" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="LongRunningTransaction" OID="cd487528-3018-4e55-95e6-0c3ce61631a4" ParentLink="Scope_Transaction" LowerBound="309.55" HigherBound="309.100">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transaction_Delivery" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="f9d14683-7fd1-408f-85f3-032a469c271e" ParentLink="Scope_Catch" LowerBound="335.1" HigherBound="361.1">
                                            <om:Property Name="ExceptionName" Value="deliveryException" />
                                            <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.BaseTypes.DeliveryFailureException" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Catch_DeliveryFailure" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="285ae0c7-e81a-49a3-804d-12ee8ff9af91" ParentLink="Catch_Statement" LowerBound="338.1" HigherBound="341.1">
                                                <om:Property Name="Expression" Value="counter= counter+1;&#xD;&#xA;strCounter= System.Convert.ToString(counter);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Increment Counters" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="d47525da-85a5-4f80-ab1f-6bda8f1bd318" ParentLink="Catch_Statement" LowerBound="341.1" HigherBound="356.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Construct_faultMessage" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageAssignment" OID="0d2f7f84-25b1-40bd-8e41-fab9d35aa5ca" ParentLink="ComplexStatement_Statement" LowerBound="344.1" HigherBound="355.1">
                                                    <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;&#xD;&#xA;faultMessage.FailureCategory=&quot;Delivery Failure to MQ&quot;;&#xD;&#xA;faultMessage.FaultDescription=deliveryException.Message;&#xD;&#xA;faultMessage.FaultCode=&quot;5003&quot;;&#xD;&#xA;faultMessage.FaultSeverity= severity;&#xD;&#xA;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_3" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="3bb42477-ee47-432a-a269-cd524706eafb" ParentLink="Construct_MessageRef" LowerBound="342.59" HigherBound="342.71">
                                                    <om:Property Name="Ref" Value="faultMessage" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="91824e3c-0d02-45ad-8480-5d7980b6238d" ParentLink="Catch_Statement" LowerBound="356.1" HigherBound="358.1">
                                                <om:Property Name="PortName" Value="SendFaultPort" />
                                                <om:Property Name="MessageName" Value="faultMessage" />
                                                <om:Property Name="OperationName" Value="FaultPort" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_fault" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="4f3f4c6e-651d-469b-8ebf-b3ceea5fc619" ParentLink="Catch_Statement" LowerBound="358.1" HigherBound="360.1">
                                                <om:Property Name="Expression" Value="throw new System.Exception(&quot;Active Credit Card not Delivered to MQ&quot;);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throw exception" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Decision" OID="a741d32c-219d-4436-87c5-008fda337630" ParentLink="ComplexStatement_Statement" LowerBound="363.1" HigherBound="369.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="isBAM" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="509fa147-2a20-4377-b68f-976e0a02447d" ParentLink="ReallyComplexStatement_Branch" LowerBound="364.37" HigherBound="369.1">
                                            <om:Property Name="Expression" Value="enableBam" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="YES" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="64b3c7e2-f9d7-4d0c-8624-6af49cfd35a0" ParentLink="ComplexStatement_Statement" LowerBound="366.1" HigherBound="368.1">
                                                <om:Property Name="Expression" Value="Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(activityName,activityID,&quot;ERPSent&quot;,System.DateTime.UtcNow);&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Track BAM 2" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="c252c64e-b015-41c0-ae18-2495552cb71d" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Decision" OID="d37f7e96-1438-491e-9144-b96e556bafde" ParentLink="ComplexStatement_Statement" LowerBound="369.1" HigherBound="376.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="isBAM" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="ac080e48-28cd-4bfc-a0e8-a673c75e0c8b" ParentLink="ReallyComplexStatement_Branch" LowerBound="370.37" HigherBound="376.1">
                                            <om:Property Name="Expression" Value="enableBam" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="YES" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="bb055c2f-7a45-4b84-b925-c5c30504b6c3" ParentLink="ComplexStatement_Statement" LowerBound="372.1" HigherBound="375.1">
                                                <om:Property Name="Expression" Value="Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(activityName,activityID,&quot;CSAckSent&quot;,System.DateTime.UtcNow);&#xD;&#xA;Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.EndActivity(activityName,activityID);&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Track BAM 3" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="ecd92662-4adf-435a-90bf-1ec2f2e245b2" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="2879f3f5-856d-4ed6-add0-c66f6e0e6158" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="VariableAssignment" OID="6c1faffb-f7db-418a-a5a7-038c98dfea01" ParentLink="ComplexStatement_Statement" LowerBound="379.1" HigherBound="387.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;in loopn&quot;, cntCards.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Extract Key values" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="d9ca057e-2e99-4171-ad92-0012409b84ec" ParentLink="ComplexStatement_Statement" LowerBound="388.1" HigherBound="391.1">
                                <om:Property Name="Expression" Value="counter= counter+1;&#xD;&#xA;strCounter= System.Convert.ToString(counter);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Increment Counters" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Catch" OID="6289f7ee-ffb4-4dd3-9561-63d00da14386" ParentLink="Scope_Catch" LowerBound="394.1" HigherBound="418.1">
                                <om:Property Name="ExceptionName" Value="InnerEx" />
                                <om:Property Name="ExceptionType" Value="System.Exception" />
                                <om:Property Name="IsFaultMessage" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Catch_InnerException" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="84797da6-0e80-4e9b-9dd2-8db11c7056f3" ParentLink="Catch_Statement" LowerBound="397.1" HigherBound="400.1">
                                    <om:Property Name="Expression" Value="counter= counter+1;&#xD;&#xA;strCounter= System.Convert.ToString(counter);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Increment Counters" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Construct" OID="444ca738-d4f0-4d8a-930c-73f0eddae36a" ParentLink="Catch_Statement" LowerBound="400.1" HigherBound="415.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_faultMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="78b427ac-d759-4a8d-9834-ebbb3841988a" ParentLink="ComplexStatement_Statement" LowerBound="403.1" HigherBound="414.1">
                                        <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;&#xD;&#xA;faultMessage.FailureCategory=&quot;Acitve Credit Cards&quot;;&#xD;&#xA;faultMessage.FaultDescription= cardID +&quot; &quot; + erpAccountNo + &quot; &quot; + InnerEx.Message;&#xD;&#xA;faultMessage.FaultCode=&quot;5002&quot;;&#xD;&#xA;faultMessage.FaultSeverity= severity;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="ef81b2ff-6fa9-4b5e-96c2-35c43501fae6" ParentLink="Construct_MessageRef" LowerBound="401.47" HigherBound="401.59">
                                        <om:Property Name="Ref" Value="faultMessage" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="9f0cc244-950a-4cb8-96ee-298f7f7eda5f" ParentLink="Catch_Statement" LowerBound="415.1" HigherBound="417.1">
                                    <om:Property Name="PortName" Value="SendFaultPort" />
                                    <om:Property Name="MessageName" Value="faultMessage" />
                                    <om:Property Name="OperationName" Value="FaultPort" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_fault" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="15765a25-d888-4bf9-968d-e200070f3d83" ParentLink="Scope_Catch" LowerBound="424.1" HigherBound="445.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch_OuterException" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="1cd8d515-f217-46a8-b35b-da9842b456ce" ParentLink="Catch_Statement" LowerBound="427.1" HigherBound="442.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_faultMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="2634ce51-76ce-4e47-9d13-0772a933a96b" ParentLink="Construct_MessageRef" LowerBound="428.35" HigherBound="428.47">
                                <om:Property Name="Ref" Value="faultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="d27ec222-94e4-4791-abbb-df0d7ba84b5d" ParentLink="ComplexStatement_Statement" LowerBound="430.1" HigherBound="441.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;&#xD;&#xA;faultMessage.FailureCategory=&quot;Scope Outer Exception&quot;;&#xD;&#xA;faultMessage.FaultDescription=ex.Message;&#xD;&#xA;faultMessage.FaultCode=&quot;5001&quot;;&#xD;&#xA;faultMessage.FaultSeverity=  Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="af6fca3f-3561-4444-97df-182a306f598d" ParentLink="Catch_Statement" LowerBound="442.1" HigherBound="444.1">
                            <om:Property Name="PortName" Value="SendFaultPort" />
                            <om:Property Name="MessageName" Value="faultMessage" />
                            <om:Property Name="OperationName" Value="FaultPort" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_fault" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="6a2eed89-563b-42d8-a236-239340979b43" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="105.1" HigherBound="107.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="142" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.SendFaultPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendFaultPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="16e10261-e56d-446a-8a71-4a9b0a3d153b" ParentLink="PortDeclaration_CLRAttribute" LowerBound="105.1" HigherBound="106.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="9f3a4d6e-291a-4936-8325-030e2f28c857" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="107.1" HigherBound="109.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="46" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.archiveBulkRespPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveBulkRespPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="9417bbf6-50b7-4665-b35b-8e8a23b70066" ParentLink="PortDeclaration_CLRAttribute" LowerBound="107.1" HigherBound="108.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="9874f8c7-e460-4f07-b43c-5d370307bfb9" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="109.1" HigherBound="112.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="92" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="Transmitted" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.SendToERPPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendTOLAS" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="acf89186-1df7-4ea9-b52c-0278f9ef4e48" ParentLink="PortDeclaration_CLRAttribute" LowerBound="109.1" HigherBound="110.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="8db46da7-b526-4e0b-92a8-79709cfb266e" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="112.1" HigherBound="115.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="109" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="Transmitted" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.SendSOPPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendSOPPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="8065db15-bab9-41ba-a5f3-0372d458e8bc" ParentLink="PortDeclaration_CLRAttribute" LowerBound="112.1" HigherBound="113.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="c990f944-ecac-4dcd-9ee5-9493b42e8717" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="115.1" HigherBound="117.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="5" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.rcvCreditCardsCS_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="rcvCreditCardsCS" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="5a3d0fde-9e04-4f08-b335-3734a491fc6b" ParentLink="PortDeclaration_CLRAttribute" LowerBound="115.1" HigherBound="116.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="d11b63ec-a5bf-41f2-b4c8-7cd114e80933" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="117.1" HigherBound="119.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ActiveCreditCards.PortType_TESTERPFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveERPFF" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="372ec207-223f-4684-a02d-365349e669b8" ParentLink="PortDeclaration_CLRAttribute" LowerBound="117.1" HigherBound="118.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ActiveCreditCards
{
    public porttype rcvCreditCardsCSPortType
    {
        oneway Operation_1
        {
            Schemas.SendCreditCardERP
        };
    };
    internal porttype SendToERPPortType
    {
        oneway Operation_1
        {
            Schemas.CreditCardToERP
        };
    };
    internal porttype archivePortType
    {
        oneway Operation_1
        {
            Schemas.CreditCardToERP
        };
    };
    internal porttype SendSOPPortType
    {
        oneway Operation_1
        {
            Schemas.CreditCardToERP
        };
    };
    internal porttype SendFaultPortType
    {
        oneway FaultPort
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype archiveBulkRespPortType
    {
        oneway Operation_1
        {
            Schemas.SendCreditCardERP
        };
    };
    public porttype rcvCreditCardsCS_PortType
    {
        oneway Operation_1
        {
            Schemas.SendCreditCardERP
        };
    };
    internal porttype PortType_Single
    {
        oneway Operation_1
        {
            Schemas.SingleCreditCardCS
        };
    };
    internal porttype PortType_TESTERPFF
    {
        oneway Operation_1
        {
            Schemas.CreditCardToERP
        };
    };
    internal porttype PortType_Test
    {
        oneway Operation_1
        {
            Schemas.SendCreditCardERP
        };
    };
    internal porttype PortType_ERPTest2
    {
        oneway Operation_1
        {
            Schemas.CreditCardToERP
        };
    };
    internal porttype PortType_1
    {
        oneway Operation_1
        {
            Schemas.SingleCreditCardCS
        };
    };
    internal porttype PortType_2
    {
        oneway Operation_1
        {
            Schemas.SendCreditCardERP
        };
    };
    internal porttype PortType_3
    {
        oneway Operation_1
        {
            Schemas.SingleCreditCardCS
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service longrunning transaction SendActiveCreditCards
    {
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses SendFaultPortType SendFaultPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses archiveBulkRespPortType archiveBulkRespPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        [Microsoft.XLANGs.BaseTypes.DeliveryNotification(Microsoft.XLANGs.BaseTypes.DeliveryNotification.NotificationLevel.Transmitted)]
        port uses SendToERPPortType SendTOLAS;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        [Microsoft.XLANGs.BaseTypes.DeliveryNotification(Microsoft.XLANGs.BaseTypes.DeliveryNotification.NotificationLevel.Transmitted)]
        port uses SendSOPPortType SendSOPPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements rcvCreditCardsCS_PortType rcvCreditCardsCS;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_TESTERPFF Port_ArchiveERPFF;
        message Schemas.SingleCreditCardCS CreditCardCSSingle;
        message Schemas.SendCreditCardERP archiveBulkRequest;
        message Schemas.CreditCardToERP archiveERPSend;
        message Schemas.CreditCardToERP sendToERP;
        message Schemas.SendCreditCardERP CreditCardCS;
        message Schemas.SendCreditCardERP SingleCardCS;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage faultMessage;
        message Schemas.SendCreditCardERP CardCS;
        message System.Xml.XmlDocument Message_XML;
        message Schemas.SingleCreditCardCS SingleCreditCardCS;
        message System.Xml.XmlDocument Message_XMLWork1;
        message System.Xml.XmlDocument Message_XMLWork2;
        message System.Text.StringBuilder vsb;
        message Schemas.SendCreditCardERPXXX CreditCardCSXXX;
        System.String activityID;
        System.String activityName;
        System.Boolean isArchive;
        System.String isTolas;
        System.Xml.XmlDocument xmlListResponse;
        System.String cardID;
        System.Xml.XmlDocument xmlquery;
        System.String erpAccountNo;
        System.Xml.XmlDocument xmldocUpdateProfile;
        System.Int32 cntCards;
        System.Int32 counter;
        System.String strCounter;
        System.Int32 severity;
        System.Boolean enableBam;
        System.String targetERP;
        System.String alias;
        System.Guid guid;
        System.String sXpath;
        System.String myXPath;
        System.String myValue;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fa25754c-5b5f-4fb5-9a64-f90e4a515ade")]
            activate receive (rcvCreditCardsCS.Operation_1, CreditCardCS);
            activityID = "";
            activityName = "";
            isArchive = true;
            isTolas = "";
            xmlListResponse = new System.Xml.XmlDocument();
            cardID = "";
            xmlquery = new System.Xml.XmlDocument();
            erpAccountNo = "";
            xmldocUpdateProfile = new System.Xml.XmlDocument();
            strCounter = "";
            enableBam = true;
            targetERP = "";
            alias = "";
            sXpath = "";
            myXPath = "";
            myValue = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0fdfc699-3edb-4b79-b90e-63aeaf8c8082")]
            scope longrunning transaction Transaction_1
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd7c90b5-82d4-4e67-a8fa-05c045d90165")]
                    if (isArchive == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c220132f-b6fe-44bb-ac96-76a1a3661a1d")]
                        construct archiveBulkRequest
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3edfbdd4-b8be-400e-a8e5-b31b842fddc8")]
                            archiveBulkRequest = CreditCardCS;
                            archiveBulkRequest(FILE.ReceivedFileName)="ActiveCreditCardRecord";
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ad43eb13-831b-4c1b-8736-1bf30e590503")]
                        send (archiveBulkRespPort.Operation_1, archiveBulkRequest);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("39fa9f3e-d576-43fb-91a9-78523653cb5f")]
                    construct CreditCardCSXXX
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("77298b23-e73d-4dec-8d5d-971eff11a82d")]
                        transform (CreditCardCSXXX) = BTNextGen.Biztalk.ActiveCreditCards.Transform_CSXXX1 (CreditCardCS);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("21895dd3-e9f1-497c-bd1c-c3c1844dacd3")]
                    isArchive=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ActiveCreditCards","isArchive"));
                    enableBam=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ActiveCreditCards","bamEnabled"));
                    severity=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ActiveCreditCards","faultSeverity"));
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7979b07c-28cb-4d4c-abfa-1b59c6e45243")]
                    cntCards= 0;
                    cntCards= System.Convert.ToInt32(xpath(CreditCardCS,                "count(/*[local-name()='SendCreditCardERP']/*[local-name()='SendCreditCardERPDetails']/*[local-name()='ActiveCreditCards'])"));
                    
                    counter=1;
                    strCounter="1";
                    
                    System.Diagnostics.EventLog.WriteEntry("No of active cards", cntCards.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("No of active xxxx", cntCards.ToString());
                    
                    
                    
                    
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6059eaf4-c222-4ed9-aa02-6acc95ea03ba")]
                    while (counter <= cntCards)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("46826616-3228-44e5-9ede-f6d470159d39")]
                        scope longrunning transaction Transaction_2
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("99908a79-dd01-4feb-8243-513cabe58b9a")]
                                construct CreditCardCSSingle
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("734d82e3-9908-4ca7-b938-4d67cf70742e")]
                                    //CreditCardCSSingle= xpath(CardsDetailsReqResponseMultiPart.parameters,"/*[local-name()='GetCreditCardDetailsResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='GetCreditCardDetailsResult' and namespace-uri()='http://tempuri.org/']/*[local-name()='ActiveCreditCards' and namespace-uri()='http://schemas.datacontract.org/2004/07/IProfiles']["+strCounter+"]");
                                    //CreditCardCSSingle= xpath(CreditCardCS,"/*[local-name()='SendCreditCardERP']/*[local-name()='SendCreditCardERPDetails']/*[local-name()='ActiveCreditCards']["+strCounter+"]");
                                    //sXpath = System.String.Format("(/*[local-name()='SendCreditCardERP']/*[local-name()='SendCreditCardERPDetails']/*[local-name()='ActiveCreditCards'])[{0}]",counter);
                                    //CreditCardCSSingle = xpath(CreditCardCSXXX,sXpath); 
                                    
                                    sXpath = System.String.Format("//ActiveCreditCards[{0}]",counter);
                                    CreditCardCSSingle = xpath(CreditCardCSXXX,sXpath); 
                                    
                                    alias= xpath(CreditCardCSSingle,"string(//alias)");
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b8319383-2b83-458e-abfb-f9fec69008ed")]
                                
                                cardID= xpath(CreditCardCSSingle,  "string(//cardID)");
                                isTolas= xpath(CreditCardCSSingle,"string(//is_Tolas)");
                                erpAccountNo= xpath(CreditCardCSSingle,"string(//erp_account_id)");
                                alias= xpath(CreditCardCSSingle,"string(//alias)");
                                
                                
                                
                                
                                
                                
                                System.Diagnostics.EventLog.WriteEntry("in loopa", isTolas);
                                
                                System.Diagnostics.EventLog.WriteEntry("in loop", cntCards.ToString());
                                
                                
                                
                                
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb8667b5-f84e-4046-a9a8-9ffd1a998010")]
                                if (enableBam)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d1e2dfcd-6547-4bdd-8083-7cbec20b9b58")]
                                    // set bam variables
                                    activityName= "active_credit_cards";
                                    guid= System.Guid.NewGuid();
                                    activityID= guid.ToString()+ "_"+ System.DateTime.Now.ToString();
                                    
                                    if (isTolas.ToLower()=="false")
                                    {
                                    targetERP= "SOP";
                                    }
                                    
                                    if (isTolas.ToLower()=="true")
                                    {
                                    targetERP= "TOLAS";
                                    }
                                    
                                    
                                    
                                    Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.BeginActivity(activityName,activityID);
                                    Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(activityName,activityID,"CSCardRcv",System.DateTime.UtcNow,
                                    "CardID",cardID,
                                    "Destination",targetERP,
                                    "Alias",alias,
                                    "ERPAccountNo",erpAccountNo);
                                    
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a68d1f5f-05d2-4ad6-b968-3f113d01e1a3")]
                                construct sendToERP
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8dd8a925-28a7-4370-bac8-c11366c358a0")]
                                    transform (sendToERP) = BTNextGen.Biztalk.ActiveCreditCards.Maps.CreditCardCS_ToCreditCardERP (CreditCardCSSingle);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e9c60da-80f4-45af-a0ce-25da4f62a9d8")]
                                if (isArchive == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c687818a-879f-4642-af68-107e57791f6e")]
                                    construct archiveERPSend
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("073df8a8-5bf6-4caa-8c5b-9a6aff36a924")]
                                        archiveERPSend= sendToERP;
                                        archiveERPSend(FILE.ReceivedFileName)="ActiveCardsERPMsg_"+targetERP+"_"+erpAccountNo ;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f5bd66cf-84b8-44e1-85f1-ac03c86becce")]
                                    send (Port_ArchiveERPFF.Operation_1, archiveERPSend);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b42fd64d-ae55-40bf-a0cc-54047fac4910")]
                                if (isTolas!=null && ( isTolas!= System.String.Empty))
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e6da235c-d05a-4339-8fed-c770756f34b4")]
                                    scope synchronized longrunning transaction Transaction_Delivery
                                    {
                                        body
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2152d3ef-52a8-45a8-bd5a-0f8230583724")]
                                            
                                            
                                            System.Diagnostics.EventLog.WriteEntry("in loopx", cntCards.ToString());
                                            
                                            
                                            
                                            
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a3884813-23e7-4339-9fad-c746ece6aa51")]
                                            if (System.Convert.ToBoolean(isTolas))
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9d611df6-4bb1-4d45-8d6e-4753077e08da")]
                                                send (SendTOLAS.Operation_1, sendToERP);
                                            }
                                            else 
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c2dad4fa-289d-48d6-ac55-047708f6f035")]
                                                send (SendSOPPort.Operation_1, sendToERP);
                                            }
                                        }
                                        exceptions
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f9d14683-7fd1-408f-85f3-032a469c271e")]
                                            catch (Microsoft.XLANGs.BaseTypes.DeliveryFailureException deliveryException)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("285ae0c7-e81a-49a3-804d-12ee8ff9af91")]
                                                counter= counter+1;
                                                strCounter= System.Convert.ToString(counter);
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d47525da-85a5-4f80-ab1f-6bda8f1bd318")]
                                                construct faultMessage
                                                {
                                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0d2f7f84-25b1-40bd-8e41-fab9d35aa5ca")]
                                                    // Create fault exception Message
                                                    faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                                    
                                                    // Assign Properties
                                                    
                                                    faultMessage.FailureCategory="Delivery Failure to MQ";
                                                    faultMessage.FaultDescription=deliveryException.Message;
                                                    faultMessage.FaultCode="5003";
                                                    faultMessage.FaultSeverity= severity;
                                                    
                                                }
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("91824e3c-0d02-45ad-8480-5d7980b6238d")]
                                                send (SendFaultPort.FaultPort, faultMessage);
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f3f4c6e-651d-469b-8ebf-b3ceea5fc619")]
                                                throw new System.Exception("Active Credit Card not Delivered to MQ");
                                            }
                                        }
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a741d32c-219d-4436-87c5-008fda337630")]
                                    if (enableBam)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("64b3c7e2-f9d7-4d0c-8624-6af49cfd35a0")]
                                        Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(activityName,activityID,"ERPSent",System.DateTime.UtcNow);
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d37f7e96-1438-491e-9144-b96e556bafde")]
                                    if (enableBam)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bb055c2f-7a45-4b84-b925-c5c30504b6c3")]
                                        Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(activityName,activityID,"CSAckSent",System.DateTime.UtcNow);
                                        Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.EndActivity(activityName,activityID);
                                    }
                                }
                                else 
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6c1faffb-f7db-418a-a5a7-038c98dfea01")]
                                    
                                    
                                    System.Diagnostics.EventLog.WriteEntry("in loopn", cntCards.ToString());
                                    
                                    
                                    
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d9ca057e-2e99-4171-ad92-0012409b84ec")]
                                counter= counter+1;
                                strCounter= System.Convert.ToString(counter);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6289f7ee-ffb4-4dd3-9561-63d00da14386")]
                                catch (System.Exception InnerEx)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("84797da6-0e80-4e9b-9dd2-8db11c7056f3")]
                                    counter= counter+1;
                                    strCounter= System.Convert.ToString(counter);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("444ca738-d4f0-4d8a-930c-73f0eddae36a")]
                                    construct faultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("78b427ac-d759-4a8d-9834-ebbb3841988a")]
                                        // Create fault exception Message
                                        faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        
                                        faultMessage.FailureCategory="Acitve Credit Cards";
                                        faultMessage.FaultDescription= cardID +" " + erpAccountNo + " " + InnerEx.Message;
                                        faultMessage.FaultCode="5002";
                                        faultMessage.FaultSeverity= severity;
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f0cc244-950a-4cb8-96ee-298f7f7eda5f")]
                                    send (SendFaultPort.FaultPort, faultMessage);
                                }
                            }
                        }
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("15765a25-d888-4bf9-968d-e200070f3d83")]
                    catch (System.Exception ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1cd8d515-f217-46a8-b35b-da9842b456ce")]
                        construct faultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d27ec222-94e4-4791-abbb-df0d7ba84b5d")]
                            // Create fault exception Message
                            faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            
                            faultMessage.FailureCategory="Scope Outer Exception";
                            faultMessage.FaultDescription=ex.Message;
                            faultMessage.FaultCode="5001";
                            faultMessage.FaultSeverity=  Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("af6fca3f-3561-4444-97df-182a306f598d")]
                        send (SendFaultPort.FaultPort, faultMessage);
                    }
                }
            }
        }
    }
}

