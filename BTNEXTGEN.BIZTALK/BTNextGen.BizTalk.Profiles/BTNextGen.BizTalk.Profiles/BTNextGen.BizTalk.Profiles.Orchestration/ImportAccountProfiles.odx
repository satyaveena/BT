#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="2861da2f-02f8-4acb-9768-69adf9edf286" LowerBound="1.1" HigherBound="537.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="ServiceDeclaration" OID="3ad3de33-daf1-472c-a240-a0b5b0a0fb31" ParentLink="Module_ServiceDeclaration" LowerBound="60.1" HigherBound="536.1">
            <om:Property Name="InitializedTransactionType" Value="True" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ImportAccountProfiles" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="b6d82fa7-a72a-421b-a132-d2526212fd04" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="101.1" HigherBound="102.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="legacyOrgID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ae3246cc-121f-41f8-8aca-785dd7244ce4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="102.1" HigherBound="103.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="faultErrorDesc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7fcb4263-e77e-4e12-90bd-47356d14826c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="103.1" HigherBound="104.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="61412626-8dbc-414b-a6e3-b4b95429d182" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="104.1" HigherBound="105.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="processFurther" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1b788788-1f34-49b6-b060-88b1ab319bdd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="105.1" HigherBound="106.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strExistingOrgName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="08865ba7-4469-4f6b-a81a-11d9bf9f08d3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="106.1" HigherBound="107.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDocTemp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="841c88ac-748e-489d-972b-9c8d327c9901" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="107.1" HigherBound="108.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="orgGuid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="abf127f2-58d5-480a-a115-8d15fefe866e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="108.1" HigherBound="109.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="isFailed" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e2d77017-d7f3-4de1-b961-deade9aa4938" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="109.1" HigherBound="110.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlWCF_IN" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2befc9df-a6f0-4fbd-b01a-96e86ce09cb3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="110.1" HigherBound="111.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="isCommException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a3dc245e-3077-4151-a6d5-0a67f414da10" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="111.1" HigherBound="112.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmldoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="322c08ef-e249-45cf-b196-5a0712c4d0cf" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="112.1" HigherBound="113.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strResponseText" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="426fe5bf-323d-4eee-b7f6-faf58da86cc8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="113.1" HigherBound="114.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intInvalidResponseCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="923163d8-bd3a-42f9-b6fd-adcf0f30ff65" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="114.1" HigherBound="115.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="udtIdentityAccount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="60e71f50-87f1-4250-aad0-c79aadd5a259" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="115.1" HigherBound="116.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="legacySource" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="23f81acd-d2c3-4f2d-bc89-be57284f23dc" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="116.1" HigherBound="117.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="isArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a0a48419-ed67-4f12-81ec-bac2f69ec9c5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="117.1" HigherBound="118.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accGuid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="812c3203-6f0a-4a24-8754-0dce80500f83" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="118.1" HigherBound="119.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="billToGuid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2e4bbe8d-484c-472f-955d-1f0df26e2bb2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="119.1" HigherBound="120.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="billToCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="83180100-56f0-4ae8-b7e5-74e7260730df" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="120.1" HigherBound="121.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strCompleteErrorResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e7addfc3-2380-4634-b3ee-e4b2e16b92b4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="121.1" HigherBound="122.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="delaySecs" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="LongRunningTransaction" OID="6d81b490-48c0-4ee1-8eb7-c0fdd1472ec8" ParentLink="ServiceDeclaration_Transaction" LowerBound="61.21" HigherBound="61.67">
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Transaction_Orch" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1a7003ed-9f43-4036-81d8-871d45559fcb" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ChkAssocBillToOut" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ce8e242f-9d75-4e64-a19c-0434c38166ce" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="82.1" HigherBound="83.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="chkAssocBillToIn" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="86a2cc25-ea31-4465-a611-ca18b5c6256c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="83.1" HigherBound="84.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveChkAcctsWCFOut" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ca45d6f6-d83c-4c5a-a0b7-dcce9b6b8e61" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="84.1" HigherBound="85.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveChkAcctsWCFIn" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a6285208-eb0b-4d8b-8da4-326439a24eaa" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="85.1" HigherBound="86.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="billToCSResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="7aae746b-e0af-4e6b-9ab8-d37d9ef46cb4" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="86.1" HigherBound="87.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.BTProfile" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountsBillToCS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4f5ee298-dddc-45c7-877b-38274ab75d6a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="87.1" HigherBound="88.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountsUpdateBillTo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="123e00d6-02bc-4232-86c0-3629be954e56" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="88.1" HigherBound="89.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="faultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="55d22131-1ff3-4dd5-913d-3b3763f832e5" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="89.1" HigherBound="90.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1c59df85-40f3-43ca-9bd8-5f90100abaf2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="90.1" HigherBound="91.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Schemas.SetAccountProfileStatus.procSetBTAccountError" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="updateLegacyResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="b47981b9-d8ab-4a1d-a595-28fc9a4ee892" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="91.1" HigherBound="92.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountProfilesResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="89a5a6dd-4fd4-4466-8be0-189fb6962cd0" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="92.1" HigherBound="93.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.BTProfile" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountProfilesCommerce" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="530046e8-1035-492a-8afb-624cdcaf2974" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="93.1" HigherBound="94.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountProfileLegacy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="32012e4d-0f26-4592-8a96-ab5ed7f93173" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="94.1" HigherBound="95.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveOut" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2800ee46-102f-4039-bd19-ec677c916225" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="95.1" HigherBound="96.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveIn" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="468e2fb1-6908-4c16-abcd-b359020d4073" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="96.1" HigherBound="97.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountsInput_MM" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="be5456f3-3bab-4674-9739-f375bccfe3a4" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="97.1" HigherBound="98.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountsOutPut_MM" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="04518509-76ac-4319-97f4-85fc46f2691d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="98.1" HigherBound="99.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.IProfile_tempuri_org.UpdatePartialProfile" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="accountsUpdate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c31b9883-dd66-4629-a8ba-3867805abac7" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="99.1" HigherBound="100.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="chkAssociatedAccountsIn" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4f3bd81c-eff3-4c2c-a292-08dfd3b5c0da" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="100.1" HigherBound="101.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="chkAssociatedAccountsOut" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="65741a2a-dd3b-4d66-8f3c-1f27410eaa2a" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="bea8c60c-404e-4a88-b289-3c2114208187" ParentLink="ServiceBody_Statement" LowerBound="124.1" HigherBound="144.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="ReceiveAccountsLegacyPort" />
                    <om:Property Name="MessageName" Value="accountProfileLegacy" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Rcv_accountProfileLegacy" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DNFPredicate" OID="113b213e-2f2f-49bc-8c87-b411854e3317" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/procGetBTAccount#StoredProcedureResultSet0&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="e7cc5bb7-358e-41c9-9b2b-515d0c1b4958" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;InvokeImport&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="Scope" OID="92b954dd-ae4f-4d0a-86b0-1c3d6c71f96d" ParentLink="ServiceBody_Statement" LowerBound="144.1" HigherBound="534.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Overall" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableAssignment" OID="b4961a23-cd00-43ba-b1f9-04ea9fa6c71d" ParentLink="ComplexStatement_Statement" LowerBound="149.1" HigherBound="161.1">
                        <om:Property Name="Expression" Value="legacySource=accountProfileLegacy.legacy_source_system;&#xD;&#xA;legacyOrgID= accountProfileLegacy.legacy_org_id;&#xD;&#xA;udtIdentityAccount=accountProfileLegacy.UdtIdentityAccount;&#xD;&#xA;accGuid=accountProfileLegacy.ShipToAccountGUID;&#xD;&#xA;orgGuid=accountProfileLegacy.CSOrgGUID;&#xD;&#xA;&#xD;&#xA;// Initialize variable&#xD;&#xA;&#xD;&#xA;processFurther=true;&#xD;&#xA;isFailed= false;&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="get legacy details" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="0134f351-e0e3-4bdb-acd3-17b85b48d663" ParentLink="ComplexStatement_Statement" LowerBound="161.1" HigherBound="165.1">
                        <om:Property Name="Expression" Value="isArchive=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.BizTalk.Profiles&quot;,&quot;AccountsProfileArchive&quot;));&#xD;&#xA;delaySecs=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.BizTalk.Profiles&quot;,&quot;delayAccounts&quot;));&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Get SSO value" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Task" OID="be3085af-2848-4ec3-bd7f-2c47e4142745" ParentLink="ComplexStatement_Statement" LowerBound="165.1" HigherBound="297.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Group_ShipTo" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="246a3b84-42cd-4793-8fb3-28ea2fd59d57" ParentLink="ComplexStatement_Statement" LowerBound="165.1" HigherBound="175.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_chkAssociatedAccountsIn" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="5ba501ab-5fe2-42e6-ae65-938919747d2f" ParentLink="Construct_MessageRef" LowerBound="166.31" HigherBound="166.54">
                                <om:Property Name="Ref" Value="chkAssociatedAccountsIn" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="fe6dfebb-9fa2-40c3-8a95-bfe937fde083" ParentLink="ComplexStatement_Statement" LowerBound="168.1" HigherBound="174.1">
                                <om:Property Name="Expression" Value="xmlDocTemp.LoadXml(&quot;&lt;ns0:CheckAssociatedAccounts xmlns:ns0=\&quot;http://tempuri.org/\&quot;&gt;&lt;ns0:singleAccount&gt;singleAccount_0&lt;/ns0:singleAccount&gt;&lt;ns0:orgID&gt;orgID_0&lt;/ns0:orgID&gt;&lt;ns0:legacyOrg&gt;legacyOrg_0&lt;/ns0:legacyOrg&gt;&lt;/ns0:CheckAssociatedAccounts&gt;&quot;);&#xD;&#xA;chkAssociatedAccountsIn.parameters= xmlDocTemp;&#xD;&#xA;chkAssociatedAccountsIn.parameters.singleAccount= accGuid;&#xD;&#xA;chkAssociatedAccountsIn.parameters.orgID= orgGuid;&#xD;&#xA;chkAssociatedAccountsIn.parameters.legacyOrg= legacyOrgID.ToString();" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="assign_chkAssociatedAccountsIn" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="6549979b-67d0-4874-9376-83c605a07c35" ParentLink="ComplexStatement_Statement" LowerBound="175.1" HigherBound="197.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Archive_In" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="7e29de96-a71f-4a3d-93f0-07d52eda98d0" ParentLink="ReallyComplexStatement_Branch" LowerBound="176.21" HigherBound="197.1">
                                <om:Property Name="Expression" Value="isArchive" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="YES" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="519947b9-809e-4aea-8d66-e80d05e9f95e" ParentLink="ComplexStatement_Statement" LowerBound="178.1" HigherBound="185.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_archiveIn" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="8f1b7775-fa05-439c-9af5-faba8efcb748" ParentLink="Construct_MessageRef" LowerBound="179.35" HigherBound="179.44">
                                        <om:Property Name="Ref" Value="archiveIn" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="c9108a8c-1f23-452e-b293-2ebc89455107" ParentLink="ComplexStatement_Statement" LowerBound="181.1" HigherBound="184.1">
                                        <om:Property Name="Expression" Value="archiveIn=accountProfileLegacy;&#xD;&#xA;archiveIn(FILE.ReceivedFileName)=&quot;AccountProfileFromLegacy_&quot;+legacyOrgID.ToString();" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="a577f3cc-fb22-45c0-96ce-54d26ee42136" ParentLink="ComplexStatement_Statement" LowerBound="185.1" HigherBound="192.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_ArchivewcfReq" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="458d86b3-31d0-426c-874d-1bcfa4ab67f7" ParentLink="Construct_MessageRef" LowerBound="186.35" HigherBound="186.55">
                                        <om:Property Name="Ref" Value="archiveChkAcctsWCFIn" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="af14fb16-5aea-456d-bcfd-e85ef7a79713" ParentLink="ComplexStatement_Statement" LowerBound="188.1" HigherBound="191.1">
                                        <om:Property Name="Expression" Value="archiveChkAcctsWCFIn=chkAssociatedAccountsIn;&#xD;&#xA;archiveChkAcctsWCFIn(FILE.ReceivedFileName)=&quot;CheckAcctsWCFReq_&quot;+legacyOrgID.ToString();" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="assign filename" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="02f27b5d-99c5-4595-9ae6-78cb3b22995a" ParentLink="ComplexStatement_Statement" LowerBound="192.1" HigherBound="194.1">
                                    <om:Property Name="PortName" Value="archiveInPort" />
                                    <om:Property Name="MessageName" Value="archiveIn" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_archiveIn" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Send" OID="18bfb738-aea1-4b22-8e9a-710c90d30b2c" ParentLink="ComplexStatement_Statement" LowerBound="194.1" HigherBound="196.1">
                                    <om:Property Name="PortName" Value="archiveWCFInPort" />
                                    <om:Property Name="MessageName" Value="archiveChkAcctsWCFIn" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_ArchveWcfReq" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="7b6d1d4a-0349-41b1-ade9-34b70ec56c8b" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="0e6cff89-73d3-40f1-b55e-32bb1968b324" ParentLink="ComplexStatement_Statement" LowerBound="197.1" HigherBound="199.1">
                            <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                            <om:Property Name="MessageName" Value="chkAssociatedAccountsIn" />
                            <om:Property Name="OperationName" Value="CheckAssociatedAccounts" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_wcf" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="4da90a80-c692-4867-b73e-890ad28b78c6" ParentLink="ComplexStatement_Statement" LowerBound="199.1" HigherBound="201.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                            <om:Property Name="MessageName" Value="chkAssociatedAccountsOut" />
                            <om:Property Name="OperationName" Value="CheckAssociatedAccounts" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_wcf" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="321f110f-536c-4875-80ce-8d47aea86146" ParentLink="ComplexStatement_Statement" LowerBound="201.1" HigherBound="214.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Archive" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="fc912f5b-6a0b-4de0-8f68-c8cfe838d9c4" ParentLink="ReallyComplexStatement_Branch" LowerBound="202.21" HigherBound="214.1">
                                <om:Property Name="Expression" Value="isArchive" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="YES" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="6328be1c-76dd-46ba-914c-91986fa66243" ParentLink="ComplexStatement_Statement" LowerBound="204.1" HigherBound="211.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_archive" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="d7a0baaf-f193-44c5-981c-2c236c3a29e1" ParentLink="ComplexStatement_Statement" LowerBound="207.1" HigherBound="210.1">
                                        <om:Property Name="Expression" Value="archiveChkAcctsWCFOut=chkAssociatedAccountsOut;&#xD;&#xA;archiveChkAcctsWCFOut(FILE.ReceivedFileName)=&quot;CheckAcctsWCFResponse_&quot;+legacyOrgID.ToString();" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Assign_fileName" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="26430d36-1790-4a24-a223-c0ad9bc3a5af" ParentLink="Construct_MessageRef" LowerBound="205.35" HigherBound="205.56">
                                        <om:Property Name="Ref" Value="archiveChkAcctsWCFOut" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="e80ddfc8-7d32-4f67-8712-390d8ffd5ffd" ParentLink="ComplexStatement_Statement" LowerBound="211.1" HigherBound="213.1">
                                    <om:Property Name="PortName" Value="archiveWcfResponsePort" />
                                    <om:Property Name="MessageName" Value="archiveChkAcctsWCFOut" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="6f7783ce-93f2-4b16-8f92-d22e3eb8d3ba" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="c6fe239c-269f-416a-9d27-0c3a6ccdeec2" ParentLink="ComplexStatement_Statement" LowerBound="214.1" HigherBound="232.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="check association" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="e02b0b11-9d5f-44a9-991c-de6d09b06370" ParentLink="ReallyComplexStatement_Branch" LowerBound="215.21" HigherBound="226.1">
                                <om:Property Name="Expression" Value="chkAssociatedAccountsOut.parameters.CheckAssociatedAccountsResult.IsAssociated==true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Already associated" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="a302c1ed-0a63-46e4-bbc0-457e5317befb" ParentLink="ComplexStatement_Statement" LowerBound="217.1" HigherBound="225.1">
                                    <om:Property Name="Expression" Value="strExistingOrgName= chkAssociatedAccountsOut.parameters.CheckAssociatedAccountsResult.orgName;&#xD;&#xA;processFurther= false;&#xD;&#xA;strResponseText= &quot;SHIPTO : The account was previously associated with organization: &quot; + strExistingOrgName +&quot;.&quot;;&#xD;&#xA;strCompleteErrorResponse.AppendLine(strResponseText);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.BizTalk.Profiles&quot;,&quot;Shipto previously associted &quot; + accGuid + &quot;: &quot; + strCompleteErrorResponse.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="process=FALSE" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="8d206394-6f06-4c6f-bda5-276090007229" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="67fe80ff-1500-4eff-addb-ab9fb2748e73" ParentLink="ComplexStatement_Statement" LowerBound="228.1" HigherBound="231.1">
                                    <om:Property Name="Expression" Value="processFurther= true;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="process= TRUE" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="17eafc2b-dca2-4b35-be13-7b95c4d67d93" ParentLink="ComplexStatement_Statement" LowerBound="232.1" HigherBound="297.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Check Process  Flag" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="e8076d13-9d77-4720-977d-8e497c855844" ParentLink="ReallyComplexStatement_Branch" LowerBound="233.21" HigherBound="297.1">
                                <om:Property Name="Expression" Value="processFurther" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="TRUE" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="60c85131-7a9e-4dd0-92b2-377e2d67d9a6" ParentLink="ComplexStatement_Statement" LowerBound="235.1" HigherBound="241.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_ShipTOAccounts" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="dd6fb888-6d8f-4967-b3c1-781068de53cd" ParentLink="Construct_MessageRef" LowerBound="236.35" HigherBound="236.58">
                                        <om:Property Name="Ref" Value="accountProfilesCommerce" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Transform" OID="9303a3fe-bfcd-4510-8322-de4501870298" ParentLink="ComplexStatement_Statement" LowerBound="238.1" HigherBound="240.1">
                                        <om:Property Name="ClassName" Value="BTNextGen.BizTalk.Profiles.Maps.AccountsLegacy_To_AccountsCommerce" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Transform_shipTo" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessagePartRef" OID="58366231-1e97-4451-b9df-2a5a23657515" ParentLink="Transform_InputMessagePartRef" LowerBound="239.135" HigherBound="239.155">
                                            <om:Property Name="MessageRef" Value="accountProfileLegacy" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="6b642c23-c452-403b-8148-1173ca626f72" ParentLink="Transform_OutputMessagePartRef" LowerBound="239.40" HigherBound="239.63">
                                            <om:Property Name="MessageRef" Value="accountProfilesCommerce" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_2" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="7c6af69a-122e-436e-afda-7fd9f6714f9a" ParentLink="ComplexStatement_Statement" LowerBound="241.1" HigherBound="250.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_AccountsInputMM" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="6d9dd4c0-f06b-4b5e-89fb-30b8adda2117" ParentLink="Construct_MessageRef" LowerBound="242.35" HigherBound="242.51">
                                        <om:Property Name="Ref" Value="accountsInput_MM" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Transform" OID="7a2f92af-c621-4d9b-8a0a-0e3cb346a648" ParentLink="ComplexStatement_Statement" LowerBound="244.1" HigherBound="246.1">
                                        <om:Property Name="ClassName" Value="BTNextGen.BizTalk.Profiles.Maps.BTProfile_To_UpdateAccounts" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Transform_WCFRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessagePartRef" OID="d6c19bec-154d-4c50-b463-46390d744cb8" ParentLink="Transform_InputMessagePartRef" LowerBound="245.132" HigherBound="245.155">
                                            <om:Property Name="MessageRef" Value="accountProfilesCommerce" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_3" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="d12dd5b2-5179-4fc0-8ce8-fab0ab74ec53" ParentLink="Transform_OutputMessagePartRef" LowerBound="245.40" HigherBound="245.67">
                                            <om:Property Name="MessageRef" Value="accountsInput_MM" />
                                            <om:Property Name="PartRef" Value="parameters" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_4" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="665d5c2c-f837-4f72-b916-d190812f04c8" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="249.1">
                                        <om:Property Name="Expression" Value="accountsInput_MM.parameters.profileKey= accGuid;&#xD;&#xA;accountsInput_MM.parameters.profileObjectName=&quot;BTAccount&quot;;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Assign_Guid" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Decision" OID="e3a5490d-feab-4ae9-8f4d-a7a511c2a388" ParentLink="ComplexStatement_Statement" LowerBound="250.1" HigherBound="263.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Archive_Out" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="b97c78a1-e024-4214-8714-746a0a60cadc" ParentLink="ReallyComplexStatement_Branch" LowerBound="251.25" HigherBound="263.1">
                                        <om:Property Name="Expression" Value="isArchive" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="YES" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="416bf2cc-6c87-4e95-a41d-0b12086a5b15" ParentLink="ComplexStatement_Statement" LowerBound="253.1" HigherBound="260.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_archiveOut" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="a352a140-b27b-44c0-be47-8bb6365e6875" ParentLink="Construct_MessageRef" LowerBound="254.39" HigherBound="254.49">
                                                <om:Property Name="Ref" Value="archiveOut" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="109c62fd-35f3-4855-9849-330aa4b82d2f" ParentLink="ComplexStatement_Statement" LowerBound="256.1" HigherBound="259.1">
                                                <om:Property Name="Expression" Value="archiveOut=accountsInput_MM;&#xD;&#xA;archiveOut(FILE.ReceivedFileName)=&quot;AccountProfilesToCommerceServer_&quot;+legacyOrgID.ToString();" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_1" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="acd18d07-48b5-4be2-90d3-fb6e8f8e9080" ParentLink="ComplexStatement_Statement" LowerBound="260.1" HigherBound="262.1">
                                            <om:Property Name="PortName" Value="archiveOutPort" />
                                            <om:Property Name="MessageName" Value="archiveOut" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_archiveOut" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="8030aceb-1495-4252-b865-abb63bbf1c4a" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="a8d7922c-22ed-4faf-824e-80be0e660618" ParentLink="ComplexStatement_Statement" LowerBound="263.1" HigherBound="265.1">
                                    <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                                    <om:Property Name="MessageName" Value="accountsInput_MM" />
                                    <om:Property Name="OperationName" Value="UpdatePartialProfile" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_accountsWCF" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="f68d6fdd-b72e-44c9-b753-0c5dd89fe0f5" ParentLink="ComplexStatement_Statement" LowerBound="265.1" HigherBound="267.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                                    <om:Property Name="MessageName" Value="accountProfilesResponse" />
                                    <om:Property Name="OperationName" Value="UpdatePartialProfile" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="rcv_accountsResponse" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Decision" OID="a8908c2e-e18e-4c13-87a3-42358ab8ca0f" ParentLink="ComplexStatement_Statement" LowerBound="267.1" HigherBound="280.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Archive_Response" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="2e8eff4e-29d0-4330-80a3-2d455dcb92c3" ParentLink="ReallyComplexStatement_Branch" LowerBound="268.25" HigherBound="280.1">
                                        <om:Property Name="Expression" Value="isArchive" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="YES" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="4babad09-1828-434f-8fd2-aeb310c34feb" ParentLink="ComplexStatement_Statement" LowerBound="270.1" HigherBound="277.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_archiveProfileResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="db4be7f1-c8d4-4a08-9ccc-9066bed3f476" ParentLink="Construct_MessageRef" LowerBound="271.39" HigherBound="271.54">
                                                <om:Property Name="Ref" Value="archiveResponse" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="248f7801-7a08-4e12-ad47-0abbb00e9871" ParentLink="ComplexStatement_Statement" LowerBound="273.1" HigherBound="276.1">
                                                <om:Property Name="Expression" Value="archiveResponse=accountProfilesResponse;&#xD;&#xA;archiveResponse(FILE.ReceivedFileName)=&quot;AccountsProfilesResponseCommerce_&quot;+legacyOrgID.ToString();" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Assign_FileName" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="d12fce49-aa7c-4b69-bb48-cbd4efbe32b6" ParentLink="ComplexStatement_Statement" LowerBound="277.1" HigherBound="279.1">
                                            <om:Property Name="PortName" Value="archiveResponsePort" />
                                            <om:Property Name="MessageName" Value="archiveResponse" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Snd_archiveResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="75cd7d54-4fc2-40d7-89e5-c29e0d75ae16" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="8a66cf9e-cc96-4fb1-a7f3-0674d8695887" ParentLink="ComplexStatement_Statement" LowerBound="280.1" HigherBound="283.1">
                                    <om:Property Name="Expression" Value="strResponseText=(xpath(accountProfilesResponse.parameters,&quot;string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])&quot;));&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get InvalidResponse Count " />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Decision" OID="6fc349a3-b61f-439a-adf9-0fcc8681ba3f" ParentLink="ComplexStatement_Statement" LowerBound="283.1" HigherBound="296.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Decide_RespType" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="7f5c1cd4-ed14-47e0-9b62-7974695f814c" ParentLink="ReallyComplexStatement_Branch" LowerBound="284.25" HigherBound="296.1">
                                        <om:Property Name="Expression" Value="strResponseText.Contains(&quot;Failed&quot;)" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ERROR " />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="9ad1e625-3005-4d60-b65c-d60c44ac3a04" ParentLink="ComplexStatement_Statement" LowerBound="286.1" HigherBound="295.1">
                                            <om:Property Name="Expression" Value="strResponseText=(xpath(accountProfilesResponse.parameters,&quot;string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])&quot;));&#xD;&#xA;strResponseText= &quot;SHIPTO : &quot;+strResponseText +&quot;.&quot;;&#xD;&#xA;&#xD;&#xA;strCompleteErrorResponse.AppendLine(strResponseText);&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.BizTalk.Profiles&quot;,&quot;Shipto ERROR response &quot; + accGuid + &quot;: &quot; + strCompleteErrorResponse.ToString());&#xD;&#xA;&#xD;&#xA;isFailed= true;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Get error response" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="c51f7ab4-0319-4e85-b2f7-197bfe662bdb" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="c61a0e90-a4f0-4d0e-a106-fc0ed0027693" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Delay" OID="5ff641c7-539f-40a4-be8e-7019da11ee67" ParentLink="ComplexStatement_Statement" LowerBound="297.1" HigherBound="299.1">
                        <om:Property Name="Timeout" Value="new System.TimeSpan(0,0,delaySecs);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Delay_1" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Task" OID="d63eb546-b701-4974-b39f-0066803b6f81" ParentLink="ComplexStatement_Statement" LowerBound="299.1" HigherBound="425.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Group_BillTo" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="d368bcb7-03a7-4b75-8b88-2f363ce8ca05" ParentLink="ComplexStatement_Statement" LowerBound="299.1" HigherBound="302.1">
                            <om:Property Name="Expression" Value="billToCount=System.Convert.ToInt32(xpath(accountProfileLegacy,&quot;count(/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/procGetBTAccount']/*[local-name()='BILLTOAccountGUID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/procGetBTAccount'])&quot;));&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="check BillTO" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Decision" OID="5d242480-6134-4048-9f24-a2e3f6880fbb" ParentLink="ComplexStatement_Statement" LowerBound="302.1" HigherBound="425.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="check BILLTO" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="eda9532f-f40f-4fec-a1ed-fbfaef5e7b00" ParentLink="ReallyComplexStatement_Branch" LowerBound="303.21" HigherBound="425.1">
                                <om:Property Name="Expression" Value="billToCount &gt; 0" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="BILL TO" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="b1d6fd50-975b-4f7e-921e-9a1574edd230" ParentLink="ComplexStatement_Statement" LowerBound="305.1" HigherBound="307.1">
                                    <om:Property Name="Expression" Value="billToGuid= accountProfileLegacy.BILLTOAccountGUID;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="extract bill TO" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Construct" OID="1a820d9f-f3aa-4c48-a834-f7ba82449189" ParentLink="ComplexStatement_Statement" LowerBound="307.1" HigherBound="317.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_chkAssociatedAccountsIn" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="897f584f-38b6-41c5-a373-2813fadfe195" ParentLink="Construct_MessageRef" LowerBound="308.35" HigherBound="308.51">
                                        <om:Property Name="Ref" Value="chkAssocBillToIn" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="05d3b6b7-0c2b-4d47-b572-d1d8bdda13e3" ParentLink="ComplexStatement_Statement" LowerBound="310.1" HigherBound="316.1">
                                        <om:Property Name="Expression" Value="xmlDocTemp.LoadXml(&quot;&lt;ns0:CheckAssociatedAccounts xmlns:ns0=\&quot;http://tempuri.org/\&quot;&gt;&lt;ns0:singleAccount&gt;singleAccount_0&lt;/ns0:singleAccount&gt;&lt;ns0:orgID&gt;orgID_0&lt;/ns0:orgID&gt;&lt;ns0:legacyOrg&gt;legacyOrg_0&lt;/ns0:legacyOrg&gt;&lt;/ns0:CheckAssociatedAccounts&gt;&quot;);&#xD;&#xA;chkAssocBillToIn.parameters= xmlDocTemp;&#xD;&#xA;chkAssocBillToIn.parameters.singleAccount= billToGuid;&#xD;&#xA;chkAssocBillToIn.parameters.orgID= orgGuid;&#xD;&#xA;chkAssocBillToIn.parameters.legacyOrg= legacyOrgID.ToString();" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="assign_chkAssociatedAccountsIn" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Decision" OID="e37e1dbb-40b3-40b0-86ac-4771758f61a6" ParentLink="ComplexStatement_Statement" LowerBound="317.1" HigherBound="330.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Archive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="b9390a47-814f-425d-9131-6138efc5d592" ParentLink="ReallyComplexStatement_Branch" LowerBound="318.25" HigherBound="330.1">
                                        <om:Property Name="Expression" Value="isArchive" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="YES" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="22a8196e-f2ad-4c33-9b34-163547b2ef9d" ParentLink="ComplexStatement_Statement" LowerBound="320.1" HigherBound="327.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_wcfReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="5c1cd604-8163-4d81-8bba-f37063da26f6" ParentLink="Construct_MessageRef" LowerBound="321.39" HigherBound="321.59">
                                                <om:Property Name="Ref" Value="archiveChkAcctsWCFIn" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="b6310406-4207-429e-bc24-28852707a467" ParentLink="ComplexStatement_Statement" LowerBound="323.1" HigherBound="326.1">
                                                <om:Property Name="Expression" Value="archiveChkAcctsWCFIn=chkAssocBillToIn;&#xD;&#xA;archiveChkAcctsWCFIn(FILE.ReceivedFileName)=&quot;CheckAcctsWCFReq_BillTo_&quot;+legacyOrgID.ToString();" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assign filename" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="5a6b1bf8-54a4-4a2b-840d-dd99ed75bda6" ParentLink="ComplexStatement_Statement" LowerBound="327.1" HigherBound="329.1">
                                            <om:Property Name="PortName" Value="archiveWCFInPort" />
                                            <om:Property Name="MessageName" Value="archiveChkAcctsWCFIn" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_ArchveWcfReq" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="7e441ee1-b2f2-4340-887a-63c3925330b5" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="89bd0550-4e75-4a0d-b97e-5b3b33c6b399" ParentLink="ComplexStatement_Statement" LowerBound="330.1" HigherBound="332.1">
                                    <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                                    <om:Property Name="MessageName" Value="chkAssocBillToIn" />
                                    <om:Property Name="OperationName" Value="CheckAssociatedAccounts" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf_req" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="012efe04-4a60-4d00-99bd-d7b5e5f38b40" ParentLink="ComplexStatement_Statement" LowerBound="332.1" HigherBound="334.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                                    <om:Property Name="MessageName" Value="ChkAssocBillToOut" />
                                    <om:Property Name="OperationName" Value="CheckAssociatedAccounts" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf_response" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Decision" OID="c3705dbf-1660-4369-9cf6-2f8e4e02f79e" ParentLink="ComplexStatement_Statement" LowerBound="334.1" HigherBound="347.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Archive wcf response" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="7cf9ee67-d0d4-4a36-8075-311e2a6db0ca" ParentLink="ReallyComplexStatement_Branch" LowerBound="335.25" HigherBound="347.1">
                                        <om:Property Name="Expression" Value="isArchive" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="YES" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Construct" OID="c020aa74-1d79-45d4-9791-89fa0fdf5315" ParentLink="ComplexStatement_Statement" LowerBound="337.1" HigherBound="344.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_archive" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="4da11952-dad8-4205-bee9-12a7017b317b" ParentLink="ComplexStatement_Statement" LowerBound="340.1" HigherBound="343.1">
                                                <om:Property Name="Expression" Value="archiveChkAcctsWCFOut=ChkAssocBillToOut;&#xD;&#xA;archiveChkAcctsWCFOut(FILE.ReceivedFileName)=&quot;CheckAcctsWCFResponse_BillTo_&quot;+legacyOrgID.ToString();" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Assign_fileName" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="ce431833-ecd5-44b0-bc74-7d756003c398" ParentLink="Construct_MessageRef" LowerBound="338.39" HigherBound="338.60">
                                                <om:Property Name="Ref" Value="archiveChkAcctsWCFOut" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="1531adfe-135f-4b00-a739-9a347cc81848" ParentLink="ComplexStatement_Statement" LowerBound="344.1" HigherBound="346.1">
                                            <om:Property Name="PortName" Value="archiveWcfResponsePort" />
                                            <om:Property Name="MessageName" Value="archiveChkAcctsWCFOut" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_archive" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="cf4c1d1d-760f-4ede-8ce7-0e7d882ec275" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Decision" OID="991d5734-cbae-47fd-ba9a-f2966f689b57" ParentLink="ComplexStatement_Statement" LowerBound="347.1" HigherBound="366.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="check association" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="b3187316-a8db-48c7-9615-39a18458873b" ParentLink="ReallyComplexStatement_Branch" LowerBound="348.25" HigherBound="360.1">
                                        <om:Property Name="Expression" Value="ChkAssocBillToOut.parameters.CheckAssociatedAccountsResult.IsAssociated==true " />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Already associated" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="3a68d0a1-c74e-4b41-9d7f-6a2344f55c17" ParentLink="ComplexStatement_Statement" LowerBound="350.1" HigherBound="359.1">
                                            <om:Property Name="Expression" Value="strExistingOrgName= ChkAssocBillToOut.parameters.CheckAssociatedAccountsResult.orgName;&#xD;&#xA;processFurther= false;&#xD;&#xA;strResponseText= &quot;BILLTO : The account was previously associated with organization: &quot; + strExistingOrgName +&quot;.&quot;;&#xD;&#xA;strCompleteErrorResponse.AppendLine(strResponseText);&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.BizTalk.Profiles&quot;, &quot;Billto previously associted&quot; + billToGuid+&quot;: &quot; + strCompleteErrorResponse.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="process=FALSE" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="6b60bd04-55ba-496c-bbaf-6b106154fd3b" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="8ec9f459-6d9e-4b2d-be0a-3fd711631705" ParentLink="ComplexStatement_Statement" LowerBound="362.1" HigherBound="365.1">
                                            <om:Property Name="Expression" Value="processFurther= true;&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="set process flag to false" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Decision" OID="02f675a1-08fc-40db-a035-ff1ba456cee7" ParentLink="ComplexStatement_Statement" LowerBound="366.1" HigherBound="424.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Check Process Flag" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="930abc64-a794-4b7e-aa98-9316fde1278d" ParentLink="ReallyComplexStatement_Branch" LowerBound="367.25" HigherBound="424.1">
                                        <om:Property Name="Expression" Value="processFurther" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="TRUE" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="1d8b847a-f1a5-46fb-8aa9-359bf08758f1" ParentLink="ComplexStatement_Statement" LowerBound="369.1" HigherBound="380.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_AccountsUpdateBILLTo" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="fbb244ae-a39b-464e-8a85-2fefc6fbc42f" ParentLink="Construct_MessageRef" LowerBound="370.39" HigherBound="370.59">
                                                <om:Property Name="Ref" Value="accountsUpdateBillTo" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="1ba6de6c-b95b-4a2f-a04b-ed10f87674a4" ParentLink="Construct_MessageRef" LowerBound="370.61" HigherBound="370.77">
                                                <om:Property Name="Ref" Value="accountsBillToCS" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Transform" OID="62b5ec65-c584-4ff3-a972-191b80481700" ParentLink="ComplexStatement_Statement" LowerBound="372.1" HigherBound="374.1">
                                                <om:Property Name="ClassName" Value="BTNextGen.BizTalk.Profiles.Maps.Legacy_To_BilltoAccounts" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Transform_BillToAccounts" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="1b5d0783-5b6f-4dc5-8e02-026439521043" ParentLink="Transform_InputMessagePartRef" LowerBound="373.122" HigherBound="373.142">
                                                    <om:Property Name="MessageRef" Value="accountProfileLegacy" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_5" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="1e2a91e1-83d5-4887-a7b3-e5c46c4dc94b" ParentLink="Transform_OutputMessagePartRef" LowerBound="373.44" HigherBound="373.60">
                                                    <om:Property Name="MessageRef" Value="accountsBillToCS" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_6" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Transform" OID="d723bd38-6a3b-4dad-ba00-2b054248eed5" ParentLink="ComplexStatement_Statement" LowerBound="374.1" HigherBound="376.1">
                                                <om:Property Name="ClassName" Value="BTNextGen.BizTalk.Profiles.Maps.BTProfile_To_UpdateAccounts" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Transform_WCFUpdate" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessagePartRef" OID="3bc0bcb3-18a8-4912-8de2-1397164e494d" ParentLink="Transform_InputMessagePartRef" LowerBound="375.140" HigherBound="375.156">
                                                    <om:Property Name="MessageRef" Value="accountsBillToCS" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_7" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="3e84e5e1-8f23-4239-ac57-93efebc69245" ParentLink="Transform_OutputMessagePartRef" LowerBound="375.44" HigherBound="375.75">
                                                    <om:Property Name="MessageRef" Value="accountsUpdateBillTo" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_8" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="6b7b5094-6507-490f-a525-e725af6e2646" ParentLink="ComplexStatement_Statement" LowerBound="376.1" HigherBound="379.1">
                                                <om:Property Name="Expression" Value="accountsUpdateBillTo.parameters.profileKey= billToGuid;&#xD;&#xA;accountsUpdateBillTo.parameters.profileObjectName=&quot;BTAccount&quot;;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value=" Assign_BillToUpdate" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Decision" OID="676ef4f3-0879-44ba-8449-e0df957d5f0a" ParentLink="ComplexStatement_Statement" LowerBound="380.1" HigherBound="393.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Archive_Out" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="DecisionBranch" OID="fc0a771d-7cff-42c3-acc7-9931c419fed5" ParentLink="ReallyComplexStatement_Branch" LowerBound="381.29" HigherBound="393.1">
                                                <om:Property Name="Expression" Value="isArchive" />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="YES" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="Construct" OID="36f69b08-1e7b-4716-8346-fbd05ac21004" ParentLink="ComplexStatement_Statement" LowerBound="383.1" HigherBound="390.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Construct_archiveOut" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageAssignment" OID="29363ace-5cc7-49ad-a33e-246fc4dc2d85" ParentLink="ComplexStatement_Statement" LowerBound="386.1" HigherBound="389.1">
                                                        <om:Property Name="Expression" Value="archiveOut=accountsUpdateBillTo;&#xD;&#xA;archiveOut(FILE.ReceivedFileName)=&quot;AccountBILLToCommerceServer_&quot;+legacyOrgID.ToString();" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="MessageAssignment_1" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                    <om:Element Type="MessageRef" OID="ddebdc6a-020c-4793-8a8e-41b2778463ca" ParentLink="Construct_MessageRef" LowerBound="384.43" HigherBound="384.53">
                                                        <om:Property Name="Ref" Value="archiveOut" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Send" OID="deb8942b-361d-457b-8b3e-84f618b7330f" ParentLink="ComplexStatement_Statement" LowerBound="390.1" HigherBound="392.1">
                                                    <om:Property Name="PortName" Value="archiveOutPort" />
                                                    <om:Property Name="MessageName" Value="archiveOut" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Send_archiveOut" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="24f53275-bffb-4aaf-9f8a-1d1a4cf92fda" ParentLink="ReallyComplexStatement_Branch">
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Else" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="1b8c0d98-149f-45d2-b64e-c781e1df6c48" ParentLink="ComplexStatement_Statement" LowerBound="393.1" HigherBound="395.1">
                                            <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                                            <om:Property Name="MessageName" Value="accountsUpdateBillTo" />
                                            <om:Property Name="OperationName" Value="UpdatePartialProfile" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_BillToCS" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="e9208716-05c6-42e4-8e28-64357a556d25" ParentLink="ComplexStatement_Statement" LowerBound="395.1" HigherBound="397.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="SendWCFBTAccountPort" />
                                            <om:Property Name="MessageName" Value="billToCSResponse" />
                                            <om:Property Name="OperationName" Value="UpdatePartialProfile" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="RcvResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Decision" OID="442fc656-7eab-4087-8577-d59e33060eb7" ParentLink="ComplexStatement_Statement" LowerBound="397.1" HigherBound="410.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Archive_Response" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="DecisionBranch" OID="a96256ab-d02f-4e02-8dbc-9ea9303002ba" ParentLink="ReallyComplexStatement_Branch" LowerBound="398.29" HigherBound="410.1">
                                                <om:Property Name="Expression" Value="isArchive" />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="YES" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="Construct" OID="982b74ce-d026-42f4-8919-4f44320482ad" ParentLink="ComplexStatement_Statement" LowerBound="400.1" HigherBound="407.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Construct_archiveProfileResponse" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageRef" OID="28039958-3df1-4d66-b7ef-86e6ee8f3672" ParentLink="Construct_MessageRef" LowerBound="401.43" HigherBound="401.58">
                                                        <om:Property Name="Ref" Value="archiveResponse" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessageAssignment" OID="2f931931-e7f4-4a6f-801c-7f46edbd9f5a" ParentLink="ComplexStatement_Statement" LowerBound="403.1" HigherBound="406.1">
                                                        <om:Property Name="Expression" Value="archiveResponse=billToCSResponse;&#xD;&#xA;archiveResponse(FILE.ReceivedFileName)=&quot;AccountsBILLToResponseCommerce_&quot;+legacyOrgID.ToString();" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="Assign_FileName" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Send" OID="680a6e52-c516-45bb-8045-7b2d77725864" ParentLink="ComplexStatement_Statement" LowerBound="407.1" HigherBound="409.1">
                                                    <om:Property Name="PortName" Value="archiveResponsePort" />
                                                    <om:Property Name="MessageName" Value="archiveResponse" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Snd_archiveResponse" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="cfe6aa03-b7a9-47ad-8d07-60454923099a" ParentLink="ReallyComplexStatement_Branch">
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Else" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="VariableAssignment" OID="a67a581d-53bb-4479-803a-89af6cd71732" ParentLink="ComplexStatement_Statement" LowerBound="410.1" HigherBound="413.1">
                                            <om:Property Name="Expression" Value="strResponseText=(xpath(billToCSResponse.parameters,&quot;string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])&quot;));&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Get InvalidResponse Count " />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Decision" OID="195e2f30-a824-4023-8747-4723ef3cad92" ParentLink="ComplexStatement_Statement" LowerBound="413.1" HigherBound="423.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Decide_RespType" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="DecisionBranch" OID="edcc9c93-175a-4b04-9149-9f8ac759c324" ParentLink="ReallyComplexStatement_Branch" LowerBound="414.29" HigherBound="423.1">
                                                <om:Property Name="Expression" Value="strResponseText.Contains(&quot;Failed&quot;)" />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ERROR " />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="VariableAssignment" OID="bf61e99f-6c7b-49bc-ba32-9f30c7f1d1ef" ParentLink="ComplexStatement_Statement" LowerBound="416.1" HigherBound="422.1">
                                                    <om:Property Name="Expression" Value="strResponseText=(xpath(billToCSResponse.parameters,&quot;string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])&quot;));&#xD;&#xA;strResponseText= &quot;BILLTO : &quot; +strResponseText+&quot;.&quot;;&#xD;&#xA;strCompleteErrorResponse.AppendLine(strResponseText);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.BizTalk.Profiles&quot;, &quot;Billto error &quot; + billToGuid + &quot;: &quot; + strCompleteErrorResponse.ToString());&#xD;&#xA;isFailed= true;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Get error response" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="3de63ed0-2e2d-4c22-b3bd-d74e547a5a6f" ParentLink="ReallyComplexStatement_Branch">
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Else" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="90598d12-a269-473e-a041-7222d79dba1c" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="58a51f29-add4-45a2-bdf6-bdb042bf7d52" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="a9b78903-0444-4a66-94cc-2f72e1b1d33c" ParentLink="ComplexStatement_Statement" LowerBound="425.1" HigherBound="446.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="IF ERROR Response" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="8deefc0c-29a9-4b52-bf95-9c0ea334ed2f" ParentLink="ReallyComplexStatement_Branch" LowerBound="426.21" HigherBound="446.1">
                            <om:Property Name="Expression" Value="isFailed || !(processFurther)&#xD;&#xA;&#xD;&#xA;// if there was a failure response or if the shipto/billto account was already associated then send error response to Legacy stored procedure." />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ERROR exists" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="2f9eeeb3-7cf4-4963-9b29-acfcd36c9911" ParentLink="ComplexStatement_Statement" LowerBound="431.1" HigherBound="443.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Construct_updateLegacyResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="2f43c951-de63-4c27-8394-8560ab8c3c67" ParentLink="Construct_MessageRef" LowerBound="432.35" HigherBound="432.55">
                                    <om:Property Name="Ref" Value="updateLegacyResponse" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="b89475c8-990a-4526-b292-8488c4c71df4" ParentLink="ComplexStatement_Statement" LowerBound="434.1" HigherBound="442.1">
                                    <om:Property Name="Expression" Value="xmldoc.LoadXml(&quot;&lt;ns0:procSetBTAccountError xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:pintOrganizationID&gt;10&lt;/ns0:pintOrganizationID&gt;&lt;ns0:pintUdtIdentityAccount&gt;&lt;/ns0:pintUdtIdentityAccount&gt;&lt;ns0:pstrLegacySourceSystem&gt;pstrL&lt;/ns0:pstrLegacySourceSystem&gt;&lt;ns0:pstrLoadStatus&gt;ps&lt;/ns0:pstrLoadStatus&gt;&lt;ns0:pstrLoadError&gt;pstrLoadError_0&lt;/ns0:pstrLoadError&gt;&lt;/ns0:procSetBTAccountError&gt;&quot;);&#xD;&#xA;updateLegacyResponse=xmldoc;&#xD;&#xA;updateLegacyResponse.pstrLoadError=strCompleteErrorResponse.ToString();&#xD;&#xA;updateLegacyResponse.pstrLoadStatus=&quot;CS Failed&quot;;&#xD;&#xA;updateLegacyResponse.pintOrganizationID=legacyOrgID;&#xD;&#xA;updateLegacyResponse.pintUdtIdentityAccount=udtIdentityAccount;&#xD;&#xA;updateLegacyResponse.pstrLegacySourceSystem=legacySource;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="2ef18147-d56e-4265-ad62-9d5df3f62dcc" ParentLink="ComplexStatement_Statement" LowerBound="443.1" HigherBound="445.1">
                                <om:Property Name="PortName" Value="UpdateErrorStatusPort" />
                                <om:Property Name="MessageName" Value="updateLegacyResponse" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Snd_updateLegacyStatus" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="baab9b6e-fe05-43fe-a042-2176f6ae8298" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="LongRunningTransaction" OID="7e5e3e59-a0f5-4b4f-b9b4-27aa6400626b" ParentLink="Scope_Transaction" LowerBound="145.18" HigherBound="145.56">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Transaction_1" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Catch" OID="9bb68c23-27da-4ed7-98c7-3149b57f05f9" ParentLink="Scope_Catch" LowerBound="449.1" HigherBound="486.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch_AllExceptions" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="1f7fc91e-b3e6-4a71-a74c-45a354786268" ParentLink="Catch_Statement" LowerBound="452.1" HigherBound="464.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_updateLegacyResponse" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="ed229012-b433-482e-9c95-ef51d079a9c2" ParentLink="Construct_MessageRef" LowerBound="453.35" HigherBound="453.55">
                                <om:Property Name="Ref" Value="updateLegacyResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="6dc06b2f-e8d6-4d09-b4e6-09fc58a92805" ParentLink="ComplexStatement_Statement" LowerBound="455.1" HigherBound="463.1">
                                <om:Property Name="Expression" Value="xmldoc.LoadXml(&quot;&lt;ns0:procSetBTAccountError xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:pintOrganizationID&gt;10&lt;/ns0:pintOrganizationID&gt;&lt;ns0:pintUdtIdentityAccount&gt;&lt;/ns0:pintUdtIdentityAccount&gt;&lt;ns0:pstrLegacySourceSystem&gt;pstrL&lt;/ns0:pstrLegacySourceSystem&gt;&lt;ns0:pstrLoadStatus&gt;ps&lt;/ns0:pstrLoadStatus&gt;&lt;ns0:pstrLoadError&gt;pstrLoadError_0&lt;/ns0:pstrLoadError&gt;&lt;/ns0:procSetBTAccountError&gt;&quot;);&#xD;&#xA;updateLegacyResponse=xmldoc;&#xD;&#xA;updateLegacyResponse.pstrLoadError=ex.Message.ToString();&#xD;&#xA;updateLegacyResponse.pstrLoadStatus=&quot;CS Failed&quot;;&#xD;&#xA;updateLegacyResponse.pintOrganizationID=legacyOrgID;&#xD;&#xA;updateLegacyResponse.pintUdtIdentityAccount= udtIdentityAccount;&#xD;&#xA;updateLegacyResponse.pstrLegacySourceSystem=legacySource;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="b6e06e55-8eec-423d-ba8e-6008e961c5e2" ParentLink="Catch_Statement" LowerBound="464.1" HigherBound="466.1">
                            <om:Property Name="PortName" Value="UpdateErrorStatusPort" />
                            <om:Property Name="MessageName" Value="updateLegacyResponse" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_legacyResponse" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="4de77434-dca9-4cb6-bffb-18092976db09" ParentLink="Catch_Statement" LowerBound="466.1" HigherBound="483.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_faultMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="2f55c8e8-a4df-4dbf-9b93-9870ce6ea271" ParentLink="ComplexStatement_Statement" LowerBound="469.1" HigherBound="482.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;&#xD;&#xA;faultMessage.FailureCategory=&quot;Commerce Server Exception&quot;;&#xD;&#xA;faultMessage.FaultDescription=ex.Message;&#xD;&#xA;faultMessage.FaultCode=&quot;1005&quot;;&#xD;&#xA;faultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.AddMessage(faultMessage,accountProfileLegacy);&#xD;&#xA;&#xD;&#xA;// this is not being sent anymore to the exception handler.&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="c9a31931-6970-48ff-8987-c967a0343cd0" ParentLink="Construct_MessageRef" LowerBound="467.35" HigherBound="467.47">
                                <om:Property Name="Ref" Value="faultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Suspend" OID="853795de-c7ef-445c-a013-390121282c43" ParentLink="Catch_Statement" LowerBound="483.1" HigherBound="485.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Message Suspended due to error &quot; + ex.Message; " />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Suspend_Message" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="bb4ddd52-9f23-4e2b-96a1-a0421fcd80b7" ParentLink="Scope_Catch" LowerBound="486.1" HigherBound="509.1">
                        <om:Property Name="ExceptionName" Value="wcfFaultException" />
                        <om:Property Name="ExceptionType" Value="SendWCFBTAccountPort.CheckAssociatedAccounts.Fault_CheckAssoAccnts" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch_SoapFault_CheckAssociatedAccounts" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="0b33c095-2bcd-4900-b3f9-e37523185255" ParentLink="Catch_Statement" LowerBound="489.1" HigherBound="492.1">
                            <om:Property Name="Expression" Value="xDoc= wcfFaultException.faultMsgBody;&#xD;&#xA;faultErrorDesc= xDoc.OuterXml;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Extract the fault" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="495f0d2b-80bb-4095-9df1-d92cd6c70533" ParentLink="Catch_Statement" LowerBound="492.1" HigherBound="504.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_updateLegacyResponse" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="f8da40d4-3659-43c6-b094-0d0c133e877a" ParentLink="Construct_MessageRef" LowerBound="493.35" HigherBound="493.55">
                                <om:Property Name="Ref" Value="updateLegacyResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="b7ce510c-2522-4e36-8867-3fa5a3b33d9d" ParentLink="ComplexStatement_Statement" LowerBound="495.1" HigherBound="503.1">
                                <om:Property Name="Expression" Value="xmldoc.LoadXml(&quot;&lt;ns0:procSetBTAccountError xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:pintOrganizationID&gt;10&lt;/ns0:pintOrganizationID&gt;&lt;ns0:pintUdtIdentityAccount&gt;&lt;/ns0:pintUdtIdentityAccount&gt;&lt;ns0:pstrLegacySourceSystem&gt;pstrL&lt;/ns0:pstrLegacySourceSystem&gt;&lt;ns0:pstrLoadStatus&gt;ps&lt;/ns0:pstrLoadStatus&gt;&lt;ns0:pstrLoadError&gt;pstrLoadError_0&lt;/ns0:pstrLoadError&gt;&lt;/ns0:procSetBTAccountError&gt;&quot;);&#xD;&#xA;updateLegacyResponse=xmldoc;&#xD;&#xA;updateLegacyResponse.pstrLoadError=&quot;IProfile service Exception in CheckAssociatedAccounts &quot;+faultErrorDesc;&#xD;&#xA;updateLegacyResponse.pstrLoadStatus=&quot;CS Failed&quot;;&#xD;&#xA;updateLegacyResponse.pintOrganizationID=legacyOrgID;&#xD;&#xA;updateLegacyResponse.pintUdtIdentityAccount= udtIdentityAccount;&#xD;&#xA;updateLegacyResponse.pstrLegacySourceSystem=legacySource;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="355c54c4-152e-41f0-b4cb-8dd07f652634" ParentLink="Catch_Statement" LowerBound="504.1" HigherBound="506.1">
                            <om:Property Name="PortName" Value="UpdateErrorStatusPort" />
                            <om:Property Name="MessageName" Value="updateLegacyResponse" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_error" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Suspend" OID="bf40f1c4-6ee1-4637-bb6d-fa00b016e403" ParentLink="Catch_Statement" LowerBound="506.1" HigherBound="508.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Message Suspended due to error &quot; + faultErrorDesc;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Suspend_Message" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="ff9b3295-6d78-4134-991e-4d0b9a603525" ParentLink="Scope_Catch" LowerBound="509.1" HigherBound="532.1">
                        <om:Property Name="ExceptionName" Value="fault_UpdateProfile" />
                        <om:Property Name="ExceptionType" Value="SendWCFBTAccountPort.UpdatePartialProfile.Fault_UpdateProfile" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch_SoapFault_UpdateProfile" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="b648efc6-df90-468e-a74d-776ca5ce0745" ParentLink="Catch_Statement" LowerBound="512.1" HigherBound="515.1">
                            <om:Property Name="Expression" Value="xDoc= fault_UpdateProfile.faultMsgBody;&#xD;&#xA;faultErrorDesc= xDoc.OuterXml;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Extract the fault" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="f8204ac8-699b-4ef7-a36a-b970cdaf7e1d" ParentLink="Catch_Statement" LowerBound="515.1" HigherBound="527.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_updateLegacyResponse" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="fa8544ed-8ba3-4b74-bfdf-2ee3c8a51d03" ParentLink="Construct_MessageRef" LowerBound="516.35" HigherBound="516.55">
                                <om:Property Name="Ref" Value="updateLegacyResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="2fc39d84-e93d-4ebb-a68c-d5d4aca212bd" ParentLink="ComplexStatement_Statement" LowerBound="518.1" HigherBound="526.1">
                                <om:Property Name="Expression" Value="xmldoc.LoadXml(&quot;&lt;ns0:procSetBTAccountError xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:pintOrganizationID&gt;10&lt;/ns0:pintOrganizationID&gt;&lt;ns0:pintUdtIdentityAccount&gt;&lt;/ns0:pintUdtIdentityAccount&gt;&lt;ns0:pstrLegacySourceSystem&gt;pstrL&lt;/ns0:pstrLegacySourceSystem&gt;&lt;ns0:pstrLoadStatus&gt;ps&lt;/ns0:pstrLoadStatus&gt;&lt;ns0:pstrLoadError&gt;pstrLoadError_0&lt;/ns0:pstrLoadError&gt;&lt;/ns0:procSetBTAccountError&gt;&quot;);&#xD;&#xA;updateLegacyResponse=xmldoc;&#xD;&#xA;updateLegacyResponse.pstrLoadError=&quot;IProfile service Exception in CheckAssociatedAccounts &quot;+faultErrorDesc;&#xD;&#xA;updateLegacyResponse.pstrLoadStatus=&quot;CS Failed&quot;;&#xD;&#xA;updateLegacyResponse.pintOrganizationID=legacyOrgID;&#xD;&#xA;updateLegacyResponse.pintUdtIdentityAccount= udtIdentityAccount;&#xD;&#xA;updateLegacyResponse.pstrLegacySourceSystem=legacySource;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="f21437f0-d808-43e3-aa06-9d2bcb077486" ParentLink="Catch_Statement" LowerBound="527.1" HigherBound="529.1">
                            <om:Property Name="PortName" Value="UpdateErrorStatusPort" />
                            <om:Property Name="MessageName" Value="updateLegacyResponse" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_error" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Suspend" OID="eb532d62-4503-4ea9-9c99-74474e87b320" ParentLink="Catch_Statement" LowerBound="529.1" HigherBound="531.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Message Suspended due to error &quot; + faultErrorDesc;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Suspend_Message" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="33193ed6-4583-4b1f-b3d0-9ce168c18841" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="63.1" HigherBound="65.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="143" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.SendFaultMessagePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendFaultMessagePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="b46edd59-7c81-4eb9-a36f-b24a049874b6" ParentLink="PortDeclaration_CLRAttribute" LowerBound="63.1" HigherBound="64.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="63f7ac64-ce32-4ec7-953f-8c665f85d3cf" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="65.1" HigherBound="67.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="110" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.UpdateErrorStatusPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="UpdateErrorStatusPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="370707a4-0b64-4b28-b4f9-620cc9aa1928" ParentLink="PortDeclaration_CLRAttribute" LowerBound="65.1" HigherBound="66.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="af9c29d1-9fac-4240-915f-e96cb314ab76" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="67.1" HigherBound="69.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="82" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.archiveResponsePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveResponsePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="0d221dfa-1c72-42bf-9e27-ed73f582119d" ParentLink="PortDeclaration_CLRAttribute" LowerBound="67.1" HigherBound="68.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a407bf20-3f35-49d4-b442-6601c73e3868" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="69.1" HigherBound="71.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="93" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.archiveOutPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveOutPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="132cd479-39e9-456f-a1fb-3beb2da3691a" ParentLink="PortDeclaration_CLRAttribute" LowerBound="69.1" HigherBound="70.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="53b0c15f-8503-4251-9aa3-5bf1e9bf4f49" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="71.1" HigherBound="73.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="33" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.archiveInPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveInPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="d12f957a-aa16-4b16-bb55-0deb14f21136" ParentLink="PortDeclaration_CLRAttribute" LowerBound="71.1" HigherBound="72.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="2379e9f7-d666-4858-9a22-10cc482b630d" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="73.1" HigherBound="75.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="38" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.archiveWCFInPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveWCFInPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="73fa78a6-1ad5-4745-b245-a383aa4a2291" ParentLink="PortDeclaration_CLRAttribute" LowerBound="73.1" HigherBound="74.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="c4ffa20c-e677-4ec4-8e7f-ada632deac54" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="75.1" HigherBound="77.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="75" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.archiveWcfResponsePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="archiveWcfResponsePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="fac322ac-ddc1-454a-86d7-5413f35689ce" ParentLink="PortDeclaration_CLRAttribute" LowerBound="75.1" HigherBound="76.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="732e85a2-0c8a-4f0b-b57e-ef3b8b4ddaa5" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="77.1" HigherBound="79.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="29" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendWCFBTAccountPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="9d9386f4-2dbf-4038-9873-0f85eed43221" ParentLink="PortDeclaration_CLRAttribute" LowerBound="77.1" HigherBound="78.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="1afe0b97-746b-434e-8e95-e8335f858a09" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="79.1" HigherBound="81.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="8" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.BizTalk.AccountProfiles.Orchestration.ReceiveAccountsLegacyPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ReceiveAccountsLegacyPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="05899c97-1703-49cf-8c7d-2b6775940f79" ParentLink="PortDeclaration_CLRAttribute" LowerBound="79.1" HigherBound="80.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="6e66f814-c8e7-4d70-81eb-179dcdc0277f" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archiveInPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="27ace520-c872-429e-b5af-d27c1c461713" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="bc36ace3-e125-4fc7-8e4c-273717cc442f" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.113">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="150f8911-d18d-4d1c-a008-15dd4ee68b90" ParentLink="Module_PortType" LowerBound="11.1" HigherBound="18.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archiveOutPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="49bb29c4-b975-4188-b82d-681224fca983" ParentLink="PortType_OperationDeclaration" LowerBound="13.1" HigherBound="17.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="d1732949-3d7a-49f5-8a1d-07659c4fce19" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="15.13" HigherBound="15.97">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="b53e10b6-8edb-40be-9ecf-056a566800d7" ParentLink="Module_PortType" LowerBound="18.1" HigherBound="25.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archiveResponsePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="287586db-5b52-4d67-95b8-9f96fed22db9" ParentLink="PortType_OperationDeclaration" LowerBound="20.1" HigherBound="24.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="adab5bbd-16b5-4e08-9725-c802bcadf18a" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="22.13" HigherBound="22.98">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="4f5f7f8e-22f7-4f62-8d13-c4242205354f" ParentLink="Module_PortType" LowerBound="25.1" HigherBound="32.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="UpdateErrorStatusPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f011a5e9-2980-4643-904d-faad40282653" ParentLink="PortType_OperationDeclaration" LowerBound="27.1" HigherBound="31.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="59ad0ae4-b710-4380-a7ec-7b9ea7f1ee10" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="29.13" HigherBound="29.93">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Schemas.SetAccountProfileStatus.procSetBTAccountError" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="7bc93b3f-f435-4c45-b8b0-331601e67f8c" ParentLink="Module_PortType" LowerBound="32.1" HigherBound="39.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendFaultMessagePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="de5be2b8-2119-4365-aa3a-2969491dd217" ParentLink="PortType_OperationDeclaration" LowerBound="34.1" HigherBound="38.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="26a161a3-f417-4f90-9d0a-2ce3913511d6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="36.13" HigherBound="36.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="5d6ea0b9-b715-4875-a3f2-465e034caaee" ParentLink="Module_PortType" LowerBound="39.1" HigherBound="46.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archiveWCFInPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="1edc35ee-9d49-47aa-b988-c040c698ac14" ParentLink="PortType_OperationDeclaration" LowerBound="41.1" HigherBound="45.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="dc65bc22-28f0-4172-872d-f5307a9cecaa" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="43.13" HigherBound="43.100">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="fe3ad68c-8f3f-4f17-8c79-8464faacde1b" ParentLink="Module_PortType" LowerBound="46.1" HigherBound="53.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="archiveWcfResponsePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="d23f8115-6dc8-44a0-be16-c579fe0f7a27" ParentLink="PortType_OperationDeclaration" LowerBound="48.1" HigherBound="52.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="d0390087-48be-4d61-8121-63eabb7979bb" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="50.13" HigherBound="50.101">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="993123fa-fa75-4bfc-911b-508900234eae" ParentLink="Module_PortType" LowerBound="53.1" HigherBound="60.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ReceiveAccountsLegacyPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="620463c0-5cec-4482-8e6c-8fed2385fc89" ParentLink="PortType_OperationDeclaration" LowerBound="55.1" HigherBound="59.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="6884f3c6-3880-4c29-9849-371a0d2acfe0" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="57.13" HigherBound="57.113">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.BizTalk.AccountProfiles.Orchestration
{
    internal porttype archiveInPortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0
        };
    };
    internal porttype archiveOutPortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage
        };
    };
    internal porttype archiveResponsePortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage
        };
    };
    internal porttype UpdateErrorStatusPortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Schemas.SetAccountProfileStatus.procSetBTAccountError
        };
    };
    internal porttype SendFaultMessagePortType
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype archiveWCFInPortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage
        };
    };
    internal porttype archiveWcfResponsePortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage
        };
    };
    internal porttype ReceiveAccountsLegacyPortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service longrunning transaction ImportAccountProfiles
    {
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses SendFaultMessagePortType SendFaultMessagePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses UpdateErrorStatusPortType UpdateErrorStatusPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses archiveResponsePortType archiveResponsePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses archiveOutPortType archiveOutPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses archiveInPortType archiveInPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses archiveWCFInPortType archiveWCFInPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses archiveWcfResponsePortType archiveWcfResponsePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses BTNextGen.BizTalk.Profiles.Orchestration.IIProfile SendWCFBTAccountPort;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port implements ReceiveAccountsLegacyPortType ReceiveAccountsLegacyPort;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage ChkAssocBillToOut;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage chkAssocBillToIn;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage archiveChkAcctsWCFOut;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage archiveChkAcctsWCFIn;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage billToCSResponse;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.BTProfile accountsBillToCS;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage accountsUpdateBillTo;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage faultMessage;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage archiveResponse;
        message BTNextGen.BizTalk.Profiles.Schemas.SetAccountProfileStatus.procSetBTAccountError updateLegacyResponse;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage accountProfilesResponse;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.BTProfile accountProfilesCommerce;
        message BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0 accountProfileLegacy;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage archiveOut;
        message BTNextGen.BizTalk.Profiles.Schemas.ProcedureResultSet_dbo_procGetBTAccount.StoredProcedureResultSet0 archiveIn;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_InputMessage accountsInput_MM;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_UpdatePartialProfile_OutputMessage accountsOutPut_MM;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.IProfile_tempuri_org.UpdatePartialProfile accountsUpdate;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_InputMessage chkAssociatedAccountsIn;
        message BTNextGen.BizTalk.Profiles.Orchestration.IIProfile_CheckAssociatedAccounts_OutputMessage chkAssociatedAccountsOut;
        System.Int32 legacyOrgID;
        System.String faultErrorDesc;
        System.Xml.XmlDocument xDoc;
        System.Boolean processFurther;
        System.String strExistingOrgName;
        System.Xml.XmlDocument xmlDocTemp;
        System.String orgGuid;
        System.Boolean isFailed;
        System.Xml.XmlDocument xmlWCF_IN;
        System.Boolean isCommException;
        System.Xml.XmlDocument xmldoc;
        System.String strResponseText;
        System.Int32 intInvalidResponseCount;
        System.String udtIdentityAccount;
        System.String legacySource;
        System.Boolean isArchive;
        System.String accGuid;
        System.String billToGuid;
        System.Int32 billToCount;
        System.Text.StringBuilder strCompleteErrorResponse;
        System.Int32 delaySecs;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bea8c60c-404e-4a88-b289-3c2114208187")]
            activate ((BTS.MessageType == "http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/procGetBTAccount#StoredProcedureResultSet0") && (BTS.Operation == "InvokeImport"))receive (ReceiveAccountsLegacyPort.Operation_1, accountProfileLegacy);
            legacyOrgID = 0;
            faultErrorDesc = "";
            xDoc = new System.Xml.XmlDocument();
            processFurther = true;
            strExistingOrgName = "";
            xmlDocTemp = new System.Xml.XmlDocument();
            orgGuid = "";
            isFailed = false;
            xmlWCF_IN = new System.Xml.XmlDocument();
            isCommException = true;
            xmldoc = new System.Xml.XmlDocument();
            strResponseText = "";
            udtIdentityAccount = "";
            legacySource = "";
            isArchive = true;
            accGuid = "";
            billToGuid = "";
            strCompleteErrorResponse = new System.Text.StringBuilder();
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("92b954dd-ae4f-4d0a-86b0-1c3d6c71f96d")]
            scope longrunning transaction Transaction_1
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b4961a23-cd00-43ba-b1f9-04ea9fa6c71d")]
                    legacySource=accountProfileLegacy.legacy_source_system;
                    legacyOrgID= accountProfileLegacy.legacy_org_id;
                    udtIdentityAccount=accountProfileLegacy.UdtIdentityAccount;
                    accGuid=accountProfileLegacy.ShipToAccountGUID;
                    orgGuid=accountProfileLegacy.CSOrgGUID;
                    
                    // Initialize variable
                    
                    processFurther=true;
                    isFailed= false;
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0134f351-e0e3-4bdb-acd3-17b85b48d663")]
                    isArchive=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.BizTalk.Profiles","AccountsProfileArchive"));
                    delaySecs=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read("BTNextGen.BizTalk.Profiles","delayAccounts"));
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("246a3b84-42cd-4793-8fb3-28ea2fd59d57")]
                    construct chkAssociatedAccountsIn
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fe6dfebb-9fa2-40c3-8a95-bfe937fde083")]
                        xmlDocTemp.LoadXml("<ns0:CheckAssociatedAccounts xmlns:ns0=\"http://tempuri.org/\"><ns0:singleAccount>singleAccount_0</ns0:singleAccount><ns0:orgID>orgID_0</ns0:orgID><ns0:legacyOrg>legacyOrg_0</ns0:legacyOrg></ns0:CheckAssociatedAccounts>");
                        chkAssociatedAccountsIn.parameters= xmlDocTemp;
                        chkAssociatedAccountsIn.parameters.singleAccount= accGuid;
                        chkAssociatedAccountsIn.parameters.orgID= orgGuid;
                        chkAssociatedAccountsIn.parameters.legacyOrg= legacyOrgID.ToString();
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6549979b-67d0-4874-9376-83c605a07c35")]
                    if (isArchive)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("519947b9-809e-4aea-8d66-e80d05e9f95e")]
                        construct archiveIn
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c9108a8c-1f23-452e-b293-2ebc89455107")]
                            archiveIn=accountProfileLegacy;
                            archiveIn(FILE.ReceivedFileName)="AccountProfileFromLegacy_"+legacyOrgID.ToString();
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a577f3cc-fb22-45c0-96ce-54d26ee42136")]
                        construct archiveChkAcctsWCFIn
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("af14fb16-5aea-456d-bcfd-e85ef7a79713")]
                            archiveChkAcctsWCFIn=chkAssociatedAccountsIn;
                            archiveChkAcctsWCFIn(FILE.ReceivedFileName)="CheckAcctsWCFReq_"+legacyOrgID.ToString();
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("02f27b5d-99c5-4595-9ae6-78cb3b22995a")]
                        send (archiveInPort.Operation_1, archiveIn);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("18bfb738-aea1-4b22-8e9a-710c90d30b2c")]
                        send (archiveWCFInPort.Operation_1, archiveChkAcctsWCFIn);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0e6cff89-73d3-40f1-b55e-32bb1968b324")]
                    send (SendWCFBTAccountPort.CheckAssociatedAccounts, chkAssociatedAccountsIn);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4da90a80-c692-4867-b73e-890ad28b78c6")]
                    receive (SendWCFBTAccountPort.CheckAssociatedAccounts, chkAssociatedAccountsOut);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("321f110f-536c-4875-80ce-8d47aea86146")]
                    if (isArchive)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6328be1c-76dd-46ba-914c-91986fa66243")]
                        construct archiveChkAcctsWCFOut
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d7a0baaf-f193-44c5-981c-2c236c3a29e1")]
                            archiveChkAcctsWCFOut=chkAssociatedAccountsOut;
                            archiveChkAcctsWCFOut(FILE.ReceivedFileName)="CheckAcctsWCFResponse_"+legacyOrgID.ToString();
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e80ddfc8-7d32-4f67-8712-390d8ffd5ffd")]
                        send (archiveWcfResponsePort.Operation_1, archiveChkAcctsWCFOut);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c6fe239c-269f-416a-9d27-0c3a6ccdeec2")]
                    if (chkAssociatedAccountsOut.parameters.CheckAssociatedAccountsResult.IsAssociated==true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a302c1ed-0a63-46e4-bbc0-457e5317befb")]
                        strExistingOrgName= chkAssociatedAccountsOut.parameters.CheckAssociatedAccountsResult.orgName;
                        processFurther= false;
                        strResponseText= "SHIPTO : The account was previously associated with organization: " + strExistingOrgName +".";
                        strCompleteErrorResponse.AppendLine(strResponseText);
                        System.Diagnostics.EventLog.WriteEntry("BTNextGen.BizTalk.Profiles","Shipto previously associted " + accGuid + ": " + strCompleteErrorResponse.ToString());
                        
                        
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("67fe80ff-1500-4eff-addb-ab9fb2748e73")]
                        processFurther= true;
                        
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("17eafc2b-dca2-4b35-be13-7b95c4d67d93")]
                    if (processFurther)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("60c85131-7a9e-4dd0-92b2-377e2d67d9a6")]
                        construct accountProfilesCommerce
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9303a3fe-bfcd-4510-8322-de4501870298")]
                            transform (accountProfilesCommerce) = BTNextGen.BizTalk.Profiles.Maps.AccountsLegacy_To_AccountsCommerce (accountProfileLegacy);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7c6af69a-122e-436e-afda-7fd9f6714f9a")]
                        construct accountsInput_MM
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a2f92af-c621-4d9b-8a0a-0e3cb346a648")]
                            transform (accountsInput_MM.parameters) = BTNextGen.BizTalk.Profiles.Maps.BTProfile_To_UpdateAccounts (accountProfilesCommerce);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("665d5c2c-f837-4f72-b916-d190812f04c8")]
                            accountsInput_MM.parameters.profileKey= accGuid;
                            accountsInput_MM.parameters.profileObjectName="BTAccount";
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e3a5490d-feab-4ae9-8f4d-a7a511c2a388")]
                        if (isArchive)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("416bf2cc-6c87-4e95-a41d-0b12086a5b15")]
                            construct archiveOut
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("109c62fd-35f3-4855-9849-330aa4b82d2f")]
                                archiveOut=accountsInput_MM;
                                archiveOut(FILE.ReceivedFileName)="AccountProfilesToCommerceServer_"+legacyOrgID.ToString();
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("acd18d07-48b5-4be2-90d3-fb6e8f8e9080")]
                            send (archiveOutPort.Operation_1, archiveOut);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a8d7922c-22ed-4faf-824e-80be0e660618")]
                        send (SendWCFBTAccountPort.UpdatePartialProfile, accountsInput_MM);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f68d6fdd-b72e-44c9-b753-0c5dd89fe0f5")]
                        receive (SendWCFBTAccountPort.UpdatePartialProfile, accountProfilesResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a8908c2e-e18e-4c13-87a3-42358ab8ca0f")]
                        if (isArchive)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4babad09-1828-434f-8fd2-aeb310c34feb")]
                            construct archiveResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("248f7801-7a08-4e12-ad47-0abbb00e9871")]
                                archiveResponse=accountProfilesResponse;
                                archiveResponse(FILE.ReceivedFileName)="AccountsProfilesResponseCommerce_"+legacyOrgID.ToString();
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d12fce49-aa7c-4b69-bb48-cbd4efbe32b6")]
                            send (archiveResponsePort.Operation_1, archiveResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a66cf9e-cc96-4fb1-a7f3-0674d8695887")]
                        strResponseText=(xpath(accountProfilesResponse.parameters,"string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])"));
                        
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6fc349a3-b61f-439a-adf9-0fcc8681ba3f")]
                        if (strResponseText.Contains("Failed"))
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9ad1e625-3005-4d60-b65c-d60c44ac3a04")]
                            strResponseText=(xpath(accountProfilesResponse.parameters,"string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])"));
                            strResponseText= "SHIPTO : "+strResponseText +".";
                            
                            strCompleteErrorResponse.AppendLine(strResponseText);
                            
                            System.Diagnostics.EventLog.WriteEntry("BTNextGen.BizTalk.Profiles","Shipto ERROR response " + accGuid + ": " + strCompleteErrorResponse.ToString());
                            
                            isFailed= true;
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5ff641c7-539f-40a4-be8e-7019da11ee67")]
                    delay new System.TimeSpan(0,0,delaySecs);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d368bcb7-03a7-4b75-8b88-2f363ce8ca05")]
                    billToCount=System.Convert.ToInt32(xpath(accountProfileLegacy,"count(/*[local-name()='StoredProcedureResultSet0' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/procGetBTAccount']/*[local-name()='BILLTOAccountGUID' and namespace-uri()='http://schemas.microsoft.com/Sql/2008/05/ProceduresResultSets/dbo/procGetBTAccount'])"));
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5d242480-6134-4048-9f24-a2e3f6880fbb")]
                    if (billToCount > 0)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b1d6fd50-975b-4f7e-921e-9a1574edd230")]
                        billToGuid= accountProfileLegacy.BILLTOAccountGUID;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1a820d9f-f3aa-4c48-a834-f7ba82449189")]
                        construct chkAssocBillToIn
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("05d3b6b7-0c2b-4d47-b572-d1d8bdda13e3")]
                            xmlDocTemp.LoadXml("<ns0:CheckAssociatedAccounts xmlns:ns0=\"http://tempuri.org/\"><ns0:singleAccount>singleAccount_0</ns0:singleAccount><ns0:orgID>orgID_0</ns0:orgID><ns0:legacyOrg>legacyOrg_0</ns0:legacyOrg></ns0:CheckAssociatedAccounts>");
                            chkAssocBillToIn.parameters= xmlDocTemp;
                            chkAssocBillToIn.parameters.singleAccount= billToGuid;
                            chkAssocBillToIn.parameters.orgID= orgGuid;
                            chkAssocBillToIn.parameters.legacyOrg= legacyOrgID.ToString();
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e37e1dbb-40b3-40b0-86ac-4771758f61a6")]
                        if (isArchive)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("22a8196e-f2ad-4c33-9b34-163547b2ef9d")]
                            construct archiveChkAcctsWCFIn
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b6310406-4207-429e-bc24-28852707a467")]
                                archiveChkAcctsWCFIn=chkAssocBillToIn;
                                archiveChkAcctsWCFIn(FILE.ReceivedFileName)="CheckAcctsWCFReq_BillTo_"+legacyOrgID.ToString();
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5a6b1bf8-54a4-4a2b-840d-dd99ed75bda6")]
                            send (archiveWCFInPort.Operation_1, archiveChkAcctsWCFIn);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("89bd0550-4e75-4a0d-b97e-5b3b33c6b399")]
                        send (SendWCFBTAccountPort.CheckAssociatedAccounts, chkAssocBillToIn);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("012efe04-4a60-4d00-99bd-d7b5e5f38b40")]
                        receive (SendWCFBTAccountPort.CheckAssociatedAccounts, ChkAssocBillToOut);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c3705dbf-1660-4369-9cf6-2f8e4e02f79e")]
                        if (isArchive)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c020aa74-1d79-45d4-9791-89fa0fdf5315")]
                            construct archiveChkAcctsWCFOut
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4da11952-dad8-4205-bee9-12a7017b317b")]
                                archiveChkAcctsWCFOut=ChkAssocBillToOut;
                                archiveChkAcctsWCFOut(FILE.ReceivedFileName)="CheckAcctsWCFResponse_BillTo_"+legacyOrgID.ToString();
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1531adfe-135f-4b00-a739-9a347cc81848")]
                            send (archiveWcfResponsePort.Operation_1, archiveChkAcctsWCFOut);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("991d5734-cbae-47fd-ba9a-f2966f689b57")]
                        if (ChkAssocBillToOut.parameters.CheckAssociatedAccountsResult.IsAssociated==true )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3a68d0a1-c74e-4b41-9d7f-6a2344f55c17")]
                            strExistingOrgName= ChkAssocBillToOut.parameters.CheckAssociatedAccountsResult.orgName;
                            processFurther= false;
                            strResponseText= "BILLTO : The account was previously associated with organization: " + strExistingOrgName +".";
                            strCompleteErrorResponse.AppendLine(strResponseText);
                            
                            System.Diagnostics.EventLog.WriteEntry("BTNextGen.BizTalk.Profiles", "Billto previously associted" + billToGuid+": " + strCompleteErrorResponse.ToString());
                            
                            
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8ec9f459-6d9e-4b2d-be0a-3fd711631705")]
                            processFurther= true;
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("02f675a1-08fc-40db-a035-ff1ba456cee7")]
                        if (processFurther)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1d8b847a-f1a5-46fb-8aa9-359bf08758f1")]
                            construct accountsUpdateBillTo, accountsBillToCS
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("62b5ec65-c584-4ff3-a972-191b80481700")]
                                transform (accountsBillToCS) = BTNextGen.BizTalk.Profiles.Maps.Legacy_To_BilltoAccounts (accountProfileLegacy);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d723bd38-6a3b-4dad-ba00-2b054248eed5")]
                                transform (accountsUpdateBillTo.parameters) = BTNextGen.BizTalk.Profiles.Maps.BTProfile_To_UpdateAccounts (accountsBillToCS);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6b7b5094-6507-490f-a525-e725af6e2646")]
                                accountsUpdateBillTo.parameters.profileKey= billToGuid;
                                accountsUpdateBillTo.parameters.profileObjectName="BTAccount";
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("676ef4f3-0879-44ba-8449-e0df957d5f0a")]
                            if (isArchive)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("36f69b08-1e7b-4716-8346-fbd05ac21004")]
                                construct archiveOut
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("29363ace-5cc7-49ad-a33e-246fc4dc2d85")]
                                    archiveOut=accountsUpdateBillTo;
                                    archiveOut(FILE.ReceivedFileName)="AccountBILLToCommerceServer_"+legacyOrgID.ToString();
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("deb8942b-361d-457b-8b3e-84f618b7330f")]
                                send (archiveOutPort.Operation_1, archiveOut);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b8c0d98-149f-45d2-b64e-c781e1df6c48")]
                            send (SendWCFBTAccountPort.UpdatePartialProfile, accountsUpdateBillTo);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e9208716-05c6-42e4-8e28-64357a556d25")]
                            receive (SendWCFBTAccountPort.UpdatePartialProfile, billToCSResponse);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("442fc656-7eab-4087-8577-d59e33060eb7")]
                            if (isArchive)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("982b74ce-d026-42f4-8919-4f44320482ad")]
                                construct archiveResponse
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2f931931-e7f4-4a6f-801c-7f46edbd9f5a")]
                                    archiveResponse=billToCSResponse;
                                    archiveResponse(FILE.ReceivedFileName)="AccountsBILLToResponseCommerce_"+legacyOrgID.ToString();
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("680a6e52-c516-45bb-8045-7b2d77725864")]
                                send (archiveResponsePort.Operation_1, archiveResponse);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a67a581d-53bb-4479-803a-89af6cd71732")]
                            strResponseText=(xpath(billToCSResponse.parameters,"string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])"));
                            
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("195e2f30-a824-4023-8747-4723ef3cad92")]
                            if (strResponseText.Contains("Failed"))
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bf61e99f-6c7b-49bc-ba32-9f30c7f1d1ef")]
                                strResponseText=(xpath(billToCSResponse.parameters,"string(/*[local-name()='UpdatePartialProfileResponse' and namespace-uri()='http://tempuri.org/']/*[local-name()='UpdatePartialProfileResult' and namespace-uri()='http://tempuri.org/'])"));
                                strResponseText= "BILLTO : " +strResponseText+".";
                                strCompleteErrorResponse.AppendLine(strResponseText);
                                System.Diagnostics.EventLog.WriteEntry("BTNextGen.BizTalk.Profiles", "Billto error " + billToGuid + ": " + strCompleteErrorResponse.ToString());
                                isFailed= true;
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9b78903-0444-4a66-94cc-2f72e1b1d33c")]
                    if (isFailed || !(processFurther)
                        
                        // if there was a failure response or if the shipto/billto account was already associated then send error response to Legacy stored procedure.
                        )
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2f9eeeb3-7cf4-4963-9b29-acfcd36c9911")]
                        construct updateLegacyResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b89475c8-990a-4526-b292-8488c4c71df4")]
                            xmldoc.LoadXml("<ns0:procSetBTAccountError xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:pintOrganizationID>10</ns0:pintOrganizationID><ns0:pintUdtIdentityAccount></ns0:pintUdtIdentityAccount><ns0:pstrLegacySourceSystem>pstrL</ns0:pstrLegacySourceSystem><ns0:pstrLoadStatus>ps</ns0:pstrLoadStatus><ns0:pstrLoadError>pstrLoadError_0</ns0:pstrLoadError></ns0:procSetBTAccountError>");
                            updateLegacyResponse=xmldoc;
                            updateLegacyResponse.pstrLoadError=strCompleteErrorResponse.ToString();
                            updateLegacyResponse.pstrLoadStatus="CS Failed";
                            updateLegacyResponse.pintOrganizationID=legacyOrgID;
                            updateLegacyResponse.pintUdtIdentityAccount=udtIdentityAccount;
                            updateLegacyResponse.pstrLegacySourceSystem=legacySource;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2ef18147-d56e-4265-ad62-9d5df3f62dcc")]
                        send (UpdateErrorStatusPort.Operation_1, updateLegacyResponse);
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9bb68c23-27da-4ed7-98c7-3149b57f05f9")]
                    catch (System.Exception ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1f7fc91e-b3e6-4a71-a74c-45a354786268")]
                        construct updateLegacyResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6dc06b2f-e8d6-4d09-b4e6-09fc58a92805")]
                            xmldoc.LoadXml("<ns0:procSetBTAccountError xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:pintOrganizationID>10</ns0:pintOrganizationID><ns0:pintUdtIdentityAccount></ns0:pintUdtIdentityAccount><ns0:pstrLegacySourceSystem>pstrL</ns0:pstrLegacySourceSystem><ns0:pstrLoadStatus>ps</ns0:pstrLoadStatus><ns0:pstrLoadError>pstrLoadError_0</ns0:pstrLoadError></ns0:procSetBTAccountError>");
                            updateLegacyResponse=xmldoc;
                            updateLegacyResponse.pstrLoadError=ex.Message.ToString();
                            updateLegacyResponse.pstrLoadStatus="CS Failed";
                            updateLegacyResponse.pintOrganizationID=legacyOrgID;
                            updateLegacyResponse.pintUdtIdentityAccount= udtIdentityAccount;
                            updateLegacyResponse.pstrLegacySourceSystem=legacySource;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b6e06e55-8eec-423d-ba8e-6008e961c5e2")]
                        send (UpdateErrorStatusPort.Operation_1, updateLegacyResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4de77434-dca9-4cb6-bffb-18092976db09")]
                        construct faultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2f55c8e8-a4df-4dbf-9b93-9870ce6ea271")]
                            // Create fault exception Message
                            faultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            
                            faultMessage.FailureCategory="Commerce Server Exception";
                            faultMessage.FaultDescription=ex.Message;
                            faultMessage.FaultCode="1005";
                            faultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.AddMessage(faultMessage,accountProfileLegacy);
                            
                            // this is not being sent anymore to the exception handler.
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("853795de-c7ef-445c-a013-390121282c43")]
                        suspend "Message Suspended due to error " + ex.Message; 
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("bb4ddd52-9f23-4e2b-96a1-a0421fcd80b7")]
                    catch (SendWCFBTAccountPort.CheckAssociatedAccounts.Fault_CheckAssoAccnts wcfFaultException)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0b33c095-2bcd-4900-b3f9-e37523185255")]
                        xDoc= wcfFaultException.faultMsgBody;
                        faultErrorDesc= xDoc.OuterXml;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("495f0d2b-80bb-4095-9df1-d92cd6c70533")]
                        construct updateLegacyResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b7ce510c-2522-4e36-8867-3fa5a3b33d9d")]
                            xmldoc.LoadXml("<ns0:procSetBTAccountError xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:pintOrganizationID>10</ns0:pintOrganizationID><ns0:pintUdtIdentityAccount></ns0:pintUdtIdentityAccount><ns0:pstrLegacySourceSystem>pstrL</ns0:pstrLegacySourceSystem><ns0:pstrLoadStatus>ps</ns0:pstrLoadStatus><ns0:pstrLoadError>pstrLoadError_0</ns0:pstrLoadError></ns0:procSetBTAccountError>");
                            updateLegacyResponse=xmldoc;
                            updateLegacyResponse.pstrLoadError="IProfile service Exception in CheckAssociatedAccounts "+faultErrorDesc;
                            updateLegacyResponse.pstrLoadStatus="CS Failed";
                            updateLegacyResponse.pintOrganizationID=legacyOrgID;
                            updateLegacyResponse.pintUdtIdentityAccount= udtIdentityAccount;
                            updateLegacyResponse.pstrLegacySourceSystem=legacySource;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("355c54c4-152e-41f0-b4cb-8dd07f652634")]
                        send (UpdateErrorStatusPort.Operation_1, updateLegacyResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bf40f1c4-6ee1-4637-bb6d-fa00b016e403")]
                        suspend "Message Suspended due to error " + faultErrorDesc;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ff9b3295-6d78-4134-991e-4d0b9a603525")]
                    catch (SendWCFBTAccountPort.UpdatePartialProfile.Fault_UpdateProfile fault_UpdateProfile)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b648efc6-df90-468e-a74d-776ca5ce0745")]
                        xDoc= fault_UpdateProfile.faultMsgBody;
                        faultErrorDesc= xDoc.OuterXml;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f8204ac8-699b-4ef7-a36a-b970cdaf7e1d")]
                        construct updateLegacyResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2fc39d84-e93d-4ebb-a68c-d5d4aca212bd")]
                            xmldoc.LoadXml("<ns0:procSetBTAccountError xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:pintOrganizationID>10</ns0:pintOrganizationID><ns0:pintUdtIdentityAccount></ns0:pintUdtIdentityAccount><ns0:pstrLegacySourceSystem>pstrL</ns0:pstrLegacySourceSystem><ns0:pstrLoadStatus>ps</ns0:pstrLoadStatus><ns0:pstrLoadError>pstrLoadError_0</ns0:pstrLoadError></ns0:procSetBTAccountError>");
                            updateLegacyResponse=xmldoc;
                            updateLegacyResponse.pstrLoadError="IProfile service Exception in CheckAssociatedAccounts "+faultErrorDesc;
                            updateLegacyResponse.pstrLoadStatus="CS Failed";
                            updateLegacyResponse.pintOrganizationID=legacyOrgID;
                            updateLegacyResponse.pintUdtIdentityAccount= udtIdentityAccount;
                            updateLegacyResponse.pstrLegacySourceSystem=legacySource;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f21437f0-d808-43e3-aa06-9d2bcb077486")]
                        send (UpdateErrorStatusPort.Operation_1, updateLegacyResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("eb532d62-4503-4ea9-9c99-74474e87b320")]
                        suspend "Message Suspended due to error " + faultErrorDesc;
                    }
                }
            }
        }
    }
}

