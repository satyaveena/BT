#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="deb8e398-de6e-4965-a117-55d82afa6b6a" LowerBound="1.1" HigherBound="880.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ReconCybersource" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="20919c2a-7d5a-4096-b04a-83f8c88fe999" ParentLink="Module_PortType" LowerBound="20.1" HigherBound="27.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_FaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="8cf5c8f2-247e-40ec-8864-0c09d3d555e3" ParentLink="PortType_OperationDeclaration" LowerBound="22.1" HigherBound="26.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="3473138a-a8a4-47fa-9896-a01b1de76258" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="24.13" HigherBound="24.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="c22cca83-fbfe-4cc6-9a0d-f34ed2ed3b93" ParentLink="Module_PortType" LowerBound="27.1" HigherBound="34.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:portType name=&quot;IOrdersService&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrdersService" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="8b09aded-e8a8-487a-bbb0-4fb3afea6179" ParentLink="PortType_OperationDeclaration" LowerBound="29.1" HigherBound="33.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:operation name=&quot;GetCyberSourceReport&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="GetCyberSourceReport" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="681beb83-aa6b-4768-a57c-77e358f9cabf" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="31.13" HigherBound="31.61">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="&lt;wsdl:input message=&quot;http://tempuri.org/:IOrdersService_GetCyberSourceReport_InputMessage&quot;/&gt;&#xD;&#xA;Action=&quot;http://tempuri.org/IOrdersService/GetCyberSourceReport&quot;&#xD;&#xA;" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="47624ec2-5bf1-4f9d-82e2-8e547fe60a4f" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="31.63" HigherBound="31.112">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="&lt;wsdl:output message=&quot;http://tempuri.org/:IOrdersService_GetCyberSourceReport_OutputMessage&quot;/&gt;&#xD;&#xA;Action=&quot;http://tempuri.org/IOrdersService/GetCyberSourceReportResponse&quot;&#xD;&#xA;" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="0f8d1951-7a84-41cd-b795-b30ab351542d" ParentLink="OperationDeclaration_FaultMessageRef" LowerBound="31.114" HigherBound="31.143">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.MultipartType_Fault" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Fault_1" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="868f9b0e-4c93-42e7-8fca-b95e5d88406a" ParentLink="Module_PortType" LowerBound="34.1" HigherBound="41.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Archive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="70cf2c40-753c-4fc5-856b-e2af8fc99304" ParentLink="PortType_OperationDeclaration" LowerBound="36.1" HigherBound="40.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="fe4f9415-0d2f-4f40-b5d4-73369a0ddb16" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="38.13" HigherBound="38.61">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="deee4c65-21d0-412b-b235-d045a2255841" ParentLink="Module_PortType" LowerBound="41.1" HigherBound="48.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Dummyx" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="49f81aad-5629-4d3c-ab2c-fcda731583d1" ParentLink="PortType_OperationDeclaration" LowerBound="43.1" HigherBound="47.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="e21d954d-285a-4d64-9cde-3e080fc14bd2" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="45.13" HigherBound="45.34">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.DummyReconCybersource" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="4a85ff20-c627-414e-8c58-9f54049a3943" ParentLink="Module_PortType" LowerBound="48.1" HigherBound="55.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ERP" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="ccb456f9-8e02-4798-9ad9-2e326b06df8b" ParentLink="PortType_OperationDeclaration" LowerBound="50.1" HigherBound="54.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="46b0eeb7-ac79-438a-954a-5e329f10f9a5" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="52.13" HigherBound="52.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.CyberSourceResponseBackup" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="f263046a-b6a0-4ac2-bde3-ae679b092cf9" ParentLink="Module_PortType" LowerBound="55.1" HigherBound="62.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveOut" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="afeaaeda-4bf6-4f55-9a00-33e0a40d6163" ParentLink="PortType_OperationDeclaration" LowerBound="57.1" HigherBound="61.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="efd66783-6338-4b9c-8706-fb52271b6df8" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="59.13" HigherBound="59.62">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="5f1362d3-c1d4-44ba-92ef-6a6a931ab928" ParentLink="Module_PortType" LowerBound="62.1" HigherBound="69.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_1" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b872eec4-ee7c-4ac1-8ab3-3063c3a2938f" ParentLink="PortType_OperationDeclaration" LowerBound="64.1" HigherBound="68.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="7c695ad3-7e00-43a8-bd37-1bc2dbf4b108" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="66.13" HigherBound="66.42">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.FlatFileSchemaCybersourceBody" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="4d4ba224-1bc7-4035-bd0e-12f455f4feef" ParentLink="Module_PortType" LowerBound="69.1" HigherBound="76.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="62aed62b-5491-41d6-ae1f-b4ca10aef442" ParentLink="PortType_OperationDeclaration" LowerBound="71.1" HigherBound="75.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="1012bc50-4e0d-4216-8baf-a64533191b72" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="73.13" HigherBound="73.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0367e0e4-065a-4065-8aef-11f4939f900b" ParentLink="Module_PortType" LowerBound="76.1" HigherBound="83.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveRAW" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="92885704-92d0-4fd8-b3b0-f748aa6b5d96" ParentLink="PortType_OperationDeclaration" LowerBound="78.1" HigherBound="82.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="74fb6e7d-1e49-421e-956c-3ef8621d5315" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="80.13" HigherBound="80.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="30d12097-d5a9-46ea-9138-0d0eb75afe57" ParentLink="Module_PortType" LowerBound="83.1" HigherBound="90.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_EmailBadDataResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="a9716e09-150f-422f-bc74-a2c2affb8f48" ParentLink="PortType_OperationDeclaration" LowerBound="85.1" HigherBound="89.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="060a03b7-77c7-4663-ac75-99d3bcca4176" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="87.13" HigherBound="87.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="3ad142a8-a1a3-4352-b439-fc6e9703279a" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Fault" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="cc98058a-dcad-4b25-b582-6b8e2639f8dd" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Fault" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="f379836b-5dc1-434a-a85f-e8966a0cee4b" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Flat" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="c325a4cf-cf11-4d7a-8ed4-91f4bf26f131" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="2e321cc3-9dd5-44ce-ba6e-0a6d804a08a6" ParentLink="Module_MessageType" LowerBound="12.1" HigherBound="16.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:message name=&quot;IOrdersService_GetCyberSourceReport_InputMessage&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrdersService_GetCyberSourceReport_InputMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="PartDeclaration" OID="71112f2e-822a-4c2b-a117-28649ffab1b1" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="14.1" HigherBound="15.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.IOrder_tempuri_org.GetCyberSourceReport" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:part name=&quot;parameters&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="parameters" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="b982d91e-b118-4b59-828b-b8e60c36cf1e" ParentLink="Module_MessageType" LowerBound="16.1" HigherBound="20.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:message name=&quot;IOrdersService_GetCyberSourceReport_OutputMessage&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrdersService_GetCyberSourceReport_OutputMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="PartDeclaration" OID="23fb4ee5-4948-4dc1-a99c-b96be0579719" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="18.1" HigherBound="19.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.IOrder_tempuri_org.GetCyberSourceReportResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:part name=&quot;parameters&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="parameters" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="c4d1464f-2d4a-4f48-9bca-dcd985ed739c" ParentLink="Module_ServiceDeclaration" LowerBound="90.1" HigherBound="879.1">
            <om:Property Name="InitializedTransactionType" Value="True" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:service name=&quot;IOrder&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrderClient" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="d794bf19-a552-4a50-a0e0-13969b57eeed" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="118.1" HigherBound="119.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant2Active" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6625332c-5e25-4769-8750-51d997bfba99" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="119.1" HigherBound="120.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2b94cefd-8ec4-4328-a308-249c5640e1e9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="120.1" HigherBound="121.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="01ba55e6-0a1d-4d46-8beb-615de25fe055" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="121.1" HigherBound="122.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6922ca86-7e7e-4d58-9b41-44e9b68c8217" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="122.1" HigherBound="123.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8561a197-6778-4631-abf8-00c347061a9a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="123.1" HigherBound="124.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varErrorMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="26323858-339b-4ffa-91ca-2e2b877a2a90" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="124.1" HigherBound="125.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b83fe51a-c6ed-4796-af44-2ed60b136d47" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="125.1" HigherBound="126.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7aa03106-bcf0-4b45-a72e-d8654fadee2d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="126.1" HigherBound="127.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHold" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="621a3f67-cf1f-479f-bf66-ba468774e2a6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="127.1" HigherBound="128.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlQRYRECONCYBERSOURCE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ae085f97-c165-499c-970c-2102f1f15087" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="128.1" HigherBound="129.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e5d29257-765c-4dbb-a3bc-9cddbe55a2fe" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="129.1" HigherBound="130.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlFLATRECYBERSOURCE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1062efe0-109e-4b6f-81fb-fb0c77bdd680" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="130.1" HigherBound="131.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sXpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="bdccd951-da47-48fb-a11e-9588dfcadb8d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="131.1" HigherBound="132.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportYear" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="af7bd79e-e375-4680-a1b9-a85bca351860" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="132.1" HigherBound="133.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportDay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f5d18744-7e87-4bb8-be63-e04b10ffaac1" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="133.1" HigherBound="134.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportMonth" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1b5d7862-11ba-48aa-8f05-5fce377cc2c2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="134.1" HigherBound="135.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cb87cf32-dacd-4baf-b889-9430fa49aad4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="135.1" HigherBound="136.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b7aa17bf-ec9e-49f7-bf41-2da61495b614" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="136.1" HigherBound="137.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ebf837d1-9b24-4330-87f1-9afde747e922" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="137.1" HigherBound="138.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive1WCF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="bad924b6-f0cc-4bab-9739-38b4d3867e93" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="138.1" HigherBound="139.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive2BackupResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="153f7314-d62b-4ea5-8085-01405065f6a0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="139.1" HigherBound="140.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive3RAW" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e5f23467-936b-47bf-a08f-79064b571ba3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="140.1" HigherBound="141.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDateYesterday" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9da362bc-99e7-4556-9cdb-590b3ffe779b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="141.1" HigherBound="142.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDateYesterday2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="31f96887-f600-4c07-8f6c-c51d9e23ebd9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="142.1" HigherBound="143.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportDate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c5eecd25-4817-464a-a75a-d009b6ca1846" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="143.1" HigherBound="144.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDaysBack" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ef638117-7b77-4be1-a485-875df6c5ff9b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="144.1" HigherBound="145.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int16" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intDaysBack" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f970b451-a652-45f1-9011-7fb5483b27cc" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="145.1" HigherBound="146.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Exception" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ab0197fb-14bb-4243-82c6-bfcf797e7c1d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="146.1" HigherBound="147.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBadDataResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d112b1bf-566c-4fc1-a227-80d5efeb71d7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="147.1" HigherBound="148.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3f69b97f-9b2d-483a-a5a0-67228eb6f272" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="148.1" HigherBound="149.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="788a1597-1702-4ee6-8bb4-b18ec44578a2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="149.1" HigherBound="150.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="583470f6-4787-4c19-bbd8-94fc26eb6062" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="150.1" HigherBound="151.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0e5e452e-2baa-4575-9783-27203645bdfe" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="151.1" HigherBound="152.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4a79bb1b-7dc3-4e63-91f7-3d492fdb7257" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="152.1" HigherBound="153.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4fd3b6b9-1908-41b6-b9e2-eccf052e256f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="153.1" HigherBound="154.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e34b545c-29d3-40c3-a986-2f67aef7cf6f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="154.1" HigherBound="155.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a6ab8d6a-3ec7-4092-bbb6-0b2afafc188a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="155.1" HigherBound="156.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant3Active" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6d16a31f-1aae-45b4-b0e3-641dd56503cb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="156.1" HigherBound="157.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant4Active" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="03230335-2234-4b17-b0c2-74b927d06a4d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="109.1" HigherBound="110.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageXMLDummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="98e8d0bf-ed1d-45b8-b022-dc5f9fcf7ca2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="110.1" HigherBound="111.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="18ecbc62-723d-4500-8f7c-016ff6bc2512" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="111.1" HigherBound="112.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Request" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="0cc62721-2b0e-4a52-8b81-abf602c0ed48" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="112.1" HigherBound="113.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Response" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="41951b8f-90c8-4c00-b962-ed9b0ac895eb" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="113.1" HigherBound="114.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.DummyReconCybersource" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Dummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="49a65fac-2043-4da2-bea6-5a946863651c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="114.1" HigherBound="115.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.CyberSourceResponseBackup" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ResponseBackup" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a2f383de-bc0d-41ac-8011-94ca1e8b785b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="115.1" HigherBound="116.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService_GetCyberSourceReport_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive1_WCF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="dc68dc6e-49bd-4e28-8d80-4b98b88636af" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="116.1" HigherBound="117.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.CyberSourceResponseBackup" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive2_BackupResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="705d5a97-a5c8-43f7-8f2e-0c9e14fa82d9" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="117.1" HigherBound="118.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.MultipartType_Flat" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive3_RAWFile" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="636b8133-f202-472c-9722-eb797ed38754" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="66daced9-8c83-4abe-bb10-1f2f55f7d6c1" ParentLink="ServiceBody_Statement" LowerBound="159.1" HigherBound="197.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_Dummy" />
                    <om:Property Name="MessageName" Value="Message_Dummy" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_Dummy" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="43fff510-b9ba-4129-b9b0-6001cc8ea1f2" ParentLink="ServiceBody_Statement" LowerBound="197.1" HigherBound="877.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableDeclaration" OID="b2931944-f941-4012-9c01-ab682778deb1" ParentLink="Scope_VariableDeclaration" LowerBound="201.1" HigherBound="202.1">
                        <om:Property Name="UseDefaultConstructor" Value="True" />
                        <om:Property Name="Type" Value="System.Text.StringBuilder" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Variable_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="f1a083e6-4300-4a17-855a-dc1fd536ab04" ParentLink="ComplexStatement_Statement" LowerBound="205.1" HigherBound="246.1">
                        <om:Property Name="Expression" Value="varArchive1WCF=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Archive1WCF&quot;));&#xD;&#xA;varArchive2BackupResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Archive2ResponseBackup&quot;));&#xD;&#xA;varArchive3RAW=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Archive3RAWFile&quot;));&#xD;&#xA;varMerchant1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant1&quot;);                                                                                                               &#xD;&#xA;varServer1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Server1&quot;);  &#xD;&#xA;varUser1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;User1&quot;);  &#xD;&#xA;varPassword1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Password1&quot;);  &#xD;&#xA;varDaysBack=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;DaysBack&quot;);  &#xD;&#xA;&#xD;&#xA;varMerchant2Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant2Active&quot;));&#xD;&#xA;varMerchant2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant2&quot;);                                                                                                               &#xD;&#xA;varServer2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Server2&quot;);  &#xD;&#xA;varUser2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;User2&quot;);  &#xD;&#xA;varPassword2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Password2&quot;);  &#xD;&#xA;&#xD;&#xA;varMerchant3Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant3Active&quot;));&#xD;&#xA;varMerchant3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant3&quot;);                                                                                                               &#xD;&#xA;varServer3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Server3&quot;);  &#xD;&#xA;varUser3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;User3&quot;);  &#xD;&#xA;varPassword3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Password3&quot;);  &#xD;&#xA;&#xD;&#xA;varMerchant4Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant4Active&quot;));&#xD;&#xA;varMerchant4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Merchant4&quot;);                                                                                                               &#xD;&#xA;varServer4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Server4&quot;);  &#xD;&#xA;varUser4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;User4&quot;);  &#xD;&#xA;varPassword4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;,&quot;Password4&quot;);  &#xD;&#xA;&#xD;&#xA;intDaysBack=System.Convert.ToInt16(varDaysBack);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varDateYesterday = System.DateTime.Now.AddDays(-intDaysBack);&#xD;&#xA;&#xD;&#xA;varReportMonth = System.Convert.ToString(varDateYesterday.Month);&#xD;&#xA;varReportYear = System.Convert.ToString(varDateYesterday.Year);&#xD;&#xA;varReportDay = System.Convert.ToString(varDateYesterday.Day);&#xD;&#xA;&#xD;&#xA;varReportMonth = varReportMonth.PadLeft(2,'0');&#xD;&#xA;varReportDay = varReportDay.PadLeft(2,'0');&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ReconCyberSource&quot;, &quot;Cybersource &quot; + varReportMonth + &quot;/&quot; + varReportDay + &quot;/&quot; + varReportYear );&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getSSO and Dates" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Construct" OID="b1d098f3-d0c6-4624-9165-ef97417f5a1a" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="265.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_WCF" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="420a55a7-0b90-428f-ac2d-7b3bfeb46f55" ParentLink="Construct_MessageRef" LowerBound="247.31" HigherBound="247.46">
                            <om:Property Name="Ref" Value="Message_Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="042004c1-a6e5-4a85-ab0a-cdc90d063269" ParentLink="ComplexStatement_Statement" LowerBound="249.1" HigherBound="264.1">
                            <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant1 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword1 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer1 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser1 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;TransactionDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_2" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="3681b0ba-044f-419b-973c-22e98bcc48f2" ParentLink="ComplexStatement_Statement" LowerBound="265.1" HigherBound="278.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="ddc9391a-38dc-448f-a8c9-f5818282dffc" ParentLink="ReallyComplexStatement_Branch" LowerBound="266.21" HigherBound="278.1">
                            <om:Property Name="Expression" Value="varArchive1WCF == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveWCFMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="ccf5e75d-9d93-44b1-8a7b-a33fb963821f" ParentLink="ComplexStatement_Statement" LowerBound="268.1" HigherBound="275.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="97c4a9a4-1cf0-4768-8280-7f94d9e1f32a" ParentLink="Construct_MessageRef" LowerBound="269.35" HigherBound="269.55">
                                    <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="380c859f-ea3a-40e8-b8ae-85bdd703b132" ParentLink="ComplexStatement_Statement" LowerBound="271.1" HigherBound="274.1">
                                    <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant1 + &quot;WCFRequest&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="4dccba6d-38db-4d3b-9b2f-3a496322fe81" ParentLink="ComplexStatement_Statement" LowerBound="275.1" HigherBound="277.1">
                                <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ArchiveWCF" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="acb44802-3534-48d1-978c-b931787307f1" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="f742a106-88a4-435a-aadc-801b9c792dfa" ParentLink="ComplexStatement_Statement" LowerBound="278.1" HigherBound="287.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="5483f8b4-6d39-4add-9caa-ca818262a707" ParentLink="Construct_MessageRef" LowerBound="279.31" HigherBound="279.46">
                            <om:Property Name="Ref" Value="MessageXMLDummy" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="68b11b91-9506-47bd-a2ea-24f17684f21c" ParentLink="Construct_MessageRef" LowerBound="279.48" HigherBound="279.64">
                            <om:Property Name="Ref" Value="Message_Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="54f81957-a646-4ec3-9fc4-429b47662a27" ParentLink="ComplexStatement_Statement" LowerBound="281.1" HigherBound="286.1">
                            <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="7548b6e4-45e1-4d12-96b6-e86312fa8889" ParentLink="ComplexStatement_Statement" LowerBound="287.1" HigherBound="323.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_WCF" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Send" OID="efed3df0-71cf-4956-ac1d-a6002cc78a22" ParentLink="ComplexStatement_Statement" LowerBound="292.1" HigherBound="294.1">
                            <om:Property Name="PortName" Value="Port_WCF" />
                            <om:Property Name="MessageName" Value="Message_Request" />
                            <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_wcf" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="7835b61b-aab8-4c37-aa1b-52a7e52a80fc" ParentLink="ComplexStatement_Statement" LowerBound="294.1" HigherBound="296.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Port_WCF" />
                            <om:Property Name="MessageName" Value="Message_Response" />
                            <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_wcf" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Catch" OID="64466e72-92ff-4653-b24b-1572fe971c62" ParentLink="Scope_Catch" LowerBound="299.1" HigherBound="321.1">
                            <om:Property Name="ExceptionName" Value="ex2" />
                            <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CatchException_wcf" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="60d664ec-a4ef-47ee-9146-e80bc03bdb80" ParentLink="Catch_Statement" LowerBound="302.1" HigherBound="318.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="d95a6699-187c-4563-a161-b320dd7a8779" ParentLink="Construct_MessageRef" LowerBound="303.43" HigherBound="303.55">
                                    <om:Property Name="Ref" Value="FaultMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="5e96991a-e793-4a8c-9c95-146b2965052e" ParentLink="ComplexStatement_Statement" LowerBound="305.1" HigherBound="317.1">
                                    <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_5" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="23f6be69-e7e1-4200-b75f-de1f867e272d" ParentLink="Catch_Statement" LowerBound="318.1" HigherBound="320.1">
                                <om:Property Name="PortName" Value="Port_FaultPort" />
                                <om:Property Name="MessageName" Value="FaultMessage" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Fault" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="6aaa1186-8e16-4613-a27e-95906fde3da6" ParentLink="ComplexStatement_Statement" LowerBound="323.1" HigherBound="329.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_Backup" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="4f48dc49-56fc-4f28-af21-c61062354157" ParentLink="Construct_MessageRef" LowerBound="324.31" HigherBound="324.53">
                            <om:Property Name="Ref" Value="Message_ResponseBackup" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="d8c7f3ba-979b-49ea-8145-2359f77e31a3" ParentLink="ComplexStatement_Statement" LowerBound="326.1" HigherBound="328.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.Transform2Backup" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_3" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="b532509f-9848-4ffe-97a7-dcd56508e923" ParentLink="Transform_InputMessagePartRef" LowerBound="327.115" HigherBound="327.142">
                                <om:Property Name="MessageRef" Value="Message_Response" />
                                <om:Property Name="PartRef" Value="parameters" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="3abb0781-0d96-4f6c-a39f-8ef4b07b643b" ParentLink="Transform_OutputMessagePartRef" LowerBound="327.36" HigherBound="327.58">
                                <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="9d333925-34ed-40b5-8d20-f97e324f4b30" ParentLink="ComplexStatement_Statement" LowerBound="329.1" HigherBound="343.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="7189a76a-712c-4e86-9c78-032adc4bc70f" ParentLink="ReallyComplexStatement_Branch" LowerBound="330.21" HigherBound="343.1">
                            <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveResponseBackup" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="8ad86844-37e7-40ba-a19e-05ec039483c4" ParentLink="ComplexStatement_Statement" LowerBound="332.1" HigherBound="340.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="96c25db2-67b8-4ff1-8baf-56b68bdf2e80" ParentLink="Construct_MessageRef" LowerBound="333.35" HigherBound="333.66">
                                    <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="76bb1bda-79d3-408b-a8bb-b070bc919301" ParentLink="ComplexStatement_Statement" LowerBound="335.1" HigherBound="339.1">
                                    <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant1 + &quot;WCFResponseBackup&quot;; &#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="cf07c2ca-d32f-436b-a396-b5fbcb6aa2a2" ParentLink="ComplexStatement_Statement" LowerBound="340.1" HigherBound="342.1">
                                <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Archive_backup" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="405e29f0-fd8b-4f2e-96c2-f21bf61126aa" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="7a8da2eb-c17a-4af5-ac82-af56d596369b" ParentLink="ComplexStatement_Statement" LowerBound="343.1" HigherBound="359.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_ERP" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="3f7b7b30-a168-4d5e-ba5b-2d921ba3ce13" ParentLink="Construct_MessageRef" LowerBound="344.31" HigherBound="344.40">
                            <om:Property Name="Ref" Value="Message_1" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="6e161fbf-be20-4bdd-a791-534044db3572" ParentLink="ComplexStatement_Statement" LowerBound="346.1" HigherBound="358.1">
                            <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Transaction Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_1" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="8b3bdbf6-8477-4f99-8831-11fb61039bf0" ParentLink="ComplexStatement_Statement" LowerBound="359.1" HigherBound="380.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_BadDataResponse" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="552ba998-f559-4ff8-84af-a3ab6496a386" ParentLink="ReallyComplexStatement_Branch" LowerBound="360.21" HigherBound="380.1">
                            <om:Property Name="Expression" Value="varBadDataResponse == false" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_1" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Send" OID="2bbf1990-31eb-4fbc-8169-9ddd652a4db7" ParentLink="ComplexStatement_Statement" LowerBound="362.1" HigherBound="364.1">
                                <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_1" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Construct" OID="abeb4222-7484-4e73-81a1-5abe8505e359" ParentLink="ComplexStatement_Statement" LowerBound="364.1" HigherBound="377.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="446c2331-0e57-4d4a-b197-60f4ca6abffe" ParentLink="Construct_MessageRef" LowerBound="365.35" HigherBound="365.47">
                                    <om:Property Name="Ref" Value="FaultMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="c0ea388a-aff5-430e-8fcc-9f0d40c74e49" ParentLink="ComplexStatement_Statement" LowerBound="367.1" HigherBound="376.1">
                                    <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_5" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="0c164207-6beb-4171-aeae-69002cac5793" ParentLink="ComplexStatement_Statement" LowerBound="377.1" HigherBound="379.1">
                                <om:Property Name="PortName" Value="Port_FaultPort" />
                                <om:Property Name="MessageName" Value="FaultMessage" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Fault" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="0cc2682c-71c4-416c-bd04-9617d72ae7c7" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="05937b8f-f711-42b9-b8b6-cce4be3ec2cc" ParentLink="ComplexStatement_Statement" LowerBound="380.1" HigherBound="393.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="371881e6-70d5-4059-bd8c-78d65564ca47" ParentLink="ReallyComplexStatement_Branch" LowerBound="381.21" HigherBound="393.1">
                            <om:Property Name="Expression" Value="varArchive3RAW == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveRAWFile" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="4218e02f-c3fa-481a-9a47-af1438921ace" ParentLink="ComplexStatement_Statement" LowerBound="383.1" HigherBound="390.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="db799fd0-dc58-42bb-a2ba-e901ffe40e92" ParentLink="Construct_MessageRef" LowerBound="384.35" HigherBound="384.59">
                                    <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="5b7aa784-2f9a-4c2f-928d-2306cd6e0e82" ParentLink="ComplexStatement_Statement" LowerBound="386.1" HigherBound="389.1">
                                    <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant1 + &quot;RAWOutput&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="b078481a-df0d-408c-b37f-c49be902c0e3" ParentLink="ComplexStatement_Statement" LowerBound="390.1" HigherBound="392.1">
                                <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Archive_raw" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="755aa47d-5386-4562-92cc-08d99981027d" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Send" OID="5606077c-5217-4238-a3bb-cc32e4e2d5df" ParentLink="ComplexStatement_Statement" LowerBound="393.1" HigherBound="395.1">
                        <om:Property Name="PortName" Value="Port_RawFile" />
                        <om:Property Name="MessageName" Value="Message_1" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_RAWFile" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Decision" OID="8e7d4a76-8433-451e-ba57-536435401317" ParentLink="ComplexStatement_Statement" LowerBound="395.1" HigherBound="547.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Merchant2_Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="0b188af3-9a75-465e-bcca-dcaef444c4ae" ParentLink="ReallyComplexStatement_Branch" LowerBound="396.21" HigherBound="547.1">
                            <om:Property Name="Expression" Value="varMerchant2Active == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Mechant2_Check" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="84373a53-436e-4aa1-bc90-53fedbee31d1" ParentLink="ComplexStatement_Statement" LowerBound="398.1" HigherBound="417.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="ee736010-9001-4c1f-b138-6250c1624928" ParentLink="Construct_MessageRef" LowerBound="399.35" HigherBound="399.50">
                                    <om:Property Name="Ref" Value="Message_Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="4091053f-313c-4c40-8b3d-f73b1da94dbb" ParentLink="ComplexStatement_Statement" LowerBound="401.1" HigherBound="416.1">
                                    <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant2 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword2 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer2 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser2 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;TransactionDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="f9afe54a-a068-4e93-ab25-2f8da9ad0861" ParentLink="ComplexStatement_Statement" LowerBound="417.1" HigherBound="430.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="7a1ec319-7528-46d8-8da2-ed8de40dc663" ParentLink="ReallyComplexStatement_Branch" LowerBound="418.25" HigherBound="430.1">
                                    <om:Property Name="Expression" Value="varArchive1WCF == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveWCFMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="ff81a4f2-7a8e-4197-8192-9df4928de574" ParentLink="ComplexStatement_Statement" LowerBound="420.1" HigherBound="427.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="3aaa6baf-37e5-402c-8b51-d2c8daede81d" ParentLink="Construct_MessageRef" LowerBound="421.39" HigherBound="421.59">
                                            <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="0db3885d-a81c-4843-a7b2-70c3826f6865" ParentLink="ComplexStatement_Statement" LowerBound="423.1" HigherBound="426.1">
                                            <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant2 + &quot;WCFRequest&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="9f749df3-1ed6-42b7-9dce-813c17123ffa" ParentLink="ComplexStatement_Statement" LowerBound="427.1" HigherBound="429.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                        <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ArchiveWCF" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="4c3af628-76ba-4ae7-973d-9daca5cc55fb" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="0ee74700-5b6e-4135-a8dd-8e2eb0837211" ParentLink="ComplexStatement_Statement" LowerBound="430.1" HigherBound="439.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="b05a63ed-2b2a-4e7a-9213-8e30644db8df" ParentLink="Construct_MessageRef" LowerBound="431.35" HigherBound="431.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="29a03ec7-1229-420c-8656-17788fdb2e8c" ParentLink="Construct_MessageRef" LowerBound="431.52" HigherBound="431.68">
                                    <om:Property Name="Ref" Value="Message_Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="22ecb790-8487-491e-bd9e-5a23cb09edae" ParentLink="ComplexStatement_Statement" LowerBound="433.1" HigherBound="438.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="bc9e6b77-3481-4642-8148-2f9cee150c93" ParentLink="ComplexStatement_Statement" LowerBound="439.1" HigherBound="475.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Send" OID="411b278e-914c-43a7-8524-e71e56a44bfb" ParentLink="ComplexStatement_Statement" LowerBound="444.1" HigherBound="446.1">
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Request" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="20bb0ae5-3307-4df0-8fbe-2ebfe29e473e" ParentLink="ComplexStatement_Statement" LowerBound="446.1" HigherBound="448.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Response" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="ba2e2713-2c7b-46f5-b7ea-adba71ca3179" ParentLink="Scope_Catch" LowerBound="451.1" HigherBound="473.1">
                                    <om:Property Name="ExceptionName" Value="ex2" />
                                    <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="67f4561d-1ab2-4a7a-83aa-c4226c361687" ParentLink="Catch_Statement" LowerBound="454.1" HigherBound="470.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="dd806b3c-2b44-4473-bafb-242c80ec7565" ParentLink="Construct_MessageRef" LowerBound="455.47" HigherBound="455.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="e476db2c-4b36-4ffe-8697-fbdc19fa74f5" ParentLink="ComplexStatement_Statement" LowerBound="457.1" HigherBound="469.1">
                                            <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="a961b75f-7dd5-4d30-b2df-302fbe90a34a" ParentLink="Catch_Statement" LowerBound="470.1" HigherBound="472.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="a1eaf7ae-739e-4bcb-920a-e20879b1d319" ParentLink="ComplexStatement_Statement" LowerBound="475.1" HigherBound="481.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Backup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="d6ccc487-ed05-4561-aa71-85e5106946df" ParentLink="Construct_MessageRef" LowerBound="476.35" HigherBound="476.57">
                                    <om:Property Name="Ref" Value="Message_ResponseBackup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="c8b88f64-1da6-45fb-8200-33b46d05b986" ParentLink="ComplexStatement_Statement" LowerBound="478.1" HigherBound="480.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.Transform2Backup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_3" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="4470b26e-69a9-44ae-86e3-dc508c72e6d8" ParentLink="Transform_InputMessagePartRef" LowerBound="479.119" HigherBound="479.146">
                                        <om:Property Name="MessageRef" Value="Message_Response" />
                                        <om:Property Name="PartRef" Value="parameters" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="9d78e4c9-a8d1-4964-b12d-d397672acf8d" ParentLink="Transform_OutputMessagePartRef" LowerBound="479.40" HigherBound="479.62">
                                        <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="9bb551bd-0c44-4cc6-94ca-0b9ce8b84c91" ParentLink="ComplexStatement_Statement" LowerBound="481.1" HigherBound="494.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="496e024d-3ac9-4d66-8919-446862005aef" ParentLink="ReallyComplexStatement_Branch" LowerBound="482.25" HigherBound="494.1">
                                    <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveResponseBackup" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="a148342f-622e-4b29-a25a-14706421aa5a" ParentLink="ComplexStatement_Statement" LowerBound="484.1" HigherBound="491.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="327158a5-d283-4caf-b06c-b1ea504f0631" ParentLink="ComplexStatement_Statement" LowerBound="487.1" HigherBound="490.1">
                                            <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant2 + &quot;WCFResponseBackup&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="9d2bff19-5d20-4e73-a9f4-f19a92628bd0" ParentLink="Construct_MessageRef" LowerBound="485.39" HigherBound="485.70">
                                            <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="5112ff75-e6e7-4106-82e7-3f381353cf5f" ParentLink="ComplexStatement_Statement" LowerBound="491.1" HigherBound="493.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                        <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_backup" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="867f5314-3dc1-44c6-8543-3f8ec5281fe1" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="47e02e86-4343-45e6-abc3-021743a9a6dc" ParentLink="ComplexStatement_Statement" LowerBound="494.1" HigherBound="510.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_ERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="d9bc7a56-0746-4289-8c55-2cc47bb28810" ParentLink="Construct_MessageRef" LowerBound="495.35" HigherBound="495.44">
                                    <om:Property Name="Ref" Value="Message_1" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="5ece285b-ba85-496e-940a-603d9452c17f" ParentLink="ComplexStatement_Statement" LowerBound="497.1" HigherBound="509.1">
                                    <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Transaction Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="37317f9b-cc80-4df2-b47c-7c9abe908c84" ParentLink="ComplexStatement_Statement" LowerBound="510.1" HigherBound="531.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_BadDataResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="7b348a41-daf9-4245-b259-f8d69af5ddae" ParentLink="ReallyComplexStatement_Branch" LowerBound="511.25" HigherBound="531.1">
                                    <om:Property Name="Expression" Value="varBadDataResponse == false" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="b82c16b4-eb07-40de-b67a-b3d982af3fe6" ParentLink="ComplexStatement_Statement" LowerBound="513.1" HigherBound="515.1">
                                        <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                        <om:Property Name="MessageName" Value="Message_1" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="5a25bbd5-51a1-4653-90f4-756995b32d1a" ParentLink="ComplexStatement_Statement" LowerBound="515.1" HigherBound="528.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="ad706bdc-05d9-4cd7-b82c-47d890574685" ParentLink="ComplexStatement_Statement" LowerBound="518.1" HigherBound="527.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="a59303a5-bbb5-4b9d-abf2-f626c27237ae" ParentLink="Construct_MessageRef" LowerBound="516.39" HigherBound="516.51">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="0328fd52-a4c9-4242-9cee-3e0cf906f27c" ParentLink="ComplexStatement_Statement" LowerBound="528.1" HigherBound="530.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="cc64b629-ef98-45bb-ba8e-9d0e6c2bb791" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="a9000001-633c-408e-ad9c-94e22d8ce0cb" ParentLink="ComplexStatement_Statement" LowerBound="531.1" HigherBound="533.1">
                                <om:Property Name="PortName" Value="Port_RawFile" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_RAWFile" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="ef4b987e-0e44-4e53-a9f0-088dd02360cd" ParentLink="ComplexStatement_Statement" LowerBound="533.1" HigherBound="546.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="de4be2c0-d224-4b8f-aedc-6667c554a9db" ParentLink="ReallyComplexStatement_Branch" LowerBound="534.25" HigherBound="546.1">
                                    <om:Property Name="Expression" Value="varArchive3RAW == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveRAWFile" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="7a787bad-cd10-4f6a-983f-297a9ee87b94" ParentLink="ComplexStatement_Statement" LowerBound="536.1" HigherBound="543.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="bd5b54c8-8ffa-4016-9831-49d625dcf0bd" ParentLink="ComplexStatement_Statement" LowerBound="539.1" HigherBound="542.1">
                                            <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant2 + &quot;RAWOutput&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="f2c5b20b-daff-40dc-a46c-2b9d539922ed" ParentLink="Construct_MessageRef" LowerBound="537.39" HigherBound="537.63">
                                            <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="f16b445f-bad6-4775-87ee-8940873e6822" ParentLink="ComplexStatement_Statement" LowerBound="543.1" HigherBound="545.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                        <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_raw" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="3b296112-ea40-47b0-adde-2fab572ac59d" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="c4acb88b-abe0-4eb3-89f4-b7cee79d9df3" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="502274e3-5644-4eaf-b87c-7731a293543a" ParentLink="ComplexStatement_Statement" LowerBound="547.1" HigherBound="699.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Merchant3_Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="690cd9bf-7649-403e-8b5f-64d9748f20f6" ParentLink="ReallyComplexStatement_Branch" LowerBound="548.21" HigherBound="699.1">
                            <om:Property Name="Expression" Value="varMerchant3Active == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Mechant2_Check" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="b103f3cd-33cb-46ed-879d-e326d08b7784" ParentLink="ComplexStatement_Statement" LowerBound="550.1" HigherBound="569.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="3a60f8c7-47de-4249-a07c-137f351d3145" ParentLink="Construct_MessageRef" LowerBound="551.35" HigherBound="551.50">
                                    <om:Property Name="Ref" Value="Message_Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="901952eb-88f0-4f8f-9d8e-a8a755806727" ParentLink="ComplexStatement_Statement" LowerBound="553.1" HigherBound="568.1">
                                    <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant3 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword3 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer3 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser3 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;TransactionDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="020e5289-b15e-483c-87b2-786bf230a239" ParentLink="ComplexStatement_Statement" LowerBound="569.1" HigherBound="582.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="a9ee5c6d-346c-4b41-8067-2d756db8afc7" ParentLink="ReallyComplexStatement_Branch" LowerBound="570.25" HigherBound="582.1">
                                    <om:Property Name="Expression" Value="varArchive1WCF == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveWCFMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="b7f9aaef-6371-499f-9050-fa7b5d331ce7" ParentLink="ComplexStatement_Statement" LowerBound="572.1" HigherBound="579.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="42f1dc2a-01cf-40c5-a2a4-2bdf4e0aab88" ParentLink="Construct_MessageRef" LowerBound="573.39" HigherBound="573.59">
                                            <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="cddd277c-8de8-4edb-9fe9-ffa4a72f3669" ParentLink="ComplexStatement_Statement" LowerBound="575.1" HigherBound="578.1">
                                            <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant3 + &quot;WCFRequest&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="a9e971ce-9f97-4810-b1be-19e1f9078f59" ParentLink="ComplexStatement_Statement" LowerBound="579.1" HigherBound="581.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                        <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ArchiveWCF" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="1b3a7c26-d348-4595-8010-b8660a063c3d" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="15003a5b-1b70-4535-993e-d3bf0ca29657" ParentLink="ComplexStatement_Statement" LowerBound="582.1" HigherBound="591.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="f33975cd-c871-409c-ab7e-1ecd4226367f" ParentLink="Construct_MessageRef" LowerBound="583.35" HigherBound="583.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="b3f3ab61-e78c-46e0-8be0-1b344cacf5f2" ParentLink="Construct_MessageRef" LowerBound="583.52" HigherBound="583.68">
                                    <om:Property Name="Ref" Value="Message_Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="3cf2b2ef-083a-4569-9c8f-b2cd21ea4124" ParentLink="ComplexStatement_Statement" LowerBound="585.1" HigherBound="590.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="69a36e9f-e045-4d45-89c0-52c76448dc3c" ParentLink="ComplexStatement_Statement" LowerBound="591.1" HigherBound="627.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Catch" OID="1e9b052a-a677-4254-8eb9-4944b1d9cf6d" ParentLink="Scope_Catch" LowerBound="603.1" HigherBound="625.1">
                                    <om:Property Name="ExceptionName" Value="ex2" />
                                    <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="6fb80781-25d9-4902-a74e-9926a5dd1145" ParentLink="Catch_Statement" LowerBound="606.1" HigherBound="622.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="e5bb8c58-1492-4921-9e9e-f9c3f5e42064" ParentLink="ComplexStatement_Statement" LowerBound="609.1" HigherBound="621.1">
                                            <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="b2157e86-a13a-4e39-a485-bba5db5491be" ParentLink="Construct_MessageRef" LowerBound="607.47" HigherBound="607.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="1110a470-9813-4f08-ae69-4b8704486454" ParentLink="Catch_Statement" LowerBound="622.1" HigherBound="624.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="531fceda-1a79-440d-933d-9e365b468e66" ParentLink="ComplexStatement_Statement" LowerBound="596.1" HigherBound="598.1">
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Request" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="c8f9e56c-1b37-494f-b31f-965d557937c8" ParentLink="ComplexStatement_Statement" LowerBound="598.1" HigherBound="600.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Response" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="291c8721-8741-47e4-9c07-dc32f208e0db" ParentLink="ComplexStatement_Statement" LowerBound="627.1" HigherBound="633.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Backup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Transform" OID="d641df78-f572-4cff-88bd-11277a86c05d" ParentLink="ComplexStatement_Statement" LowerBound="630.1" HigherBound="632.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.Transform2Backup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_3" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="ad8e30c1-e345-453b-924b-139bdbab190c" ParentLink="Transform_OutputMessagePartRef" LowerBound="631.40" HigherBound="631.62">
                                        <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="fa86fb85-fb64-481e-937a-5be90a203555" ParentLink="Transform_InputMessagePartRef" LowerBound="631.119" HigherBound="631.146">
                                        <om:Property Name="MessageRef" Value="Message_Response" />
                                        <om:Property Name="PartRef" Value="parameters" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageRef" OID="df5b8cf0-cb3c-41e5-a32b-bac1c2f9a966" ParentLink="Construct_MessageRef" LowerBound="628.35" HigherBound="628.57">
                                    <om:Property Name="Ref" Value="Message_ResponseBackup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="b7a0ff84-e8eb-42e3-9bbc-913096f9dcba" ParentLink="ComplexStatement_Statement" LowerBound="633.1" HigherBound="646.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="95ac5d1e-9bd8-4b99-a831-24c325598b46" ParentLink="ReallyComplexStatement_Branch" LowerBound="634.25" HigherBound="646.1">
                                    <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveResponseBackup" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="a7f9e26e-3c5a-4fd3-aece-c14f80c1addb" ParentLink="ComplexStatement_Statement" LowerBound="636.1" HigherBound="643.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="fa26deb4-73e2-4918-9145-ca28893ed203" ParentLink="ComplexStatement_Statement" LowerBound="639.1" HigherBound="642.1">
                                            <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant3 + &quot;WCFResponseBackup&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="00909a19-987e-4497-b0aa-1d682bc76ad2" ParentLink="Construct_MessageRef" LowerBound="637.39" HigherBound="637.70">
                                            <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="bad9b6ca-b2f5-4a1d-b3a4-fb703d502096" ParentLink="ComplexStatement_Statement" LowerBound="643.1" HigherBound="645.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                        <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_backup" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="66a2a611-e81d-450b-8510-7be7f9454a7c" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="2cd837f9-2661-4900-9be7-6e96cdf61b65" ParentLink="ComplexStatement_Statement" LowerBound="646.1" HigherBound="662.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_ERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="196ac73b-59c7-4a6a-81eb-f15d75590684" ParentLink="Construct_MessageRef" LowerBound="647.35" HigherBound="647.44">
                                    <om:Property Name="Ref" Value="Message_1" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="72a76daa-7eb6-4a48-84ee-5b75f757c4b9" ParentLink="ComplexStatement_Statement" LowerBound="649.1" HigherBound="661.1">
                                    <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Transaction Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="318976ad-de5d-4c86-baf7-07d116e91b42" ParentLink="ComplexStatement_Statement" LowerBound="662.1" HigherBound="683.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_BadDataResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="2697b7bf-7686-4f4f-acf4-63f46b0c525f" ParentLink="ReallyComplexStatement_Branch" LowerBound="663.25" HigherBound="683.1">
                                    <om:Property Name="Expression" Value="varBadDataResponse == false" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="80cdd7e3-89d7-4f05-909f-1e9d1336cbc6" ParentLink="ComplexStatement_Statement" LowerBound="665.1" HigherBound="667.1">
                                        <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                        <om:Property Name="MessageName" Value="Message_1" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="e4dd427d-1c82-49ca-96de-358b66ce8cd0" ParentLink="ComplexStatement_Statement" LowerBound="667.1" HigherBound="680.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="62ae4cec-d74c-4592-a7a0-ef8d7af0c5cd" ParentLink="ComplexStatement_Statement" LowerBound="670.1" HigherBound="679.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="3c358f80-e585-4194-9bb4-e5cbe2ec8847" ParentLink="Construct_MessageRef" LowerBound="668.39" HigherBound="668.51">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="4b554a4e-193e-48e7-b034-ffb5ff83d81e" ParentLink="ComplexStatement_Statement" LowerBound="680.1" HigherBound="682.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="11d632b2-55f9-44b2-99e0-f854e0724e80" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="dd83d5bf-6cf5-4fbb-ae10-93f245b55549" ParentLink="ComplexStatement_Statement" LowerBound="683.1" HigherBound="685.1">
                                <om:Property Name="PortName" Value="Port_RawFile" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_RAWFile" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="8a4e76bd-19e9-4fae-a6d0-202d768c7aae" ParentLink="ComplexStatement_Statement" LowerBound="685.1" HigherBound="698.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="cb7f0973-4d71-4c44-88dc-8e308989d1f5" ParentLink="ReallyComplexStatement_Branch" LowerBound="686.25" HigherBound="698.1">
                                    <om:Property Name="Expression" Value="varArchive3RAW == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveRAWFile" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="947b24d3-6163-4185-aac0-e8a420ee7320" ParentLink="ComplexStatement_Statement" LowerBound="688.1" HigherBound="695.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="ff5b35bf-7295-4d93-82c5-00287d0befb9" ParentLink="Construct_MessageRef" LowerBound="689.39" HigherBound="689.63">
                                            <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="5bfa7429-653e-4ed8-a4ea-4bd500ef54b8" ParentLink="ComplexStatement_Statement" LowerBound="691.1" HigherBound="694.1">
                                            <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant3 + &quot;RAWOutput&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="587dbf3e-d996-4ad9-8d63-414d00eb4ca8" ParentLink="ComplexStatement_Statement" LowerBound="695.1" HigherBound="697.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                        <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_raw" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="bad32afd-8e1b-4a20-bd38-1361176a92d5" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="90efc2b4-aade-4cce-8688-753682f465be" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="b77570c2-e811-48c0-a543-e1ce40807963" ParentLink="ComplexStatement_Statement" LowerBound="699.1" HigherBound="851.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Merchant4_Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="35ad0431-ab87-4b15-b3a8-1ff18577ea54" ParentLink="ReallyComplexStatement_Branch" LowerBound="700.21" HigherBound="851.1">
                            <om:Property Name="Expression" Value="varMerchant4Active == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Mechant4_Check" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="88828bae-56e2-46d8-829c-be602d8e010c" ParentLink="ComplexStatement_Statement" LowerBound="702.1" HigherBound="721.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="23ab632c-bd87-4d57-81e6-5b3dfeb565b3" ParentLink="Construct_MessageRef" LowerBound="703.35" HigherBound="703.50">
                                    <om:Property Name="Ref" Value="Message_Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="c20adc6d-345e-4500-8727-5bf71c407630" ParentLink="ComplexStatement_Statement" LowerBound="705.1" HigherBound="720.1">
                                    <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant4 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword4 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer4 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser4 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;TransactionDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="7cd223c6-46e7-46e6-9241-0f2a1b417e2f" ParentLink="ComplexStatement_Statement" LowerBound="721.1" HigherBound="734.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="bcd54bc9-cec5-4b98-af65-cdd5aa72e5b4" ParentLink="ReallyComplexStatement_Branch" LowerBound="722.25" HigherBound="734.1">
                                    <om:Property Name="Expression" Value="varArchive1WCF == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveWCFMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="b18a0b30-d631-46ce-8b40-4513d3b2e64d" ParentLink="ComplexStatement_Statement" LowerBound="724.1" HigherBound="731.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="33cc5a49-9c4f-4ad9-80f8-96cdb8b73fa1" ParentLink="Construct_MessageRef" LowerBound="725.39" HigherBound="725.59">
                                            <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="7f1d0075-db30-432a-a25e-8304b2adead6" ParentLink="ComplexStatement_Statement" LowerBound="727.1" HigherBound="730.1">
                                            <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant4 + &quot;WCFRequest&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="21a6cddd-0baa-4c76-8646-318bc09c8179" ParentLink="ComplexStatement_Statement" LowerBound="731.1" HigherBound="733.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                        <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ArchiveWCF" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="55f3dc4c-11dd-49c3-99fd-15be89ff8df3" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="42703cee-9d70-4ca5-aa6a-7a1c5fd20f40" ParentLink="ComplexStatement_Statement" LowerBound="734.1" HigherBound="743.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="6155fe37-c836-4b67-9861-35a06a771a75" ParentLink="Construct_MessageRef" LowerBound="735.35" HigherBound="735.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="9c5f78ec-3d67-48c8-8fc8-69846df33fc0" ParentLink="Construct_MessageRef" LowerBound="735.52" HigherBound="735.68">
                                    <om:Property Name="Ref" Value="Message_Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="0651ce8d-06d6-453e-9223-c0489965b3c5" ParentLink="ComplexStatement_Statement" LowerBound="737.1" HigherBound="742.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="3bf95dad-947b-4585-99ee-b6640d301263" ParentLink="ComplexStatement_Statement" LowerBound="743.1" HigherBound="779.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Catch" OID="04ef3b60-d1a6-4aa9-a8da-b0a23d8ccd56" ParentLink="Scope_Catch" LowerBound="755.1" HigherBound="777.1">
                                    <om:Property Name="ExceptionName" Value="ex2" />
                                    <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="7d51f9d3-542d-4ccf-a63a-a13e022796c4" ParentLink="Catch_Statement" LowerBound="758.1" HigherBound="774.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="78db95e4-cb86-45db-9537-e20648ba7c54" ParentLink="ComplexStatement_Statement" LowerBound="761.1" HigherBound="773.1">
                                            <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="9c404512-3c09-45d9-bf99-ea8375e9dce4" ParentLink="Construct_MessageRef" LowerBound="759.47" HigherBound="759.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="8143195f-c1d3-4aa2-9931-6fd93baa59e3" ParentLink="Catch_Statement" LowerBound="774.1" HigherBound="776.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="43462465-51d4-427f-a3ff-746ae0c863d3" ParentLink="ComplexStatement_Statement" LowerBound="748.1" HigherBound="750.1">
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Request" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="f2397ccd-5bbe-44f3-9e9a-c8f711ede171" ParentLink="ComplexStatement_Statement" LowerBound="750.1" HigherBound="752.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Response" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="101126ce-b1cf-4cc3-933a-d8a2e8e76a5c" ParentLink="ComplexStatement_Statement" LowerBound="779.1" HigherBound="785.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Backup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Transform" OID="f5f50902-3c66-4b5b-98f0-92ab2a14037c" ParentLink="ComplexStatement_Statement" LowerBound="782.1" HigherBound="784.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.Transform2Backup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_3" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="a4369565-1f08-4488-bf35-16fdf9177705" ParentLink="Transform_OutputMessagePartRef" LowerBound="783.40" HigherBound="783.62">
                                        <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="f8fedcdc-b145-41e5-b5b7-a1787f3d2b6c" ParentLink="Transform_InputMessagePartRef" LowerBound="783.119" HigherBound="783.146">
                                        <om:Property Name="MessageRef" Value="Message_Response" />
                                        <om:Property Name="PartRef" Value="parameters" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageRef" OID="6005ee91-c47f-46d3-8b84-14c374b7d7e7" ParentLink="Construct_MessageRef" LowerBound="780.35" HigherBound="780.57">
                                    <om:Property Name="Ref" Value="Message_ResponseBackup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="f2ec560b-54cb-4a61-b0cc-6cb7e9c3ee57" ParentLink="ComplexStatement_Statement" LowerBound="785.1" HigherBound="798.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="34b7efdf-847d-413a-adfd-8a7ed3bee667" ParentLink="ReallyComplexStatement_Branch" LowerBound="786.25" HigherBound="798.1">
                                    <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveResponseBackup" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="45325e67-1153-48eb-a2f0-9b6466ee671b" ParentLink="ComplexStatement_Statement" LowerBound="788.1" HigherBound="795.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="bcd30ae8-9bff-4628-ae52-21b88db8606d" ParentLink="ComplexStatement_Statement" LowerBound="791.1" HigherBound="794.1">
                                            <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant4 + &quot;WCFResponseBackup&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="0c132632-9766-462b-b649-6775497b67b6" ParentLink="Construct_MessageRef" LowerBound="789.39" HigherBound="789.70">
                                            <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="43c68f88-c5b1-4f02-877f-1f9e8ab48e67" ParentLink="ComplexStatement_Statement" LowerBound="795.1" HigherBound="797.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                        <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_backup" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="aef6c3ea-bc15-4a22-972f-7421c50ac73f" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="b721debb-6635-403a-9c8d-1338cc16c04b" ParentLink="ComplexStatement_Statement" LowerBound="798.1" HigherBound="814.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_ERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="2db2d288-0cc1-4dd9-bc21-3c6db39d8954" ParentLink="Construct_MessageRef" LowerBound="799.35" HigherBound="799.44">
                                    <om:Property Name="Ref" Value="Message_1" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="01015829-d7b8-4888-8ff6-516236cca1a9" ParentLink="ComplexStatement_Statement" LowerBound="801.1" HigherBound="813.1">
                                    <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Transaction Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="8083753c-8e28-41db-9c3e-e1cd958d34c2" ParentLink="ComplexStatement_Statement" LowerBound="814.1" HigherBound="835.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_BadDataResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="827cd61a-764d-4ca5-ae9a-9b1108058af1" ParentLink="ReallyComplexStatement_Branch" LowerBound="815.25" HigherBound="835.1">
                                    <om:Property Name="Expression" Value="varBadDataResponse == false" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="cd360e8a-4acf-4fd7-a8ed-bb334b4557ec" ParentLink="ComplexStatement_Statement" LowerBound="817.1" HigherBound="819.1">
                                        <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                        <om:Property Name="MessageName" Value="Message_1" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="a0c5751f-7fd2-41ff-9322-ec47cf303474" ParentLink="ComplexStatement_Statement" LowerBound="819.1" HigherBound="832.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="44a2bf18-7cf8-47f3-a584-01dc9e5bd2a1" ParentLink="ComplexStatement_Statement" LowerBound="822.1" HigherBound="831.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="6d2cd1a4-96a8-43d1-87af-fae1d5c1d65d" ParentLink="Construct_MessageRef" LowerBound="820.39" HigherBound="820.51">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="c278cee4-9b1e-4bc7-a53b-b241a16aff29" ParentLink="ComplexStatement_Statement" LowerBound="832.1" HigherBound="834.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="dcdf6315-46cc-49d8-bfcb-51926dae8ef7" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="844328b1-4b69-41e5-95bb-cb61f794b4ae" ParentLink="ComplexStatement_Statement" LowerBound="835.1" HigherBound="837.1">
                                <om:Property Name="PortName" Value="Port_RawFile" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_RAWFile" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="8f8f38a9-d9ba-46c2-a4e9-1c98eac4086f" ParentLink="ComplexStatement_Statement" LowerBound="837.1" HigherBound="850.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="b58ef38b-6b19-48d9-b6e2-97753cc197f9" ParentLink="ReallyComplexStatement_Branch" LowerBound="838.25" HigherBound="850.1">
                                    <om:Property Name="Expression" Value="varArchive3RAW == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveRAWFile" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="ed8cc621-ee82-438b-8c70-5014b27dca9a" ParentLink="ComplexStatement_Statement" LowerBound="840.1" HigherBound="847.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="1373dd16-1f61-4931-9c2f-5153adbe92dc" ParentLink="Construct_MessageRef" LowerBound="841.39" HigherBound="841.63">
                                            <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="034db688-5b53-4668-802b-b09cd93e16d8" ParentLink="ComplexStatement_Statement" LowerBound="843.1" HigherBound="846.1">
                                            <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant4 + &quot;RAWOutput&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="e9331be8-d256-4c3e-8ead-bab385fe595b" ParentLink="ComplexStatement_Statement" LowerBound="847.1" HigherBound="849.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                        <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_raw" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="276a4d4f-0d1c-4cfa-8b18-edf2063b75ce" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="35174d36-b95d-4e7b-8b69-2936bbb4259a" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Terminate" OID="04810da7-6b3f-4ad2-964d-5d0290fe659c" ParentLink="ComplexStatement_Statement" LowerBound="851.1" HigherBound="853.1">
                        <om:Property Name="ErrorMessage" Value="&quot;test&quot;;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Terminate_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="10b355ed-7a6d-4b08-b228-2ea3f2604dc0" ParentLink="Scope_MessageDeclaration" LowerBound="200.1" HigherBound="201.1">
                        <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.MultipartType_Flat" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Message_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Catch" OID="652d7b97-711e-4220-9793-c6724eb06904" ParentLink="Scope_Catch" LowerBound="856.1" HigherBound="875.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.SystemException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_Main" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="9f9c8e03-f03a-453a-92f3-3c983db154b5" ParentLink="Catch_Statement" LowerBound="859.1" HigherBound="872.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_Fault" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="c94b1016-c61a-4ef1-86cf-aab33ac2e843" ParentLink="Construct_MessageRef" LowerBound="860.35" HigherBound="860.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="3eb4209c-23a1-4a1f-b98f-4a113e9c17c0" ParentLink="ComplexStatement_Statement" LowerBound="862.1" HigherBound="871.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=ex.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_5" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="f44192ac-80a0-42b4-a091-25a013bf9a97" ParentLink="Catch_Statement" LowerBound="872.1" HigherBound="874.1">
                            <om:Property Name="PortName" Value="Port_FaultPort" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Fault" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="db0333f6-eadd-4f45-af40-4305a95f3b64" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="93.1" HigherBound="95.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.IOrdersService" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_WCF" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="6efa7246-3257-460f-a776-d04a1659dceb" ParentLink="PortDeclaration_CLRAttribute" LowerBound="93.1" HigherBound="94.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="895ce8ef-441a-44d2-beb3-5c6f11a129e3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="95.1" HigherBound="97.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_Archive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveWCF" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="a82586ea-f5de-4381-bbc7-0743054d9299" ParentLink="PortDeclaration_CLRAttribute" LowerBound="95.1" HigherBound="96.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4d31e022-34ca-47cb-847c-79a0e3ecc906" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="97.1" HigherBound="99.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_Dummyx" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Dummy" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="8b65908e-e5bc-498a-a9e9-33b2688f6096" ParentLink="PortDeclaration_CLRAttribute" LowerBound="97.1" HigherBound="98.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="172a8aea-b377-417b-a4ea-cfcce09d50fa" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="99.1" HigherBound="101.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_ERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveBackup" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="5a5c0d1e-ea48-4692-b487-56665c9ae366" ParentLink="PortDeclaration_CLRAttribute" LowerBound="99.1" HigherBound="100.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="777ca44e-e4cf-4aa8-8f90-fee8cf487540" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="101.1" HigherBound="103.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_2" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_RawFile" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="197f9a86-472b-441a-a890-c8b6abb24482" ParentLink="PortDeclaration_CLRAttribute" LowerBound="101.1" HigherBound="102.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="5d6019dc-7135-473c-baa0-16e5d9ca5b79" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="103.1" HigherBound="105.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_ArchiveRAW" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveRAW" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="7284ed50-94af-450c-a7e8-b515a72b9192" ParentLink="PortDeclaration_CLRAttribute" LowerBound="103.1" HigherBound="104.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="d0a425a5-ca42-40e8-abe3-2e3a2bd0dde2" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="105.1" HigherBound="107.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_FaultPort" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_FaultPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="a5885f31-2526-47e2-8ce2-d5d2a2dd22c1" ParentLink="PortDeclaration_CLRAttribute" LowerBound="105.1" HigherBound="106.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="6d013108-1e34-452e-b127-bc6cde3a0c8a" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="107.1" HigherBound="109.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource.PortType_EmailBadDataResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_EmailBadDataResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="2b95b8fb-d95e-4bd9-a9f7-390ba29a87bb" ParentLink="PortDeclaration_CLRAttribute" LowerBound="107.1" HigherBound="108.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ReconCybersource
{
    internal messagetype MultipartType_Fault
    {
        body BTS.soap_envelope_1__1.Fault MessagePart_Fault;
    };
    internal messagetype MultipartType_Flat
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_Body;
    };
    internal messagetype IOrdersService_GetCyberSourceReport_InputMessage
    {
        body IOrder_tempuri_org.GetCyberSourceReport parameters;
    };
    internal messagetype IOrdersService_GetCyberSourceReport_OutputMessage
    {
        body IOrder_tempuri_org.GetCyberSourceReportResponse parameters;
    };
    internal porttype PortType_FaultPort
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype IOrdersService
    {
        requestresponse GetCyberSourceReport
        {
            IOrdersService_GetCyberSourceReport_InputMessage, IOrdersService_GetCyberSourceReport_OutputMessage, Fault_1 = MultipartType_Fault
        };
    };
    internal porttype PortType_Archive
    {
        oneway Operation_1
        {
            IOrdersService_GetCyberSourceReport_InputMessage
        };
    };
    internal porttype PortType_Dummyx
    {
        oneway Operation_1
        {
            DummyReconCybersource
        };
    };
    internal porttype PortType_ERP
    {
        oneway Operation_1
        {
            CyberSourceResponseBackup
        };
    };
    internal porttype PortType_ArchiveOut
    {
        oneway Operation_1
        {
            IOrdersService_GetCyberSourceReport_OutputMessage
        };
    };
    internal porttype PortType_1
    {
        oneway Operation_1
        {
            FlatFileSchemaCybersourceBody
        };
    };
    internal porttype PortType_2
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    internal porttype PortType_ArchiveRAW
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    internal porttype PortType_EmailBadDataResponse
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service IOrderClient
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses IOrdersService Port_WCF;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Archive Port_ArchiveWCF;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_Dummyx Port_Dummy;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ERP Port_ArchiveBackup;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_2 Port_RawFile;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveRAW Port_ArchiveRAW;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses PortType_FaultPort Port_FaultPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_EmailBadDataResponse Port_EmailBadDataResponse;
        message System.Xml.XmlDocument MessageXMLDummy;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage FaultMessage;
        message IOrdersService_GetCyberSourceReport_InputMessage Message_Request;
        message IOrdersService_GetCyberSourceReport_OutputMessage Message_Response;
        message DummyReconCybersource Message_Dummy;
        message CyberSourceResponseBackup Message_ResponseBackup;
        message IOrdersService_GetCyberSourceReport_InputMessage Message_Archive1_WCF;
        message CyberSourceResponseBackup Message_Archive2_BackupResponse;
        message MultipartType_Flat Message_Archive3_RAWFile;
        System.Boolean varMerchant2Active;
        System.String varMerchant2;
        System.String varPassword2;
        System.String varUser2;
        System.String varServer2;
        System.String varErrorMessage;
        System.Xml.XmlDocument xmlDoc;
        System.Text.StringBuilder msgbody;
        System.String sHold;
        System.Xml.XmlDocument xmlQRYRECONCYBERSOURCE;
        System.String varServer1;
        System.Xml.XmlDocument xmlFLATRECYBERSOURCE;
        System.String sXpath;
        System.String varReportYear;
        System.String varReportDay;
        System.String varReportMonth;
        System.String varMerchant1;
        System.String varUser1;
        System.String varPassword1;
        System.Boolean varArchive1WCF;
        System.Boolean varArchive2BackupResponse;
        System.Boolean varArchive3RAW;
        System.DateTime varDateYesterday;
        System.DateTime varDateYesterday2;
        System.String varReportDate;
        System.String varDaysBack;
        System.Int16 intDaysBack;
        System.Exception varException;
        System.Boolean varBadDataResponse;
        System.String varMerchant3;
        System.String varMerchant4;
        System.String varUser3;
        System.String varUser4;
        System.String varPassword3;
        System.String varPassword4;
        System.String varServer3;
        System.String varServer4;
        System.Boolean varMerchant3Active;
        System.Boolean varMerchant4Active;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("66daced9-8c83-4abe-bb10-1f2f55f7d6c1")]
            activate receive (Port_Dummy.Operation_1, Message_Dummy);
            varMerchant2Active = true;
            varMerchant2 = "";
            varPassword2 = "";
            varUser2 = "";
            varServer2 = "";
            varErrorMessage = "";
            xmlDoc = new System.Xml.XmlDocument();
            msgbody = new System.Text.StringBuilder();
            sHold = "";
            xmlQRYRECONCYBERSOURCE = new System.Xml.XmlDocument();
            varServer1 = "";
            xmlFLATRECYBERSOURCE = new System.Xml.XmlDocument();
            sXpath = "";
            varReportYear = "";
            varReportDay = "";
            varReportMonth = "";
            varMerchant1 = "";
            varUser1 = "";
            varPassword1 = "";
            varArchive1WCF = true;
            varArchive2BackupResponse = true;
            varArchive3RAW = true;
            varReportDate = "";
            varDaysBack = "";
            varException = new System.Exception();
            varBadDataResponse = true;
            varMerchant3 = "";
            varMerchant4 = "";
            varUser3 = "";
            varUser4 = "";
            varPassword3 = "";
            varPassword4 = "";
            varServer3 = "";
            varServer4 = "";
            varMerchant3Active = true;
            varMerchant4Active = true;
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("43fff510-b9ba-4129-b9b0-6001cc8ea1f2")]
            scope
            {
                message MultipartType_Flat Message_1;
                System.Text.StringBuilder Variable_1;
                body
                {
                    Variable_1 = new System.Text.StringBuilder();
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f1a083e6-4300-4a17-855a-dc1fd536ab04")]
                    varArchive1WCF=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Archive1WCF"));
                    varArchive2BackupResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Archive2ResponseBackup"));
                    varArchive3RAW=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Archive3RAWFile"));
                    varMerchant1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant1");                                                                                                               
                    varServer1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Server1");  
                    varUser1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","User1");  
                    varPassword1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Password1");  
                    varDaysBack=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","DaysBack");  
                    
                    varMerchant2Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant2Active"));
                    varMerchant2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant2");                                                                                                               
                    varServer2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Server2");  
                    varUser2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","User2");  
                    varPassword2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Password2");  
                    
                    varMerchant3Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant3Active"));
                    varMerchant3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant3");                                                                                                               
                    varServer3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Server3");  
                    varUser3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","User3");  
                    varPassword3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Password3");  
                    
                    varMerchant4Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant4Active"));
                    varMerchant4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Merchant4");                                                                                                               
                    varServer4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Server4");  
                    varUser4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","User4");  
                    varPassword4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource","Password4");  
                    
                    intDaysBack=System.Convert.ToInt16(varDaysBack);
                    
                    
                    varDateYesterday = System.DateTime.Now.AddDays(-intDaysBack);
                    
                    varReportMonth = System.Convert.ToString(varDateYesterday.Month);
                    varReportYear = System.Convert.ToString(varDateYesterday.Year);
                    varReportDay = System.Convert.ToString(varDateYesterday.Day);
                    
                    varReportMonth = varReportMonth.PadLeft(2,'0');
                    varReportDay = varReportDay.PadLeft(2,'0');
                    
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ReconCyberSource", "Cybersource " + varReportMonth + "/" + varReportDay + "/" + varReportYear );
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b1d098f3-d0c6-4624-9165-ef97417f5a1a")]
                    construct Message_Request
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("042004c1-a6e5-4a85-ab0a-cdc90d063269")]
                        //For Testing... 
                        //varCurrentYear = "2013"; 
                        //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                        //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                        //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                        
                        
                        //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                        
                        xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant1 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword1 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer1 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser1 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>TransactionDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                        
                        
                        
                        Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3681b0ba-044f-419b-973c-22e98bcc48f2")]
                    if (varArchive1WCF == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ccf5e75d-9d93-44b1-8a7b-a33fb963821f")]
                        construct Message_Archive1_WCF
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("380c859f-ea3a-40e8-b8ae-85bdd703b132")]
                            Message_Archive1_WCF = Message_Request; 
                            Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant1 + "WCFRequest"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4dccba6d-38db-4d3b-9b2f-3a496322fe81")]
                        send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f742a106-88a4-435a-aadc-801b9c792dfa")]
                    construct MessageXMLDummy, Message_Response
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("54f81957-a646-4ec3-9fc4-429b47662a27")]
                        MessageXMLDummy = new System.Xml.XmlDocument();
                        MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                        
                        Message_Response.parameters = MessageXMLDummy;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7548b6e4-45e1-4d12-96b6-e86312fa8889")]
                    scope
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("efed3df0-71cf-4956-ac1d-a6002cc78a22")]
                            send (Port_WCF.GetCyberSourceReport, Message_Request);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7835b61b-aab8-4c37-aa1b-52a7e52a80fc")]
                            receive (Port_WCF.GetCyberSourceReport, Message_Response);
                        }
                        exceptions
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("64466e72-92ff-4653-b24b-1572fe971c62")]
                            catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("60d664ec-a4ef-47ee-9146-e80bc03bdb80")]
                                construct FaultMessage
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5e96991a-e793-4a8c-9c95-146b2965052e")]
                                    // Create fault 
                                    xmlDoc = ex2.MessagePart_Fault;
                                    varErrorMessage = xmlDoc.OuterXml;
                                    // Create fault exception Message
                                    FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                    
                                    // Assign Properties
                                    FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                    FaultMessage.FaultDescription=varErrorMessage;
                                    FaultMessage.FaultCode="3004";
                                    FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("23f6be69-e7e1-4200-b75f-de1f867e272d")]
                                send (Port_FaultPort.Operation_1, FaultMessage);
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6aaa1186-8e16-4613-a27e-95906fde3da6")]
                    construct Message_ResponseBackup
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d8c7f3ba-979b-49ea-8145-2359f77e31a3")]
                        transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource.Transform2Backup (Message_Response.parameters);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9d333925-34ed-40b5-8d20-f97e324f4b30")]
                    if (varArchive2BackupResponse == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8ad86844-37e7-40ba-a19e-05ec039483c4")]
                        construct Message_Archive2_BackupResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("76bb1bda-79d3-408b-a8bb-b070bc919301")]
                            Message_Archive2_BackupResponse = Message_ResponseBackup; 
                            Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant1 + "WCFResponseBackup"; 
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cf07c2ca-d32f-436b-a396-b5fbcb6aa2a2")]
                        send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a8da2eb-c17a-4af5-ac82-af56d596369b")]
                    construct Message_1
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e161fbf-be20-4bdd-a791-534044db3572")]
                        sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                        //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                        //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                        Variable_1 = new System.Text.StringBuilder();
                        Variable_1.AppendLine(sXpath); 
                        Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                        varBadDataResponse = sXpath.StartsWith("Transaction Detail Report");
                        //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                        
                        
                        
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8b3bdbf6-8477-4f99-8831-11fb61039bf0")]
                    if (varBadDataResponse == false)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2bbf1990-31eb-4fbc-8169-9ddd652a4db7")]
                        send (Port_EmailBadDataResponse.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("abeb4222-7484-4e73-81a1-5abe8505e359")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c0ea388a-aff5-430e-8fcc-9f0d40c74e49")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                            FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                            FaultMessage.FaultCode="3004";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0c164207-6beb-4171-aeae-69002cac5793")]
                        send (Port_FaultPort.Operation_1, FaultMessage);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("05937b8f-f711-42b9-b8b6-cce4be3ec2cc")]
                    if (varArchive3RAW == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4218e02f-c3fa-481a-9a47-af1438921ace")]
                        construct Message_Archive3_RAWFile
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5b7aa784-2f9a-4c2f-928d-2306cd6e0e82")]
                            Message_Archive3_RAWFile = Message_1; 
                            Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant1 + "RAWOutput"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b078481a-df0d-408c-b37f-c49be902c0e3")]
                        send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5606077c-5217-4238-a3bb-cc32e4e2d5df")]
                    send (Port_RawFile.Operation_1, Message_1);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8e7d4a76-8433-451e-ba57-536435401317")]
                    if (varMerchant2Active == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("84373a53-436e-4aa1-bc90-53fedbee31d1")]
                        construct Message_Request
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4091053f-313c-4c40-8b3d-f73b1da94dbb")]
                            //For Testing... 
                            //varCurrentYear = "2013"; 
                            //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                            
                            
                            //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                            
                            xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant2 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword2 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer2 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser2 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>TransactionDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                            
                            
                            
                            Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f9afe54a-a068-4e93-ab25-2f8da9ad0861")]
                        if (varArchive1WCF == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ff81a4f2-7a8e-4197-8192-9df4928de574")]
                            construct Message_Archive1_WCF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0db3885d-a81c-4843-a7b2-70c3826f6865")]
                                Message_Archive1_WCF = Message_Request; 
                                Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant2 + "WCFRequest"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f749df3-1ed6-42b7-9dce-813c17123ffa")]
                            send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0ee74700-5b6e-4135-a8dd-8e2eb0837211")]
                        construct MessageXMLDummy, Message_Response
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("22ecb790-8487-491e-bd9e-5a23cb09edae")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                            
                            Message_Response.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bc9e6b77-3481-4642-8148-2f9cee150c93")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("411b278e-914c-43a7-8524-e71e56a44bfb")]
                                send (Port_WCF.GetCyberSourceReport, Message_Request);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("20bb0ae5-3307-4df0-8fbe-2ebfe29e473e")]
                                receive (Port_WCF.GetCyberSourceReport, Message_Response);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba2e2713-2c7b-46f5-b7ea-adba71ca3179")]
                                catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("67f4561d-1ab2-4a7a-83aa-c4226c361687")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e476db2c-4b36-4ffe-8697-fbdc19fa74f5")]
                                        // Create fault 
                                        xmlDoc = ex2.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        // Create fault exception Message
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3004";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a961b75f-7dd5-4d30-b2df-302fbe90a34a")]
                                    send (Port_FaultPort.Operation_1, FaultMessage);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a1eaf7ae-739e-4bcb-920a-e20879b1d319")]
                        construct Message_ResponseBackup
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c8b88f64-1da6-45fb-8200-33b46d05b986")]
                            transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource.Transform2Backup (Message_Response.parameters);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9bb551bd-0c44-4cc6-94ca-0b9ce8b84c91")]
                        if (varArchive2BackupResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a148342f-622e-4b29-a25a-14706421aa5a")]
                            construct Message_Archive2_BackupResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("327158a5-d283-4caf-b06c-b1ea504f0631")]
                                Message_Archive2_BackupResponse = Message_ResponseBackup; 
                                Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant2 + "WCFResponseBackup"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5112ff75-e6e7-4106-82e7-3f381353cf5f")]
                            send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("47e02e86-4343-45e6-abc3-021743a9a6dc")]
                        construct Message_1
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5ece285b-ba85-496e-940a-603d9452c17f")]
                            sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                            //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                            Variable_1 = new System.Text.StringBuilder();
                            Variable_1.AppendLine(sXpath); 
                            Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                            varBadDataResponse = sXpath.StartsWith("Transaction Detail Report");
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("37317f9b-cc80-4df2-b47c-7c9abe908c84")]
                        if (varBadDataResponse == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b82c16b4-eb07-40de-b67a-b3d982af3fe6")]
                            send (Port_EmailBadDataResponse.Operation_1, Message_1);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5a25bbd5-51a1-4653-90f4-756995b32d1a")]
                            construct FaultMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ad706bdc-05d9-4cd7-b82c-47d890574685")]
                                // Create fault exception Message
                                FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                
                                // Assign Properties
                                FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                                FaultMessage.FaultCode="3004";
                                FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0328fd52-a4c9-4242-9cee-3e0cf906f27c")]
                            send (Port_FaultPort.Operation_1, FaultMessage);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9000001-633c-408e-ad9c-94e22d8ce0cb")]
                        send (Port_RawFile.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ef4b987e-0e44-4e53-a9f0-088dd02360cd")]
                        if (varArchive3RAW == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a787bad-cd10-4f6a-983f-297a9ee87b94")]
                            construct Message_Archive3_RAWFile
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd5b54c8-8ffa-4016-9831-49d625dcf0bd")]
                                Message_Archive3_RAWFile = Message_1; 
                                Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant2 + "RAWOutput"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f16b445f-bad6-4775-87ee-8940873e6822")]
                            send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("502274e3-5644-4eaf-b87c-7731a293543a")]
                    if (varMerchant3Active == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b103f3cd-33cb-46ed-879d-e326d08b7784")]
                        construct Message_Request
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("901952eb-88f0-4f8f-9d8e-a8a755806727")]
                            //For Testing... 
                            //varCurrentYear = "2013"; 
                            //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                            
                            
                            //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                            
                            xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant3 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword3 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer3 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser3 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>TransactionDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                            
                            
                            
                            Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("020e5289-b15e-483c-87b2-786bf230a239")]
                        if (varArchive1WCF == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b7f9aaef-6371-499f-9050-fa7b5d331ce7")]
                            construct Message_Archive1_WCF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("cddd277c-8de8-4edb-9fe9-ffa4a72f3669")]
                                Message_Archive1_WCF = Message_Request; 
                                Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant3 + "WCFRequest"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9e971ce-9f97-4810-b1be-19e1f9078f59")]
                            send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("15003a5b-1b70-4535-993e-d3bf0ca29657")]
                        construct MessageXMLDummy, Message_Response
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3cf2b2ef-083a-4569-9c8f-b2cd21ea4124")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                            
                            Message_Response.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("69a36e9f-e045-4d45-89c0-52c76448dc3c")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("531fceda-1a79-440d-933d-9e365b468e66")]
                                send (Port_WCF.GetCyberSourceReport, Message_Request);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c8f9e56c-1b37-494f-b31f-965d557937c8")]
                                receive (Port_WCF.GetCyberSourceReport, Message_Response);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1e9b052a-a677-4254-8eb9-4944b1d9cf6d")]
                                catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6fb80781-25d9-4902-a74e-9926a5dd1145")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e5bb8c58-1492-4921-9e9e-f9c3f5e42064")]
                                        // Create fault 
                                        xmlDoc = ex2.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        // Create fault exception Message
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3004";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1110a470-9813-4f08-ae69-4b8704486454")]
                                    send (Port_FaultPort.Operation_1, FaultMessage);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("291c8721-8741-47e4-9c07-dc32f208e0db")]
                        construct Message_ResponseBackup
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d641df78-f572-4cff-88bd-11277a86c05d")]
                            transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource.Transform2Backup (Message_Response.parameters);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b7a0ff84-e8eb-42e3-9bbc-913096f9dcba")]
                        if (varArchive2BackupResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a7f9e26e-3c5a-4fd3-aece-c14f80c1addb")]
                            construct Message_Archive2_BackupResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("fa26deb4-73e2-4918-9145-ca28893ed203")]
                                Message_Archive2_BackupResponse = Message_ResponseBackup; 
                                Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant3 + "WCFResponseBackup"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bad9b6ca-b2f5-4a1d-b3a4-fb703d502096")]
                            send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2cd837f9-2661-4900-9be7-6e96cdf61b65")]
                        construct Message_1
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("72a76daa-7eb6-4a48-84ee-5b75f757c4b9")]
                            sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                            //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                            Variable_1 = new System.Text.StringBuilder();
                            Variable_1.AppendLine(sXpath); 
                            Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                            varBadDataResponse = sXpath.StartsWith("Transaction Detail Report");
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("318976ad-de5d-4c86-baf7-07d116e91b42")]
                        if (varBadDataResponse == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("80cdd7e3-89d7-4f05-909f-1e9d1336cbc6")]
                            send (Port_EmailBadDataResponse.Operation_1, Message_1);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e4dd427d-1c82-49ca-96de-358b66ce8cd0")]
                            construct FaultMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("62ae4cec-d74c-4592-a7a0-ef8d7af0c5cd")]
                                // Create fault exception Message
                                FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                
                                // Assign Properties
                                FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                                FaultMessage.FaultCode="3004";
                                FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4b554a4e-193e-48e7-b034-ffb5ff83d81e")]
                            send (Port_FaultPort.Operation_1, FaultMessage);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("dd83d5bf-6cf5-4fbb-ae10-93f245b55549")]
                        send (Port_RawFile.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a4e76bd-19e9-4fae-a6d0-202d768c7aae")]
                        if (varArchive3RAW == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("947b24d3-6163-4185-aac0-e8a420ee7320")]
                            construct Message_Archive3_RAWFile
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5bfa7429-653e-4ed8-a4ea-4bd500ef54b8")]
                                Message_Archive3_RAWFile = Message_1; 
                                Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant3 + "RAWOutput"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("587dbf3e-d996-4ad9-8d63-414d00eb4ca8")]
                            send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b77570c2-e811-48c0-a543-e1ce40807963")]
                    if (varMerchant4Active == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("88828bae-56e2-46d8-829c-be602d8e010c")]
                        construct Message_Request
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c20adc6d-345e-4500-8727-5bf71c407630")]
                            //For Testing... 
                            //varCurrentYear = "2013"; 
                            //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                            
                            
                            //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                            
                            xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant4 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword4 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer4 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser4 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>TransactionDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                            
                            
                            
                            Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7cd223c6-46e7-46e6-9241-0f2a1b417e2f")]
                        if (varArchive1WCF == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b18a0b30-d631-46ce-8b40-4513d3b2e64d")]
                            construct Message_Archive1_WCF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7f1d0075-db30-432a-a25e-8304b2adead6")]
                                Message_Archive1_WCF = Message_Request; 
                                Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant4 + "WCFRequest"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("21a6cddd-0baa-4c76-8646-318bc09c8179")]
                            send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("42703cee-9d70-4ca5-aa6a-7a1c5fd20f40")]
                        construct MessageXMLDummy, Message_Response
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0651ce8d-06d6-453e-9223-c0489965b3c5")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                            
                            Message_Response.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3bf95dad-947b-4585-99ee-b6640d301263")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("43462465-51d4-427f-a3ff-746ae0c863d3")]
                                send (Port_WCF.GetCyberSourceReport, Message_Request);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f2397ccd-5bbe-44f3-9e9a-c8f711ede171")]
                                receive (Port_WCF.GetCyberSourceReport, Message_Response);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("04ef3b60-d1a6-4aa9-a8da-b0a23d8ccd56")]
                                catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7d51f9d3-542d-4ccf-a63a-a13e022796c4")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("78db95e4-cb86-45db-9537-e20648ba7c54")]
                                        // Create fault 
                                        xmlDoc = ex2.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        // Create fault exception Message
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3004";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8143195f-c1d3-4aa2-9931-6fd93baa59e3")]
                                    send (Port_FaultPort.Operation_1, FaultMessage);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("101126ce-b1cf-4cc3-933a-d8a2e8e76a5c")]
                        construct Message_ResponseBackup
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f5f50902-3c66-4b5b-98f0-92ab2a14037c")]
                            transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource.Transform2Backup (Message_Response.parameters);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f2ec560b-54cb-4a61-b0cc-6cb7e9c3ee57")]
                        if (varArchive2BackupResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("45325e67-1153-48eb-a2f0-9b6466ee671b")]
                            construct Message_Archive2_BackupResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bcd30ae8-9bff-4628-ae52-21b88db8606d")]
                                Message_Archive2_BackupResponse = Message_ResponseBackup; 
                                Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant4 + "WCFResponseBackup"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("43c68f88-c5b1-4f02-877f-1f9e8ab48e67")]
                            send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b721debb-6635-403a-9c8d-1338cc16c04b")]
                        construct Message_1
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("01015829-d7b8-4888-8ff6-516236cca1a9")]
                            sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                            //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                            Variable_1 = new System.Text.StringBuilder();
                            Variable_1.AppendLine(sXpath); 
                            Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                            varBadDataResponse = sXpath.StartsWith("Transaction Detail Report");
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8083753c-8e28-41db-9c3e-e1cd958d34c2")]
                        if (varBadDataResponse == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cd360e8a-4acf-4fd7-a8ed-bb334b4557ec")]
                            send (Port_EmailBadDataResponse.Operation_1, Message_1);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a0c5751f-7fd2-41ff-9322-ec47cf303474")]
                            construct FaultMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("44a2bf18-7cf8-47f3-a584-01dc9e5bd2a1")]
                                // Create fault exception Message
                                FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                
                                // Assign Properties
                                FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                                FaultMessage.FaultCode="3004";
                                FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c278cee4-9b1e-4bc7-a53b-b241a16aff29")]
                            send (Port_FaultPort.Operation_1, FaultMessage);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("844328b1-4b69-41e5-95bb-cb61f794b4ae")]
                        send (Port_RawFile.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8f8f38a9-d9ba-46c2-a4e9-1c98eac4086f")]
                        if (varArchive3RAW == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed8cc621-ee82-438b-8c70-5014b27dca9a")]
                            construct Message_Archive3_RAWFile
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("034db688-5b53-4668-802b-b09cd93e16d8")]
                                Message_Archive3_RAWFile = Message_1; 
                                Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant4 + "RAWOutput"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e9331be8-d256-4c3e-8ead-bab385fe595b")]
                            send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("04810da7-6b3f-4ad2-964d-5d0290fe659c")]
                    terminate "test";;
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("652d7b97-711e-4220-9793-c6724eb06904")]
                    catch (System.SystemException ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f9c8e03-f03a-453a-92f3-3c983db154b5")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3eb4209c-23a1-4a1f-b98f-4a113e9c17c0")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                            FaultMessage.FaultDescription=ex.Message;
                            FaultMessage.FaultCode="3004";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f44192ac-80a0-42b4-a091-25a013bf9a97")]
                        send (Port_FaultPort.Operation_1, FaultMessage);
                    }
                }
            }
        }
    }
}

