#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="326a228b-4da3-4e67-9a1b-89d90ca4b332" LowerBound="1.1" HigherBound="891.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ExpiredQuotations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="10e97c18-d1f2-4ff1-a338-73ddb452874d" ParentLink="Module_PortType" LowerBound="8.1" HigherBound="15.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ReceiveDummy" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="551e473e-30ce-4d76-baf2-2f8edcfd34fe" ParentLink="PortType_OperationDeclaration" LowerBound="10.1" HigherBound="14.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="a98ecb68-b7c6-442e-b97d-c498f8f60159" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="12.13" HigherBound="12.35">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.ExpiredQuotationsDummy" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="e490cb12-2cee-498d-a80a-d0a998a536d7" ParentLink="Module_PortType" LowerBound="15.1" HigherBound="22.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortTypeSQL_GetExpiredQuotation" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="11379e6c-7f6a-42c4-a8a9-029de5b8b1e6" ParentLink="PortType_OperationDeclaration" LowerBound="17.1" HigherBound="21.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procOrdersGetExpiredQuotations" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="996c8e73-fb4d-42a0-8faf-0839174dbc77" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="19.13" HigherBound="19.65">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="7ac0d895-13ba-4c93-8c3b-78637ca21055" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="19.67" HigherBound="19.127">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="6f4dd3ee-a280-4e51-9477-3a041d764115" ParentLink="Module_PortType" LowerBound="22.1" HigherBound="29.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Archive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f654ca95-787b-43d9-8d13-555bc8c46767" ParentLink="PortType_OperationDeclaration" LowerBound="24.1" HigherBound="28.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="b5c48551-ed15-4160-9b26-e126fa748f98" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="26.13" HigherBound="26.65">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="77222c98-f214-4d88-954b-6a377c0a8c93" ParentLink="Module_PortType" LowerBound="29.1" HigherBound="36.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveResp" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="1f93bc2c-53ad-42ad-af0c-b684c263aa46" ParentLink="PortType_OperationDeclaration" LowerBound="31.1" HigherBound="35.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="fe2b8f76-a73e-4b62-b252-6e70eeca8e21" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="33.13" HigherBound="33.73">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="e3a236f4-f621-4c1f-98f4-4447b0415323" ParentLink="Module_PortType" LowerBound="36.1" HigherBound="43.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveSingle" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="723e9bf1-8cdc-43e1-89e6-8238c2c49e83" ParentLink="PortType_OperationDeclaration" LowerBound="38.1" HigherBound="42.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="04130d3a-19d0-432d-a986-e4f915f97ace" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="40.13" HigherBound="40.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.ExpiredQuotationsSingle" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="3fec0361-e56c-4547-8c2e-6844f4413eea" ParentLink="Module_PortType" LowerBound="43.1" HigherBound="50.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SMTPQuotations" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4e4e13b3-d2b0-4166-886f-0c621a764bbb" ParentLink="PortType_OperationDeclaration" LowerBound="45.1" HigherBound="49.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0c6a3a6f-729a-4964-bed2-47299f84f89a" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="47.13" HigherBound="47.32">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.MultipartType_Email" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="70e8f434-73ee-4696-98ed-38747543774a" ParentLink="Module_PortType" LowerBound="50.1" HigherBound="57.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_GetAlertTemplateMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="2cf78e4e-79f7-4765-9fb3-99a345b49bf6" ParentLink="PortType_OperationDeclaration" LowerBound="52.1" HigherBound="56.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procGetAlertMessageTemplate" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="317252ec-54e4-4248-8a05-37711efab4d6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="54.13" HigherBound="54.70">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="f96e5135-5206-429b-aae9-2a961bda5d5a" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="54.72" HigherBound="54.137">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="81bde347-db01-448c-aab1-88097eabe0da" ParentLink="Module_PortType" LowerBound="57.1" HigherBound="64.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortTypeSQL_InsertAlertMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="6128e985-34f3-475d-a3d4-c0f27d956f27" ParentLink="PortType_OperationDeclaration" LowerBound="59.1" HigherBound="63.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procInsertAlertUserMessage" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="d3b7c5ad-2c85-4e45-90d8-a7f04e15598b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="61.13" HigherBound="61.72">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="63e93686-c03e-4ece-9c30-b1b67a70fdc2" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="61.74" HigherBound="61.141">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="892869f6-dbdc-4ef9-80f7-0f2b5dbc298e" ParentLink="Module_PortType" LowerBound="64.1" HigherBound="71.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveGetAlert" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="0173b4d4-2801-4065-9ad9-f3ffb0984043" ParentLink="PortType_OperationDeclaration" LowerBound="66.1" HigherBound="70.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="a58f0a60-2727-4ad3-b7aa-b1b49e768df6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="68.13" HigherBound="68.70">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="029dad89-a89c-46c3-a498-f5b4ec2c32dd" ParentLink="Module_PortType" LowerBound="71.1" HigherBound="78.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_GetAlertResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="49f76fd5-5355-4693-a961-81d01feb10e3" ParentLink="PortType_OperationDeclaration" LowerBound="73.1" HigherBound="77.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="15055e12-94d1-40d7-aad6-fd91ced3a0dc" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="75.13" HigherBound="75.78">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="a41709fc-68f1-46f8-beb4-0f8d4e917b63" ParentLink="Module_PortType" LowerBound="78.1" HigherBound="85.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveInsertAlert" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="2c7062e2-fef8-4c9c-8717-08784e4fb43d" ParentLink="PortType_OperationDeclaration" LowerBound="80.1" HigherBound="84.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="90db01bd-075e-4830-ac3a-47d97d7ff14f" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="82.13" HigherBound="82.72">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="8ccd1286-1695-430e-a490-10204a313d48" ParentLink="Module_PortType" LowerBound="85.1" HigherBound="92.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveInsertAlertResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b69ea46c-3315-4ef0-b606-b1387e4bb112" ParentLink="PortType_OperationDeclaration" LowerBound="87.1" HigherBound="91.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="fe126d37-b9b2-4836-8d3d-642fc6ed4f94" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="89.13" HigherBound="89.80">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="947b666e-26cd-45d5-b2ac-78c43daa672c" ParentLink="Module_PortType" LowerBound="92.1" HigherBound="99.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortTypeSQL_UpdateBAsket" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="bf853a6e-fd40-4fb0-88a5-ce85b6fa7761" ParentLink="PortType_OperationDeclaration" LowerBound="94.1" HigherBound="98.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procOrdersSetExpiredQuotations" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="05d7a948-fbc2-4e3f-b59d-f11b4dd9b67f" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="96.13" HigherBound="96.77">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="eff60e59-a0e5-47df-8933-d783e129b0c3" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="96.79" HigherBound="96.151">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="af9a35ff-88a8-4a0f-b4a6-10ebf383608b" ParentLink="Module_PortType" LowerBound="99.1" HigherBound="106.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveUpdateBasket" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="0400eb12-60b1-4373-80b6-208ea0370a42" ParentLink="PortType_OperationDeclaration" LowerBound="101.1" HigherBound="105.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="3fc40b23-880b-4815-881f-ad63036205bf" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="103.13" HigherBound="103.77">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="d8c492a1-99f8-48a2-93bc-b790ac8eaa7d" ParentLink="Module_PortType" LowerBound="106.1" HigherBound="113.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveBasketResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="30a84a43-dbfc-4d34-9148-07045d5cc631" ParentLink="PortType_OperationDeclaration" LowerBound="108.1" HigherBound="112.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="97b930d2-e302-41e7-857c-eff2c4a09bfd" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="110.13" HigherBound="110.85">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="cec870f1-c559-4967-b8c6-5e65077e4f81" ParentLink="Module_PortType" LowerBound="113.1" HigherBound="120.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SMTPSQLErrorAlerts" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="cae2b635-1e49-43b8-a5af-0ea65147ac00" ParentLink="PortType_OperationDeclaration" LowerBound="115.1" HigherBound="119.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="530e7b3f-d77b-427d-b912-777f04091d91" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="117.13" HigherBound="117.78">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="4a4e4fa0-ecc0-4bef-8418-1cd45c602f55" ParentLink="Module_PortType" LowerBound="120.1" HigherBound="127.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SMTP_SQLErrorQuotations" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="1721a731-17c9-45fd-ad95-e5fb123a7673" ParentLink="PortType_OperationDeclaration" LowerBound="122.1" HigherBound="126.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="13cd1452-e267-44ac-ba6e-5a94cdc383fd" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="124.13" HigherBound="124.73">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0a4d1a50-67c5-41ef-8b6f-1b1d2745cd60" ParentLink="Module_PortType" LowerBound="127.1" HigherBound="134.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SMTP_SQLINSERTALERT" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="91ff80ed-7b79-4bb9-933d-459817bf153d" ParentLink="PortType_OperationDeclaration" LowerBound="129.1" HigherBound="133.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="2cd53472-d8ab-4c05-8759-dbd939829379" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="131.13" HigherBound="131.80">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="732dc70e-f5ef-4b7b-ad88-867728fc3a49" ParentLink="Module_PortType" LowerBound="134.1" HigherBound="141.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SQLUPDATEBASKET" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="5efbb5fb-e18e-461f-ab22-801ba1bd2c6b" ParentLink="PortType_OperationDeclaration" LowerBound="136.1" HigherBound="140.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="6cc5f70d-fc63-4cdf-89e3-28cdce9c37ca" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="138.13" HigherBound="138.85">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="e7e8e749-c6b4-4142-86d7-b47f8b9badf5" ParentLink="Module_ServiceDeclaration" LowerBound="141.1" HigherBound="890.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ExpiredQuotationsMain" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="VariableDeclaration" OID="bae1274a-fae7-49d6-b2bf-5a4cdb46bec6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="204.1" HigherBound="205.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="108a2ee7-1554-4d15-beae-666b9159a546" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="205.1" HigherBound="206.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCurrentDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="16dd7566-c763-42d7-b2de-103c920b070b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="206.1" HigherBound="207.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="43ce13ac-f31f-4f81-b005-812e43cb78c9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="207.1" HigherBound="208.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e09cd02d-aef6-4789-9e7a-dfd7ba4883c2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="208.1" HigherBound="209.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intExpirationDay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5cc3966c-2887-448d-b544-a00c98955c5a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="209.1" HigherBound="210.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strExpirationDaysList" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="19576ff6-de35-469e-ade9-d6b142298d15" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="210.1" HigherBound="211.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intExpirationFromDay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c90de963-61e1-4c2f-9327-7aff85e09ef0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="211.1" HigherBound="212.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intExpirationToDay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0a379f79-f4b1-4669-b0c0-ac1a3497e42e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="212.1" HigherBound="213.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveExpiredRequestQuotations" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e9c9fe14-bd04-46ce-b4a5-6eb4f3907145" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="213.1" HigherBound="214.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveExpiredResponseQuotations" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="aa2c07c7-109c-499c-813f-db3dba4f7cd9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="214.1" HigherBound="215.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS360Name" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b7648000-2826-4fa9-97bf-82d24514cc49" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="215.1" HigherBound="216.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPFrom" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="95818a99-b176-4d5f-a1a3-e9eca7ae675f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="216.1" HigherBound="217.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPTo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9e55dc89-f9dd-4d0f-a38e-bd423a19ac51" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="217.1" HigherBound="218.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS360Logo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1dc5de07-30fb-4f05-b9d3-2264f238ec20" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="218.1" HigherBound="219.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveQuotationsSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cf697ff9-61d3-4511-8954-486739372737" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="219.1" HigherBound="220.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPHost" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ce1bd480-a694-41cf-ae79-392ff4734b08" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="220.1" HigherBound="221.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHold" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ad0ba2ab-d6b1-45be-a3bc-af7767eeb750" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="221.1" HigherBound="222.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlExpiredRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="be44c373-956b-4fa0-b287-499e37dca29c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="222.1" HigherBound="223.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intRecordCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="51ff8d0c-543f-4a09-a012-3a01f2e44178" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="223.1" HigherBound="224.1">
                <om:Property Name="InitialValue" Value="1" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intLoopCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3845f107-f383-41be-8c41-3004c0a84fd4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="224.1" HigherBound="225.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sXpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ad28a381-1bd4-4765-bf3f-a0c94c737be5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="225.1" HigherBound="226.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveExpiredSingleQuotations" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a3e1717d-af83-4fcb-a96a-c62db926d065" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="226.1" HigherBound="227.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketSummaryID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f3983653-fe2a-4c5a-a244-78c4af03bf37" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="227.1" HigherBound="228.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varQuoteID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="252c6d9e-34a4-4195-bf4f-17e753502c4a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="228.1" HigherBound="229.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d34d5342-8939-4f72-b483-67194da65608" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="229.1" HigherBound="230.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDuration" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c686a6f1-6a71-40c0-a4c2-a59963d34f8f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="230.1" HigherBound="231.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailAddress" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="99c39900-df8a-4430-bd4f-7a2d8bf8546e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="231.1" HigherBound="232.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFirstName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="af4ab887-9cbe-4f35-9356-1c08ffa91079" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="232.1" HigherBound="233.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLogging" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4b53358c-6225-4790-a691-fd2f3459f61e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="233.1" HigherBound="234.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBiztalkAdmin" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5e317409-83db-4eeb-b940-62c37bfccb1d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="234.1" HigherBound="235.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intAlertTemplateMessageID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="49d8f3f1-bb09-48e3-b319-59da87c5b536" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="235.1" HigherBound="236.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHoldGetAlert" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c4354439-5a77-454c-9493-4b1147eb96a6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="236.1" HigherBound="237.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlGetAlertRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3565d28c-4599-41f2-bbe3-bf738d51c873" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="237.1" HigherBound="238.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAlertTemplateMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b9ffef08-6e9e-46fd-aab7-561dde1da29a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="238.1" HigherBound="239.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAlertMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b152f775-7505-45cd-bff8-534d38eef326" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="239.1" HigherBound="240.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varConfigReference" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7c93009c-cde4-4baf-a192-56f67b38ca16" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="240.1" HigherBound="241.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f8253e06-1a58-4cb1-8888-dd68aa61cad3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="241.1" HigherBound="242.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReturn" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6ff3b4db-905f-4ba7-8fd1-387ad639451f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="242.1" HigherBound="243.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReturnValue" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="66ae6a91-97d9-4e5e-bc3c-2e41fa0f8604" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="243.1" HigherBound="244.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketOwnerID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e949bbc8-7faf-4193-bdcd-f87ff904eacc" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="244.1" HigherBound="245.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHoldInsertAlert" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cbb987f8-0a70-4b1d-91e1-187dc394ec43" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="245.1" HigherBound="246.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlInsertAlertRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2779c0de-ab4b-437a-91d3-d546d902b29a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="246.1" HigherBound="247.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSourceSystem" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b69a8465-b45e-4d6d-b243-2c8355637ed8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="247.1" HigherBound="248.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveGetAlertTemplateResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8da7640d-b798-4015-a777-9a9c990bbcf6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="248.1" HigherBound="249.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveGetAlertTemplate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9f620459-db27-4877-ad3d-43bfd700635c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="249.1" HigherBound="250.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveInsertAlert" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d0cc71e7-be23-4860-8caf-bc19a89bf77a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="250.1" HigherBound="251.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveInsertAlertResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d56cf96d-56bd-4d6f-83aa-764b6da17450" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="251.1" HigherBound="252.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHoldUpdateBasket" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="36d579e6-47f7-4efb-9f8b-6d974c085bfd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="252.1" HigherBound="253.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlUpdateBasketRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="94a61e90-eaad-4f65-b4ba-95c8f1ef234c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="253.1" HigherBound="254.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveUpdateBasket" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d3cbc518-b031-4c4c-ad00-910c4e813820" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="254.1" HigherBound="255.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveUpdateBasketResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="14ba3fb0-65ba-4f8e-9bac-d9d7f90e3f95" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="255.1" HigherBound="256.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intExpirationDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e06047c9-c3c6-4e34-bdaa-4f645dd999a8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="256.1" HigherBound="257.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExpirationDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="34c51990-9f6a-4e52-98d5-d38d8c7baf02" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="257.1" HigherBound="258.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intDuration" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2b3b3167-45a7-4799-9f02-372f71369f23" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="258.1" HigherBound="259.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailMessageTemplate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9e5ab02c-73b2-4950-a376-82c2b9b41804" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="259.1" HigherBound="260.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailTS360Support" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="81144d59-dadd-4944-acb8-8455fa373895" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="260.1" HigherBound="261.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailSubject" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6314f7e0-6cb1-4cf3-ace6-39ed9595f41e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="261.1" HigherBound="262.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailSubjectTemplate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cd19eb1e-42b8-4f7c-a271-f65c8d78878f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="182.1" HigherBound="183.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.ExpiredQuotationsDummy" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Dummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="27f85cdb-1f27-42d3-9d2d-0a3c55f13271" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="183.1" HigherBound="184.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotations" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4a82c6bf-be09-4a76-b341-00ca0432a36d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="184.1" HigherBound="185.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotationsResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="019967fe-c02e-4330-9666-748273312e24" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="185.1" HigherBound="186.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotationsArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="650c6de6-797d-4a3c-a1b2-a4e00d89f1bf" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="186.1" HigherBound="187.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotationsResponseArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4747741d-09ec-4d35-94b2-d88b061149bf" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="187.1" HigherBound="188.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.ExpiredQuotationsX" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotationsX" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4f9a7700-d050-4daa-8d08-34add23bc759" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="188.1" HigherBound="189.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.ExpiredQuotationsSingle" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotationsSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="6c7d55f1-9609-453a-b957-39cc7b4549c0" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="189.1" HigherBound="190.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.ExpiredQuotationsSingle" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ExpiredQuotationsSingleArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e4636ea4-1e7a-4d5b-acfd-73997d42ef60" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="190.1" HigherBound="191.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.MultipartType_Email" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="emailMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e7c77853-77dc-44e6-8ef7-0a3a1f1a8b62" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="191.1" HigherBound="192.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_GetAlertTemplate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="41611cc0-4fa7-4721-a604-cb95e4f31ad8" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="192.1" HigherBound="193.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_GetAlertTemplateResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ce73550e-d327-4cd6-b14a-9ae0de5ccaf4" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="193.1" HigherBound="194.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_InsertAlert" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="42eaaaed-faa3-4101-9276-31a7a8001598" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="194.1" HigherBound="195.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_InsertAlertResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="6d93e2af-893a-43b2-912f-b1434e19aae8" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="195.1" HigherBound="196.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d6bfbece-3ee4-4409-9f4f-c1990b88f681" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="196.1" HigherBound="197.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_GetAlertTemplateArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="73826b83-dcb1-44ac-a3dd-a7f1173a3571" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="197.1" HigherBound="198.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_GetAlertTemplateResponseArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ab0acaf9-f34a-4ec2-a19e-7e6e19f5fdbe" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="198.1" HigherBound="199.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_InsertAlertArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d418fac6-f32f-44df-a810-12b15f77cec2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="199.1" HigherBound="200.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_InsertAlertResponseArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="522170c1-0018-4980-b603-8ed1e184bbe2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="200.1" HigherBound="201.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_UpdateBasket" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="3f1b121c-3262-413e-9970-d680940cc17e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="201.1" HigherBound="202.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_UpdateBasketResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="25783fa2-f2aa-45cf-94fa-c4aea54b26c1" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="202.1" HigherBound="203.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_UpdateBasketArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="abf94433-cf47-47da-a83d-64bb0af6e12c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="203.1" HigherBound="204.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_UpdateBasketResponseArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="ad2a2e33-6c3e-432e-9bb5-28b286b4e5da" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="e4f2a597-c2d0-4c7d-97a3-0a577c2bd3b9" ParentLink="ServiceBody_Statement" LowerBound="264.1" HigherBound="314.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_Dummy" />
                    <om:Property Name="MessageName" Value="Message_Dummy" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_Dummy" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="5eeb241c-3072-443e-b43c-f745f1911e39" ParentLink="ServiceBody_Statement" LowerBound="314.1" HigherBound="888.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main" />
                    <om:Property Name="Signal" Value="False" />
                    <om:Element Type="VariableAssignment" OID="5eb3f72d-fbbd-43d5-9a68-3754ed046851" ParentLink="ComplexStatement_Statement" LowerBound="319.1" HigherBound="368.1">
                        <om:Property Name="Expression" Value="varArchiveExpiredRequestQuotations=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveExpiredRequestQuotations&quot;));&#xD;&#xA;varArchiveExpiredResponseQuotations=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveExpiredResponseQuotations&quot;)); &#xD;&#xA;varArchiveExpiredSingleQuotations=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveExpiredSingleQuotations&quot;)); &#xD;&#xA;varArchiveGetAlertTemplate=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveGetAlertTemplate&quot;)); &#xD;&#xA;varArchiveGetAlertTemplateResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveGetAlertTemplateResponse&quot;)); &#xD;&#xA;varArchiveInsertAlert=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveInsertAlert&quot;)); &#xD;&#xA;varArchiveInsertAlertResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveInsertAlertResponse&quot;));&#xD;&#xA;varArchiveUpdateBasket=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveUpdateBasket&quot;)); &#xD;&#xA;varArchiveUpdateBasketResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ArchiveUpdateBasketResponse&quot;));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varLogging=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;Logging&quot;)); &#xD;&#xA;varEmailTS360Support=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;EmailTS360Support&quot;); &#xD;&#xA;varEmailMessageTemplate=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;EmailMessageTemplate&quot;); &#xD;&#xA;varEmailSubjectTemplate=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;EmailSubjectTemplate&quot;); &#xD;&#xA;&#xD;&#xA;varTS360Logo=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;TS360Logo&quot;); &#xD;&#xA;varSMTPFrom=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;SMTPFrom&quot;);                                                                                                                                                                                                                              &#xD;&#xA;varSMTPHost=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;SMTPHost&quot;);                                                                                                               &#xD;&#xA;varSourceSystem=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;SourceSystem&quot;);&#xD;&#xA;varTS360Name=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;TS360Name&quot;);   &#xD;&#xA;varBiztalkAdmin=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;BiztalkAdmin&quot;);                                                                                                                &#xD;&#xA;strExpirationDaysList=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ExpirationDaysList&quot;);&#xD;&#xA;intExpirationFromDay=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ExpirationFromDay&quot;));&#xD;&#xA;intExpirationDay=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ExpirationDay&quot;));&#xD;&#xA;intExpirationToDay=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;ExpirationToDay&quot;));&#xD;&#xA;intAlertTemplateMessageID=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;,&quot;AlertTemplateMessageID&quot;));&#xD;&#xA;&#xD;&#xA;if (varLogging == true) &#xD;&#xA;{&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, strExpirationDaysList);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, intExpirationFromDay.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, intExpirationDay.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, intExpirationToDay.ToString());&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;---Application Variables 1---&quot; +  System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;ExpirationDaysList: &quot; + strExpirationDaysList + System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;ExpirationFromDay: &quot;        + intExpirationFromDay.ToString()    + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;ExpirationToDay: &quot;          + intExpirationToDay.ToString()    + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;ExpirationDay: &quot;          + intExpirationDay.ToString()    + System.Environment.NewLine  ); &#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;---Application Variables 1.1---&quot; +  System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;EmailMessageTemplate: &quot; + varEmailMessageTemplate + System.Environment.NewLine ); &#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getSSO and Dates" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Task" OID="d2826289-f99c-4955-af52-adc22bc8d889" ParentLink="ComplexStatement_Statement" LowerBound="368.1" HigherBound="426.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Group_GetAlertMessage" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="dccd46c7-7e64-4e1e-8cc3-232813dd8f6d" ParentLink="ComplexStatement_Statement" LowerBound="368.1" HigherBound="379.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_GetAlertTemplate" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="84add3d5-92c0-4ddb-a87f-46d5716dd3d7" ParentLink="Construct_MessageRef" LowerBound="369.31" HigherBound="369.55">
                                <om:Property Name="Ref" Value="Message_GetAlertTemplate" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="17158578-caa0-4343-a35e-a4aa429f6695" ParentLink="ComplexStatement_Statement" LowerBound="371.1" HigherBound="378.1">
                                <om:Property Name="Expression" Value="&#xD;&#xA;sHoldGetAlert = &quot;&lt;ns0:procGetAlertMessageTemplate xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:AlertMessageTemplateID&gt;&lt;/ns0:AlertMessageTemplateID&gt;&lt;ns0:AlertMessageTemplate&gt;&lt;/ns0:AlertMessageTemplate&gt;&lt;ns0:ConfigReferenceValue&gt;&lt;/ns0:ConfigReferenceValue&gt;&lt;ns0:Return&gt;&lt;/ns0:Return&gt;&lt;ns0:Message&gt;&lt;/ns0:Message&gt;&lt;/ns0:procGetAlertMessageTemplate&gt;&quot;;&#xD;&#xA;xmlGetAlertRequest.LoadXml(@sHoldGetAlert); &#xD;&#xA;Message_GetAlertTemplate = xmlGetAlertRequest;&#xD;&#xA;&#xD;&#xA;Message_GetAlertTemplate.AlertMessageTemplateID = intAlertTemplateMessageID; &#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_1" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="ac201122-f58d-41bb-8f95-72495113b8cf" ParentLink="ComplexStatement_Statement" LowerBound="379.1" HigherBound="392.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ArchiveGetAlertTemplate" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="8db80584-7192-4257-8cbe-bd3e70c4091c" ParentLink="ReallyComplexStatement_Branch" LowerBound="380.21" HigherBound="392.1">
                                <om:Property Name="Expression" Value="varArchiveGetAlertTemplate == true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ArchiveGetAlertTemplate" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="2174da52-833f-45f9-8b93-e0e63fae6d74" ParentLink="ComplexStatement_Statement" LowerBound="382.1" HigherBound="389.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="3bb8fd6d-0784-4ccb-b7e6-d44284ca2569" ParentLink="ComplexStatement_Statement" LowerBound="385.1" HigherBound="388.1">
                                        <om:Property Name="Expression" Value="Message_GetAlertTemplateArchive = Message_GetAlertTemplate; &#xD;&#xA;Message_GetAlertTemplateArchive(FILE.ReceivedFileName)=&quot;Archive1GetAlertTemplate&quot;; " />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="c79021d7-0dc2-4671-a057-87f3c21754a8" ParentLink="Construct_MessageRef" LowerBound="383.35" HigherBound="383.66">
                                        <om:Property Name="Ref" Value="Message_GetAlertTemplateArchive" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="9be2d436-a72e-43a0-bee9-46e534c80657" ParentLink="ComplexStatement_Statement" LowerBound="389.1" HigherBound="391.1">
                                    <om:Property Name="PortName" Value="Port_ArchiveGetAlert" />
                                    <om:Property Name="MessageName" Value="Message_GetAlertTemplateArchive" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="d2df442f-9155-4bd2-a4be-e81b84e40ecd" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="f5f87b29-a6d3-4a3a-b8e2-77da5554684d" ParentLink="ComplexStatement_Statement" LowerBound="392.1" HigherBound="394.1">
                            <om:Property Name="PortName" Value="PortSQL_GetAlertMessage" />
                            <om:Property Name="MessageName" Value="Message_GetAlertTemplate" />
                            <om:Property Name="OperationName" Value="procGetAlertMessageTemplate" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_GetAlertTemplate" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="5ad9921e-e0f6-4bc2-acbd-50f52a5336fa" ParentLink="ComplexStatement_Statement" LowerBound="394.1" HigherBound="396.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="PortSQL_GetAlertMessage" />
                            <om:Property Name="MessageName" Value="Message_GetAlertTemplateResponse" />
                            <om:Property Name="OperationName" Value="procGetAlertMessageTemplate" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_GetAlertTemplateResponse" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="92d6aa75-2218-42eb-a187-d2f2544d1994" ParentLink="ComplexStatement_Statement" LowerBound="396.1" HigherBound="409.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ArchiveGetAlertTemplateResponse" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="ea459216-8cbf-4644-8e50-f83970778849" ParentLink="ReallyComplexStatement_Branch" LowerBound="397.21" HigherBound="409.1">
                                <om:Property Name="Expression" Value="varArchiveGetAlertTemplateResponse == true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ArchiveGetAlertTemplate" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="8079cc72-6472-4af1-bc41-87547881515a" ParentLink="ComplexStatement_Statement" LowerBound="399.1" HigherBound="406.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="b4d2271b-3d38-4884-a675-2d6129c513f6" ParentLink="ComplexStatement_Statement" LowerBound="402.1" HigherBound="405.1">
                                        <om:Property Name="Expression" Value="Message_GetAlertTemplateResponseArchive = Message_GetAlertTemplateResponse; &#xD;&#xA;Message_GetAlertTemplateResponseArchive(FILE.ReceivedFileName)=&quot;Archive2GetAlertTemplateResponse&quot;; " />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="a43741ef-f962-4966-bf6b-67d549958e4c" ParentLink="Construct_MessageRef" LowerBound="400.35" HigherBound="400.74">
                                        <om:Property Name="Ref" Value="Message_GetAlertTemplateResponseArchive" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="09182d1a-989c-407a-93e2-f80d17d48ad3" ParentLink="ComplexStatement_Statement" LowerBound="406.1" HigherBound="408.1">
                                    <om:Property Name="PortName" Value="Port_ArchiveGetAlertResponse" />
                                    <om:Property Name="MessageName" Value="Message_GetAlertTemplateResponseArchive" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="dddd7d6d-99bb-42f7-b9c4-ecea0273ec38" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="a0ffadb3-59fe-42b5-9cbe-6101ce8db801" ParentLink="ComplexStatement_Statement" LowerBound="409.1" HigherBound="426.1">
                            <om:Property Name="Expression" Value="varAlertTemplateMessage = Message_GetAlertTemplateResponse.AlertMessageTemplate; &#xD;&#xA;varConfigReference = Message_GetAlertTemplateResponse.ConfigReferenceValue; &#xD;&#xA;varReturnValue = Message_GetAlertTemplateResponse.ReturnValue; &#xD;&#xA;varReturn = Message_GetAlertTemplateResponse.Return; &#xD;&#xA;varMessage = Message_GetAlertTemplateResponse.Message; &#xD;&#xA;&#xD;&#xA;if (varLogging == true)&#xD;&#xA;{&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;---Application Variables 2---&quot; +  System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;AlertTemplateMessage: &quot; + varAlertTemplateMessage + System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;Return: &quot;               + varReturn.ToString()    + System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;Message: &quot;             + varMessage              + System.Environment.NewLine);         &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="AssignTemplateMessage" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="5759ee90-12a4-4540-becc-76cb8cedd75f" ParentLink="ComplexStatement_Statement" LowerBound="426.1" HigherBound="439.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_SQLError" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="9186813a-991d-48ca-8ade-9af67b1f4651" ParentLink="ReallyComplexStatement_Branch" LowerBound="427.21" HigherBound="439.1">
                            <om:Property Name="Expression" Value="varReturn != 0 || varReturnValue != 0 || varAlertTemplateMessage.Length == 0 || varConfigReference.Length == 0 " />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_SQLError" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="VariableAssignment" OID="0ea633aa-dd92-4930-b33d-ce97bfa2314c" ParentLink="ComplexStatement_Statement" LowerBound="429.1" HigherBound="434.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;Invalid SQL Response: &quot; + System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;Return: &quot; + varReturn.ToString() + &#xD;&#xA;                                                                               &quot;ReturnValue: &quot; + varReturnValue.ToString() +&#xD;&#xA;                                                                               &quot;Message: &quot; + varMessage + varMessage);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="WriteToEventLog" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Send" OID="c7a93642-19f0-4f05-9822-36a53ee46373" ParentLink="ComplexStatement_Statement" LowerBound="434.1" HigherBound="436.1">
                                <om:Property Name="PortName" Value="Port_SMTP_SQLErrorAlerts" />
                                <om:Property Name="MessageName" Value="Message_GetAlertTemplateResponse" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_SQLError" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="4f348c42-b296-4cd2-9479-84d6331e575a" ParentLink="ComplexStatement_Statement" LowerBound="436.1" HigherBound="438.1">
                                <om:Property Name="ErrorMessage" Value="&quot;BTNextGen.Biztalk.ExpiredQuotations - Invalid SQL Response&quot;;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_Process" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="ed276f96-476f-4e83-9861-a59bc4698c3a" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="bc8fd90c-330d-45fd-b649-a9ea659cd042" ParentLink="ComplexStatement_Statement" LowerBound="439.1" HigherBound="463.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_ExpiredQuotations" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="d96531cf-5473-4ba4-81b6-1d277f9e0372" ParentLink="Construct_MessageRef" LowerBound="440.31" HigherBound="440.56">
                            <om:Property Name="Ref" Value="Message_ExpiredQuotations" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="1308b9c2-1472-4240-ae27-1a179d860c3b" ParentLink="ComplexStatement_Statement" LowerBound="442.1" HigherBound="462.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;//- &lt;ns0:procOrdersGetExpiredQuotations xmlns:ns0=&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo&quot;&gt;&#xD;&#xA;//  &lt;ns0:strExpirationFromDay&gt;10&lt;/ns0:strExpirationFromDay&gt; &#xD;&#xA;//  &lt;ns0:strExpirationToDay&gt;10&lt;/ns0:strExpirationToDay&gt; &#xD;&#xA;//  &lt;ns0:strExpirationDaysList&gt;strExpirationDaysListstrExpira&lt;/ns0:strExpirationDaysList&gt; &#xD;&#xA;//  &lt;ns0:strExpirationDay&gt;10&lt;/ns0:strExpirationDay&gt; &#xD;&#xA;//  &lt;/ns0:procOrdersGetExpiredQuotations&gt;&#xD;&#xA;&#xD;&#xA;//sHold = &quot;&lt;GetExpiredCards xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;&#xD;&#xA;sHold = &quot;&lt;ns0:procOrdersGetExpiredQuotations xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:strExpirationFromDay&gt;&lt;/ns0:strExpirationFromDay&gt;&lt;ns0:strExpirationToDay&gt;&lt;/ns0:strExpirationToDay&gt;&lt;ns0:strExpirationDaysList&gt;&lt;/ns0:strExpirationDaysList&gt;&lt;ns0:strExpirationDay&gt;&lt;/ns0:strExpirationDay&gt;&lt;/ns0:procOrdersGetExpiredQuotations&gt;&quot;; &#xD;&#xA;xmlExpiredRequest.LoadXml(@sHold); &#xD;&#xA;Message_ExpiredQuotations = xmlExpiredRequest;&#xD;&#xA;&#xD;&#xA;Message_ExpiredQuotations.strExpirationDay = intExpirationDay; &#xD;&#xA;Message_ExpiredQuotations.strExpirationDaysList = strExpirationDaysList; &#xD;&#xA;Message_ExpiredQuotations.strExpirationFromDay = intExpirationFromDay; &#xD;&#xA;Message_ExpiredQuotations.strExpirationToDay = intExpirationToDay; &#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_1" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="69748ad5-ef70-4c75-9623-248cc19ebf27" ParentLink="ComplexStatement_Statement" LowerBound="463.1" HigherBound="476.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveExpiredQuery" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="c0e29492-6ac0-4458-8986-78d330b98c24" ParentLink="ReallyComplexStatement_Branch" LowerBound="464.21" HigherBound="476.1">
                            <om:Property Name="Expression" Value="varArchiveExpiredRequestQuotations == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveExpiredQuery" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="7907d622-c28c-4a12-a9da-bb5444d624ec" ParentLink="ComplexStatement_Statement" LowerBound="466.1" HigherBound="473.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="76b5f91f-f5a9-415c-a28b-a3a3ae4c58e3" ParentLink="Construct_MessageRef" LowerBound="467.35" HigherBound="467.67">
                                    <om:Property Name="Ref" Value="Message_ExpiredQuotationsArchive" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="223ea81d-567e-4abc-8927-ea83a9178863" ParentLink="ComplexStatement_Statement" LowerBound="469.1" HigherBound="472.1">
                                    <om:Property Name="Expression" Value="Message_ExpiredQuotationsArchive = Message_ExpiredQuotations; &#xD;&#xA;Message_ExpiredQuotationsArchive(FILE.ReceivedFileName)=&quot;Archive3ExpiredRequestQuotations&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="484d2272-30f5-40ec-ade3-deb8f9a8cb9c" ParentLink="ComplexStatement_Statement" LowerBound="473.1" HigherBound="475.1">
                                <om:Property Name="PortName" Value="Port_ArchiveReq" />
                                <om:Property Name="MessageName" Value="Message_ExpiredQuotationsArchive" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Archive" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="4b1b446f-acd4-4743-a7c7-595983a5f470" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Send" OID="8fda8868-f0f8-423e-a57a-3ec171a06569" ParentLink="ComplexStatement_Statement" LowerBound="476.1" HigherBound="478.1">
                        <om:Property Name="PortName" Value="PortSQL_GetExpiredQuotations" />
                        <om:Property Name="MessageName" Value="Message_ExpiredQuotations" />
                        <om:Property Name="OperationName" Value="procOrdersGetExpiredQuotations" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_Request" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Receive" OID="9c2405a1-c255-450e-b655-c5ce376e3a42" ParentLink="ComplexStatement_Statement" LowerBound="478.1" HigherBound="480.1">
                        <om:Property Name="Activate" Value="False" />
                        <om:Property Name="PortName" Value="PortSQL_GetExpiredQuotations" />
                        <om:Property Name="MessageName" Value="Message_ExpiredQuotationsResponse" />
                        <om:Property Name="OperationName" Value="procOrdersGetExpiredQuotations" />
                        <om:Property Name="OperationMessageName" Value="Response" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Receive_Response" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Decision" OID="d1c01843-00a6-482a-938e-6dbfa9e432ed" ParentLink="ComplexStatement_Statement" LowerBound="480.1" HigherBound="493.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveExpiredResponse" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="032c2359-d36c-47cf-8963-834c843698e8" ParentLink="ReallyComplexStatement_Branch" LowerBound="481.21" HigherBound="493.1">
                            <om:Property Name="Expression" Value="varArchiveExpiredResponseQuotations == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveExpiredQuery" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="bd64ca44-eda4-462e-af00-1e38f7de61b1" ParentLink="ComplexStatement_Statement" LowerBound="483.1" HigherBound="490.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="202b4d38-b52d-426c-ae0e-5cc6174b08a8" ParentLink="Construct_MessageRef" LowerBound="484.35" HigherBound="484.75">
                                    <om:Property Name="Ref" Value="Message_ExpiredQuotationsResponseArchive" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="65fdbe69-fac9-45a7-855d-3af315829e5e" ParentLink="ComplexStatement_Statement" LowerBound="486.1" HigherBound="489.1">
                                    <om:Property Name="Expression" Value="Message_ExpiredQuotationsResponseArchive = Message_ExpiredQuotationsResponse; &#xD;&#xA;Message_ExpiredQuotationsResponseArchive(FILE.ReceivedFileName)=&quot;Archive4ExpiredResponseQuotations&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="1236f4b1-47d4-41a8-90d9-0b9a73890b94" ParentLink="ComplexStatement_Statement" LowerBound="490.1" HigherBound="492.1">
                                <om:Property Name="PortName" Value="Port_ArchiveResp" />
                                <om:Property Name="MessageName" Value="Message_ExpiredQuotationsResponseArchive" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Archive" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="03cdbf70-488d-4ecd-b4e5-ed4a662d59ad" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="1dd383c5-33e7-4dae-b455-e8e8eeedd57b" ParentLink="ComplexStatement_Statement" LowerBound="493.1" HigherBound="505.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_SQLError" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="bda46b52-e50a-4c4a-8026-80d9184ca822" ParentLink="ReallyComplexStatement_Branch" LowerBound="494.21" HigherBound="505.1">
                            <om:Property Name="Expression" Value="varReturn != 0 || varReturnValue != 0 || varAlertTemplateMessage.Length == 0 || varConfigReference.Length == 0 " />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_SQLError" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="VariableAssignment" OID="b25426ab-b892-4525-b0bb-cefd1686378b" ParentLink="ComplexStatement_Statement" LowerBound="496.1" HigherBound="500.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;Invalid SQL Response: &quot; + System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;ReturnValue: &quot; + varReturnValue.ToString()); &#xD;&#xA;                                                                               " />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="WriteToEventLog" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Send" OID="68f34a0f-c983-4b1f-93f5-fc8a671f77a1" ParentLink="ComplexStatement_Statement" LowerBound="500.1" HigherBound="502.1">
                                <om:Property Name="PortName" Value="Port_SMTP_SQLErrorQuotations" />
                                <om:Property Name="MessageName" Value="Message_ExpiredQuotationsResponse" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_SQLError" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="951f3f67-900e-4581-ac08-3c772a5b6781" ParentLink="ComplexStatement_Statement" LowerBound="502.1" HigherBound="504.1">
                                <om:Property Name="ErrorMessage" Value="&quot;BTNextGen.Biztalk.ExpiredQuotations - Invalid SQL Response&quot;;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_Process" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="c8419fb4-0eb9-41c6-9e1f-52f4ad77405e" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="8cd47088-b16d-4b5e-89c9-0bf682c01bd3" ParentLink="ComplexStatement_Statement" LowerBound="505.1" HigherBound="511.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_QuotationsX" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Transform" OID="6d87e3b7-ff4c-43a3-9622-a615ad066a15" ParentLink="ComplexStatement_Statement" LowerBound="508.1" HigherBound="510.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ExpiredQuotations.Transform_Messagex" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_MessageX" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="5b875189-a5b4-4aaa-bb58-c46abe594bd3" ParentLink="Transform_InputMessagePartRef" LowerBound="509.122" HigherBound="509.155">
                                <om:Property Name="MessageRef" Value="Message_ExpiredQuotationsResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="38c26c84-726e-43b5-b852-6a31a3210c07" ParentLink="Transform_OutputMessagePartRef" LowerBound="509.36" HigherBound="509.62">
                                <om:Property Name="MessageRef" Value="Message_ExpiredQuotationsX" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageRef" OID="8db28b24-73b5-4811-ada2-357d7d04ab9a" ParentLink="Construct_MessageRef" LowerBound="506.31" HigherBound="506.57">
                            <om:Property Name="Ref" Value="Message_ExpiredQuotationsX" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="5d4e6a94-3bc8-4b7b-9c3f-65fda0fdc167" ParentLink="ComplexStatement_Statement" LowerBound="511.1" HigherBound="520.1">
                        <om:Property Name="Expression" Value="intRecordCount = System.Convert.ToInt32(xpath(Message_ExpiredQuotationsX, &quot;count(//QuotationsData)&quot;));&#xD;&#xA;          &#xD;&#xA;if (varLogging == true)                                                                              &#xD;&#xA;{&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, intRecordCount.ToString());&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;---Application Variables 3---&quot; +  System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;Record Count: &quot; + intRecordCount.ToString()+ System.Environment.NewLine); &#xD;&#xA;}" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getRecordCount" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="While" OID="ab52e39b-3ff0-4682-832e-500afa9f7481" ParentLink="ComplexStatement_Statement" LowerBound="520.1" HigherBound="866.1">
                        <om:Property Name="Expression" Value="intLoopCount &lt;= intRecordCount" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Loop_1" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="2d5934ca-8da2-4bc0-b170-125c3b075502" ParentLink="ComplexStatement_Statement" LowerBound="523.1" HigherBound="535.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructSingleMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="e0daacfc-3fd4-4789-8a3c-4b8365582122" ParentLink="Construct_MessageRef" LowerBound="524.35" HigherBound="524.66">
                                <om:Property Name="Ref" Value="Message_ExpiredQuotationsSingle" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="8023a7d0-ea8b-4ef8-90e1-9bb109db5709" ParentLink="ComplexStatement_Statement" LowerBound="526.1" HigherBound="534.1">
                                <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;sXpath = System.String.Format(&quot;//QuotationsData[{0}]&quot;,intLoopCount);&#xD;&#xA;Message_ExpiredQuotationsSingle = xpath(Message_ExpiredQuotationsX,sXpath); &#xD;&#xA;                          &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="136e3240-d40e-4af7-b7b6-3c75de27bc84" ParentLink="ComplexStatement_Statement" LowerBound="535.1" HigherBound="548.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ArchiveExpiredSingle" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="f354ebef-a7bc-4fa4-a9c4-0b211275c114" ParentLink="ReallyComplexStatement_Branch" LowerBound="536.25" HigherBound="548.1">
                                <om:Property Name="Expression" Value="varArchiveExpiredRequestQuotations == true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ArchiveExpiredSingle" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="e901fab2-73ef-4f5a-a8a5-3c45e9743716" ParentLink="ComplexStatement_Statement" LowerBound="538.1" HigherBound="545.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="2fa8e7a1-8665-4575-84d4-cb4a69368ee9" ParentLink="Construct_MessageRef" LowerBound="539.39" HigherBound="539.77">
                                        <om:Property Name="Ref" Value="Message_ExpiredQuotationsSingleArchive" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="024d4323-170c-4413-9968-1157c20822a5" ParentLink="ComplexStatement_Statement" LowerBound="541.1" HigherBound="544.1">
                                        <om:Property Name="Expression" Value="Message_ExpiredQuotationsSingleArchive = Message_ExpiredQuotationsSingle; &#xD;&#xA;Message_ExpiredQuotationsSingleArchive(FILE.ReceivedFileName)=&quot;Archive5ExpiredSingleQuotations&quot;; " />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="f9c95c5f-dcd5-4909-9439-fd8f7c701149" ParentLink="ComplexStatement_Statement" LowerBound="545.1" HigherBound="547.1">
                                    <om:Property Name="PortName" Value="Port_ArchiveSingle" />
                                    <om:Property Name="MessageName" Value="Message_ExpiredQuotationsSingleArchive" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="f3490c64-aa97-4065-94a2-cce8e247fde9" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="501316e7-622c-4728-a103-fdd3703a6bdf" ParentLink="ComplexStatement_Statement" LowerBound="548.1" HigherBound="620.1">
                            <om:Property Name="Expression" Value="&#xD;&#xA;//Create Email and Alert Variables... &#xD;&#xA;varFirstName = xpath(Message_ExpiredQuotationsSingle,&quot;string(//firstname)&quot;);&#xD;&#xA;varBasketName = xpath(Message_ExpiredQuotationsSingle,&quot;string(//basketname)&quot;);&#xD;&#xA;varQuoteID = xpath(Message_ExpiredQuotationsSingle,&quot;string(//quoteid)&quot;);&#xD;&#xA;varEmailAddress = xpath(Message_ExpiredQuotationsSingle,&quot;string(//EmailAddress)&quot;);&#xD;&#xA;varBasketSummaryID = xpath(Message_ExpiredQuotationsSingle,&quot;string(//basketsummaryid)&quot;);&#xD;&#xA;varDuration = xpath(Message_ExpiredQuotationsSingle,&quot;string(//duration)&quot;);&#xD;&#xA;intDuration = System.Convert.ToInt32(varDuration); &#xD;&#xA;intExpirationDateTime  = System.DateTime.Now.AddDays(intDuration);&#xD;&#xA;varExpirationDateTime = intExpirationDateTime.ToString(&quot;yyyy-MM-dd&quot;); &#xD;&#xA;varBasketOwnerID = xpath(Message_ExpiredQuotationsSingle,&quot;string(//basketownerid)&quot;);&#xD;&#xA;&#xD;&#xA;//Complete Alert Message&#xD;&#xA;varAlertMessage=varAlertTemplateMessage; &#xD;&#xA;varAlertMessage=varAlertMessage.Replace(&quot;@cart&quot;,varBasketName); &#xD;&#xA;varAlertMessage=varAlertMessage.Replace(&quot;@quotation&quot;,varQuoteID); &#xD;&#xA;varAlertMessage=varAlertMessage.Replace(&quot;@days&quot;,varDuration);&#xD;&#xA;varAlertMessage=varAlertMessage.Replace(&quot;@expirationdate&quot;, varExpirationDateTime); &#xD;&#xA;varAlertMessage=varAlertMessage.Replace(&quot;@URL&quot;,varConfigReference + varBasketSummaryID); &#xD;&#xA;&#xD;&#xA;//Complete Email Message&#xD;&#xA;varEmailMessage=varEmailMessageTemplate; &#xD;&#xA;varEmailMessage=varEmailMessage.Replace(&quot;@varFirstName&quot;, varFirstName);&#xD;&#xA;varEmailMessage=varEmailMessage.Replace(&quot;@varQuoteID&quot;, varQuoteID);&#xD;&#xA;varEmailMessage=varEmailMessage.Replace(&quot;@varBasketName&quot;, varBasketName);&#xD;&#xA;varEmailMessage=varEmailMessage.Replace(&quot;@varDuration&quot;, varDuration);&#xD;&#xA;varEmailMessage=varEmailMessage.Replace(&quot;@varExpirationDateTime&quot;, varExpirationDateTime);&#xD;&#xA;varEmailMessage=varEmailMessage.Replace(&quot;@varEmailTS360Support&quot;, varEmailTS360Support);&#xD;&#xA;&#xD;&#xA;//Complete Email Subject  &#xD;&#xA;varEmailSubject=varEmailSubjectTemplate; &#xD;&#xA;varEmailSubject=varEmailSubject.Replace(&quot;@varQuoteID&quot;, varQuoteID); &#xD;&#xA;varEmailSubject=varEmailSubject.Replace(&quot;@varTS360Name&quot;, varTS360Name); &#xD;&#xA;&#xD;&#xA; &#xD;&#xA;&#xD;&#xA;//Assign Email address to dynamic port&#xD;&#xA;Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;&#xD;&#xA;//Send out an email with logging values&#xD;&#xA;if (varLogging == true)&#xD;&#xA;{&#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varFirstName);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varBasketName);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varQuoteID);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varEmailAddress);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varBasketSummaryID);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varDuration);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varCurrentDateTime);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varAlertMessage);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, varBasketOwnerID);&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;---Application Variables 4---&quot; +  System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;FirstName: &quot; + varFirstName + System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;BasketName: &quot;               + varBasketName    + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;QuoteID: &quot;             + varQuoteID              + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;EmailAddress: &quot; + varEmailAddress + System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;BasketSummaryID: &quot;               + varBasketSummaryID    + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;Duration: &quot;             + varDuration              + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;ExpirationDate: &quot; + varCurrentDateTime + System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;AlertMessage: &quot;               + varAlertMessage    + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;BasketOwnerID: &quot;             + varBasketOwnerID              + System.Environment.NewLine &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;);        &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;}" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="AssignVariables" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Decision" OID="ca3f28af-d345-4a7a-ab9b-44b629c32c73" ParentLink="ComplexStatement_Statement" LowerBound="620.1" HigherBound="719.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ValidEmail" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="06054fc3-77b4-4184-9ea6-a3a27a612012" ParentLink="ReallyComplexStatement_Branch" LowerBound="621.25" HigherBound="660.1">
                                <om:Property Name="Expression" Value="varEmailAddress.Length &gt; 0" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Rule_ValidaEmail" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="88e0ef0e-d58f-4826-a0bd-f63cafbc061d" ParentLink="ComplexStatement_Statement" LowerBound="623.1" HigherBound="659.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructMessageEmailCust" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="f1906121-8bc6-4251-861c-5c47e5e874ac" ParentLink="Construct_MessageRef" LowerBound="624.39" HigherBound="624.47">
                                        <om:Property Name="Ref" Value="emailMsg" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="cb9b5ab8-c24d-4bba-9981-395db3453f7f" ParentLink="ComplexStatement_Statement" LowerBound="626.1" HigherBound="658.1">
                                        <om:Property Name="Expression" Value="//Assign values to Message body&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;img src=&quot; +  varTS360Logo +   &quot;&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(varEmailMessage); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varEmailSubject; &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="de86ee3e-70cd-491c-9b2a-65af9106cdd3" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="ac743f59-6031-4067-8061-322ccdddf6ba" ParentLink="ComplexStatement_Statement" LowerBound="662.1" HigherBound="718.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructMessageEmailInvalid" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="6a626fa1-d223-4f32-8086-614cbe1b5c60" ParentLink="Construct_MessageRef" LowerBound="663.39" HigherBound="663.47">
                                        <om:Property Name="Ref" Value="emailMsg" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="9262048b-72c5-4a85-a471-f94faed8dca6" ParentLink="ComplexStatement_Statement" LowerBound="665.1" HigherBound="717.1">
                                        <om:Property Name="Expression" Value="varEmailAddress = varBiztalkAdmin; &#xD;&#xA;Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;img src=&quot; +  varTS360Logo +   &quot;&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Dear &quot; + &quot;TS360 Quote Support&quot; + &quot;,&quot; +   &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Please be advised, the Quote:  &quot; + varQuoteID + &quot; for cart:  &quot; + varBasketName  + &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;is about to expire in &quot; + varDuration + &quot; day(s) on &quot; + varExpirationDateTime + &quot;.  At such time, the quotation will no longer be available.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;If we intend on giving the customer the chance to order this quotation, logon to TS360, search for Quote ID &quot; + varQuoteID + &quot; and determine a valid contact for.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Thanks&lt;br /&gt;TS360 Biztalk SUPPORT&lt;br /&gt;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//Please be advised, your Quote: @quotation for cart XYZ123 will expire in 7 days on 2013-11-27.  At such time, the quotation will no longer be available.  //&#xD;&#xA;//If you intend on ordering this cart/quotation, logon to TS 360, search for Quote ID @quotation and submit as an order.  &#xD;&#xA;//You may also forward this email to B&amp;T Tech Support and ask that B&amp;T place the order on your behalf.&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//xmlDoc=TmpMsg;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;//emailMsg.attachment=xmlDoc;&#xD;&#xA;//emailMsg.attachment(MIME.FileName)= faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.Application)+&quot;_&quot; +faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.FaultCode)+&quot;.xml&quot;; &#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varTS360Name + &quot; Quote ID &quot; + varQuoteID + &quot; expiring soon - Preemptive Notification INVALID EMAIL&quot;; &#xD;&#xA;&#xD;&#xA;//Quote ID @quotation expiring soon - Preemptive Notification&#xD;&#xA;&#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="b31e2744-7205-49ce-ab73-010ffa4c0514" ParentLink="ComplexStatement_Statement" LowerBound="719.1" HigherBound="721.1">
                            <om:Property Name="PortName" Value="Port_SMTPQuotations" />
                            <om:Property Name="MessageName" Value="emailMsg" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Email" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Task" OID="43890558-0f77-466c-ac7b-5ba6e8448d85" ParentLink="ComplexStatement_Statement" LowerBound="721.1" HigherBound="805.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Group_InsertAlertMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="4f365497-c298-49b5-9e0a-08c47cdd2053" ParentLink="ComplexStatement_Statement" LowerBound="721.1" HigherBound="739.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_InsertAlert" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="e7c890cb-4e38-4ef0-9003-8c4db734e998" ParentLink="Construct_MessageRef" LowerBound="722.35" HigherBound="722.54">
                                    <om:Property Name="Ref" Value="Message_InsertAlert" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="30822271-d22a-4302-a2b9-2ba2c4971685" ParentLink="ComplexStatement_Statement" LowerBound="724.1" HigherBound="738.1">
                                    <om:Property Name="Expression" Value="//Create message&#xD;&#xA;sHoldInsertAlert = &quot;&lt;ns0:procInsertAlertUserMessage xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:AlertMessage&gt;&lt;/ns0:AlertMessage&gt;&lt;ns0:UserID&gt;&lt;/ns0:UserID&gt;&lt;ns0:MessageTemplateID&gt;&lt;/ns0:MessageTemplateID&gt;&lt;ns0:SourceSystem&gt;&lt;/ns0:SourceSystem&gt;&lt;ns0:Return&gt;&lt;/ns0:Return&gt;&lt;ns0:Message&gt;&lt;/ns0:Message&gt;&lt;/ns0:procInsertAlertUserMessage&gt;&quot;; xmlInsertAlertRequest.LoadXml(@sHoldGetAlert); &#xD;&#xA;xmlInsertAlertRequest.LoadXml(@sHoldInsertAlert);&#xD;&#xA;Message_InsertAlert = xmlInsertAlertRequest;&#xD;&#xA;&#xD;&#xA;//Assign  values to message&#xD;&#xA;Message_InsertAlert.MessageTemplateID = intAlertTemplateMessageID;&#xD;&#xA;Message_InsertAlert.SourceSystem = varSourceSystem; &#xD;&#xA;Message_InsertAlert.UserID = varBasketOwnerID; &#xD;&#xA;Message_InsertAlert.AlertMessage = varAlertMessage;&#xD;&#xA;Message_InsertAlert.Message = &quot;xxx&quot;;  &#xD;&#xA;&#xD;&#xA; &#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="6438d0d2-87c9-4643-9f40-b7674dc531cf" ParentLink="ComplexStatement_Statement" LowerBound="739.1" HigherBound="752.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveInsertAlert" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="1de9b204-df74-4e21-a7d1-1b8138320fd4" ParentLink="ReallyComplexStatement_Branch" LowerBound="740.25" HigherBound="752.1">
                                    <om:Property Name="Expression" Value="varArchiveInsertAlert == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveGetAlertTemplate" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="9f20bed5-3eda-4a2c-9813-bed1d4dab35c" ParentLink="ComplexStatement_Statement" LowerBound="742.1" HigherBound="749.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="7f68c5e1-3cbb-4105-aafb-66e796b94470" ParentLink="Construct_MessageRef" LowerBound="743.39" HigherBound="743.65">
                                            <om:Property Name="Ref" Value="Message_InsertAlertArchive" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="cce4254a-655d-41c2-ad42-bca7dc8d4767" ParentLink="ComplexStatement_Statement" LowerBound="745.1" HigherBound="748.1">
                                            <om:Property Name="Expression" Value="Message_InsertAlertArchive = Message_InsertAlert; &#xD;&#xA;Message_InsertAlertArchive(FILE.ReceivedFileName)=&quot;Archive6InsertAlert&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="cb607493-fb43-4373-a257-a9193e654a9a" ParentLink="ComplexStatement_Statement" LowerBound="749.1" HigherBound="751.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveInsertAlert" />
                                        <om:Property Name="MessageName" Value="Message_InsertAlertArchive" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="41a0615d-2828-4d5c-8f3b-b0589317a00e" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="6caa3814-b748-4013-a024-40f6de9773b5" ParentLink="ComplexStatement_Statement" LowerBound="752.1" HigherBound="754.1">
                                <om:Property Name="PortName" Value="PortSQL_InsertAlertMessage" />
                                <om:Property Name="MessageName" Value="Message_InsertAlert" />
                                <om:Property Name="OperationName" Value="procInsertAlertUserMessage" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Message_InsertAlert" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Receive" OID="c582803c-855b-45e6-b477-1e46e3bd9916" ParentLink="ComplexStatement_Statement" LowerBound="754.1" HigherBound="756.1">
                                <om:Property Name="Activate" Value="False" />
                                <om:Property Name="PortName" Value="PortSQL_InsertAlertMessage" />
                                <om:Property Name="MessageName" Value="Message_InsertAlertResponse" />
                                <om:Property Name="OperationName" Value="procInsertAlertUserMessage" />
                                <om:Property Name="OperationMessageName" Value="Response" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Receive_Message_InsertAlertResponse" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="a7401750-cb18-4021-95d7-3e700c51abec" ParentLink="ComplexStatement_Statement" LowerBound="756.1" HigherBound="769.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveInsertAlertResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="fd3fe876-8d81-444f-a75c-a3739dfceacf" ParentLink="ReallyComplexStatement_Branch" LowerBound="757.25" HigherBound="769.1">
                                    <om:Property Name="Expression" Value="varArchiveInsertAlertResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveGetAlertTemplate" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="e5c0c890-dc8e-4d19-9387-77ce3186698a" ParentLink="ComplexStatement_Statement" LowerBound="759.1" HigherBound="766.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="0215f51c-0244-4f10-971d-64c9f5296a7f" ParentLink="Construct_MessageRef" LowerBound="760.39" HigherBound="760.73">
                                            <om:Property Name="Ref" Value="Message_InsertAlertResponseArchive" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="8aaded7c-8c54-4a60-97f9-fad6b2f17557" ParentLink="ComplexStatement_Statement" LowerBound="762.1" HigherBound="765.1">
                                            <om:Property Name="Expression" Value="Message_InsertAlertResponseArchive = Message_InsertAlertResponse; &#xD;&#xA;Message_InsertAlertResponseArchive(FILE.ReceivedFileName)=&quot;Archive7InsertAlertResponse&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="a9d437e6-1409-42ea-abca-b09059af6fde" ParentLink="ComplexStatement_Statement" LowerBound="766.1" HigherBound="768.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveInsertAlertResponse" />
                                        <om:Property Name="MessageName" Value="Message_InsertAlertResponseArchive" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="a65f7f0e-b52a-40e9-93d8-8feb93652513" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="88ee62c5-60aa-4a75-9e94-3ef78c00b161" ParentLink="ComplexStatement_Statement" LowerBound="769.1" HigherBound="794.1">
                                <om:Property Name="Expression" Value="varReturnValue = Message_InsertAlertResponse.ReturnValue; &#xD;&#xA;varReturn = Message_InsertAlertResponse.Return; &#xD;&#xA;varMessage = Message_InsertAlertResponse.Message; &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if (varLogging == true)&#xD;&#xA;{&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;---Application Variables 5---&quot; +  System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;Return: &quot; + varReturn.ToString() + System.Environment.NewLine +&#xD;&#xA;                                                                              &quot;ReturnValue: &quot;               + varReturnValue.ToString()    + System.Environment.NewLine + &#xD;&#xA;                                                                              &quot;Message: &quot;             + varMessage              + System.Environment.NewLine  + &#xD;&#xA;                                                                              &quot;BasketOwner: &quot;         + varBasketOwnerID &#xD;&#xA;                                                                          &#xD;&#xA;                              &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;);        &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;}" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="AssignVariables" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="0e275b1d-d773-48d6-aff6-59343e1603a3" ParentLink="ComplexStatement_Statement" LowerBound="794.1" HigherBound="805.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_SQLError" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="5bf4be09-1306-4f5e-8f88-87053fdc6da6" ParentLink="ReallyComplexStatement_Branch" LowerBound="795.25" HigherBound="805.1">
                                    <om:Property Name="Expression" Value="varReturn != 0 || varReturnValue != 0 || varAlertMessage.Length == 0    " />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_SQLError" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="VariableAssignment" OID="e329dacb-bbfb-4c15-8f75-aa9d17cf67dd" ParentLink="ComplexStatement_Statement" LowerBound="797.1" HigherBound="802.1">
                                        <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;Invalid SQL Response InsertUserAlert: &quot; + System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;Return: &quot; + varReturn.ToString() + System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;ReturnValue: &quot; + varReturnValue.ToString() + System.Environment.NewLine  + &#xD;&#xA;                                                                               &quot;BasketOwner: &quot;         + varBasketOwnerID ); " />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="WriteToEventLog" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Send" OID="12fddc6a-104a-4864-8e76-0e66cb4078c7" ParentLink="ComplexStatement_Statement" LowerBound="802.1" HigherBound="804.1">
                                        <om:Property Name="PortName" Value="Port_SMTP_SQLINSERTALERTS" />
                                        <om:Property Name="MessageName" Value="Message_InsertAlertResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_SQLError" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="38e4f3ae-41fe-430c-9c94-9796f4b5b0d6" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Task" OID="7e45d111-5b3a-40bd-8413-af9e97562385" ParentLink="ComplexStatement_Statement" LowerBound="805.1" HigherBound="863.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Group_UpdateBasket" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="7ec14847-2ae1-4b96-854f-e7778edb4b0a" ParentLink="ComplexStatement_Statement" LowerBound="805.1" HigherBound="822.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_UpdateBasket" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="7d0c73ee-e200-4bd2-86f9-3e4f87acc1ba" ParentLink="Construct_MessageRef" LowerBound="806.35" HigherBound="806.55">
                                    <om:Property Name="Ref" Value="Message_UpdateBasket" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="7627fb18-6c02-4072-9ec0-154032a7b470" ParentLink="ComplexStatement_Statement" LowerBound="808.1" HigherBound="821.1">
                                    <om:Property Name="Expression" Value="//Create message&#xD;&#xA;&#xD;&#xA;sHoldUpdateBasket = &quot;&lt;ns0:procOrdersSetExpiredQuotations xmlns:ns0=\&quot;http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\&quot;&gt;&lt;ns0:duration&gt;&lt;/ns0:duration&gt;&lt;ns0:basketsummaryid&gt;basketsummaryidbasketsummaryidbasketsummaryidbaske&lt;/ns0:basketsummaryid&gt;&lt;ns0:Return&gt;&lt;/ns0:Return&gt;&lt;ns0:Message&gt;&lt;/ns0:Message&gt;&lt;/ns0:procOrdersSetExpiredQuotations&gt;&quot;;&#xD;&#xA;xmlUpdateBasketRequest.LoadXml(@sHoldUpdateBasket);&#xD;&#xA;Message_UpdateBasket = xmlUpdateBasketRequest;&#xD;&#xA;&#xD;&#xA;//Assign  values to message&#xD;&#xA;Message_UpdateBasket.basketsummaryid = varBasketSummaryID;&#xD;&#xA;Message_UpdateBasket.duration = System.Convert.ToInt32(varDuration); &#xD;&#xA;&#xD;&#xA;&#xD;&#xA; &#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="c3a6811f-0e88-4f16-9529-0aa2789888bf" ParentLink="ComplexStatement_Statement" LowerBound="822.1" HigherBound="835.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveUpdateBasket" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="3e0d6996-6c70-456e-b616-978f8b3ff608" ParentLink="ReallyComplexStatement_Branch" LowerBound="823.25" HigherBound="835.1">
                                    <om:Property Name="Expression" Value="varArchiveUpdateBasket == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveUpdateBasket" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="384f0eb1-0d58-4f51-aa57-ec5d4ecbd0cb" ParentLink="ComplexStatement_Statement" LowerBound="825.1" HigherBound="832.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="4dd61bdb-50e0-418e-a1f3-23ff7eeebbe4" ParentLink="ComplexStatement_Statement" LowerBound="828.1" HigherBound="831.1">
                                            <om:Property Name="Expression" Value="Message_UpdateBasketArchive = Message_UpdateBasket; &#xD;&#xA;Message_UpdateBasketArchive(FILE.ReceivedFileName)=&quot;Archive8UpdateBasket&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="a8f8f723-cb58-4045-b5c3-888b6af879af" ParentLink="Construct_MessageRef" LowerBound="826.39" HigherBound="826.66">
                                            <om:Property Name="Ref" Value="Message_UpdateBasketArchive" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="faee22aa-ebee-4bd0-9ba8-1ae606db9368" ParentLink="ComplexStatement_Statement" LowerBound="832.1" HigherBound="834.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveUpdateBasket" />
                                        <om:Property Name="MessageName" Value="Message_UpdateBasketArchive" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="0b78324c-c94b-48f6-a670-a7fc972810d0" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="2e5de936-4621-45a2-b714-868dbdb88c28" ParentLink="ComplexStatement_Statement" LowerBound="835.1" HigherBound="837.1">
                                <om:Property Name="PortName" Value="PortSQL_UpdateBasket" />
                                <om:Property Name="MessageName" Value="Message_UpdateBasket" />
                                <om:Property Name="OperationName" Value="procOrdersSetExpiredQuotations" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Message_InsertAlert" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Receive" OID="540d2e36-23d3-4347-bbd9-66e2c8311d58" ParentLink="ComplexStatement_Statement" LowerBound="837.1" HigherBound="839.1">
                                <om:Property Name="Activate" Value="False" />
                                <om:Property Name="PortName" Value="PortSQL_UpdateBasket" />
                                <om:Property Name="MessageName" Value="Message_UpdateBasketResponse" />
                                <om:Property Name="OperationName" Value="procOrdersSetExpiredQuotations" />
                                <om:Property Name="OperationMessageName" Value="Response" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Receive_Message_InsertAlertResponse" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="f3962707-282f-490c-ade8-e9840ce5e47d" ParentLink="ComplexStatement_Statement" LowerBound="839.1" HigherBound="852.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveUpdateBasketResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="195233a7-3dd1-4797-bac2-000c830d89d0" ParentLink="ReallyComplexStatement_Branch" LowerBound="840.25" HigherBound="852.1">
                                    <om:Property Name="Expression" Value="varArchiveUpdateBasketResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveGetAlertTemplate" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="67230011-0b0d-44a1-abb3-aba4d606fc26" ParentLink="ComplexStatement_Statement" LowerBound="842.1" HigherBound="849.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="4f17db4a-ab68-4627-a47d-101185a19a7e" ParentLink="Construct_MessageRef" LowerBound="843.39" HigherBound="843.74">
                                            <om:Property Name="Ref" Value="Message_UpdateBasketResponseArchive" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="6e33a382-f18a-4b94-83cc-9ad1e3d6da33" ParentLink="ComplexStatement_Statement" LowerBound="845.1" HigherBound="848.1">
                                            <om:Property Name="Expression" Value="Message_UpdateBasketResponseArchive = Message_UpdateBasketResponse; &#xD;&#xA;Message_UpdateBasketResponseArchive(FILE.ReceivedFileName)=&quot;Archive9UpdateBasketResponse&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="2335415f-0957-4628-8d7c-44de0a164f63" ParentLink="ComplexStatement_Statement" LowerBound="849.1" HigherBound="851.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveUpdateBAsketResponse" />
                                        <om:Property Name="MessageName" Value="Message_UpdateBasketResponseArchive" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="dfe04434-549e-4dfd-803e-97050dab2a69" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="b5f94520-c8f3-470e-b899-46e497762061" ParentLink="ComplexStatement_Statement" LowerBound="852.1" HigherBound="863.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_SQLError" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="0319c159-129e-485a-954b-22040e41bbef" ParentLink="ReallyComplexStatement_Branch" LowerBound="853.25" HigherBound="863.1">
                                    <om:Property Name="Expression" Value="varReturn != 0 || varReturnValue != 0 || varAlertTemplateMessage.Length == 0 || varConfigReference.Length == 0 " />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_SQLError" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="VariableAssignment" OID="e5d0e678-cde3-41ee-b2ea-66c77d03e0d6" ParentLink="ComplexStatement_Statement" LowerBound="855.1" HigherBound="860.1">
                                        <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredQuotations&quot;, &quot;Invalid SQL Response UpdateBasket: &quot; + System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;Return: &quot; + varReturn.ToString() +  System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;ReturnValue: &quot; + varReturnValue.ToString() +  System.Environment.NewLine + &#xD;&#xA;                                                                               &quot;Message: &quot; + varMessage + varMessage);" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="WriteToEventLog" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Send" OID="f467278a-8526-429f-bf99-f70ab2071aa4" ParentLink="ComplexStatement_Statement" LowerBound="860.1" HigherBound="862.1">
                                        <om:Property Name="PortName" Value="Port_SMTP_SQLUPDATEBASKET" />
                                        <om:Property Name="MessageName" Value="Message_UpdateBasketResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_SQLError" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="3b01caab-1c5e-4e3f-bdf2-04bb4f10e617" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="661bf767-ce3b-4f97-8026-51557023b7ed" ParentLink="ComplexStatement_Statement" LowerBound="863.1" HigherBound="865.1">
                            <om:Property Name="Expression" Value="intLoopCount = intLoopCount + 1; " />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="AddToCounter" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="2c2844a5-7823-41be-a9d3-3015fe743a7a" ParentLink="Scope_Catch" LowerBound="869.1" HigherBound="886.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.SystemException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_Main" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="f19e0f87-488d-4c57-8aca-f580597fdd46" ParentLink="Catch_Statement" LowerBound="872.1" HigherBound="885.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_Fault" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="cfd04cc9-0587-404a-b48d-4ef4a07a23c3" ParentLink="Construct_MessageRef" LowerBound="873.35" HigherBound="873.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="c5f6e534-45e7-461e-b821-7685b0770047" ParentLink="ComplexStatement_Statement" LowerBound="875.1" HigherBound="884.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ExpiredQuotations Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=ex.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3019&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_5" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="7bd00cde-3c17-4720-aa8d-d24a3f6c4f3f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="144.1" HigherBound="146.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ReceiveDummy" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Dummy" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="7e672a90-7d78-4a97-8b61-c81e05f3f05a" ParentLink="PortDeclaration_CLRAttribute" LowerBound="144.1" HigherBound="145.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="6c4461da-1e4c-4c12-b87d-e3f11e900efc" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="146.1" HigherBound="148.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortTypeSQL_GetExpiredQuotation" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PortSQL_GetExpiredQuotations" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="242a2f08-56fe-4ef4-a482-3350f2f958af" ParentLink="PortDeclaration_CLRAttribute" LowerBound="146.1" HigherBound="147.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="b20e277c-5ff0-40ec-b933-18453bea123c" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="148.1" HigherBound="150.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_Archive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveReq" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="fd2871c0-9a7d-4fc3-bc74-ea897cb06274" ParentLink="PortDeclaration_CLRAttribute" LowerBound="148.1" HigherBound="149.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="157985cf-dda9-4f51-ae27-08ffdc5f5fce" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="150.1" HigherBound="152.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveResp" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveResp" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="6b4d4c1a-4f30-4a1c-b0bc-ecac32547207" ParentLink="PortDeclaration_CLRAttribute" LowerBound="150.1" HigherBound="151.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="3a65e32c-4c4c-4b6f-8f76-631152f3ee2d" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="152.1" HigherBound="154.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveSingle" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveSingle" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="cbc625f8-ebcb-4916-b4ba-3f2b58277ca8" ParentLink="PortDeclaration_CLRAttribute" LowerBound="152.1" HigherBound="153.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0ec8be74-3391-4b6a-b24f-e1a287ef4979" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="154.1" HigherBound="156.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_SMTPQuotations" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SMTPQuotations" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="ee5336f2-c8c5-4745-8704-e7f9feada3eb" ParentLink="PortDeclaration_CLRAttribute" LowerBound="154.1" HigherBound="155.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a6733eee-1606-47cb-99f2-0fc416ab6577" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="156.1" HigherBound="158.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_GetAlertTemplateMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PortSQL_GetAlertMessage" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="746d2d4b-9a75-47fd-b058-ed02e0643ccb" ParentLink="PortDeclaration_CLRAttribute" LowerBound="156.1" HigherBound="157.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4b984271-c8eb-44d3-a03b-9efb8cd14ef5" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="158.1" HigherBound="160.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortTypeSQL_InsertAlertMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PortSQL_InsertAlertMessage" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="b5c3284c-d815-4b24-8663-0f8c12d7c4f8" ParentLink="PortDeclaration_CLRAttribute" LowerBound="158.1" HigherBound="159.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="8ed028cf-1110-4777-9bc0-479060b0a52f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="160.1" HigherBound="162.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveGetAlert" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveGetAlert" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="9889c587-3a9f-46ef-b0d1-60a6a3c84e16" ParentLink="PortDeclaration_CLRAttribute" LowerBound="160.1" HigherBound="161.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="735763d5-d802-47d7-8858-c495c3ab2d07" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="162.1" HigherBound="164.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_GetAlertResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveGetAlertResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="638f8448-74b6-4aba-a404-b66089c9507e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="162.1" HigherBound="163.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="e5ddfe50-b5c3-4dcc-9a21-37ddda4034b0" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="164.1" HigherBound="166.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveInsertAlert" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveInsertAlert" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="c00df903-c407-4f13-9976-5ed66408ccf3" ParentLink="PortDeclaration_CLRAttribute" LowerBound="164.1" HigherBound="165.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="04421629-38ed-4597-922a-e28f587686ad" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="166.1" HigherBound="168.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveInsertAlertResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveInsertAlertResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="a68e99b0-c9dc-4d9e-9263-6d9626f91184" ParentLink="PortDeclaration_CLRAttribute" LowerBound="166.1" HigherBound="167.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="7f2167fa-759b-4d23-917a-e3d78f001d66" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="168.1" HigherBound="170.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortTypeSQL_UpdateBAsket" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PortSQL_UpdateBasket" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="dda7571d-91de-47a4-89f5-bcab9fba0b78" ParentLink="PortDeclaration_CLRAttribute" LowerBound="168.1" HigherBound="169.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0d3518e9-6402-4ae1-8eb4-55b12225d1d3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="170.1" HigherBound="172.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveUpdateBasket" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveUpdateBasket" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="9ecf978f-e4cc-4383-911c-83619cd34f50" ParentLink="PortDeclaration_CLRAttribute" LowerBound="170.1" HigherBound="171.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="b90e89b8-b91e-438d-b846-0039706c92f3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="172.1" HigherBound="174.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_ArchiveBasketResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveUpdateBAsketResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="e745da01-470a-4da3-9c41-dac8a3ef9a11" ParentLink="PortDeclaration_CLRAttribute" LowerBound="172.1" HigherBound="173.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="50c51b1d-47da-4e6e-b0b6-3389a8cca335" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="174.1" HigherBound="176.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_SMTPSQLErrorAlerts" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SMTP_SQLErrorAlerts" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="131001e4-44f8-4660-839e-eaa0bf7c849a" ParentLink="PortDeclaration_CLRAttribute" LowerBound="174.1" HigherBound="175.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="d22cdc2e-653b-4a0b-a5c5-e7342810b829" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="176.1" HigherBound="178.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_SMTP_SQLErrorQuotations" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SMTP_SQLErrorQuotations" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="a76119a9-825f-48fd-94ae-d8c14daa1a9a" ParentLink="PortDeclaration_CLRAttribute" LowerBound="176.1" HigherBound="177.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="71be34fa-6ac0-495d-8901-1dae2dc04c81" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="178.1" HigherBound="180.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_SMTP_SQLINSERTALERT" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SMTP_SQLINSERTALERTS" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="4ddecfab-3c1a-4f21-ae41-d7260f6f1a89" ParentLink="PortDeclaration_CLRAttribute" LowerBound="178.1" HigherBound="179.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a4781880-4b06-4325-ada9-5cd191e63974" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="180.1" HigherBound="182.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredQuotations.PortType_SQLUPDATEBASKET" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SMTP_SQLUPDATEBASKET" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="d49d0dc9-38c0-41a2-a563-066b83751f4e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="180.1" HigherBound="181.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="9f249c69-1085-4bfd-a369-fcaa031eda18" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Email" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="63ded735-b4a1-4a2e-8d5b-2814a47a94d6" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ExpiredQuotations
{
    internal messagetype MultipartType_Email
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_Body;
    };
    internal porttype PortType_ReceiveDummy
    {
        oneway Operation_1
        {
            ExpiredQuotationsDummy
        };
    };
    internal porttype PortTypeSQL_GetExpiredQuotation
    {
        requestresponse procOrdersGetExpiredQuotations
        {
            EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations, EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse
        };
    };
    internal porttype PortType_Archive
    {
        oneway Operation_1
        {
            EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations
        };
    };
    internal porttype PortType_ArchiveResp
    {
        oneway Operation_1
        {
            EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse
        };
    };
    internal porttype PortType_ArchiveSingle
    {
        oneway Operation_1
        {
            ExpiredQuotationsSingle
        };
    };
    internal porttype PortType_SMTPQuotations
    {
        oneway Operation_1
        {
            MultipartType_Email
        };
    };
    internal porttype PortType_GetAlertTemplateMessage
    {
        requestresponse procGetAlertMessageTemplate
        {
            EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate, EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse
        };
    };
    internal porttype PortTypeSQL_InsertAlertMessage
    {
        requestresponse procInsertAlertUserMessage
        {
            EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage, EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse
        };
    };
    internal porttype PortType_ArchiveGetAlert
    {
        oneway Operation_1
        {
            EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate
        };
    };
    internal porttype PortType_GetAlertResponse
    {
        oneway Operation_1
        {
            EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse
        };
    };
    internal porttype PortType_ArchiveInsertAlert
    {
        oneway Operation_1
        {
            EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage
        };
    };
    internal porttype PortType_ArchiveInsertAlertResponse
    {
        oneway Operation_1
        {
            EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse
        };
    };
    internal porttype PortTypeSQL_UpdateBAsket
    {
        requestresponse procOrdersSetExpiredQuotations
        {
            EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations, EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse
        };
    };
    internal porttype PortType_ArchiveUpdateBasket
    {
        oneway Operation_1
        {
            EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations
        };
    };
    internal porttype PortType_ArchiveBasketResponse
    {
        oneway Operation_1
        {
            EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse
        };
    };
    internal porttype PortType_SMTPSQLErrorAlerts
    {
        oneway Operation_1
        {
            EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse
        };
    };
    internal porttype PortType_SMTP_SQLErrorQuotations
    {
        oneway Operation_1
        {
            EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse
        };
    };
    internal porttype PortType_SMTP_SQLINSERTALERT
    {
        oneway Operation_1
        {
            EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse
        };
    };
    internal porttype PortType_SQLUPDATEBASKET
    {
        oneway Operation_1
        {
            EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service ExpiredQuotationsMain
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_ReceiveDummy Port_Dummy;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortTypeSQL_GetExpiredQuotation PortSQL_GetExpiredQuotations;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Archive Port_ArchiveReq;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveResp Port_ArchiveResp;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveSingle Port_ArchiveSingle;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_SMTPQuotations Port_SMTPQuotations;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_GetAlertTemplateMessage PortSQL_GetAlertMessage;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortTypeSQL_InsertAlertMessage PortSQL_InsertAlertMessage;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveGetAlert Port_ArchiveGetAlert;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_GetAlertResponse Port_ArchiveGetAlertResponse;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveInsertAlert Port_ArchiveInsertAlert;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveInsertAlertResponse Port_ArchiveInsertAlertResponse;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortTypeSQL_UpdateBAsket PortSQL_UpdateBasket;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveUpdateBasket Port_ArchiveUpdateBasket;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveBasketResponse Port_ArchiveUpdateBAsketResponse;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SMTPSQLErrorAlerts Port_SMTP_SQLErrorAlerts;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SMTP_SQLErrorQuotations Port_SMTP_SQLErrorQuotations;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SMTP_SQLINSERTALERT Port_SMTP_SQLINSERTALERTS;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SQLUPDATEBASKET Port_SMTP_SQLUPDATEBASKET;
        message ExpiredQuotationsDummy Message_Dummy;
        message EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations Message_ExpiredQuotations;
        message EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse Message_ExpiredQuotationsResponse;
        message EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotations Message_ExpiredQuotationsArchive;
        message EQ_TypedProcedure_dbo.procOrdersGetExpiredQuotationsResponse Message_ExpiredQuotationsResponseArchive;
        message ExpiredQuotationsX Message_ExpiredQuotationsX;
        message ExpiredQuotationsSingle Message_ExpiredQuotationsSingle;
        message ExpiredQuotationsSingle Message_ExpiredQuotationsSingleArchive;
        message MultipartType_Email emailMsg;
        message EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate Message_GetAlertTemplate;
        message EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse Message_GetAlertTemplateResponse;
        message EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage Message_InsertAlert;
        message EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse Message_InsertAlertResponse;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage FaultMessage;
        message EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplate Message_GetAlertTemplateArchive;
        message EQ_GetAlertTypedProcedure_dbo.procGetAlertMessageTemplateResponse Message_GetAlertTemplateResponseArchive;
        message EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessage Message_InsertAlertArchive;
        message EQ_InsertAlertTypedProcedure_dbo.procInsertAlertUserMessageResponse Message_InsertAlertResponseArchive;
        message EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations Message_UpdateBasket;
        message EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse Message_UpdateBasketResponse;
        message EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotations Message_UpdateBasketArchive;
        message EQ_UpdateBasketTypedProcedure_dbo.procOrdersSetExpiredQuotationsResponse Message_UpdateBasketResponseArchive;
        System.String varEmailMessage;
        System.String varCurrentDateTime;
        System.DateTime intCurrentDateTime;
        System.Text.StringBuilder msgbody;
        System.Int32 intExpirationDay;
        System.String strExpirationDaysList;
        System.Int32 intExpirationFromDay;
        System.Int32 intExpirationToDay;
        System.Boolean varArchiveExpiredRequestQuotations;
        System.Boolean varArchiveExpiredResponseQuotations;
        System.String varTS360Name;
        System.String varSMTPFrom;
        System.String varSMTPTo;
        System.String varTS360Logo;
        System.Boolean varArchiveQuotationsSingle;
        System.String varSMTPHost;
        System.String sHold;
        System.Xml.XmlDocument xmlExpiredRequest;
        System.Int32 intRecordCount;
        System.Int32 intLoopCount;
        System.String sXpath;
        System.Boolean varArchiveExpiredSingleQuotations;
        System.String varBasketSummaryID;
        System.String varQuoteID;
        System.String varBasketName;
        System.String varDuration;
        System.String varEmailAddress;
        System.String varFirstName;
        System.Boolean varLogging;
        System.String varBiztalkAdmin;
        System.Int32 intAlertTemplateMessageID;
        System.String sHoldGetAlert;
        System.Xml.XmlDocument xmlGetAlertRequest;
        System.String varAlertTemplateMessage;
        System.String varAlertMessage;
        System.String varConfigReference;
        System.String varMessage;
        System.Int32 varReturn;
        System.Int32 varReturnValue;
        System.String varBasketOwnerID;
        System.String sHoldInsertAlert;
        System.Xml.XmlDocument xmlInsertAlertRequest;
        System.String varSourceSystem;
        System.Boolean varArchiveGetAlertTemplateResponse;
        System.Boolean varArchiveGetAlertTemplate;
        System.Boolean varArchiveInsertAlert;
        System.Boolean varArchiveInsertAlertResponse;
        System.String sHoldUpdateBasket;
        System.Xml.XmlDocument xmlUpdateBasketRequest;
        System.Boolean varArchiveUpdateBasket;
        System.Boolean varArchiveUpdateBasketResponse;
        System.DateTime intExpirationDateTime;
        System.String varExpirationDateTime;
        System.Int32 intDuration;
        System.String varEmailMessageTemplate;
        System.String varEmailTS360Support;
        System.String varEmailSubject;
        System.String varEmailSubjectTemplate;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e4f2a597-c2d0-4c7d-97a3-0a577c2bd3b9")]
            activate receive (Port_Dummy.Operation_1, Message_Dummy);
            varEmailMessage = "";
            varCurrentDateTime = "";
            msgbody = new System.Text.StringBuilder();
            strExpirationDaysList = "";
            varArchiveExpiredRequestQuotations = true;
            varArchiveExpiredResponseQuotations = true;
            varTS360Name = "";
            varSMTPFrom = "";
            varSMTPTo = "";
            varTS360Logo = "";
            varArchiveQuotationsSingle = true;
            varSMTPHost = "";
            sHold = "";
            xmlExpiredRequest = new System.Xml.XmlDocument();
            intLoopCount = 1;
            sXpath = "";
            varArchiveExpiredSingleQuotations = true;
            varBasketSummaryID = "";
            varQuoteID = "";
            varBasketName = "";
            varDuration = "";
            varEmailAddress = "";
            varFirstName = "";
            varLogging = true;
            varBiztalkAdmin = "";
            sHoldGetAlert = "";
            xmlGetAlertRequest = new System.Xml.XmlDocument();
            varAlertTemplateMessage = "";
            varAlertMessage = "";
            varConfigReference = "";
            varMessage = "";
            varBasketOwnerID = "";
            sHoldInsertAlert = "";
            xmlInsertAlertRequest = new System.Xml.XmlDocument();
            varSourceSystem = "";
            varArchiveGetAlertTemplateResponse = true;
            varArchiveGetAlertTemplate = true;
            varArchiveInsertAlert = true;
            varArchiveInsertAlertResponse = true;
            sHoldUpdateBasket = "";
            xmlUpdateBasketRequest = new System.Xml.XmlDocument();
            varArchiveUpdateBasket = true;
            varArchiveUpdateBasketResponse = true;
            varExpirationDateTime = "";
            varEmailMessageTemplate = "";
            varEmailTS360Support = "";
            varEmailSubject = "";
            varEmailSubjectTemplate = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5eeb241c-3072-443e-b43c-f745f1911e39")]
            scope
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5eb3f72d-fbbd-43d5-9a68-3754ed046851")]
                    varArchiveExpiredRequestQuotations=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveExpiredRequestQuotations"));
                    varArchiveExpiredResponseQuotations=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveExpiredResponseQuotations")); 
                    varArchiveExpiredSingleQuotations=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveExpiredSingleQuotations")); 
                    varArchiveGetAlertTemplate=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveGetAlertTemplate")); 
                    varArchiveGetAlertTemplateResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveGetAlertTemplateResponse")); 
                    varArchiveInsertAlert=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveInsertAlert")); 
                    varArchiveInsertAlertResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveInsertAlertResponse"));
                    varArchiveUpdateBasket=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveUpdateBasket")); 
                    varArchiveUpdateBasketResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ArchiveUpdateBasketResponse"));
                    
                    
                    varLogging=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","Logging")); 
                    varEmailTS360Support=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","EmailTS360Support"); 
                    varEmailMessageTemplate=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","EmailMessageTemplate"); 
                    varEmailSubjectTemplate=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","EmailSubjectTemplate"); 
                    
                    varTS360Logo=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","TS360Logo"); 
                    varSMTPFrom=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","SMTPFrom");                                                                                                                                                                                                                              
                    varSMTPHost=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","SMTPHost");                                                                                                               
                    varSourceSystem=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","SourceSystem");
                    varTS360Name=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","TS360Name");   
                    varBiztalkAdmin=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","BiztalkAdmin");                                                                                                                
                    strExpirationDaysList=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ExpirationDaysList");
                    intExpirationFromDay=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ExpirationFromDay"));
                    intExpirationDay=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ExpirationDay"));
                    intExpirationToDay=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","ExpirationToDay"));
                    intAlertTemplateMessageID=System.Convert.ToInt32(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredQuotations","AlertTemplateMessageID"));
                    
                    if (varLogging == true) 
                    {
                    //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", strExpirationDaysList);
                    //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", intExpirationFromDay.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", intExpirationDay.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", intExpirationToDay.ToString());
                    
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "---Application Variables 1---" +  System.Environment.NewLine +
                                                                                                  "ExpirationDaysList: " + strExpirationDaysList + System.Environment.NewLine +
                                                                                                  "ExpirationFromDay: "        + intExpirationFromDay.ToString()    + System.Environment.NewLine + 
                                                                                                  "ExpirationToDay: "          + intExpirationToDay.ToString()    + System.Environment.NewLine + 
                                                                                                  "ExpirationDay: "          + intExpirationDay.ToString()    + System.Environment.NewLine  ); 
                    
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "---Application Variables 1.1---" +  System.Environment.NewLine +
                                                                                                  "EmailMessageTemplate: " + varEmailMessageTemplate + System.Environment.NewLine ); 
                    
                    }
                    
                    
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("dccd46c7-7e64-4e1e-8cc3-232813dd8f6d")]
                    construct Message_GetAlertTemplate
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("17158578-caa0-4343-a35e-a4aa429f6695")]
                        
                        sHoldGetAlert = "<ns0:procGetAlertMessageTemplate xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:AlertMessageTemplateID></ns0:AlertMessageTemplateID><ns0:AlertMessageTemplate></ns0:AlertMessageTemplate><ns0:ConfigReferenceValue></ns0:ConfigReferenceValue><ns0:Return></ns0:Return><ns0:Message></ns0:Message></ns0:procGetAlertMessageTemplate>";
                        xmlGetAlertRequest.LoadXml(@sHoldGetAlert); 
                        Message_GetAlertTemplate = xmlGetAlertRequest;
                        
                        Message_GetAlertTemplate.AlertMessageTemplateID = intAlertTemplateMessageID; 
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ac201122-f58d-41bb-8f95-72495113b8cf")]
                    if (varArchiveGetAlertTemplate == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2174da52-833f-45f9-8b93-e0e63fae6d74")]
                        construct Message_GetAlertTemplateArchive
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3bb8fd6d-0784-4ccb-b7e6-d44284ca2569")]
                            Message_GetAlertTemplateArchive = Message_GetAlertTemplate; 
                            Message_GetAlertTemplateArchive(FILE.ReceivedFileName)="Archive1GetAlertTemplate"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9be2d436-a72e-43a0-bee9-46e534c80657")]
                        send (Port_ArchiveGetAlert.Operation_1, Message_GetAlertTemplateArchive);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f5f87b29-a6d3-4a3a-b8e2-77da5554684d")]
                    send (PortSQL_GetAlertMessage.procGetAlertMessageTemplate, Message_GetAlertTemplate);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5ad9921e-e0f6-4bc2-acbd-50f52a5336fa")]
                    receive (PortSQL_GetAlertMessage.procGetAlertMessageTemplate, Message_GetAlertTemplateResponse);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("92d6aa75-2218-42eb-a187-d2f2544d1994")]
                    if (varArchiveGetAlertTemplateResponse == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8079cc72-6472-4af1-bc41-87547881515a")]
                        construct Message_GetAlertTemplateResponseArchive
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b4d2271b-3d38-4884-a675-2d6129c513f6")]
                            Message_GetAlertTemplateResponseArchive = Message_GetAlertTemplateResponse; 
                            Message_GetAlertTemplateResponseArchive(FILE.ReceivedFileName)="Archive2GetAlertTemplateResponse"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("09182d1a-989c-407a-93e2-f80d17d48ad3")]
                        send (Port_ArchiveGetAlertResponse.Operation_1, Message_GetAlertTemplateResponseArchive);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a0ffadb3-59fe-42b5-9cbe-6101ce8db801")]
                    varAlertTemplateMessage = Message_GetAlertTemplateResponse.AlertMessageTemplate; 
                    varConfigReference = Message_GetAlertTemplateResponse.ConfigReferenceValue; 
                    varReturnValue = Message_GetAlertTemplateResponse.ReturnValue; 
                    varReturn = Message_GetAlertTemplateResponse.Return; 
                    varMessage = Message_GetAlertTemplateResponse.Message; 
                    
                    if (varLogging == true)
                    {
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "---Application Variables 2---" +  System.Environment.NewLine +
                                                                                                  "AlertTemplateMessage: " + varAlertTemplateMessage + System.Environment.NewLine +
                                                                                                  "Return: "               + varReturn.ToString()    + System.Environment.NewLine + 
                                                                                                   "Message: "             + varMessage              + System.Environment.NewLine);         
                    
                    
                    }
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5759ee90-12a4-4540-becc-76cb8cedd75f")]
                    if (varReturn != 0 || varReturnValue != 0 || varAlertTemplateMessage.Length == 0 || varConfigReference.Length == 0 )
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0ea633aa-dd92-4930-b33d-ce97bfa2314c")]
                        System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "Invalid SQL Response: " + System.Environment.NewLine + 
                                                                                                       "Return: " + varReturn.ToString() + 
                                                                                                       "ReturnValue: " + varReturnValue.ToString() +
                                                                                                       "Message: " + varMessage + varMessage);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c7a93642-19f0-4f05-9822-36a53ee46373")]
                        send (Port_SMTP_SQLErrorAlerts.Operation_1, Message_GetAlertTemplateResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f348c42-b296-4cd2-9479-84d6331e575a")]
                        terminate "BTNextGen.Biztalk.ExpiredQuotations - Invalid SQL Response";;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("bc8fd90c-330d-45fd-b649-a9ea659cd042")]
                    construct Message_ExpiredQuotations
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1308b9c2-1472-4240-ae27-1a179d860c3b")]
                        
                        //- <ns0:procOrdersGetExpiredQuotations xmlns:ns0="http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo">
                        //  <ns0:strExpirationFromDay>10</ns0:strExpirationFromDay> 
                        //  <ns0:strExpirationToDay>10</ns0:strExpirationToDay> 
                        //  <ns0:strExpirationDaysList>strExpirationDaysListstrExpira</ns0:strExpirationDaysList> 
                        //  <ns0:strExpirationDay>10</ns0:strExpirationDay> 
                        //  </ns0:procOrdersGetExpiredQuotations>
                        
                        //sHold = "<GetExpiredCards xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                        
                        sHold = "<ns0:procOrdersGetExpiredQuotations xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:strExpirationFromDay></ns0:strExpirationFromDay><ns0:strExpirationToDay></ns0:strExpirationToDay><ns0:strExpirationDaysList></ns0:strExpirationDaysList><ns0:strExpirationDay></ns0:strExpirationDay></ns0:procOrdersGetExpiredQuotations>"; 
                        xmlExpiredRequest.LoadXml(@sHold); 
                        Message_ExpiredQuotations = xmlExpiredRequest;
                        
                        Message_ExpiredQuotations.strExpirationDay = intExpirationDay; 
                        Message_ExpiredQuotations.strExpirationDaysList = strExpirationDaysList; 
                        Message_ExpiredQuotations.strExpirationFromDay = intExpirationFromDay; 
                        Message_ExpiredQuotations.strExpirationToDay = intExpirationToDay; 
                        
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("69748ad5-ef70-4c75-9623-248cc19ebf27")]
                    if (varArchiveExpiredRequestQuotations == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7907d622-c28c-4a12-a9da-bb5444d624ec")]
                        construct Message_ExpiredQuotationsArchive
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("223ea81d-567e-4abc-8927-ea83a9178863")]
                            Message_ExpiredQuotationsArchive = Message_ExpiredQuotations; 
                            Message_ExpiredQuotationsArchive(FILE.ReceivedFileName)="Archive3ExpiredRequestQuotations"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("484d2272-30f5-40ec-ade3-deb8f9a8cb9c")]
                        send (Port_ArchiveReq.Operation_1, Message_ExpiredQuotationsArchive);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8fda8868-f0f8-423e-a57a-3ec171a06569")]
                    send (PortSQL_GetExpiredQuotations.procOrdersGetExpiredQuotations, Message_ExpiredQuotations);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9c2405a1-c255-450e-b655-c5ce376e3a42")]
                    receive (PortSQL_GetExpiredQuotations.procOrdersGetExpiredQuotations, Message_ExpiredQuotationsResponse);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d1c01843-00a6-482a-938e-6dbfa9e432ed")]
                    if (varArchiveExpiredResponseQuotations == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd64ca44-eda4-462e-af00-1e38f7de61b1")]
                        construct Message_ExpiredQuotationsResponseArchive
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("65fdbe69-fac9-45a7-855d-3af315829e5e")]
                            Message_ExpiredQuotationsResponseArchive = Message_ExpiredQuotationsResponse; 
                            Message_ExpiredQuotationsResponseArchive(FILE.ReceivedFileName)="Archive4ExpiredResponseQuotations"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1236f4b1-47d4-41a8-90d9-0b9a73890b94")]
                        send (Port_ArchiveResp.Operation_1, Message_ExpiredQuotationsResponseArchive);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1dd383c5-33e7-4dae-b455-e8e8eeedd57b")]
                    if (varReturn != 0 || varReturnValue != 0 || varAlertTemplateMessage.Length == 0 || varConfigReference.Length == 0 )
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b25426ab-b892-4525-b0bb-cefd1686378b")]
                        System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "Invalid SQL Response: " + System.Environment.NewLine + 
                                                                                                       "ReturnValue: " + varReturnValue.ToString()); 
                                                                                                       
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("68f34a0f-c983-4b1f-93f5-fc8a671f77a1")]
                        send (Port_SMTP_SQLErrorQuotations.Operation_1, Message_ExpiredQuotationsResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("951f3f67-900e-4581-ac08-3c772a5b6781")]
                        terminate "BTNextGen.Biztalk.ExpiredQuotations - Invalid SQL Response";;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8cd47088-b16d-4b5e-89c9-0bf682c01bd3")]
                    construct Message_ExpiredQuotationsX
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6d87e3b7-ff4c-43a3-9622-a615ad066a15")]
                        transform (Message_ExpiredQuotationsX) = BTNextGen.Biztalk.ExpiredQuotations.Transform_Messagex (Message_ExpiredQuotationsResponse);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5d4e6a94-3bc8-4b7b-9c3f-65fda0fdc167")]
                    intRecordCount = System.Convert.ToInt32(xpath(Message_ExpiredQuotationsX, "count(//QuotationsData)"));
                              
                    if (varLogging == true)                                                                              
                    {
                    //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", intRecordCount.ToString());
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "---Application Variables 3---" +  System.Environment.NewLine +
                                                                                                  "Record Count: " + intRecordCount.ToString()+ System.Environment.NewLine); 
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ab52e39b-3ff0-4682-832e-500afa9f7481")]
                    while (intLoopCount <= intRecordCount)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2d5934ca-8da2-4bc0-b170-125c3b075502")]
                        construct Message_ExpiredQuotationsSingle
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8023a7d0-ea8b-4ef8-90e1-9bb109db5709")]
                            
                            
                            sXpath = System.String.Format("//QuotationsData[{0}]",intLoopCount);
                            Message_ExpiredQuotationsSingle = xpath(Message_ExpiredQuotationsX,sXpath); 
                                                      
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("136e3240-d40e-4af7-b7b6-3c75de27bc84")]
                        if (varArchiveExpiredRequestQuotations == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e901fab2-73ef-4f5a-a8a5-3c45e9743716")]
                            construct Message_ExpiredQuotationsSingleArchive
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("024d4323-170c-4413-9968-1157c20822a5")]
                                Message_ExpiredQuotationsSingleArchive = Message_ExpiredQuotationsSingle; 
                                Message_ExpiredQuotationsSingleArchive(FILE.ReceivedFileName)="Archive5ExpiredSingleQuotations"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f9c95c5f-dcd5-4909-9439-fd8f7c701149")]
                            send (Port_ArchiveSingle.Operation_1, Message_ExpiredQuotationsSingleArchive);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("501316e7-622c-4728-a103-fdd3703a6bdf")]
                        
                        //Create Email and Alert Variables... 
                        varFirstName = xpath(Message_ExpiredQuotationsSingle,"string(//firstname)");
                        varBasketName = xpath(Message_ExpiredQuotationsSingle,"string(//basketname)");
                        varQuoteID = xpath(Message_ExpiredQuotationsSingle,"string(//quoteid)");
                        varEmailAddress = xpath(Message_ExpiredQuotationsSingle,"string(//EmailAddress)");
                        varBasketSummaryID = xpath(Message_ExpiredQuotationsSingle,"string(//basketsummaryid)");
                        varDuration = xpath(Message_ExpiredQuotationsSingle,"string(//duration)");
                        intDuration = System.Convert.ToInt32(varDuration); 
                        intExpirationDateTime  = System.DateTime.Now.AddDays(intDuration);
                        varExpirationDateTime = intExpirationDateTime.ToString("yyyy-MM-dd"); 
                        varBasketOwnerID = xpath(Message_ExpiredQuotationsSingle,"string(//basketownerid)");
                        
                        //Complete Alert Message
                        varAlertMessage=varAlertTemplateMessage; 
                        varAlertMessage=varAlertMessage.Replace("@cart",varBasketName); 
                        varAlertMessage=varAlertMessage.Replace("@quotation",varQuoteID); 
                        varAlertMessage=varAlertMessage.Replace("@days",varDuration);
                        varAlertMessage=varAlertMessage.Replace("@expirationdate", varExpirationDateTime); 
                        varAlertMessage=varAlertMessage.Replace("@URL",varConfigReference + varBasketSummaryID); 
                        
                        //Complete Email Message
                        varEmailMessage=varEmailMessageTemplate; 
                        varEmailMessage=varEmailMessage.Replace("@varFirstName", varFirstName);
                        varEmailMessage=varEmailMessage.Replace("@varQuoteID", varQuoteID);
                        varEmailMessage=varEmailMessage.Replace("@varBasketName", varBasketName);
                        varEmailMessage=varEmailMessage.Replace("@varDuration", varDuration);
                        varEmailMessage=varEmailMessage.Replace("@varExpirationDateTime", varExpirationDateTime);
                        varEmailMessage=varEmailMessage.Replace("@varEmailTS360Support", varEmailTS360Support);
                        
                        //Complete Email Subject  
                        varEmailSubject=varEmailSubjectTemplate; 
                        varEmailSubject=varEmailSubject.Replace("@varQuoteID", varQuoteID); 
                        varEmailSubject=varEmailSubject.Replace("@varTS360Name", varTS360Name); 
                        
                         
                        
                        //Assign Email address to dynamic port
                        Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                        
                        //Send out an email with logging values
                        if (varLogging == true)
                        {
                        
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varFirstName);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varBasketName);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varQuoteID);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varEmailAddress);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varBasketSummaryID);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varDuration);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varCurrentDateTime);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varAlertMessage);
                        //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", varBasketOwnerID);
                        
                        System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "---Application Variables 4---" +  System.Environment.NewLine +
                                                                                                      "FirstName: " + varFirstName + System.Environment.NewLine +
                                                                                                      "BasketName: "               + varBasketName    + System.Environment.NewLine + 
                                                                                                      "QuoteID: "             + varQuoteID              + System.Environment.NewLine + 
                                                                                                      "EmailAddress: " + varEmailAddress + System.Environment.NewLine +
                                                                                                      "BasketSummaryID: "               + varBasketSummaryID    + System.Environment.NewLine + 
                                                                                                      "Duration: "             + varDuration              + System.Environment.NewLine + 
                                                                                                      "ExpirationDate: " + varCurrentDateTime + System.Environment.NewLine +
                                                                                                      "AlertMessage: "               + varAlertMessage    + System.Environment.NewLine + 
                                                                                                      "BasketOwnerID: "             + varBasketOwnerID              + System.Environment.NewLine 
                        
                        
                        
                        );        
                        
                        
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ca3f28af-d345-4a7a-ab9b-44b629c32c73")]
                        if (varEmailAddress.Length > 0)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("88e0ef0e-d58f-4826-a0bd-f63cafbc061d")]
                            construct emailMsg
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb9b5ab8-c24d-4bba-9981-395db3453f7f")]
                                //Assign values to Message body
                                msgbody = new System.Text.StringBuilder();
                                msgbody.AppendLine("<html><body>");
                                msgbody.AppendLine("<img src=" +  varTS360Logo +   ">");
                                msgbody.AppendLine(varEmailMessage); 
                                msgbody.AppendLine("</body></html>");
                                
                                emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                emailMsg(SMTP.From)= varSMTPFrom;
                                emailMsg(SMTP.Subject)=varEmailSubject; 
                                
                                
                                emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                emailMsg(SMTP.MessagePartsAttachments)=2;
                                
                                Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ac743f59-6031-4067-8061-322ccdddf6ba")]
                            construct emailMsg
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9262048b-72c5-4a85-a471-f94faed8dca6")]
                                varEmailAddress = varBiztalkAdmin; 
                                Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                
                                msgbody = new System.Text.StringBuilder();
                                msgbody.AppendLine("<html><body>");
                                msgbody.AppendLine("<img src=" +  varTS360Logo +   ">");
                                msgbody.AppendLine("<p>Dear " + "TS360 Quote Support" + "," +   "</p><p>");
                                msgbody.AppendLine("<p>Please be advised, the Quote:  " + varQuoteID + " for cart:  " + varBasketName  + "</p><p>");
                                msgbody.AppendLine("<p>is about to expire in " + varDuration + " day(s) on " + varExpirationDateTime + ".  At such time, the quotation will no longer be available.</p><p>");
                                msgbody.AppendLine("<p>If we intend on giving the customer the chance to order this quotation, logon to TS360, search for Quote ID " + varQuoteID + " and determine a valid contact for.</p><p>");
                                
                                
                                msgbody.AppendLine("<p>Thanks<br />TS360 Biztalk SUPPORT<br /></p><p>");
                                
                                
                                //Please be advised, your Quote: @quotation for cart XYZ123 will expire in 7 days on 2013-11-27.  At such time, the quotation will no longer be available.  //
                                //If you intend on ordering this cart/quotation, logon to TS 360, search for Quote ID @quotation and submit as an order.  
                                //You may also forward this email to B&T Tech Support and ask that B&T place the order on your behalf.
                                
                                
                                
                                msgbody.AppendLine("</body></html>");
                                
                                //xmlDoc=TmpMsg;
                                emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                //emailMsg.attachment=xmlDoc;
                                //emailMsg.attachment(MIME.FileName)= faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.Application)+"_" +faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.FaultCode)+".xml"; 
                                emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                emailMsg(SMTP.From)= varSMTPFrom;
                                emailMsg(SMTP.Subject)=varTS360Name + " Quote ID " + varQuoteID + " expiring soon - Preemptive Notification INVALID EMAIL"; 
                                
                                //Quote ID @quotation expiring soon - Preemptive Notification
                                
                                emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                emailMsg(SMTP.MessagePartsAttachments)=2;
                                
                                Port_SMTPQuotations(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b31e2744-7205-49ce-ab73-010ffa4c0514")]
                        send (Port_SMTPQuotations.Operation_1, emailMsg);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f365497-c298-49b5-9e0a-08c47cdd2053")]
                        construct Message_InsertAlert
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("30822271-d22a-4302-a2b9-2ba2c4971685")]
                            //Create message
                            sHoldInsertAlert = "<ns0:procInsertAlertUserMessage xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:AlertMessage></ns0:AlertMessage><ns0:UserID></ns0:UserID><ns0:MessageTemplateID></ns0:MessageTemplateID><ns0:SourceSystem></ns0:SourceSystem><ns0:Return></ns0:Return><ns0:Message></ns0:Message></ns0:procInsertAlertUserMessage>"; xmlInsertAlertRequest.LoadXml(@sHoldGetAlert); 
                            xmlInsertAlertRequest.LoadXml(@sHoldInsertAlert);
                            Message_InsertAlert = xmlInsertAlertRequest;
                            
                            //Assign  values to message
                            Message_InsertAlert.MessageTemplateID = intAlertTemplateMessageID;
                            Message_InsertAlert.SourceSystem = varSourceSystem; 
                            Message_InsertAlert.UserID = varBasketOwnerID; 
                            Message_InsertAlert.AlertMessage = varAlertMessage;
                            Message_InsertAlert.Message = "xxx";  
                            
                             
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6438d0d2-87c9-4643-9f40-b7674dc531cf")]
                        if (varArchiveInsertAlert == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f20bed5-3eda-4a2c-9813-bed1d4dab35c")]
                            construct Message_InsertAlertArchive
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("cce4254a-655d-41c2-ad42-bca7dc8d4767")]
                                Message_InsertAlertArchive = Message_InsertAlert; 
                                Message_InsertAlertArchive(FILE.ReceivedFileName)="Archive6InsertAlert"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb607493-fb43-4373-a257-a9193e654a9a")]
                            send (Port_ArchiveInsertAlert.Operation_1, Message_InsertAlertArchive);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6caa3814-b748-4013-a024-40f6de9773b5")]
                        send (PortSQL_InsertAlertMessage.procInsertAlertUserMessage, Message_InsertAlert);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c582803c-855b-45e6-b477-1e46e3bd9916")]
                        receive (PortSQL_InsertAlertMessage.procInsertAlertUserMessage, Message_InsertAlertResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a7401750-cb18-4021-95d7-3e700c51abec")]
                        if (varArchiveInsertAlertResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e5c0c890-dc8e-4d19-9387-77ce3186698a")]
                            construct Message_InsertAlertResponseArchive
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8aaded7c-8c54-4a60-97f9-fad6b2f17557")]
                                Message_InsertAlertResponseArchive = Message_InsertAlertResponse; 
                                Message_InsertAlertResponseArchive(FILE.ReceivedFileName)="Archive7InsertAlertResponse"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9d437e6-1409-42ea-abca-b09059af6fde")]
                            send (Port_ArchiveInsertAlertResponse.Operation_1, Message_InsertAlertResponseArchive);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("88ee62c5-60aa-4a75-9e94-3ef78c00b161")]
                        varReturnValue = Message_InsertAlertResponse.ReturnValue; 
                        varReturn = Message_InsertAlertResponse.Return; 
                        varMessage = Message_InsertAlertResponse.Message; 
                        
                        
                        if (varLogging == true)
                        {
                        
                        
                        
                        System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "---Application Variables 5---" +  System.Environment.NewLine +
                                                                                                      "Return: " + varReturn.ToString() + System.Environment.NewLine +
                                                                                                      "ReturnValue: "               + varReturnValue.ToString()    + System.Environment.NewLine + 
                                                                                                      "Message: "             + varMessage              + System.Environment.NewLine  + 
                                                                                                      "BasketOwner: "         + varBasketOwnerID 
                                                                                                  
                                                      
                        
                        
                        
                        );        
                        
                        
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0e275b1d-d773-48d6-aff6-59343e1603a3")]
                        if (varReturn != 0 || varReturnValue != 0 || varAlertMessage.Length == 0    )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e329dacb-bbfb-4c15-8f75-aa9d17cf67dd")]
                            System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "Invalid SQL Response InsertUserAlert: " + System.Environment.NewLine + 
                                                                                                           "Return: " + varReturn.ToString() + System.Environment.NewLine + 
                                                                                                           "ReturnValue: " + varReturnValue.ToString() + System.Environment.NewLine  + 
                                                                                                           "BasketOwner: "         + varBasketOwnerID ); 
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("12fddc6a-104a-4864-8e76-0e66cb4078c7")]
                            send (Port_SMTP_SQLINSERTALERTS.Operation_1, Message_InsertAlertResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7ec14847-2ae1-4b96-854f-e7778edb4b0a")]
                        construct Message_UpdateBasket
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7627fb18-6c02-4072-9ec0-154032a7b470")]
                            //Create message
                            
                            sHoldUpdateBasket = "<ns0:procOrdersSetExpiredQuotations xmlns:ns0=\"http://schemas.microsoft.com/Sql/2008/05/TypedProcedures/dbo\"><ns0:duration></ns0:duration><ns0:basketsummaryid>basketsummaryidbasketsummaryidbasketsummaryidbaske</ns0:basketsummaryid><ns0:Return></ns0:Return><ns0:Message></ns0:Message></ns0:procOrdersSetExpiredQuotations>";
                            xmlUpdateBasketRequest.LoadXml(@sHoldUpdateBasket);
                            Message_UpdateBasket = xmlUpdateBasketRequest;
                            
                            //Assign  values to message
                            Message_UpdateBasket.basketsummaryid = varBasketSummaryID;
                            Message_UpdateBasket.duration = System.Convert.ToInt32(varDuration); 
                            
                            
                             
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c3a6811f-0e88-4f16-9529-0aa2789888bf")]
                        if (varArchiveUpdateBasket == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("384f0eb1-0d58-4f51-aa57-ec5d4ecbd0cb")]
                            construct Message_UpdateBasketArchive
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4dd61bdb-50e0-418e-a1f3-23ff7eeebbe4")]
                                Message_UpdateBasketArchive = Message_UpdateBasket; 
                                Message_UpdateBasketArchive(FILE.ReceivedFileName)="Archive8UpdateBasket"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("faee22aa-ebee-4bd0-9ba8-1ae606db9368")]
                            send (Port_ArchiveUpdateBasket.Operation_1, Message_UpdateBasketArchive);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2e5de936-4621-45a2-b714-868dbdb88c28")]
                        send (PortSQL_UpdateBasket.procOrdersSetExpiredQuotations, Message_UpdateBasket);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("540d2e36-23d3-4347-bbd9-66e2c8311d58")]
                        receive (PortSQL_UpdateBasket.procOrdersSetExpiredQuotations, Message_UpdateBasketResponse);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f3962707-282f-490c-ade8-e9840ce5e47d")]
                        if (varArchiveUpdateBasketResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("67230011-0b0d-44a1-abb3-aba4d606fc26")]
                            construct Message_UpdateBasketResponseArchive
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e33a382-f18a-4b94-83cc-9ad1e3d6da33")]
                                Message_UpdateBasketResponseArchive = Message_UpdateBasketResponse; 
                                Message_UpdateBasketResponseArchive(FILE.ReceivedFileName)="Archive9UpdateBasketResponse"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2335415f-0957-4628-8d7c-44de0a164f63")]
                            send (Port_ArchiveUpdateBAsketResponse.Operation_1, Message_UpdateBasketResponseArchive);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b5f94520-c8f3-470e-b899-46e497762061")]
                        if (varReturn != 0 || varReturnValue != 0 || varAlertTemplateMessage.Length == 0 || varConfigReference.Length == 0 )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e5d0e678-cde3-41ee-b2ea-66c77d03e0d6")]
                            System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredQuotations", "Invalid SQL Response UpdateBasket: " + System.Environment.NewLine + 
                                                                                                           "Return: " + varReturn.ToString() +  System.Environment.NewLine + 
                                                                                                           "ReturnValue: " + varReturnValue.ToString() +  System.Environment.NewLine + 
                                                                                                           "Message: " + varMessage + varMessage);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f467278a-8526-429f-bf99-f70ab2071aa4")]
                            send (Port_SMTP_SQLUPDATEBASKET.Operation_1, Message_UpdateBasketResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("661bf767-ce3b-4f97-8026-51557023b7ed")]
                        intLoopCount = intLoopCount + 1; 
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2c2844a5-7823-41be-a9d3-3015fe743a7a")]
                    catch (System.SystemException ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f19e0f87-488d-4c57-8aca-f580597fdd46")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c5f6e534-45e7-461e-b821-7685b0770047")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="BTNextGen.Biztalk.ExpiredQuotations Exception";
                            FaultMessage.FaultDescription=ex.Message;
                            FaultMessage.FaultCode="3019";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                        }
                    }
                }
            }
        }
    }
}

