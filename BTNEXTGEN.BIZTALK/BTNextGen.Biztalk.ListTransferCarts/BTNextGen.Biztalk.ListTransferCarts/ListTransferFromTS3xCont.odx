#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="a2166b23-bc43-41df-a6bb-a6342e66e80b" LowerBound="1.1" HigherBound="1120.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ListTransferCarts" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="e6c90516-5157-4ffa-b44a-7edb42237e90" ParentLink="Module_PortType" LowerBound="20.1" HigherBound="27.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ListTransferEnhanced" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c20fb477-ccf4-469c-b96d-331b146d3154" ParentLink="PortType_OperationDeclaration" LowerBound="22.1" HigherBound="26.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="46ccfb4b-2b5e-4bf5-aa03-408a0fafa923" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="24.13" HigherBound="24.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="591ecc75-4433-4562-be9d-ede917b7361e" ParentLink="Module_PortType" LowerBound="27.1" HigherBound="34.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendListTransferEnhanced" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="16248f30-b5ff-494e-96f4-2e1520dd5929" ParentLink="PortType_OperationDeclaration" LowerBound="29.1" HigherBound="33.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="fba32e2c-6cfe-4ca3-850f-f4488d1cc9b5" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="31.13" HigherBound="31.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="45598e79-f579-44db-8bb4-a3d6e8111b6f" ParentLink="Module_PortType" LowerBound="34.1" HigherBound="41.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendEmail" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4a57ae09-be94-46c7-b522-7a51adc3a938" ParentLink="PortType_OperationDeclaration" LowerBound="36.1" HigherBound="40.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="ed4f68fd-38b0-4be8-93cb-282dbc6543e4" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="38.13" HigherBound="38.35">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="2a4a1652-3879-4a33-b2fc-7bd08da1bb38" ParentLink="Module_PortType" LowerBound="41.1" HigherBound="48.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendEmailSMTP_ListTransfer" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="72df3b0f-1f01-444a-aede-1b741091c222" ParentLink="PortType_OperationDeclaration" LowerBound="43.1" HigherBound="47.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="4136a7e4-c951-42ee-9fb4-bc9098b6e97d" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="45.13" HigherBound="45.32">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_email" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="7dd3ff13-ef1a-4dcb-a55c-72c7840fef6f" ParentLink="Module_PortType" LowerBound="48.1" HigherBound="55.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveBasketCount" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="6697602e-d890-4b33-aadb-e4c2592ec3ae" ParentLink="PortType_OperationDeclaration" LowerBound="50.1" HigherBound="54.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="02c2441d-0aa0-4b0b-ba87-e29fde7e2ea3" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="52.13" HigherBound="52.32">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.BasketCountResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="5fef8df2-9efe-4a7b-aab0-7e91b2530b71" ParentLink="Module_PortType" LowerBound="55.1" HigherBound="62.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_1" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="eb668ce8-10f8-45cc-9d27-ff1b0e6b02a7" ParentLink="PortType_OperationDeclaration" LowerBound="57.1" HigherBound="61.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="398776a8-0c70-468a-b510-c6c05760d1e9" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="59.13" HigherBound="59.32">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFFEmail" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="78419c15-f3dc-46d9-9ae5-4f6481d15cd7" ParentLink="Module_PortType" LowerBound="62.1" HigherBound="69.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_emailsmtp_lt" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4a42c202-f21e-41a0-a787-9a1eae7455ec" ParentLink="PortType_OperationDeclaration" LowerBound="64.1" HigherBound="68.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0f21afad-4cdd-4622-acc2-73d056429414" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="66.13" HigherBound="66.40">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_emailcomplete" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="141ff495-4633-47c0-9105-e101f4008600" ParentLink="Module_PortType" LowerBound="69.1" HigherBound="76.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_LT2_FaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="e1a9bbbf-6d4a-4764-b9c3-2ed00d4ccb7b" ParentLink="PortType_OperationDeclaration" LowerBound="71.1" HigherBound="75.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0ce5f681-ff9c-4948-a0f1-38e0d729125f" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="73.13" HigherBound="73.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="afe53509-8887-454e-b1dd-bc2c10558778" ParentLink="Module_PortType" LowerBound="76.1" HigherBound="83.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendEmail_LT2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="585b4e6f-1827-421d-ae61-efad6fb5e725" ParentLink="PortType_OperationDeclaration" LowerBound="78.1" HigherBound="82.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="d2af2b50-6d76-40d5-b509-8448ade55b5b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="80.13" HigherBound="80.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="409c1483-1acf-4bf3-ac61-8d19b75ca08b" ParentLink="Module_PortType" LowerBound="83.1" HigherBound="90.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveSQL3" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="eec1957a-276d-43f1-9516-873e89055148" ParentLink="PortType_OperationDeclaration" LowerBound="85.1" HigherBound="89.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="e16762af-90a6-4950-a367-daa2f42c4b26" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="87.13" HigherBound="87.71">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="9998b6ab-a930-4f2e-9e8c-bddfb9c80001" ParentLink="Module_PortType" LowerBound="90.1" HigherBound="97.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SQL2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="77e6637c-a035-46c5-993f-45e55af4c9f8" ParentLink="PortType_OperationDeclaration" LowerBound="92.1" HigherBound="96.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procListTransferInsertBaskets" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="0f64ae3e-9a22-4147-99c8-14db24eb2153" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="94.73" HigherBound="94.139">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="6b1fd459-06ec-4abc-94f6-41d46884f4eb" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="94.13" HigherBound="94.71">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="73953771-d182-483a-9da0-a6a0ecad730a" ParentLink="Module_PortType" LowerBound="97.1" HigherBound="104.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveSQL42" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="919ad193-57f7-4dd0-8097-022fdd79ff95" ParentLink="PortType_OperationDeclaration" LowerBound="99.1" HigherBound="103.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="2e151075-e07e-4e08-9065-3445c59bf695" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="101.13" HigherBound="101.79">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="64bccf19-b6ec-4e77-ac24-3fb79477beca" ParentLink="Module_PortType" LowerBound="104.1" HigherBound="111.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SQLGET" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="51fc58ce-f4d8-423d-b82a-06811b8ac742" ParentLink="PortType_OperationDeclaration" LowerBound="106.1" HigherBound="110.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procListTransferGetLineWarningsLog" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="eb94beab-31ec-430f-bbcf-c9cd3614654c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="108.13" HigherBound="108.75">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLog" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="de3b2d94-34d8-4cb2-8326-1ac1c108a672" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="108.77" HigherBound="108.147">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLogResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="92ec4024-1bf7-4c11-91ef-181966e56fd6" ParentLink="Module_PortType" LowerBound="111.1" HigherBound="118.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveSQLGET" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="89d87b69-2251-4d76-a8bf-3220c6960c59" ParentLink="PortType_OperationDeclaration" LowerBound="113.1" HigherBound="117.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="b8dd3a0e-fb73-4f57-95bb-92add798e6b9" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="115.13" HigherBound="115.75">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLog" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="20901839-06fa-4514-a968-8c72c5185d5d" ParentLink="Module_PortType" LowerBound="118.1" HigherBound="125.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveSQLGetresponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="38611c98-193b-4f92-8451-b2ea1a67dfa0" ParentLink="PortType_OperationDeclaration" LowerBound="120.1" HigherBound="124.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="170ab024-ef05-4287-8bbf-7cca0efb7aba" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="122.13" HigherBound="122.83">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLogResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="7d57f492-a870-41e2-bd30-7843727b5ce2" ParentLink="Module_PortType" LowerBound="125.1" HigherBound="132.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Archive7EmailFTP" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="738d1c33-6197-4c2f-8892-30da7112618b" ParentLink="PortType_OperationDeclaration" LowerBound="127.1" HigherBound="131.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="16866514-c3c8-4fea-b9fc-92724cf184f8" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="129.13" HigherBound="129.35">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="bc6c8103-57b2-4db0-ae43-8ed96ba7ab9a" ParentLink="Module_PortType" LowerBound="132.1" HigherBound="139.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_EmailFF" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c81b7b17-470f-482a-beb5-706d68019378" ParentLink="PortType_OperationDeclaration" LowerBound="134.1" HigherBound="138.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="36ff33fd-6b79-4330-8694-88bfb61d4aa5" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="136.13" HigherBound="136.42">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_emailcompleteFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="77f7b6e5-f2b5-4085-8aab-5b4848c1e4d1" ParentLink="Module_PortType" LowerBound="139.1" HigherBound="146.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_XMLUSERCHK" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="7c919afa-3c17-49fc-bb26-61d6d81b9448" ParentLink="PortType_OperationDeclaration" LowerBound="141.1" HigherBound="145.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procTS360APIValidateUser" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="3dc5d1d2-9ee1-480c-b652-af1470c28963" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="143.13" HigherBound="143.56">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUser" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="833da622-c037-4029-8a50-a4a571c8a51d" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="143.58" HigherBound="143.109">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUserResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="cfc922b2-4311-4861-aea1-02416840bf79" ParentLink="Module_ServiceDeclaration" LowerBound="146.1" HigherBound="1119.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ListTransferFromTS3_Cont" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="VariableDeclaration" OID="0f74bc66-7cb1-41e5-a3c6-57112b7d24c4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="211.1" HigherBound="212.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="False" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e9e5b092-e153-43f8-9475-94bf5bf77c18" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="212.1" HigherBound="213.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="237be24c-40ae-4175-af8e-b43156371f23" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="213.1" HigherBound="214.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailAddress" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="33dc8041-48ce-4ff2-b600-fb3b9d75601f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="214.1" HigherBound="215.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPFrom" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5e9c5678-0011-431b-ae1a-084c64c9aede" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="215.1" HigherBound="216.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPTo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5e202e0a-beb8-4043-8162-1748b0a3e987" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="216.1" HigherBound="217.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPHost" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="353f5a55-ff68-407b-a03d-17418f30cdea" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="217.1" HigherBound="218.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUserID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a31f0ed7-6c0c-4317-9e92-70206aa3510e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="218.1" HigherBound="219.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c89871fc-4736-4961-88a5-14045ec00682" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="219.1" HigherBound="220.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e04b15c7-ef9a-4c52-8eec-b60420f239e5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="220.1" HigherBound="221.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f20876e3-9b88-4ddb-b373-e53bdf1ea9f9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="221.1" HigherBound="222.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b3e86921-68b3-4cd3-9da7-b831368f8705" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="222.1" HigherBound="223.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFilename" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="62159919-2850-4e77-a796-28829b34eaa5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="223.1" HigherBound="224.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLineReceivedCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9eb0c4f3-cfd0-4a93-b7c9-496f85fa113d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="224.1" HigherBound="225.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLineReceivedCountString" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3bfd7a5e-1a0f-4639-a9d2-b8d1bdc06f3a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="225.1" HigherBound="226.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLineInsertedCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="44c73f99-6e94-4205-b376-d98432691304" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="226.1" HigherBound="227.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varXpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0e892f27-d758-4950-8cfb-680197da1c36" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="227.1" HigherBound="228.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="33237615-3218-4cc0-991b-967703d018b4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="228.1" HigherBound="229.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCartName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="353dab48-8e11-468a-8411-72613e75b7c8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="229.1" HigherBound="230.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSourceSystem" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="28e19a1c-c683-4bc8-9a5a-aa908332f111" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="230.1" HigherBound="231.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDestinationAction" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f0130321-801a-4fc3-9257-b41de45cd585" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="231.1" HigherBound="232.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varXMLFromFTP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fc9d6283-b2cc-49d4-8a05-8ca3c62f1732" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="232.1" HigherBound="233.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varXMLFromFTPDirectory" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3fbcf3e5-c636-4f86-8bcf-5245de441fea" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="233.1" HigherBound="234.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPCC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="614a7e6e-89cb-486a-b3d6-7a9c7de5a55c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="234.1" HigherBound="235.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive5" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="78eb8a8a-cd7b-48a2-b35b-d009f02b0bc3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="235.1" HigherBound="236.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive6" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6587e627-e080-4a70-a27b-21f738f99186" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="236.1" HigherBound="237.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailSMTP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7743dc49-c454-4eb0-83c8-8e5765ad5be7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="237.1" HigherBound="238.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3a120e33-5df5-45fb-87a8-1c5d7557f383" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="238.1" HigherBound="239.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6636ec9f-2f22-48fd-866d-8ef7cd762a7a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="239.1" HigherBound="240.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Variable_1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ebbda910-d326-4861-9c98-93f1186a2003" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="240.1" HigherBound="241.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketGuid" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c712964d-7177-47a1-a9d8-250aef9ff1a0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="241.1" HigherBound="242.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPBiztalk" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="220c93d6-aa07-4289-ac45-6564e1fcc462" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="242.1" HigherBound="243.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive7" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="64706f18-1fc7-4006-8da5-2789bafe382e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="243.1" HigherBound="244.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varfilenameNew" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d6c37303-eeb6-4538-b9f5-314f21663a81" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="244.1" HigherBound="245.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAllowedSourceSystems" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a2b4b59a-60d0-4887-99c7-3e844602fce0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="245.1" HigherBound="246.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAllowedSourceIndicator" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="11e91164-9a8e-451b-b22b-a8f449b7204b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="246.1" HigherBound="247.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAllowedDestinationActions" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4c0697b2-9025-473d-8369-adce76102c12" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="247.1" HigherBound="248.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAllowedDestinationActionsIndicator" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="de28e62f-dd70-4950-a045-0d4c0432e6cb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="248.1" HigherBound="249.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReference" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e7e31178-c92c-46fb-8c70-ad85dfdd7f0a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="249.1" HigherBound="250.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFILEFROMFTP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8e828fe2-91e7-4533-884e-9e47f25a05ac" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="250.1" HigherBound="251.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFileLocation" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="acd020b4-9517-4258-ab4d-ddef2e1f4f0e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="251.1" HigherBound="252.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketLineOverallLimit" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="89c433df-6213-4237-b270-d02818f27120" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="252.1" HigherBound="253.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketLineSplitLimit" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1805192a-a278-44a0-80a9-37e7f999a6f5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="253.1" HigherBound="254.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCSGUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5f822a7e-4e33-4b5c-994d-62bc39bf63bc" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="254.1" HigherBound="255.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailAddressCC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="62ecd104-dac4-4217-bf7b-64d9dd74baba" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="255.1" HigherBound="256.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPCCTemp1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4d3624c7-3aeb-47fe-8093-e47b20c075ac" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="256.1" HigherBound="257.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPCCTemp2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2bc39e0e-1bf0-4a41-bb1b-c5cee08b9e3d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="257.1" HigherBound="258.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varGroupName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9994e561-36da-4080-b604-4856035f9fcc" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="258.1" HigherBound="259.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBasketName2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cfd15b1b-e281-4946-8299-739accb6f1db" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="259.1" HigherBound="260.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUserFolder" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ba96a969-0d79-4183-94a2-bfa40969c22c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="185.1" HigherBound="186.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ab1afbce-df91-4437-a44c-dcaf6b5a1303" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="186.1" HigherBound="187.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ListCartSchema" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="70b91c6f-3f05-4eb7-b63f-ea79c142c0c5" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="187.1" HigherBound="188.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Email" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="0250ab2a-f39f-488c-8872-f0eff337637e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="188.1" HigherBound="189.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_email" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="emailMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ca9e8d2e-c7d5-46b4-a583-f32943fc77e9" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="189.1" HigherBound="190.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageArchive2ListCartSchema" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9e757444-5a10-4dae-b242-60e572301b67" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="190.1" HigherBound="191.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.BasketCountResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_BasketCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="821fe4a5-8315-4390-af1f-c799ec7151d8" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="191.1" HigherBound="192.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFFEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_EmailFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ffe4176b-8a75-4599-a42a-7aeaccdbd447" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="192.1" HigherBound="193.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferCartsWarnings" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Warnings" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cacc0d54-5c52-4963-99a3-14e4bcd016d1" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="193.1" HigherBound="194.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_emailcomplete" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="emailMsgComplete" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="7aa11b7e-ab76-48cf-a8ea-f456710b4349" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="194.1" HigherBound="195.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.IProfilesR2_VerifyUserPassword_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="verifyPwdReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cd909cfe-3411-4db7-9fcc-be6dd5fc45d4" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="195.1" HigherBound="196.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.IProfilesR2_VerifyUserPassword_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="verifyPwdResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="f4fd6e56-bfff-4a53-a358-6aa1faa7d34d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="196.1" HigherBound="197.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.BasketCountResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageArchive5BasketCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="bca59a24-49e2-4856-a500-4f6a9e6f0fd3" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="197.1" HigherBound="198.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFFEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageArchive6EmailFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="db44f236-6c5f-45bc-9b3f-0ee53b7a32f5" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="198.1" HigherBound="199.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ToSQL2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="94dff96a-3b66-43d2-9c9e-3220e2d5e93a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="199.1" HigherBound="200.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive3SQLRequest2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d8a6f64f-1217-42df-a744-f6f1ffb2a534" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="200.1" HigherBound="201.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_FromSQL2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e320cb99-f893-457c-ae26-37397da5d6fd" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="201.1" HigherBound="202.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive4SQLResponse2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5e34ec05-d38f-4d6c-9586-68d3717eaffe" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="202.1" HigherBound="203.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLog" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_SQLGET" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1006b331-eaaa-448c-98af-117924a00fea" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="203.1" HigherBound="204.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLogResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_SQLGETRESPONSE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5f7dcdf4-da8b-493b-beb7-8b516e57cea3" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="204.1" HigherBound="205.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive7EmailFTP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="3b0a9d07-fc5d-4ea2-afa2-ec023a4b96fb" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="205.1" HigherBound="206.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_emailcompleteFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="emailMsgCompleteFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="0a99e20c-21af-4347-80f5-43718433441d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="206.1" HigherBound="207.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ListCartSchema2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5ee3e951-48b5-4b49-bd2f-072a0709c258" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="207.1" HigherBound="208.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_XMLDummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d893303a-6f76-4f55-9a82-c171e7a45341" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="208.1" HigherBound="209.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchemaIntermediate" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ListCartSchemaIXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="74c68457-d408-47df-a810-1e40e05854db" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="209.1" HigherBound="210.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUser" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgVerifyUserEmailSqlReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="af636305-db2f-46f1-abd2-cb01a77996c3" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="210.1" HigherBound="211.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUserResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgVerifyUserEmailSqlResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="f464c2b2-e822-4e2a-9666-9db51e8d0432" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="2e46e9c8-afee-40c2-8f10-948fe6a95806" ParentLink="ServiceBody_Statement" LowerBound="262.1" HigherBound="308.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="ReceiveListTransferEnhanced" />
                    <om:Property Name="MessageName" Value="Message_ListCartSchema" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_ListCartXML" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="d528f154-8b25-429a-9773-51df7cf438f5" ParentLink="ServiceBody_Statement" LowerBound="308.1" HigherBound="1117.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main2" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableAssignment" OID="b4821af8-80b8-4f4f-b349-53f12558ac74" ParentLink="ComplexStatement_Statement" LowerBound="313.1" HigherBound="404.1">
                        <om:Property Name="Expression" Value="varArchive2=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive2&quot;));&#xD;&#xA;varArchive3=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive3&quot;));&#xD;&#xA;varArchive4=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive4&quot;));&#xD;&#xA;varArchive5=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive5&quot;));&#xD;&#xA;varArchive6=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive6&quot;));&#xD;&#xA;varArchive7=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive7&quot;));&#xD;&#xA;varAllowedSourceSystems=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;AllowedSourceSystems&quot;));&#xD;&#xA;varAllowedDestinationActions=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;AllowedDestinationActions&quot;));&#xD;&#xA;varEmailSMTP=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;EmailExceptions&quot;));&#xD;&#xA;varXMLFromFTPDirectory=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ListTransfer&quot;,&quot;XMLFromFTPLocalDirectory&quot;);&#xD;&#xA;varSMTPHost=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPHost&quot;));&#xD;&#xA;&#xD;&#xA;varSMTPFrom=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPFrom&quot;));&#xD;&#xA;varSMTPBiztalk=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPBiztalk&quot;));&#xD;&#xA;&#xD;&#xA;varBasketLineOverallLimit=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;BasketLineOverallLimit&quot;));&#xD;&#xA;varBasketLineSplitLimit=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;BasketLineSplitLimit&quot;));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varBasketName = xpath(Message_ListCartSchema,&quot;string(//CartName)&quot;);&#xD;&#xA;&#xD;&#xA;varUserFolder=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;UserFolder&quot;));&#xD;&#xA;&#xD;&#xA;varEmailAddress = xpath(Message_ListCartSchema,&quot;string(//UserEmail)&quot;);&#xD;&#xA;varEmailAddressCC = xpath(Message_ListCartSchema,&quot;string(//UserEmailCC)&quot;);&#xD;&#xA;varSMTPCCTemp1=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPCC&quot;));&#xD;&#xA;// if EmailCC exists, combine with biztalk CC parameters, otherwise just use biztalk CC parameter &#xD;&#xA;if (varEmailAddressCC.Length &gt; 0 ) &#xD;&#xA;{  &#xD;&#xA;    varSMTPCCTemp2 = varEmailAddressCC.Replace(&quot;,&quot;, &quot;;&quot;); &#xD;&#xA;    varSMTPCC=varSMTPCCTemp1 + &quot;;&quot; + varSMTPCCTemp2; &#xD;&#xA;}&#xD;&#xA;else &#xD;&#xA;{&#xD;&#xA;    varSMTPCC=varSMTPCCTemp1;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;email&quot;, varEmailAddress.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;email2&quot;, varEmailAddressCC.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;email3&quot;, varSMTPCC.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varUserID = xpath(Message_ListCartSchema,&quot;string(//DestinationUserID)&quot;);&#xD;&#xA;varReference = xpath(Message_ListCartSchema,&quot;string(//Reference)&quot;);&#xD;&#xA;varLineReceivedCount = System.Convert.ToInt32(xpath(Message_ListCartSchema, &quot;count(//Details)&quot;));&#xD;&#xA;&#xD;&#xA;varFileLocation = Message_ListCartSchema(BTS.InboundTransportLocation);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filepath&quot;, varFileLocation.ToString());&#xD;&#xA;&#xD;&#xA;varFilename = Message_ListCartSchema(FILE.ReceivedFileName);&#xD;&#xA;&#xD;&#xA;varfilenameNew = varFilename.Substring(varFilename.LastIndexOf(@&quot;\&quot;) + 1);&#xD;&#xA;&#xD;&#xA;varXMLFromFTP = varFileLocation.IndexOf(varXMLFromFTPDirectory,0);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename&quot;, varFilename.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename&quot;, varfilenameNew.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename3&quot;, varFilename);&#xD;&#xA;varFilename = varFilename.Substring(varFilename.LastIndexOf(@&quot;\&quot;) + 1);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename4&quot;, varFilename);&#xD;&#xA;varFilename = varFilename.Substring(0,varFilename.LastIndexOf(@&quot;.xml&quot;));&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename5&quot;, varFilename);&#xD;&#xA;&#xD;&#xA;varDestinationAction = xpath(Message_ListCartSchema,&quot;string(//DestinationAction)&quot;);&#xD;&#xA;varSourceSystem =  xpath(Message_ListCartSchema,&quot;string(//SourceSystem)&quot;);&#xD;&#xA;varCartName =  xpath(Message_ListCartSchema,&quot;string(//CartName)&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//make uppercase&#xD;&#xA;varAllowedSourceSystems = varAllowedSourceSystems.ToUpper();&#xD;&#xA;varAllowedDestinationActions = varAllowedDestinationActions.ToUpper();&#xD;&#xA;&#xD;&#xA;varSourceSystem = varSourceSystem.ToUpper();&#xD;&#xA;varDestinationAction = varDestinationAction.ToUpper();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//determine if value exists within string&#xD;&#xA;varAllowedSourceIndicator = varAllowedSourceSystems.IndexOf(varSourceSystem);&#xD;&#xA;varAllowedDestinationActionsIndicator = varAllowedDestinationActions.IndexOf(varDestinationAction);&#xD;&#xA;&#xD;&#xA;varGroupName =  xpath(Message_ListCartSchema,&quot;string(//GroupName)&quot;);&#xD;&#xA;&#xD;&#xA;if (varGroupName.Length &gt; 0 ) &#xD;&#xA;  { varBasketName2 = varGroupName + &quot;_&quot; + varBasketName; } &#xD;&#xA;else &#xD;&#xA;   { varBasketName2 = varSourceSystem + &quot;_&quot; + varBasketName; } &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getSSO" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="5f7e1cc7-4b47-49e2-be20-9d40f06669d2" ParentLink="ComplexStatement_Statement" LowerBound="404.1" HigherBound="579.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CheckReceiveLocation" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="b3f236fd-1f65-42b1-8afa-a22b52fc5961" ParentLink="ReallyComplexStatement_Branch" LowerBound="405.21" HigherBound="579.1">
                            <om:Property Name="Expression" Value="varXMLFromFTP &gt; 0" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_FromFTPReceiveLocation" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Decision" OID="8eb37c93-e2e1-476e-9fac-9872be422087" ParentLink="ComplexStatement_Statement" LowerBound="407.1" HigherBound="422.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_Archive7" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="74e3398d-2e77-4df4-9f93-f4986ee5d5f3" ParentLink="ReallyComplexStatement_Branch" LowerBound="408.25" HigherBound="422.1">
                                    <om:Property Name="Expression" Value="varArchive7 == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="Archive7Message" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="9c27d9cd-a8b6-4fe0-89d0-d239a370e051" ParentLink="ComplexStatement_Statement" LowerBound="410.1" HigherBound="419.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchive7Message" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="75a8fd0f-8c56-457c-8d15-9258471655c6" ParentLink="Construct_MessageRef" LowerBound="411.39" HigherBound="411.63">
                                            <om:Property Name="Ref" Value="Message_Archive7EmailFTP" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="37d63eb3-7561-4f2a-8edb-2cdba8b9f197" ParentLink="Construct_MessageRef" LowerBound="411.65" HigherBound="411.78">
                                            <om:Property Name="Ref" Value="Message_Email" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="ef447a30-79e4-4d92-b01a-9f1dd7f5d239" ParentLink="ComplexStatement_Statement" LowerBound="413.1" HigherBound="415.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_Email" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="fd0ec515-417a-492a-b581-6018fe41846c" ParentLink="Transform_OutputMessagePartRef" LowerBound="414.44" HigherBound="414.57">
                                                <om:Property Name="MessageRef" Value="Message_Email" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_20" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="d037ec25-0ced-4974-a7f7-87369b55e2cf" ParentLink="Transform_InputMessagePartRef" LowerBound="414.114" HigherBound="414.136">
                                                <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_19" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="2653d3f7-56af-4aec-aee0-79712855c7be" ParentLink="ComplexStatement_Statement" LowerBound="415.1" HigherBound="418.1">
                                            <om:Property Name="Expression" Value="Message_Archive7EmailFTP = Message_Email; &#xD;&#xA;Message_Archive7EmailFTP(FILE.ReceivedFileName)=varfilenameNew; &#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="dc42fa5a-72c2-43c9-acf7-39fac23e2d86" ParentLink="ComplexStatement_Statement" LowerBound="419.1" HigherBound="421.1">
                                        <om:Property Name="PortName" Value="Port_Archive7EmailFTP" />
                                        <om:Property Name="MessageName" Value="Message_Email" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_ArchiveEmailFTP" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="149a15f0-5f9d-45c4-a633-e5c6d067f443" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="246d764b-437a-4ffb-9815-31ba71b45501" ParentLink="ComplexStatement_Statement" LowerBound="422.1" HigherBound="426.1">
                                <om:Property Name="Expression" Value="//varCSGUID=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; &#xD;&#xA;varEmailAddress = xpath(Message_ListCartSchema,&quot;string(//UserEmail)&quot;);&#xD;&#xA;varUserID = xpath(Message_ListCartSchema,&quot;string(//DestinationUserID)&quot;);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="assignvariables" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="6787c844-a6f9-43f0-be1f-dff5afc12c46" ParentLink="ComplexStatement_Statement" LowerBound="426.1" HigherBound="578.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CheckUserandEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="44e1b350-b6e0-4cd0-8343-a59ac2e10fc9" ParentLink="ReallyComplexStatement_Branch" LowerBound="427.25" HigherBound="527.1">
                                    <om:Property Name="Expression" Value="varEmailAddress.Length &gt; 0 &amp;&amp; varUserID.Length &gt; 0 " />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_CheckUserandEmail" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="536be139-c6dd-48c8-87c4-4ad5f5936a61" ParentLink="ComplexStatement_Statement" LowerBound="429.1" HigherBound="435.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Cons_VerifyUserEmailRequest" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="99095f81-815d-4c24-bc2e-e39b716a1328" ParentLink="Construct_MessageRef" LowerBound="430.39" HigherBound="430.63">
                                            <om:Property Name="Ref" Value="msgVerifyUserEmailSqlReq" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="39bc67f8-c18f-49e5-ab0b-bb52b7b9e869" ParentLink="ComplexStatement_Statement" LowerBound="432.1" HigherBound="434.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_VerifyUserEmail" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_VerifyUserEmail" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="6ec56b79-4eaf-458b-bb93-8c6cd7865568" ParentLink="Transform_InputMessagePartRef" LowerBound="433.135" HigherBound="433.157">
                                                <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_9" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="544398fe-fdac-449d-89ef-878f12575b83" ParentLink="Transform_OutputMessagePartRef" LowerBound="433.44" HigherBound="433.68">
                                                <om:Property Name="MessageRef" Value="msgVerifyUserEmailSqlReq" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_10" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="9d201834-73e6-4ed7-89a7-7bde38cf938a" ParentLink="ComplexStatement_Statement" LowerBound="435.1" HigherBound="437.1">
                                        <om:Property Name="PortName" Value="Port_SQLXMLUSERCHK" />
                                        <om:Property Name="MessageName" Value="msgVerifyUserEmailSqlReq" />
                                        <om:Property Name="OperationName" Value="procTS360APIValidateUser" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Request" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Receive" OID="fac21367-c7ca-46e0-afca-4a98df1a4703" ParentLink="ComplexStatement_Statement" LowerBound="437.1" HigherBound="439.1">
                                        <om:Property Name="Activate" Value="False" />
                                        <om:Property Name="PortName" Value="Port_SQLXMLUSERCHK" />
                                        <om:Property Name="MessageName" Value="msgVerifyUserEmailSqlResponse" />
                                        <om:Property Name="OperationName" Value="procTS360APIValidateUser" />
                                        <om:Property Name="OperationMessageName" Value="Response" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Receive_Response" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="0b529bf2-1395-4318-a82a-96bfbf9749e3" ParentLink="ComplexStatement_Statement" LowerBound="439.1" HigherBound="443.1">
                                        <om:Property Name="Expression" Value="varCSGUID=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; &#xD;&#xA;//varEmailAddress = xpath(Message_ListCartSchema,&quot;string(//UserEmail)&quot;);&#xD;&#xA;//varUserID = xpath(Message_ListCartSchema,&quot;string(//DestinationUserID)&quot;);" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="assignvariables" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Decision" OID="f1d9ea09-6fe9-4c22-bc68-34a649d6b0f6" ParentLink="ComplexStatement_Statement" LowerBound="443.1" HigherBound="526.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Decide_1" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="DecisionBranch" OID="dd7029e9-2413-4fb4-a45c-437d25afeef2" ParentLink="ReallyComplexStatement_Branch" LowerBound="444.29" HigherBound="473.1">
                                            <om:Property Name="Expression" Value="varCSGUID != null" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Rule_ValidUser" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Construct" OID="d6bfe50f-94ef-4116-b42e-3ad0dc4e3f30" ParentLink="ComplexStatement_Statement" LowerBound="446.1" HigherBound="459.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_AddinGUID" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="b54c5278-f325-4451-bb8e-90ac6a886ab3" ParentLink="Construct_MessageRef" LowerBound="447.43" HigherBound="447.66">
                                                    <om:Property Name="Ref" Value="Message_ListCartSchema2" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="61a61e1f-fc1d-4459-bcbf-6c1b162f651a" ParentLink="ComplexStatement_Statement" LowerBound="449.1" HigherBound="451.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_AddInGuid" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_AddInGuid" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="b92d3b6a-978d-4ce5-9214-effe7634af19" ParentLink="Transform_InputMessagePartRef" LowerBound="450.132" HigherBound="450.154">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_27" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="d9dab78f-12eb-41eb-98e5-2b4af02571a3" ParentLink="Transform_OutputMessagePartRef" LowerBound="450.48" HigherBound="450.71">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema2" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_28" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="7fd5f211-f56e-4d1a-87bf-23e9ea581fef" ParentLink="ComplexStatement_Statement" LowerBound="451.1" HigherBound="458.1">
                                                    <om:Property Name="Expression" Value="//Message_XMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;//Message_XMLDummy.LoadXml(@&quot;&lt;Dummy xmlns=&quot;&quot;http://tempuri.org/&quot;&quot;&gt;&lt;DummyX xmlns:a=&quot;&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders&quot;&quot; xmlns:i=&quot;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&quot;&gt;&lt;a:BasketDetailsResponse&gt;&lt;a:ErrorMessage&gt; &lt;/a:ErrorMessage&gt;&lt;a:LegacyBasketId&gt;13759439&lt;/a:LegacyBasketId&gt;&lt;a:LegacySourceSystem&gt;TS3&lt;/a:LegacySourceSystem&gt;&lt;a:LoadStatus&gt;Loaded&lt;/a:LoadStatus&gt;&lt;/a:BasketDetailsResponse&gt;&lt;/DummyX&gt;&lt;/Dummy&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//Message_ListCartSchema2 = Message_XMLDummy;&#xD;&#xA;Message_ListCartSchema2.csUserGuid=varCSGUID; &#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Construct" OID="0ce0ede8-58bc-4c8a-84ff-881a9020dfe0" ParentLink="ComplexStatement_Statement" LowerBound="459.1" HigherBound="472.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_1" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="2a94597b-0e31-4d3e-8fa3-c2536cedbe5d" ParentLink="Construct_MessageRef" LowerBound="460.43" HigherBound="460.65">
                                                    <om:Property Name="Ref" Value="Message_ListCartSchema" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="e4b8905d-0527-4a9e-864e-f441027ad0fc" ParentLink="Construct_MessageRef" LowerBound="460.67" HigherBound="460.83">
                                                    <om:Property Name="Ref" Value="Message_XMLDummy" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="d81dbe0a-4336-458e-b767-7a85048ad7c6" ParentLink="ComplexStatement_Statement" LowerBound="462.1" HigherBound="469.1">
                                                    <om:Property Name="Expression" Value="Message_XMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;Message_XMLDummy.LoadXml(@&quot;&lt;Dummy xmlns=&quot;&quot;http://tempuri.org/&quot;&quot;&gt;&lt;DummyX xmlns:a=&quot;&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders&quot;&quot; xmlns:i=&quot;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&quot;&gt;&lt;a:BasketDetailsResponse&gt;&lt;a:ErrorMessage&gt; &lt;/a:ErrorMessage&gt;&lt;a:LegacyBasketId&gt;13759439&lt;/a:LegacyBasketId&gt;&lt;a:LegacySourceSystem&gt;TS3&lt;/a:LegacySourceSystem&gt;&lt;a:LoadStatus&gt;Loaded&lt;/a:LoadStatus&gt;&lt;/a:BasketDetailsResponse&gt;&lt;/DummyX&gt;&lt;/Dummy&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_ListCartSchema = Message_XMLDummy;&#xD;&#xA;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="dca3c5b1-3b9b-4e1d-8815-6f32b4338a9e" ParentLink="ComplexStatement_Statement" LowerBound="469.1" HigherBound="471.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_1" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="790b5f89-7435-4def-af48-80fcf16e953e" ParentLink="Transform_InputMessagePartRef" LowerBound="470.123" HigherBound="470.146">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema2" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_31" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="0b5295fd-c3ae-480e-bdd9-812fa23f9d44" ParentLink="Transform_OutputMessagePartRef" LowerBound="470.48" HigherBound="470.70">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_32" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="18cac5a3-50f3-42b4-a199-ff2fb4f1a845" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="94f3e5bf-781a-400e-8eaa-098f532f9f57" ParentLink="ComplexStatement_Statement" LowerBound="475.1" HigherBound="477.1">
                                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;,&quot;Invalid UserID/Email&quot;);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="LOG ERROR" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="9eaee52e-ed6c-48ac-a87c-d527f72b844f" ParentLink="ComplexStatement_Statement" LowerBound="477.1" HigherBound="521.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="73679a67-182c-45de-b3bd-68f3cf68a9dc" ParentLink="Construct_MessageRef" LowerBound="478.43" HigherBound="478.56">
                                                    <om:Property Name="Ref" Value="Message_Email" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="3d37ee42-5e72-44d4-be94-70fc41863cdd" ParentLink="Construct_MessageRef" LowerBound="478.58" HigherBound="478.74">
                                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="0cccbc46-ec7e-4b34-b710-99102edd39d3" ParentLink="ComplexStatement_Statement" LowerBound="480.1" HigherBound="482.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_Email" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="462ed9dc-2c2b-42ab-bb16-c4c7491f50f1" ParentLink="Transform_InputMessagePartRef" LowerBound="481.118" HigherBound="481.140">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_13" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="b5b9193d-e443-4b3d-aaf7-195a3cbfc315" ParentLink="Transform_OutputMessagePartRef" LowerBound="481.48" HigherBound="481.61">
                                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_14" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="8a756edd-0109-4f86-ab91-7104576074ad" ParentLink="ComplexStatement_Statement" LowerBound="482.1" HigherBound="520.1">
                                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, the userid / email provided was invalid.&quot;); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;UserID: &quot; + varUserID); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Email : &quot; + varEmailAddress); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Please note, the userid and email can fail for the following reason(s):&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;1. The Userid is mistyped or does not exist.&quot;); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;2. The Email address is mistyped or does not exist. &quot;  );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;3. The Email address must correspond to the email address on file for the Userid. &quot;); &#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="a232b684-a60a-4aa7-9854-cc0c0613fb5b" ParentLink="ComplexStatement_Statement" LowerBound="521.1" HigherBound="523.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Terminate" OID="4314dcd2-fcba-4710-97fa-41acc07c9f54" ParentLink="ComplexStatement_Statement" LowerBound="523.1" HigherBound="525.1">
                                                <om:Property Name="ErrorMessage" Value="&quot;Process terminated due to bad userid / email&quot;;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Terminate_BadUserId" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="dae7bfd8-4bd8-4623-914a-dd534b9faa7e" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="VariableAssignment" OID="64d968ce-7f33-4093-b6fb-a271f2eb0ec7" ParentLink="ComplexStatement_Statement" LowerBound="529.1" HigherBound="531.1">
                                        <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;,&quot;Invalid UserID/Email&quot;);" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="LOG ERROR" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="b35ae1bd-dee1-421a-b8bb-ddd380531d93" ParentLink="ComplexStatement_Statement" LowerBound="531.1" HigherBound="573.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="e18130e6-b0be-443f-8799-4b876d81a304" ParentLink="Construct_MessageRef" LowerBound="532.39" HigherBound="532.52">
                                            <om:Property Name="Ref" Value="Message_Email" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="0349b3c4-4f51-4f2d-8515-8ba1860e97f8" ParentLink="Construct_MessageRef" LowerBound="532.54" HigherBound="532.70">
                                            <om:Property Name="Ref" Value="emailMsgComplete" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="91f7ac48-9910-46e7-b9a0-a456967a330d" ParentLink="ComplexStatement_Statement" LowerBound="534.1" HigherBound="536.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_Email" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="8b5e0e0b-cecf-4743-8c3e-8920642ed8b9" ParentLink="Transform_InputMessagePartRef" LowerBound="535.114" HigherBound="535.136">
                                                <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_13" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="3b3e025b-b0bd-4c58-aac7-c99fcd5efabf" ParentLink="Transform_OutputMessagePartRef" LowerBound="535.44" HigherBound="535.57">
                                                <om:Property Name="MessageRef" Value="Message_Email" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_14" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="da15535b-da0e-4136-94e8-bfc51f611f4f" ParentLink="ComplexStatement_Statement" LowerBound="536.1" HigherBound="572.1">
                                            <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, the userid / email provided was missing :&quot;); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;UserID: &quot; + varUserID); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Email : &quot; + varEmailAddress); &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="4dfba0cc-ff5d-443d-94b9-6cb20c71e800" ParentLink="ComplexStatement_Statement" LowerBound="573.1" HigherBound="575.1">
                                        <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                        <om:Property Name="MessageName" Value="emailMsgComplete" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_EmailSMTP" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Terminate" OID="dd7d8206-c3ce-484e-9774-d036c4636716" ParentLink="ComplexStatement_Statement" LowerBound="575.1" HigherBound="577.1">
                                        <om:Property Name="ErrorMessage" Value="&quot;Process terminated due to bad userid / email&quot;;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Terminate_BadUserId" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="7413c78d-a9bf-41fe-8057-e62c2e4d7b6a" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="62ceb7d8-9d6d-4f1e-8d99-1f535499c28a" ParentLink="ComplexStatement_Statement" LowerBound="579.1" HigherBound="721.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CheckForRequiredFields" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="c8308c9a-58fe-4c54-988c-06ba8c27ce79" ParentLink="ReallyComplexStatement_Branch" LowerBound="580.21" HigherBound="628.1">
                            <om:Property Name="Expression" Value="varBasketName.Length &lt; 1 || varBasketName.Length &gt; 81&#xD;&#xA;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Basket" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="a8feae1d-9ebc-414b-bbc7-ce3b75ce3e85" ParentLink="ComplexStatement_Statement" LowerBound="582.1" HigherBound="623.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="835d631e-c48b-4aa7-a8ee-bcef8bbb656e" ParentLink="Construct_MessageRef" LowerBound="583.35" HigherBound="583.48">
                                    <om:Property Name="Ref" Value="Message_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="6a23169d-9f54-4977-bc60-21e47ebb8e35" ParentLink="Construct_MessageRef" LowerBound="583.50" HigherBound="583.66">
                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="98f055ee-5535-49fe-ad1c-6f21c1355b88" ParentLink="ComplexStatement_Statement" LowerBound="585.1" HigherBound="587.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_Email" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="0a7677fc-ec6a-446d-bbf4-88f02ea9440b" ParentLink="Transform_OutputMessagePartRef" LowerBound="586.40" HigherBound="586.53">
                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_14" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="029ea375-ef30-491d-aa96-59887f5fccf8" ParentLink="Transform_InputMessagePartRef" LowerBound="586.110" HigherBound="586.132">
                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_13" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="db25f711-6d57-4d75-87a0-b64ed9b44b7d" ParentLink="ComplexStatement_Statement" LowerBound="587.1" HigherBound="622.1">
                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, the cart name was invalid: &quot; + varBasketName); &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="41dca3c6-3858-4bd1-80ed-5f6a3e2c5074" ParentLink="ComplexStatement_Statement" LowerBound="623.1" HigherBound="625.1">
                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="98b18d5c-7c47-44f6-9a02-a9a4397e7776" ParentLink="ComplexStatement_Statement" LowerBound="625.1" HigherBound="627.1">
                                <om:Property Name="ErrorMessage" Value="&quot;Invalid BasketName sent&quot;; " />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_BadData" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="a3edf8f5-4fae-402b-9737-678cc7444e1f" ParentLink="ReallyComplexStatement_Branch" LowerBound="628.26" HigherBound="677.1">
                            <om:Property Name="Expression" Value="//varDestinationAction.ToUpper() != &quot;CART&quot; &amp;&amp; varDestinationAction.ToUpper() != &quot;GRIDCART&quot;&#xD;&#xA;varAllowedDestinationActionsIndicator == -1&#xD;&#xA;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_DestinationAction" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="4be1d810-dda1-4e44-bc0c-d9f2b34646bb" ParentLink="ComplexStatement_Statement" LowerBound="631.1" HigherBound="672.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="b5c742df-f857-4d51-9908-bb9c6520d110" ParentLink="Construct_MessageRef" LowerBound="632.35" HigherBound="632.48">
                                    <om:Property Name="Ref" Value="Message_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="39847bd9-d95c-4a18-8350-649720ef058e" ParentLink="Construct_MessageRef" LowerBound="632.50" HigherBound="632.66">
                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="3c7f6d19-6997-4805-ab25-c902afd053d1" ParentLink="ComplexStatement_Statement" LowerBound="634.1" HigherBound="636.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_Email" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="360c5cd9-4e52-47fe-8ce5-e8ae1b3b80a9" ParentLink="Transform_OutputMessagePartRef" LowerBound="635.40" HigherBound="635.53">
                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_14" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="bb8410f4-54fe-44cd-a278-82a6b76652fd" ParentLink="Transform_InputMessagePartRef" LowerBound="635.110" HigherBound="635.132">
                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_13" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="6e470ba0-6320-4587-aea3-f9dfd35b65be" ParentLink="ComplexStatement_Statement" LowerBound="636.1" HigherBound="671.1">
                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart &quot; + varBasketName + &quot; was not created&quot;); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;The destination action supplied was invalid: &quot;+ varDestinationAction ); &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString() );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="e23cabba-e143-4ad7-b1f3-b660cf135532" ParentLink="ComplexStatement_Statement" LowerBound="672.1" HigherBound="674.1">
                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="362c2772-78b2-48fd-987b-ab128c360e8d" ParentLink="ComplexStatement_Statement" LowerBound="674.1" HigherBound="676.1">
                                <om:Property Name="ErrorMessage" Value="&quot;Invalid Destination Action sent&quot;; " />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_BadData" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="972a8cec-4274-4a54-811c-675c24c47ae7" ParentLink="ReallyComplexStatement_Branch" LowerBound="677.26" HigherBound="721.1">
                            <om:Property Name="Expression" Value="//varSourceSystem.ToUpper() != &quot;BOOKLIST&quot; &amp;&amp; varSourceSystem.ToUpper() != &quot;NEXTREAD&quot; &amp;&amp; varSourceSystem.ToUpper() != &quot;EXCELTOOL&quot;&#xD;&#xA;&#xD;&#xA;varAllowedSourceIndicator == -1" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_SourceSystem" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="b0cbb9aa-8d98-4570-a71d-f16473f2bbea" ParentLink="ComplexStatement_Statement" LowerBound="681.1" HigherBound="716.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="33690a35-7ee5-470a-ad8a-0be418f7c140" ParentLink="Construct_MessageRef" LowerBound="682.35" HigherBound="682.48">
                                    <om:Property Name="Ref" Value="Message_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="436d8597-55ab-4862-96ba-e6675f29adc9" ParentLink="Construct_MessageRef" LowerBound="682.50" HigherBound="682.66">
                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="f8f57216-2a90-4aa2-af35-c880bf8534ef" ParentLink="ComplexStatement_Statement" LowerBound="684.1" HigherBound="686.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_Email" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="a693d2ad-e552-4d27-95bc-cc5bc5e02a72" ParentLink="Transform_OutputMessagePartRef" LowerBound="685.40" HigherBound="685.53">
                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_24" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="c8d9f44b-2127-4b27-a464-5ac1830005c8" ParentLink="Transform_InputMessagePartRef" LowerBound="685.110" HigherBound="685.132">
                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_23" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="ed2bcdb9-6049-4d96-84fa-60309402062e" ParentLink="ComplexStatement_Statement" LowerBound="686.1" HigherBound="715.1">
                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart &quot; + varBasketName + &quot; was not created&quot;); &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;The source system supplied was invalid: &quot;+ varSourceSystem ); &#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="cef40b64-788e-437d-ac72-bc60dbcf36b3" ParentLink="ComplexStatement_Statement" LowerBound="716.1" HigherBound="718.1">
                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="31ef5696-e525-4a32-9cf2-6fd2b8236264" ParentLink="ComplexStatement_Statement" LowerBound="718.1" HigherBound="720.1">
                                <om:Property Name="ErrorMessage" Value="&quot;Invalid Source System sent...&quot;; " />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_BadData" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="dfe8a300-7216-4854-a963-6998a9b54ba9" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="c65a9ce5-74df-4ae7-8826-246bcdb08ef8" ParentLink="ComplexStatement_Statement" LowerBound="721.1" HigherBound="734.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive2" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="9556a1c6-d7f0-44a6-941a-ba85573e48e5" ParentLink="ReallyComplexStatement_Branch" LowerBound="722.21" HigherBound="734.1">
                            <om:Property Name="Expression" Value="varArchive2 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Archive2Message" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="7b216e98-9ef1-4d02-a044-7646302dc8a8" ParentLink="ComplexStatement_Statement" LowerBound="724.1" HigherBound="731.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive2Message" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="fd7264f1-1410-453e-a214-d3d3b9719e2a" ParentLink="Construct_MessageRef" LowerBound="725.35" HigherBound="725.64">
                                    <om:Property Name="Ref" Value="MessageArchive2ListCartSchema" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="a1d40cf0-89d0-4184-a043-0646996be0ff" ParentLink="ComplexStatement_Statement" LowerBound="727.1" HigherBound="730.1">
                                    <om:Property Name="Expression" Value="MessageArchive2ListCartSchema = Message_ListCartSchema; &#xD;&#xA;MessageArchive2ListCartSchema(FILE.ReceivedFileName)=&quot;Archive2XMLListTransfer&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="562c0b49-b80a-4862-aaee-b8ce67132bb1" ParentLink="ComplexStatement_Statement" LowerBound="731.1" HigherBound="733.1">
                                <om:Property Name="PortName" Value="Port_SendArchiveListTransferEnhanced" />
                                <om:Property Name="MessageName" Value="MessageArchive2ListCartSchema" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Archive2" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="7f39439f-cd3c-4c31-9f84-65eaa383511e" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="a8a8f5e8-58d9-44b7-bc7b-fb7e345d7c20" ParentLink="ComplexStatement_Statement" LowerBound="734.1" HigherBound="743.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_SQL2IXML" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Transform" OID="6c79689d-8a87-4e25-b413-5f9fde483daf" ParentLink="ComplexStatement_Statement" LowerBound="737.1" HigherBound="739.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_IXML" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_IXML" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="35cfeeb3-7733-4446-9374-b5355e6cabb6" ParentLink="Transform_InputMessagePartRef" LowerBound="738.118" HigherBound="738.140">
                                <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_33" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="1a80c397-b252-47db-965f-ec453e3a304b" ParentLink="Transform_OutputMessagePartRef" LowerBound="738.36" HigherBound="738.62">
                                <om:Property Name="MessageRef" Value="Message_ListCartSchemaIXML" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_34" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="62b34910-1d48-4888-84ed-df481a02bc9e" ParentLink="ComplexStatement_Statement" LowerBound="739.1" HigherBound="742.1">
                            <om:Property Name="Expression" Value="xpath(Message_ListCartSchemaIXML,    &quot;/*[local-name()='ListCarts' and namespace-uri()='http://ListTransferCarts.ListCartSchemaIntermediate']/*[local-name()='BasketLineSplitLimit' and namespace-uri()='']&quot;) = varBasketLineSplitLimit; &#xD;&#xA;xpath(Message_ListCartSchemaIXML,    &quot;/*[local-name()='ListCarts' and namespace-uri()='http://ListTransferCarts.ListCartSchemaIntermediate']/*[local-name()='BasketLineOverallLimit' and namespace-uri()='']&quot;) = varBasketLineOverallLimit; &#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="cf2feae1-c3e1-4468-9809-9679a3b5ad89" ParentLink="Construct_MessageRef" LowerBound="735.31" HigherBound="735.57">
                            <om:Property Name="Ref" Value="Message_ListCartSchemaIXML" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="04631c10-730e-4fca-8c1b-8aaaa3486af6" ParentLink="ComplexStatement_Statement" LowerBound="743.1" HigherBound="749.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_SQL2" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="0810ac81-52c8-46ba-ac58-e753c10f6909" ParentLink="Construct_MessageRef" LowerBound="744.31" HigherBound="744.45">
                            <om:Property Name="Ref" Value="Message_ToSQL2" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="90db5dfa-0619-4a80-bc25-5264e6845189" ParentLink="ComplexStatement_Statement" LowerBound="746.1" HigherBound="748.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_RequestSQL2" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_RequestSQL2" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="6641cce1-a50e-4306-b6fc-13303166117b" ParentLink="Transform_InputMessagePartRef" LowerBound="747.113" HigherBound="747.139">
                                <om:Property Name="MessageRef" Value="Message_ListCartSchemaIXML" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_17" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="a9351f2c-2fc0-4bbe-bebc-acee3c352027" ParentLink="Transform_OutputMessagePartRef" LowerBound="747.36" HigherBound="747.50">
                                <om:Property Name="MessageRef" Value="Message_ToSQL2" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_18" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="98c19c38-58ca-419e-9a76-a8e30cc2ea40" ParentLink="ComplexStatement_Statement" LowerBound="749.1" HigherBound="762.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive3" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="beeff810-cb88-4774-a060-9ec315cc7862" ParentLink="ReallyComplexStatement_Branch" LowerBound="750.21" HigherBound="762.1">
                            <om:Property Name="Expression" Value="varArchive3 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Archive3Message" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="02c30cc0-861e-4a94-b170-4b8140acdaea" ParentLink="ComplexStatement_Statement" LowerBound="752.1" HigherBound="759.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive3Message" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="f33ff15a-afc8-4e48-95b1-0ad5561add84" ParentLink="Construct_MessageRef" LowerBound="753.35" HigherBound="753.62">
                                    <om:Property Name="Ref" Value="Message_Archive3SQLRequest2" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="ba38c1d0-8759-43b2-84be-3f0cbe783a84" ParentLink="ComplexStatement_Statement" LowerBound="755.1" HigherBound="758.1">
                                    <om:Property Name="Expression" Value="Message_Archive3SQLRequest2 = Message_ToSQL2; &#xD;&#xA;Message_Archive3SQLRequest2(FILE.ReceivedFileName)=&quot;Archive3SQLRequest&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="44f9aaaa-4879-4a5f-899f-1ac086575c4e" ParentLink="ComplexStatement_Statement" LowerBound="759.1" HigherBound="761.1">
                                <om:Property Name="PortName" Value="Port_ArchiveSQL3" />
                                <om:Property Name="MessageName" Value="Message_Archive3SQLRequest2" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_ArchiveSQL" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="6f91f5ae-3d17-4287-b208-d3fbcc346ab4" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Send" OID="2fb0deac-077e-4ab0-a1bd-35882ea2024c" ParentLink="ComplexStatement_Statement" LowerBound="762.1" HigherBound="764.1">
                        <om:Property Name="PortName" Value="Port_SQL2" />
                        <om:Property Name="MessageName" Value="Message_ToSQL2" />
                        <om:Property Name="OperationName" Value="procListTransferInsertBaskets" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_SQL2" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Receive" OID="6d196609-2b5e-4e31-95ee-1d1c7441ade6" ParentLink="ComplexStatement_Statement" LowerBound="764.1" HigherBound="766.1">
                        <om:Property Name="Activate" Value="False" />
                        <om:Property Name="PortName" Value="Port_SQL2" />
                        <om:Property Name="MessageName" Value="Message_FromSQL2" />
                        <om:Property Name="OperationName" Value="procListTransferInsertBaskets" />
                        <om:Property Name="OperationMessageName" Value="Response" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Receive_SQL2" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Decision" OID="b01dc20c-9b60-42f8-851d-7dad85c11158" ParentLink="ComplexStatement_Statement" LowerBound="766.1" HigherBound="779.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive4" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="334dca3d-90db-431a-880d-ea488bc72598" ParentLink="ReallyComplexStatement_Branch" LowerBound="767.21" HigherBound="779.1">
                            <om:Property Name="Expression" Value="varArchive4 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Archive3Message" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="b4918ef6-c0fd-4fd8-9949-13a8546a8661" ParentLink="ComplexStatement_Statement" LowerBound="769.1" HigherBound="776.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive4Message" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="9da75e58-9b6e-4dbd-b69f-3943960d9c42" ParentLink="Construct_MessageRef" LowerBound="770.35" HigherBound="770.63">
                                    <om:Property Name="Ref" Value="Message_Archive4SQLResponse2" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="9f278c80-98fa-4873-a319-48294fcc0e70" ParentLink="ComplexStatement_Statement" LowerBound="772.1" HigherBound="775.1">
                                    <om:Property Name="Expression" Value="Message_Archive4SQLResponse2 = Message_FromSQL2; &#xD;&#xA;Message_Archive4SQLResponse2(FILE.ReceivedFileName)=&quot;Archive4SQLResponse&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="d720e562-8cac-4fca-a739-e413a13dbec2" ParentLink="ComplexStatement_Statement" LowerBound="776.1" HigherBound="778.1">
                                <om:Property Name="PortName" Value="Port_ArchiveSQL4" />
                                <om:Property Name="MessageName" Value="Message_Archive4SQLResponse2" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_ArchiveSQL" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="ac77772f-d6de-4ee8-b263-f33492fd5589" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="7198810a-0901-43ba-81e6-1815c606ce80" ParentLink="ComplexStatement_Statement" LowerBound="779.1" HigherBound="785.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_BasketCount" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="15bd737e-3262-4be7-9bfb-da0ff9690f7c" ParentLink="Construct_MessageRef" LowerBound="780.31" HigherBound="780.50">
                            <om:Property Name="Ref" Value="Message_BasketCount" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="a45a40e6-5019-42d4-b7ae-4319f732e2bd" ParentLink="ComplexStatement_Statement" LowerBound="782.1" HigherBound="784.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_BasketCount" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_BasketCount" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="34e1327a-6b78-4808-a62e-c7d4341a1edf" ParentLink="Transform_InputMessagePartRef" LowerBound="783.118" HigherBound="783.134">
                                <om:Property Name="MessageRef" Value="Message_FromSQL2" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="9170f081-c131-4a24-8bab-292491b8b6b9" ParentLink="Transform_OutputMessagePartRef" LowerBound="783.36" HigherBound="783.55">
                                <om:Property Name="MessageRef" Value="Message_BasketCount" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="334c224d-a365-4f9f-adf1-cd725b55b869" ParentLink="ComplexStatement_Statement" LowerBound="785.1" HigherBound="798.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive5" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="6ae00524-1582-4418-969c-cf4996179b66" ParentLink="ReallyComplexStatement_Branch" LowerBound="786.21" HigherBound="798.1">
                            <om:Property Name="Expression" Value="varArchive5 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Archive5Message" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="0a9d1222-0c29-47bf-82ae-0106443b6682" ParentLink="ComplexStatement_Statement" LowerBound="788.1" HigherBound="795.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive4Message" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="a01cef9f-468c-4a60-893b-1be5a79dd262" ParentLink="Construct_MessageRef" LowerBound="789.35" HigherBound="789.61">
                                    <om:Property Name="Ref" Value="MessageArchive5BasketCount" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="206da181-c173-4c4f-a793-1161cf1594d6" ParentLink="ComplexStatement_Statement" LowerBound="791.1" HigherBound="794.1">
                                    <om:Property Name="Expression" Value="MessageArchive5BasketCount = Message_BasketCount; &#xD;&#xA;MessageArchive5BasketCount(FILE.ReceivedFileName)=&quot;Archive5BasketCount&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="9fd9d7c1-aa1a-4229-8908-b424d49847d2" ParentLink="ComplexStatement_Statement" LowerBound="795.1" HigherBound="797.1">
                                <om:Property Name="PortName" Value="Port_ArchiveBasketCount" />
                                <om:Property Name="MessageName" Value="MessageArchive5BasketCount" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_ArchiveBasketCount" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="06259294-ce8a-40e3-8289-85e1e7648fee" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="5f602099-8827-4ab0-8ebc-8eb89e49a1ec" ParentLink="ComplexStatement_Statement" LowerBound="798.1" HigherBound="812.1">
                        <om:Property Name="Expression" Value="varLineInsertedCount = xpath(Message_BasketCount, &quot;string(//BasketLinesInserted)&quot;);&#xD;&#xA;varResponse = xpath(Message_BasketCount, &quot;string(//ReturnValue)&quot;);&#xD;&#xA;varMessage = xpath(Message_BasketCount, &quot;string(//Message)&quot;);&#xD;&#xA;varBasketGuid = xpath(Message_BasketCount, &quot;string(//BasketOrderFormGuid)&quot;);&#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;show me the count&quot;, varLineInsertedCount.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;show me the respnse&quot;, varResponse.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;show me the message&quot;, varMessage.ToString());&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;show me the host&quot;,varSMTPHost.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//varUserID = xpath(Message_ListCartSchema,&quot;string(//DestinationUserID)&quot;);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getBasketCount" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Construct" OID="e1cb13f8-435f-4e9f-82e0-77beeffc33d7" ParentLink="ComplexStatement_Statement" LowerBound="812.1" HigherBound="818.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_EmailFF" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="192fd4fc-397a-4223-90a1-28adf508a799" ParentLink="Construct_MessageRef" LowerBound="813.31" HigherBound="813.46">
                            <om:Property Name="Ref" Value="Message_EmailFF" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="212d8b76-002a-4f2c-82db-8d3b14c72e87" ParentLink="ComplexStatement_Statement" LowerBound="815.1" HigherBound="817.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_EmailFF" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_2" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="8c9543f6-aa87-4aff-9da8-968f47c0ec93" ParentLink="Transform_InputMessagePartRef" LowerBound="816.110" HigherBound="816.132">
                                <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_7" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="b95a1fbe-5a1f-4e69-a9b0-8021403c0a15" ParentLink="Transform_OutputMessagePartRef" LowerBound="816.36" HigherBound="816.51">
                                <om:Property Name="MessageRef" Value="Message_EmailFF" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_8" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="2cb56345-fa9b-4425-b755-d4037a95bdc3" ParentLink="ComplexStatement_Statement" LowerBound="818.1" HigherBound="831.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive6" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="928ef5c2-4edb-48df-a177-0bef0b7c1956" ParentLink="ReallyComplexStatement_Branch" LowerBound="819.21" HigherBound="831.1">
                            <om:Property Name="Expression" Value="varArchive6 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="Archive5Message" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="4a96ecf1-7dc0-46f0-a681-5d8e0d27245c" ParentLink="ComplexStatement_Statement" LowerBound="821.1" HigherBound="828.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive4Message" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="b1e5a892-429c-4222-976f-3be1cdd0468c" ParentLink="Construct_MessageRef" LowerBound="822.35" HigherBound="822.57">
                                    <om:Property Name="Ref" Value="MessageArchive6EmailFF" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="5b55ef05-dfdf-4494-8a2c-f929beca93d7" ParentLink="ComplexStatement_Statement" LowerBound="824.1" HigherBound="827.1">
                                    <om:Property Name="Expression" Value="MessageArchive6EmailFF = Message_EmailFF; &#xD;&#xA;MessageArchive6EmailFF(FILE.ReceivedFileName)=&quot;Archive6EmailFF&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="e21a5e33-24a9-4fff-987d-d57ff9b7d936" ParentLink="ComplexStatement_Statement" LowerBound="828.1" HigherBound="830.1">
                                <om:Property Name="PortName" Value="Port_ArchiveEmailFF" />
                                <om:Property Name="MessageName" Value="MessageArchive6EmailFF" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_ArchiveEmailFF" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="592d8a1e-f043-4282-88d5-2637946e1dda" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="eb8bc632-3d2c-4ef2-8076-02cbd358f758" ParentLink="ComplexStatement_Statement" LowerBound="831.1" HigherBound="1087.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="DetermineStatus" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="cbccf599-efe9-4b13-9d52-1553bc976639" ParentLink="ReallyComplexStatement_Branch" LowerBound="832.21" HigherBound="881.1">
                            <om:Property Name="Expression" Value="varResponse &gt; 50000 &amp;&amp; varResponse &lt; 50040&#xD;&#xA;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_UserException" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="f33a8cd0-87eb-4c95-8047-2b58c57fbcc0" ParentLink="ComplexStatement_Statement" LowerBound="834.1" HigherBound="872.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_EmailFailure" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="17e7f47d-c411-40c7-b96c-a887d4ba7b4f" ParentLink="Construct_MessageRef" LowerBound="835.35" HigherBound="835.48">
                                    <om:Property Name="Ref" Value="Message_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="db3e4228-1117-45bd-821a-a89bf4cda45d" ParentLink="Construct_MessageRef" LowerBound="835.50" HigherBound="835.66">
                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="ae4ecb1b-e161-4d21-845d-f5743fbedb0b" ParentLink="ComplexStatement_Statement" LowerBound="837.1" HigherBound="839.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_Email" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="0e7ae35a-e16a-41d2-ac86-c8610b8c9330" ParentLink="Transform_OutputMessagePartRef" LowerBound="838.40" HigherBound="838.53">
                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_26" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="e668e555-1cf2-4f42-8b67-57cd0048dcaf" ParentLink="Transform_InputMessagePartRef" LowerBound="838.110" HigherBound="838.132">
                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_25" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="24bc112f-87cc-4cc7-b466-b9ac402dbeaa" ParentLink="ComplexStatement_Statement" LowerBound="839.1" HigherBound="871.1">
                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart &quot; + varBasketName + &quot; was not created successfully&quot;); &#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Reason: &quot; + varMessage);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//varSMTPHost = &quot;5.0.110.24&quot;;&#xD;&#xA;//varSMTPFrom = &quot;BTBiztalk@baker-taylor.com&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: UnSuccessful Cart action for &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="a3ffb500-cb89-46e7-a818-7ab4ac112606" ParentLink="ComplexStatement_Statement" LowerBound="872.1" HigherBound="874.1">
                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="f82b1015-ffca-4776-b21e-ee6f9991ae91" ParentLink="ComplexStatement_Statement" LowerBound="874.1" HigherBound="880.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_EmailSMTP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="14f47fb1-b94f-4c9c-b41c-7cd86cf7dde1" ParentLink="ReallyComplexStatement_Branch" LowerBound="875.25" HigherBound="880.1">
                                    <om:Property Name="Expression" Value="varEmailSMTP == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_EmailSMTP" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="778bbe71-721a-4cf0-a606-d06af787363c" ParentLink="ComplexStatement_Statement" LowerBound="877.1" HigherBound="879.1">
                                        <om:Property Name="PortName" Value="Port_SendEmail" />
                                        <om:Property Name="MessageName" Value="Message_Email" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Email" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="11b1879f-87a6-4131-8379-6124af27e708" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="bc26eb84-d1b4-45b6-8ff1-8a4bb66043da" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Decision" OID="2360399a-919a-421c-afd9-5aab8341a616" ParentLink="ComplexStatement_Statement" LowerBound="883.1" HigherBound="1086.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_1" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="DecisionBranch" OID="0740b6a3-3f51-4878-a99d-b038d88defc7" ParentLink="ReallyComplexStatement_Branch" LowerBound="884.25" HigherBound="946.1">
                                    <om:Property Name="Expression" Value="varResponse != 0 " />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_SystemException" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="6989e879-25f7-4233-9bf0-79c33bed210a" ParentLink="ComplexStatement_Statement" LowerBound="886.1" HigherBound="924.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_EmailFailure" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="a241613f-f600-41a3-8fd5-e52f6a8052c8" ParentLink="Construct_MessageRef" LowerBound="887.39" HigherBound="887.52">
                                            <om:Property Name="Ref" Value="Message_Email" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="3366318b-787f-4ba7-8515-602e7f942583" ParentLink="Construct_MessageRef" LowerBound="887.54" HigherBound="887.70">
                                            <om:Property Name="Ref" Value="emailMsgComplete" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="4104f4ac-bbc4-4655-8c05-e4410e6bb02d" ParentLink="ComplexStatement_Statement" LowerBound="889.1" HigherBound="891.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_Email" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="1f860066-394c-4b9e-a55e-6bd52126c27f" ParentLink="Transform_OutputMessagePartRef" LowerBound="890.44" HigherBound="890.57">
                                                <om:Property Name="MessageRef" Value="Message_Email" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_22" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="275d5d66-8330-4f44-851a-aac94a7a5c7f" ParentLink="Transform_InputMessagePartRef" LowerBound="890.114" HigherBound="890.136">
                                                <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_21" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="ad53bb0d-f7ae-467a-9b12-82355d965814" ParentLink="ComplexStatement_Statement" LowerBound="891.1" HigherBound="923.1">
                                            <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart &quot; + varBasketName + &quot; was not created successfully&quot;); &#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Reason: &quot; + varMessage);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//varSMTPHost = &quot;5.0.110.24&quot;;&#xD;&#xA;//varSMTPFrom = &quot;BTBiztalk@baker-taylor.com&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCCTemp1;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: UnSuccessful Cart action for &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varSMTPBiztalk;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="a58476c8-59d6-4874-b541-f7e0112df121" ParentLink="ComplexStatement_Statement" LowerBound="924.1" HigherBound="926.1">
                                        <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                        <om:Property Name="MessageName" Value="emailMsgComplete" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_EmailSMTP" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Decision" OID="6e834c8c-1271-4efa-9c78-170fd334b56f" ParentLink="ComplexStatement_Statement" LowerBound="926.1" HigherBound="932.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Decide_EmailSMTP" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="15a92fd7-2662-443f-abf2-d81a81b074ce" ParentLink="ReallyComplexStatement_Branch" LowerBound="927.29" HigherBound="932.1">
                                            <om:Property Name="Expression" Value="varEmailSMTP == true" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Rule_EmailSMTP" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Send" OID="1615b7ea-7804-4854-ba00-4dd28af9b0e3" ParentLink="ComplexStatement_Statement" LowerBound="929.1" HigherBound="931.1">
                                                <om:Property Name="PortName" Value="Port_SendEmail" />
                                                <om:Property Name="MessageName" Value="Message_Email" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_Email" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="8fd85971-821b-439d-a902-4ea8f0483908" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Decision" OID="107de40f-f872-4f29-ac7b-313e12a3d1e7" ParentLink="ComplexStatement_Statement" LowerBound="932.1" HigherBound="945.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Decide_Archive7" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="51978390-25c1-4383-adfa-a0930036be09" ParentLink="ReallyComplexStatement_Branch" LowerBound="933.29" HigherBound="945.1">
                                            <om:Property Name="Expression" Value="varArchive7 == true" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="Archive7Message" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Construct" OID="669b7487-42e4-40fb-826f-5315264bf872" ParentLink="ComplexStatement_Statement" LowerBound="935.1" HigherBound="942.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructArchive7Message" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageAssignment" OID="4db1121a-ef15-41c4-aa10-a72cd9221a0e" ParentLink="ComplexStatement_Statement" LowerBound="938.1" HigherBound="941.1">
                                                    <om:Property Name="Expression" Value="Message_Archive7EmailFTP = Message_Email; &#xD;&#xA;Message_Archive7EmailFTP(FILE.ReceivedFileName)=&quot;Archive7EmailFTP&quot;; " />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="718b1acd-8509-41ab-b0ee-64c0d3b6c6c0" ParentLink="Construct_MessageRef" LowerBound="936.43" HigherBound="936.67">
                                                    <om:Property Name="Ref" Value="Message_Archive7EmailFTP" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="177b6ffa-b099-4bf8-8640-5e941e7d2f8c" ParentLink="ComplexStatement_Statement" LowerBound="942.1" HigherBound="944.1">
                                                <om:Property Name="PortName" Value="Port_Archive7EmailFTP" />
                                                <om:Property Name="MessageName" Value="Message_Email" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_ArchiveEmailFTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="107ae20e-6b97-450b-8c1d-64c4fa013a8e" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="6e59fac7-fb63-496a-bb79-c54d06650bd2" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Decision" OID="d36a0949-1c44-4dfb-81d0-bfd4880c698e" ParentLink="ComplexStatement_Statement" LowerBound="948.1" HigherBound="1085.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Decide_CompletePartialSuccess" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="d343987a-155e-4309-a0aa-0f84d84db3c7" ParentLink="ReallyComplexStatement_Branch" LowerBound="949.29" HigherBound="1000.1">
                                            <om:Property Name="Expression" Value="(varLineInsertedCount == varLineReceivedCount.ToString()) " />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Rule_CountsMatch" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Construct" OID="84e56b19-2b4a-4ebf-9efb-0a52465b0b12" ParentLink="ComplexStatement_Statement" LowerBound="951.1" HigherBound="991.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="e267c270-cc81-4813-a5ab-827cda2a0dcd" ParentLink="Construct_MessageRef" LowerBound="952.43" HigherBound="952.56">
                                                    <om:Property Name="Ref" Value="Message_Email" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="24a9ac75-0685-41f5-97f9-75c6e3b17a61" ParentLink="Construct_MessageRef" LowerBound="952.58" HigherBound="952.74">
                                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="ccd48b15-6c22-49aa-b92c-dfd46314ac5d" ParentLink="ComplexStatement_Statement" LowerBound="954.1" HigherBound="956.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_Email" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="781aff23-3cb0-48a1-ba41-7b01416efe6a" ParentLink="Transform_InputMessagePartRef" LowerBound="955.118" HigherBound="955.140">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_11" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="c9b895b3-a923-487a-b055-0130a23054da" ParentLink="Transform_OutputMessagePartRef" LowerBound="955.48" HigherBound="955.61">
                                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_12" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="4e66b62a-4cce-421e-9664-61b436d5bada" ParentLink="ComplexStatement_Statement" LowerBound="956.1" HigherBound="990.1">
                                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart &quot; + varBasketName2 + &quot; was created successfully in the &quot;); &#xD;&#xA;msgbody.AppendLine( varUserFolder + &quot;.&quot;); &#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: &quot; + varLineInsertedCount.ToString());&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;//varSMTPHost = &quot;5.0.110.24&quot;;&#xD;&#xA;//varSMTPFrom = &quot;BTBiztalk@baker-taylor.com&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Completely Successful Cart action for &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="bedbe771-6154-47ec-b2c4-f925228b7ce7" ParentLink="ComplexStatement_Statement" LowerBound="991.1" HigherBound="993.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Decision" OID="3cbec473-6497-4a49-977f-4dc7a80daba6" ParentLink="ComplexStatement_Statement" LowerBound="993.1" HigherBound="999.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Decide_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="DecisionBranch" OID="618f374b-e02c-444e-979e-207d16f56290" ParentLink="ReallyComplexStatement_Branch" LowerBound="994.33" HigherBound="999.1">
                                                    <om:Property Name="Expression" Value="varEmailSMTP == true" />
                                                    <om:Property Name="IsGhostBranch" Value="True" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Rule_EmailSMTP" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="Send" OID="60bfc330-6ded-4992-a97c-59d38499a836" ParentLink="ComplexStatement_Statement" LowerBound="996.1" HigherBound="998.1">
                                                        <om:Property Name="PortName" Value="Port_SendEmail" />
                                                        <om:Property Name="MessageName" Value="Message_Email" />
                                                        <om:Property Name="OperationName" Value="Operation_1" />
                                                        <om:Property Name="OperationMessageName" Value="Request" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Send_Email" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="DecisionBranch" OID="1717ce51-c731-4327-bf82-571e3fe2a4c9" ParentLink="ReallyComplexStatement_Branch">
                                                    <om:Property Name="IsGhostBranch" Value="True" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Else" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="505ad8c3-6002-4892-9922-1b3d80401192" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Construct" OID="25821e3e-a6d6-43d1-a17b-c6de7de43925" ParentLink="ComplexStatement_Statement" LowerBound="1002.1" HigherBound="1008.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_SQLGET" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="Transform" OID="c148222a-1efa-45d6-a4f9-3b586347f159" ParentLink="ComplexStatement_Statement" LowerBound="1005.1" HigherBound="1007.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_SQLGET" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_SQLGET" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="b6de68ef-3dc5-462c-bbc1-56d49fc95027" ParentLink="Transform_InputMessagePartRef" LowerBound="1006.120" HigherBound="1006.136">
                                                        <om:Property Name="MessageRef" Value="Message_FromSQL2" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_15" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="2756c679-915a-437c-b9ee-ece4fa454f63" ParentLink="Transform_OutputMessagePartRef" LowerBound="1006.48" HigherBound="1006.62">
                                                        <om:Property Name="MessageRef" Value="Message_SQLGET" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_16" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="b91e3f91-ec9d-405e-bfb2-5d0d0d56e97c" ParentLink="Construct_MessageRef" LowerBound="1003.43" HigherBound="1003.57">
                                                    <om:Property Name="Ref" Value="Message_SQLGET" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="e20099c5-9eb8-455d-b648-f8c36e903c0d" ParentLink="ComplexStatement_Statement" LowerBound="1008.1" HigherBound="1010.1">
                                                <om:Property Name="PortName" Value="Port_ArchiveSQLGET" />
                                                <om:Property Name="MessageName" Value="Message_SQLGET" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_ArchiveSQLGet" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Send" OID="58847507-b27a-4b9d-b7aa-0b5295debd68" ParentLink="ComplexStatement_Statement" LowerBound="1010.1" HigherBound="1012.1">
                                                <om:Property Name="PortName" Value="Port_SQLGET" />
                                                <om:Property Name="MessageName" Value="Message_SQLGET" />
                                                <om:Property Name="OperationName" Value="procListTransferGetLineWarningsLog" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_SQLGET" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Receive" OID="2802bf76-8fe5-4a0a-8b4f-db4fe727b068" ParentLink="ComplexStatement_Statement" LowerBound="1012.1" HigherBound="1014.1">
                                                <om:Property Name="Activate" Value="False" />
                                                <om:Property Name="PortName" Value="Port_SQLGET" />
                                                <om:Property Name="MessageName" Value="Message_SQLGETRESPONSE" />
                                                <om:Property Name="OperationName" Value="procListTransferGetLineWarningsLog" />
                                                <om:Property Name="OperationMessageName" Value="Response" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Receive_SQLGETRESPONSE" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Send" OID="b25c78c2-0989-49a5-a702-ddfa9160d815" ParentLink="ComplexStatement_Statement" LowerBound="1014.1" HigherBound="1016.1">
                                                <om:Property Name="PortName" Value="Port_ArchiveSQLGetResponse" />
                                                <om:Property Name="MessageName" Value="Message_SQLGETRESPONSE" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_ArchiveSQLGETResponse" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="ec9b7608-8e1a-46e1-b8b1-84d0c62fd015" ParentLink="ComplexStatement_Statement" LowerBound="1016.1" HigherBound="1063.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailPartial" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="ebfaf2e6-c378-4e7e-a4a3-fe99b102835a" ParentLink="Construct_MessageRef" LowerBound="1017.43" HigherBound="1017.56">
                                                    <om:Property Name="Ref" Value="Message_Email" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="ee8f73d9-4708-46e1-b490-4b71b74f01ff" ParentLink="Construct_MessageRef" LowerBound="1017.58" HigherBound="1017.66">
                                                    <om:Property Name="Ref" Value="emailMsg" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="36d276a6-58eb-4f9d-8508-7d96313f3814" ParentLink="Construct_MessageRef" LowerBound="1017.68" HigherBound="1017.84">
                                                    <om:Property Name="Ref" Value="Message_Warnings" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="6e57d3f9-95e5-4bd7-a203-6e54e50e81ed" ParentLink="ComplexStatement_Statement" LowerBound="1019.1" HigherBound="1021.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Email" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_Email" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="4e8f5cbd-339b-4009-80e7-eef3a6e5b141" ParentLink="Transform_OutputMessagePartRef" LowerBound="1020.48" HigherBound="1020.61">
                                                        <om:Property Name="MessageRef" Value="Message_Email" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_4" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="a143a926-5418-40c3-906a-5fd917f74d2e" ParentLink="Transform_InputMessagePartRef" LowerBound="1020.118" HigherBound="1020.140">
                                                        <om:Property Name="MessageRef" Value="Message_ListCartSchema" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_3" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Transform" OID="617b9022-fd2f-447a-9187-10e3a2a0a09e" ParentLink="ComplexStatement_Statement" LowerBound="1021.1" HigherBound="1023.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_Warnings" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_Warnings" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="637b6d87-418d-4fa3-9756-6be2f7d81cad" ParentLink="Transform_InputMessagePartRef" LowerBound="1022.124" HigherBound="1022.146">
                                                        <om:Property Name="MessageRef" Value="Message_SQLGETRESPONSE" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_5" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="7aec51c6-1cb0-4820-96c0-9f74b02b142b" ParentLink="Transform_OutputMessagePartRef" LowerBound="1022.48" HigherBound="1022.64">
                                                        <om:Property Name="MessageRef" Value="Message_Warnings" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_6" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="1dc24a8a-1455-484f-b617-0865248547d7" ParentLink="ComplexStatement_Statement" LowerBound="1023.1" HigherBound="1062.1">
                                                    <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;Your cart &quot; + varBasketName2 + &quot; was created partially in the &quot;);&#xD;&#xA;msgbody.AppendLine( varUserFolder + &quot;.&quot;); &#xD;&#xA; &#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: &quot; + varLineInsertedCount.ToString());&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;//varSMTPHost = &quot;5.0.110.24&quot;;&#xD;&#xA;//varSMTPFrom = &quot;BTBiztalk@baker-taylor.com&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsg.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsg.MessagePart_bodyattachment = Message_Email;  //was message_email&#xD;&#xA;emailMsg.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsg.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;  &#xD;&#xA;emailMsg.MessagePart_bodyAttachment2 = Message_Warnings;  //was message_email&#xD;&#xA;emailMsg.MessagePart_bodyAttachment2(MIME.FileName) = varFilename + &quot;_warnings.xml&quot;;&#xD;&#xA;emailMsg.MessagePart_bodyAttachment2(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsg.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsg(SMTP.Subject)=&quot;ListTransfer: Partially Successful Cart action for &quot; + varUserID; &#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailSMTP_ListTransfer(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="971d7ccd-9489-4502-b09b-6b3f8ec68187" ParentLink="ComplexStatement_Statement" LowerBound="1063.1" HigherBound="1065.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailSMTP_ListTransfer" />
                                                <om:Property Name="MessageName" Value="emailMsg" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Decision" OID="3ff8112c-2820-431a-98f4-06d56c427207" ParentLink="ComplexStatement_Statement" LowerBound="1065.1" HigherBound="1071.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Decide_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="DecisionBranch" OID="d7af8f6c-461f-413a-b01a-c8bccf511f71" ParentLink="ReallyComplexStatement_Branch" LowerBound="1066.33" HigherBound="1071.1">
                                                    <om:Property Name="Expression" Value="varEmailSMTP == true" />
                                                    <om:Property Name="IsGhostBranch" Value="True" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Rule_EmailSMTP" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="Send" OID="7b799f4c-d500-4e80-9756-3aa707c1085e" ParentLink="ComplexStatement_Statement" LowerBound="1068.1" HigherBound="1070.1">
                                                        <om:Property Name="PortName" Value="Port_SendEmail" />
                                                        <om:Property Name="MessageName" Value="Message_Email" />
                                                        <om:Property Name="OperationName" Value="Operation_1" />
                                                        <om:Property Name="OperationMessageName" Value="Request" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Send_Email" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="DecisionBranch" OID="ae8936ba-5d14-416d-b3b7-d3442722970d" ParentLink="ReallyComplexStatement_Branch">
                                                    <om:Property Name="IsGhostBranch" Value="True" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Else" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Decision" OID="98f6c29f-6102-41dd-b2ad-f583621a5399" ParentLink="ComplexStatement_Statement" LowerBound="1071.1" HigherBound="1084.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Decide_Archive7" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="DecisionBranch" OID="a10d3891-5e4d-46c2-adf5-22bbfefdfc63" ParentLink="ReallyComplexStatement_Branch" LowerBound="1072.33" HigherBound="1084.1">
                                                    <om:Property Name="Expression" Value="varArchive7 == true" />
                                                    <om:Property Name="IsGhostBranch" Value="True" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="Archive7Message" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="Construct" OID="9b415133-96c3-4526-824e-6dba594b4777" ParentLink="ComplexStatement_Statement" LowerBound="1074.1" HigherBound="1081.1">
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="ConstructArchive7Message" />
                                                        <om:Property Name="Signal" Value="True" />
                                                        <om:Element Type="MessageRef" OID="8f729e79-54c4-41d6-80e8-60c58f1607a1" ParentLink="Construct_MessageRef" LowerBound="1075.47" HigherBound="1075.71">
                                                            <om:Property Name="Ref" Value="Message_Archive7EmailFTP" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Signal" Value="False" />
                                                        </om:Element>
                                                        <om:Element Type="MessageAssignment" OID="92bfaf11-1d3a-4be5-a248-e5f23077d96b" ParentLink="ComplexStatement_Statement" LowerBound="1077.1" HigherBound="1080.1">
                                                            <om:Property Name="Expression" Value="Message_Archive7EmailFTP = Message_Email; &#xD;&#xA;Message_Archive7EmailFTP(FILE.ReceivedFileName)=&quot;Archive7EmailFTP&quot;; " />
                                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                                            <om:Property Name="Signal" Value="True" />
                                                        </om:Element>
                                                    </om:Element>
                                                    <om:Element Type="Send" OID="bdb17f55-2b60-40df-aee2-1319ba8d8586" ParentLink="ComplexStatement_Statement" LowerBound="1081.1" HigherBound="1083.1">
                                                        <om:Property Name="PortName" Value="Port_Archive7EmailFTP" />
                                                        <om:Property Name="MessageName" Value="Message_Email" />
                                                        <om:Property Name="OperationName" Value="Operation_1" />
                                                        <om:Property Name="OperationMessageName" Value="Request" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Send_ArchiveEmailFTP" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="DecisionBranch" OID="b6e9e6bc-ef03-4e1b-a7a8-8f4bc5446790" ParentLink="ReallyComplexStatement_Branch">
                                                    <om:Property Name="IsGhostBranch" Value="True" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Else" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="14393532-ee37-4628-9bd9-fdf0324a814f" ParentLink="Scope_Catch" LowerBound="1090.1" HigherBound="1115.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.SystemException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_Main2" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="c5d9585f-3a84-4898-83f3-3aade189e81f" ParentLink="Catch_Statement" LowerBound="1093.1" HigherBound="1110.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructFaultMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="67218a6f-7a90-4251-b9a4-4f40f719dc4f" ParentLink="Construct_MessageRef" LowerBound="1094.35" HigherBound="1094.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="e5ae1b84-2cf9-4bf0-9e8b-8cec2ca214cf" ParentLink="ComplexStatement_Statement" LowerBound="1096.1" HigherBound="1109.1">
                                <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;Btnextgen.Biztalk.ListTransferCarts2 Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=ex.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3011&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="f7752806-8ef9-42d4-bd5c-c4767dc99be2" ParentLink="Catch_Statement" LowerBound="1110.1" HigherBound="1112.1">
                            <om:Property Name="PortName" Value="LT2_FaultPort" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Exception" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Send" OID="70f7ebbc-e4f9-489a-8a4a-dc7d829a15af" ParentLink="Catch_Statement" LowerBound="1112.1" HigherBound="1114.1">
                            <om:Property Name="PortName" Value="Port_SendEmailFail_LT2" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Email" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="958c919f-1d2f-4ce7-9138-dfbd45fa67a6" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="149.1" HigherBound="151.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ListTransferEnhanced" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ReceiveListTransferEnhanced" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="d3458ebf-6617-492d-b41a-3065224c7b71" ParentLink="PortDeclaration_CLRAttribute" LowerBound="149.1" HigherBound="150.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="5ca333f5-9bdb-4b5b-b278-430571f473c1" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="151.1" HigherBound="153.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SendListTransferEnhanced" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendArchiveListTransferEnhanced" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="be2508e8-00f1-416c-9084-73fdd7853c10" ParentLink="PortDeclaration_CLRAttribute" LowerBound="151.1" HigherBound="152.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="31086a00-9d3e-47ef-ba41-bce09c0cdde6" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="153.1" HigherBound="155.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SendEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendEmail" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="e2e6025c-1913-4fea-9d31-840ab946ce66" ParentLink="PortDeclaration_CLRAttribute" LowerBound="153.1" HigherBound="154.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="e48d393c-9b51-4e3f-9cd5-924fad7a72d8" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="155.1" HigherBound="157.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SendEmailSMTP_ListTransfer" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendEmailSMTP_ListTransfer" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="42ef4eb9-bd55-4d83-9fbb-4e6b1ce46cf9" ParentLink="PortDeclaration_CLRAttribute" LowerBound="155.1" HigherBound="156.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="476a7c53-f174-419a-b306-b1730a4027d3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="157.1" HigherBound="159.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ArchiveBasketCount" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveBasketCount" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="8f6660eb-f81a-4589-a2ad-b350c8ee0780" ParentLink="PortDeclaration_CLRAttribute" LowerBound="157.1" HigherBound="158.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4c286aab-2c50-4754-834e-a21973dbc56c" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="159.1" HigherBound="161.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_1" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveEmailFF" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="6b7676c0-fefd-4399-81a4-ee0528a2e27f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="159.1" HigherBound="160.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="568a430e-f580-4b6c-8d01-b453618c8f1d" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="161.1" HigherBound="163.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="52" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_emailsmtp_lt" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendEmailComplete_LT" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="PhysicalBindingAttribute" OID="8af3c259-6841-433e-bcf1-52498461a9eb" ParentLink="PortDeclaration_CLRAttribute" LowerBound="161.1" HigherBound="162.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="8baead97-b2ff-4814-a0f8-1e18b935e9f7" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="163.1" HigherBound="165.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_LT2_FaultPort" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="LT2_FaultPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="d7cde22e-1357-493f-8383-91dbae0d30d3" ParentLink="PortDeclaration_CLRAttribute" LowerBound="163.1" HigherBound="164.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="78544b83-b310-4bb6-80e1-0ff293a89f24" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="165.1" HigherBound="167.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SendEmail_LT2" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendEmailFail_LT2" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="4ebb09d1-e289-406f-a9d6-365f06faf5e9" ParentLink="PortDeclaration_CLRAttribute" LowerBound="165.1" HigherBound="166.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="ca244973-57e9-4853-842f-0893b97ae88b" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="167.1" HigherBound="169.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ArchiveSQL3" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveSQL3" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="fe632cef-15b9-4e12-8e44-66e0c7e81d30" ParentLink="PortDeclaration_CLRAttribute" LowerBound="167.1" HigherBound="168.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="f4db7ca1-acae-43ca-bdc9-137109649e53" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="169.1" HigherBound="171.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SQL2" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SQL2" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="fbeed384-51e1-4bba-864e-48d55f9ce3f1" ParentLink="PortDeclaration_CLRAttribute" LowerBound="169.1" HigherBound="170.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="d868b98c-7055-4751-9561-47b11d365563" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="171.1" HigherBound="173.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ArchiveSQL42" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveSQL4" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="cc0b7486-b265-4b70-acc8-44513cc4fe45" ParentLink="PortDeclaration_CLRAttribute" LowerBound="171.1" HigherBound="172.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a4cb8fc2-726c-4e3f-97a9-0bb5774894a2" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="173.1" HigherBound="175.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="280" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SQLGET" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SQLGET" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="ff255b18-34c9-48e4-a55f-a069110e5003" ParentLink="PortDeclaration_CLRAttribute" LowerBound="173.1" HigherBound="174.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0ed0c62c-7ec2-4c6c-ac32-5b25fdf7a1e9" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="175.1" HigherBound="177.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ArchiveSQLGET" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveSQLGET" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="e04aed4d-5895-4aae-b101-de557ee60d50" ParentLink="PortDeclaration_CLRAttribute" LowerBound="175.1" HigherBound="176.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="72a67f1d-0eef-40bb-a636-d14a3b560f93" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="177.1" HigherBound="179.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ArchiveSQLGetresponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveSQLGetResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="6d1f807b-e213-4830-a60c-ed0c86c2c762" ParentLink="PortDeclaration_CLRAttribute" LowerBound="177.1" HigherBound="178.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="8acfbbc2-09db-4394-a3ba-1668a1f27b40" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="179.1" HigherBound="181.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_Archive7EmailFTP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Archive7EmailFTP" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="b3e48ade-3328-4da4-a004-a0e29d75abac" ParentLink="PortDeclaration_CLRAttribute" LowerBound="179.1" HigherBound="180.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4464bf0e-56a3-49f1-bce9-13db9fd70283" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="181.1" HigherBound="183.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_EmailFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_EmailFF" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="9a982bee-4290-4b30-88c8-3b78afe27b96" ParentLink="PortDeclaration_CLRAttribute" LowerBound="181.1" HigherBound="182.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="15de177c-4208-439e-b46d-022c72b8340c" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="183.1" HigherBound="185.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_XMLUSERCHK" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SQLXMLUSERCHK" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="2c624444-6626-487f-905f-379ad2b92f1b" ParentLink="PortDeclaration_CLRAttribute" LowerBound="183.1" HigherBound="184.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="a1189b25-b301-49d2-b369-c724c41337e2" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="9.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_emailcompleteFF" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="85e8a142-2ba2-43a0-a4bd-2097f1a56ff3" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="PartDeclaration" OID="638c8c7b-f87c-44be-8fa9-cb614547a345" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="7.1" HigherBound="8.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="IsBodyPart" Value="False" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_bodyattachment" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="27fe439e-5684-4822-8a95-eeed6f6993ca" ParentLink="Module_MessageType" LowerBound="9.1" HigherBound="14.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_emailcomplete" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="8719641f-6e4a-4748-9449-37b8b3aa8694" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="11.1" HigherBound="12.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="PartDeclaration" OID="511d95b9-659c-47fd-83be-69b2f486de28" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="12.1" HigherBound="13.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="IsBodyPart" Value="False" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_bodyattachment" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="199f6cd6-598d-44b8-b9b8-d7a122fdb6ad" ParentLink="Module_MessageType" LowerBound="14.1" HigherBound="20.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_email" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="b9890394-a003-43fb-a8da-baf5afb82245" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="16.1" HigherBound="17.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="PartDeclaration" OID="f570d64c-a3e7-4561-ac1f-21fc453ef65b" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="17.1" HigherBound="18.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="IsBodyPart" Value="False" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_bodyattachment" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="PartDeclaration" OID="1cfbad0a-32d2-480c-a91f-3333c8613b16" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="18.1" HigherBound="19.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferCartsWarnings" />
                <om:Property Name="IsBodyPart" Value="False" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_bodyAttachment2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ListTransferCarts
{
    internal messagetype MultipartType_emailcompleteFF
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_body;
        Copy_of_ListCartSchema MessagePart_bodyattachment;
    };
    internal messagetype MultipartType_emailcomplete
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_body;
        Copy_of_ListCartSchema MessagePart_bodyattachment;
    };
    internal messagetype MultipartType_email
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_body;
        Copy_of_ListCartSchema MessagePart_bodyattachment;
        ListTransferCartsWarnings MessagePart_bodyAttachment2;
    };
    internal porttype PortType_ListTransferEnhanced
    {
        oneway Operation_1
        {
            ListCartSchema
        };
    };
    internal porttype PortType_SendListTransferEnhanced
    {
        oneway Operation_1
        {
            ListCartSchema
        };
    };
    internal porttype PortType_SendEmail
    {
        oneway Operation_1
        {
            Copy_of_ListCartSchema
        };
    };
    internal porttype PortType_SendEmailSMTP_ListTransfer
    {
        oneway Operation_1
        {
            MultipartType_email
        };
    };
    internal porttype PortType_ArchiveBasketCount
    {
        oneway Operation_1
        {
            BasketCountResponse
        };
    };
    internal porttype PortType_1
    {
        oneway Operation_1
        {
            ListTransferFFEmail
        };
    };
    internal porttype PortType_emailsmtp_lt
    {
        oneway Operation_1
        {
            MultipartType_emailcomplete
        };
    };
    internal porttype PortType_LT2_FaultPort
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_SendEmail_LT2
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_ArchiveSQL3
    {
        oneway Operation_1
        {
            LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets
        };
    };
    internal porttype PortType_SQL2
    {
        requestresponse procListTransferInsertBaskets
        {
            LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets, LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse
        };
    };
    internal porttype PortType_ArchiveSQL42
    {
        oneway Operation_1
        {
            LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse
        };
    };
    internal porttype PortType_SQLGET
    {
        requestresponse procListTransferGetLineWarningsLog
        {
            LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLog, LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLogResponse
        };
    };
    internal porttype PortType_ArchiveSQLGET
    {
        oneway Operation_1
        {
            LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLog
        };
    };
    internal porttype PortType_ArchiveSQLGetresponse
    {
        oneway Operation_1
        {
            LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLogResponse
        };
    };
    internal porttype PortType_Archive7EmailFTP
    {
        oneway Operation_1
        {
            Copy_of_ListCartSchema
        };
    };
    internal porttype PortType_EmailFF
    {
        oneway Operation_1
        {
            MultipartType_emailcompleteFF
        };
    };
    internal porttype PortType_XMLUSERCHK
    {
        requestresponse procTS360APIValidateUser
        {
            TypedProcedure_dbo.procTS360APIValidateUser, TypedProcedure_dbo.procTS360APIValidateUserResponse
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service ListTransferFromTS3_Cont
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_ListTransferEnhanced ReceiveListTransferEnhanced;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SendListTransferEnhanced Port_SendArchiveListTransferEnhanced;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SendEmail Port_SendEmail;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_SendEmailSMTP_ListTransfer Port_SendEmailSMTP_ListTransfer;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveBasketCount Port_ArchiveBasketCount;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_1 Port_ArchiveEmailFF;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_emailsmtp_lt Port_SendEmailComplete_LT;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses PortType_LT2_FaultPort LT2_FaultPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SendEmail_LT2 Port_SendEmailFail_LT2;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveSQL3 Port_ArchiveSQL3;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SQL2 Port_SQL2;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveSQL42 Port_ArchiveSQL4;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SQLGET Port_SQLGET;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveSQLGET Port_ArchiveSQLGET;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveSQLGetresponse Port_ArchiveSQLGetResponse;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Archive7EmailFTP Port_Archive7EmailFTP;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_EmailFF Port_EmailFF;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_XMLUSERCHK Port_SQLXMLUSERCHK;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage FaultMessage;
        message ListCartSchema Message_ListCartSchema;
        message Copy_of_ListCartSchema Message_Email;
        message MultipartType_email emailMsg;
        message ListCartSchema MessageArchive2ListCartSchema;
        message BasketCountResponse Message_BasketCount;
        message ListTransferFFEmail Message_EmailFF;
        message ListTransferCartsWarnings Message_Warnings;
        message MultipartType_emailcomplete emailMsgComplete;
        message IProfilesR2_VerifyUserPassword_InputMessage verifyPwdReq;
        message IProfilesR2_VerifyUserPassword_OutputMessage verifyPwdResponse;
        message BasketCountResponse MessageArchive5BasketCount;
        message ListTransferFFEmail MessageArchive6EmailFF;
        message LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets Message_ToSQL2;
        message LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBaskets Message_Archive3SQLRequest2;
        message LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse Message_FromSQL2;
        message LT_SQLADD_TypedProcedure_dbo.procListTransferInsertBasketsResponse Message_Archive4SQLResponse2;
        message LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLog Message_SQLGET;
        message LT_SQLGETTypedProcedure_dbo.procListTransferGetLineWarningsLogResponse Message_SQLGETRESPONSE;
        message Copy_of_ListCartSchema Message_Archive7EmailFTP;
        message MultipartType_emailcompleteFF emailMsgCompleteFF;
        message ListCartSchema Message_ListCartSchema2;
        message System.Xml.XmlDocument Message_XMLDummy;
        message ListCartSchemaIntermediate Message_ListCartSchemaIXML;
        message TypedProcedure_dbo.procTS360APIValidateUser msgVerifyUserEmailSqlReq;
        message TypedProcedure_dbo.procTS360APIValidateUserResponse msgVerifyUserEmailSqlResponse;
        System.Text.StringBuilder msgbody;
        System.String varBasketName;
        System.String varEmailAddress;
        System.String varSMTPFrom;
        System.String varSMTPTo;
        System.String varSMTPHost;
        System.String varUserID;
        System.Boolean varArchive1;
        System.Boolean varArchive2;
        System.Boolean varArchive3;
        System.Boolean varArchive4;
        System.String varFilename;
        System.Int32 varLineReceivedCount;
        System.String varLineReceivedCountString;
        System.String varLineInsertedCount;
        System.String varXpath;
        System.Xml.XmlDocument varDummy;
        System.String varCartName;
        System.String varSourceSystem;
        System.String varDestinationAction;
        System.Int32 varXMLFromFTP;
        System.String varXMLFromFTPDirectory;
        System.String varSMTPCC;
        System.Boolean varArchive5;
        System.Boolean varArchive6;
        System.Boolean varEmailSMTP;
        System.Int32 varResponse;
        System.String varMessage;
        System.Boolean Variable_1;
        System.String varBasketGuid;
        System.String varSMTPBiztalk;
        System.Boolean varArchive7;
        System.String varfilenameNew;
        System.String varAllowedSourceSystems;
        System.Int32 varAllowedSourceIndicator;
        System.String varAllowedDestinationActions;
        System.Int32 varAllowedDestinationActionsIndicator;
        System.String varReference;
        System.Boolean varFILEFROMFTP;
        System.String varFileLocation;
        System.String varBasketLineOverallLimit;
        System.String varBasketLineSplitLimit;
        System.String varCSGUID;
        System.String varEmailAddressCC;
        System.String varSMTPCCTemp1;
        System.String varSMTPCCTemp2;
        System.String varGroupName;
        System.String varBasketName2;
        System.String varUserFolder;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2e46e9c8-afee-40c2-8f10-948fe6a95806")]
            activate receive (ReceiveListTransferEnhanced.Operation_1, Message_ListCartSchema);
            msgbody = new System.Text.StringBuilder();
            varBasketName = "";
            varEmailAddress = "";
            varSMTPFrom = "";
            varSMTPTo = "";
            varSMTPHost = "";
            varUserID = "";
            varArchive1 = true;
            varArchive2 = true;
            varArchive3 = true;
            varArchive4 = true;
            varFilename = "";
            varLineReceivedCountString = "";
            varLineInsertedCount = "";
            varXpath = "";
            varDummy = new System.Xml.XmlDocument();
            varCartName = "";
            varSourceSystem = "";
            varDestinationAction = "";
            varXMLFromFTPDirectory = "";
            varSMTPCC = "";
            varArchive5 = true;
            varArchive6 = true;
            varEmailSMTP = false;
            varMessage = "";
            Variable_1 = true;
            varBasketGuid = "";
            varSMTPBiztalk = "";
            varArchive7 = true;
            varfilenameNew = "";
            varAllowedSourceSystems = "";
            varAllowedDestinationActions = "";
            varReference = "";
            varFILEFROMFTP = true;
            varFileLocation = "";
            varBasketLineOverallLimit = "";
            varBasketLineSplitLimit = "";
            varCSGUID = "";
            varEmailAddressCC = "";
            varSMTPCCTemp1 = "";
            varSMTPCCTemp2 = "";
            varGroupName = "";
            varBasketName2 = "";
            varUserFolder = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d528f154-8b25-429a-9773-51df7cf438f5")]
            scope
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b4821af8-80b8-4f4f-b349-53f12558ac74")]
                    varArchive2=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive2"));
                    varArchive3=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive3"));
                    varArchive4=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive4"));
                    varArchive5=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive5"));
                    varArchive6=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive6"));
                    varArchive7=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive7"));
                    varAllowedSourceSystems=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","AllowedSourceSystems"));
                    varAllowedDestinationActions=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","AllowedDestinationActions"));
                    varEmailSMTP=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","EmailExceptions"));
                    varXMLFromFTPDirectory=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ListTransfer","XMLFromFTPLocalDirectory");
                    varSMTPHost=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPHost"));
                    
                    varSMTPFrom=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPFrom"));
                    varSMTPBiztalk=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPBiztalk"));
                    
                    varBasketLineOverallLimit=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","BasketLineOverallLimit"));
                    varBasketLineSplitLimit=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","BasketLineSplitLimit"));
                    
                    
                    varBasketName = xpath(Message_ListCartSchema,"string(//CartName)");
                    
                    varUserFolder=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","UserFolder"));
                    
                    varEmailAddress = xpath(Message_ListCartSchema,"string(//UserEmail)");
                    varEmailAddressCC = xpath(Message_ListCartSchema,"string(//UserEmailCC)");
                    varSMTPCCTemp1=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPCC"));
                    // if EmailCC exists, combine with biztalk CC parameters, otherwise just use biztalk CC parameter 
                    if (varEmailAddressCC.Length > 0 ) 
                    {  
                        varSMTPCCTemp2 = varEmailAddressCC.Replace(",", ";"); 
                        varSMTPCC=varSMTPCCTemp1 + ";" + varSMTPCCTemp2; 
                    }
                    else 
                    {
                        varSMTPCC=varSMTPCCTemp1;
                    }
                    
                    //System.Diagnostics.EventLog.WriteEntry("email", varEmailAddress.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("email2", varEmailAddressCC.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("email3", varSMTPCC.ToString());
                    
                    
                    
                    varUserID = xpath(Message_ListCartSchema,"string(//DestinationUserID)");
                    varReference = xpath(Message_ListCartSchema,"string(//Reference)");
                    varLineReceivedCount = System.Convert.ToInt32(xpath(Message_ListCartSchema, "count(//Details)"));
                    
                    varFileLocation = Message_ListCartSchema(BTS.InboundTransportLocation);
                    //System.Diagnostics.EventLog.WriteEntry("Original Filepath", varFileLocation.ToString());
                    
                    varFilename = Message_ListCartSchema(FILE.ReceivedFileName);
                    
                    varfilenameNew = varFilename.Substring(varFilename.LastIndexOf(@"\") + 1);
                    
                    varXMLFromFTP = varFileLocation.IndexOf(varXMLFromFTPDirectory,0);
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename", varFilename.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename", varfilenameNew.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename3", varFilename);
                    varFilename = varFilename.Substring(varFilename.LastIndexOf(@"\") + 1);
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename4", varFilename);
                    varFilename = varFilename.Substring(0,varFilename.LastIndexOf(@".xml"));
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename5", varFilename);
                    
                    varDestinationAction = xpath(Message_ListCartSchema,"string(//DestinationAction)");
                    varSourceSystem =  xpath(Message_ListCartSchema,"string(//SourceSystem)");
                    varCartName =  xpath(Message_ListCartSchema,"string(//CartName)");
                    
                    
                    //make uppercase
                    varAllowedSourceSystems = varAllowedSourceSystems.ToUpper();
                    varAllowedDestinationActions = varAllowedDestinationActions.ToUpper();
                    
                    varSourceSystem = varSourceSystem.ToUpper();
                    varDestinationAction = varDestinationAction.ToUpper();
                    
                    
                    //determine if value exists within string
                    varAllowedSourceIndicator = varAllowedSourceSystems.IndexOf(varSourceSystem);
                    varAllowedDestinationActionsIndicator = varAllowedDestinationActions.IndexOf(varDestinationAction);
                    
                    varGroupName =  xpath(Message_ListCartSchema,"string(//GroupName)");
                    
                    if (varGroupName.Length > 0 ) 
                      { varBasketName2 = varGroupName + "_" + varBasketName; } 
                    else 
                       { varBasketName2 = varSourceSystem + "_" + varBasketName; } 
                    
                    
                    
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5f7e1cc7-4b47-49e2-be20-9d40f06669d2")]
                    if (varXMLFromFTP > 0)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8eb37c93-e2e1-476e-9fac-9872be422087")]
                        if (varArchive7 == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9c27d9cd-a8b6-4fe0-89d0-d239a370e051")]
                            construct Message_Archive7EmailFTP, Message_Email
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ef447a30-79e4-4d92-b01a-9f1dd7f5d239")]
                                transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2653d3f7-56af-4aec-aee0-79712855c7be")]
                                Message_Archive7EmailFTP = Message_Email; 
                                Message_Archive7EmailFTP(FILE.ReceivedFileName)=varfilenameNew; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("dc42fa5a-72c2-43c9-acf7-39fac23e2d86")]
                            send (Port_Archive7EmailFTP.Operation_1, Message_Email);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("246d764b-437a-4ffb-9815-31ba71b45501")]
                        //varCSGUID=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; 
                        varEmailAddress = xpath(Message_ListCartSchema,"string(//UserEmail)");
                        varUserID = xpath(Message_ListCartSchema,"string(//DestinationUserID)");
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6787c844-a6f9-43f0-be1f-dff5afc12c46")]
                        if (varEmailAddress.Length > 0 && varUserID.Length > 0 )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("536be139-c6dd-48c8-87c4-4ad5f5936a61")]
                            construct msgVerifyUserEmailSqlReq
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("39bc67f8-c18f-49e5-ab0b-bb52b7b9e869")]
                                transform (msgVerifyUserEmailSqlReq) = BTNextGen.Biztalk.ListTransferCarts.Transform_VerifyUserEmail (Message_ListCartSchema);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9d201834-73e6-4ed7-89a7-7bde38cf938a")]
                            send (Port_SQLXMLUSERCHK.procTS360APIValidateUser, msgVerifyUserEmailSqlReq);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fac21367-c7ca-46e0-afca-4a98df1a4703")]
                            receive (Port_SQLXMLUSERCHK.procTS360APIValidateUser, msgVerifyUserEmailSqlResponse);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0b529bf2-1395-4318-a82a-96bfbf9749e3")]
                            varCSGUID=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; 
                            //varEmailAddress = xpath(Message_ListCartSchema,"string(//UserEmail)");
                            //varUserID = xpath(Message_ListCartSchema,"string(//DestinationUserID)");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f1d9ea09-6fe9-4c22-bc68-34a649d6b0f6")]
                            if (varCSGUID != null)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d6bfe50f-94ef-4116-b42e-3ad0dc4e3f30")]
                                construct Message_ListCartSchema2
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("61a61e1f-fc1d-4459-bcbf-6c1b162f651a")]
                                    transform (Message_ListCartSchema2) = BTNextGen.Biztalk.ListTransferCarts.Transform_AddInGuid (Message_ListCartSchema);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7fd5f211-f56e-4d1a-87bf-23e9ea581fef")]
                                    //Message_XMLDummy = new System.Xml.XmlDocument();
                                    //Message_XMLDummy.LoadXml(@"<Dummy xmlns=""http://tempuri.org/""><DummyX xmlns:a=""http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""><a:BasketDetailsResponse><a:ErrorMessage> </a:ErrorMessage><a:LegacyBasketId>13759439</a:LegacyBasketId><a:LegacySourceSystem>TS3</a:LegacySourceSystem><a:LoadStatus>Loaded</a:LoadStatus></a:BasketDetailsResponse></DummyX></Dummy>");
                                    
                                    
                                    //Message_ListCartSchema2 = Message_XMLDummy;
                                    Message_ListCartSchema2.csUserGuid=varCSGUID; 
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0ce0ede8-58bc-4c8a-84ff-881a9020dfe0")]
                                construct Message_ListCartSchema, Message_XMLDummy
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d81dbe0a-4336-458e-b767-7a85048ad7c6")]
                                    Message_XMLDummy = new System.Xml.XmlDocument();
                                    Message_XMLDummy.LoadXml(@"<Dummy xmlns=""http://tempuri.org/""><DummyX xmlns:a=""http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""><a:BasketDetailsResponse><a:ErrorMessage> </a:ErrorMessage><a:LegacyBasketId>13759439</a:LegacyBasketId><a:LegacySourceSystem>TS3</a:LegacySourceSystem><a:LoadStatus>Loaded</a:LoadStatus></a:BasketDetailsResponse></DummyX></Dummy>");
                                    
                                    
                                    Message_ListCartSchema = Message_XMLDummy;
                                    
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("dca3c5b1-3b9b-4e1d-8815-6f32b4338a9e")]
                                    transform (Message_ListCartSchema) = BTNextGen.Biztalk.ListTransferCarts.Transform_1 (Message_ListCartSchema2);
                                }
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("94f3e5bf-781a-400e-8eaa-098f532f9f57")]
                                System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts","Invalid UserID/Email");
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9eaee52e-ed6c-48ac-a87c-d527f72b844f")]
                                construct Message_Email, emailMsgComplete
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0cccbc46-ec7e-4b34-b710-99102edd39d3")]
                                    transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a756edd-0109-4f86-ab91-7104576074ad")]
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    msgbody.AppendLine("Your cart was not created, the userid / email provided was invalid."); 
                                    msgbody.AppendLine("<p>UserID: " + varUserID); 
                                    msgbody.AppendLine("<p>Email : " + varEmailAddress); 
                                    msgbody.AppendLine("<p><p>Please note, the userid and email can fail for the following reason(s):");
                                    msgbody.AppendLine("<p>1. The Userid is mistyped or does not exist."); 
                                    msgbody.AppendLine("<p>2. The Email address is mistyped or does not exist. "  );
                                    msgbody.AppendLine("<p>3. The Email address must correspond to the email address on file for the Userid. "); 
                                    
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                    
                                    msgbody.AppendLine("</body></html>");
                                    
                                    
                                    
                                    
                                    
                                    emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                                    emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsgComplete(SMTP.From)= varSMTPFrom;
                                    emailMsgComplete(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                    
                                    emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a232b684-a60a-4aa7-9854-cc0c0613fb5b")]
                                send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4314dcd2-fcba-4710-97fa-41acc07c9f54")]
                                terminate "Process terminated due to bad userid / email";;
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("64d968ce-7f33-4093-b6fb-a271f2eb0ec7")]
                            System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts","Invalid UserID/Email");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b35ae1bd-dee1-421a-b8bb-ddd380531d93")]
                            construct Message_Email, emailMsgComplete
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("91f7ac48-9910-46e7-b9a0-a456967a330d")]
                                transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("da15535b-da0e-4136-94e8-bfc51f611f4f")]
                                msgbody = new System.Text.StringBuilder();
                                msgbody.AppendLine("<html><body>");
                                msgbody.AppendLine("Filename: " + varFilename);
                                msgbody.AppendLine("<p><p>Summary:");
                                msgbody.AppendLine("Your cart was not created, the userid / email provided was missing :"); 
                                msgbody.AppendLine("<p>UserID: " + varUserID); 
                                msgbody.AppendLine("<p>Email : " + varEmailAddress); 
                                
                                
                                
                                msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                
                                msgbody.AppendLine("</body></html>");
                                
                                
                                
                                
                                
                                emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                                emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                
                                emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                emailMsgComplete(SMTP.From)= varSMTPFrom;
                                emailMsgComplete(SMTP.CC)=varSMTPCC;
                                
                                emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                
                                emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                
                                Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4dfba0cc-ff5d-443d-94b9-6cb20c71e800")]
                            send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("dd7d8206-c3ce-484e-9774-d036c4636716")]
                            terminate "Process terminated due to bad userid / email";;
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("62ceb7d8-9d6d-4f1e-8d99-1f535499c28a")]
                    if (varBasketName.Length < 1 || varBasketName.Length > 81)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a8feae1d-9ebc-414b-bbc7-ce3b75ce3e85")]
                        construct Message_Email, emailMsgComplete
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("98f055ee-5535-49fe-ad1c-6f21c1355b88")]
                            transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("db25f711-6d57-4d75-87a0-b64ed9b44b7d")]
                            msgbody = new System.Text.StringBuilder();
                            msgbody.AppendLine("<html><body>");
                            msgbody.AppendLine("Filename: " + varFilename);
                            msgbody.AppendLine("<p><p>Summary:");
                            msgbody.AppendLine("Your cart was not created, the cart name was invalid: " + varBasketName); 
                            
                            
                            
                            msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                            msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                            
                            msgbody.AppendLine("</body></html>");
                            
                            
                            
                            
                            
                            emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                            emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                            emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                            emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            
                            emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                            emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                            emailMsgComplete(SMTP.From)= varSMTPFrom;
                            emailMsgComplete(SMTP.CC)=varSMTPCC;
                            
                            
                            emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                            
                            emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                            emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                            
                            Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("41dca3c6-3858-4bd1-80ed-5f6a3e2c5074")]
                        send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("98b18d5c-7c47-44f6-9a02-a9a4397e7776")]
                        terminate "Invalid BasketName sent"; ;
                    }
                    else if (//varDestinationAction.ToUpper() != "CART" && varDestinationAction.ToUpper() != "GRIDCART"
                        varAllowedDestinationActionsIndicator == -1)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4be1d810-dda1-4e44-bc0c-d9f2b34646bb")]
                        construct Message_Email, emailMsgComplete
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c7f6d19-6997-4805-ab25-c902afd053d1")]
                            transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e470ba0-6320-4587-aea3-f9dfd35b65be")]
                            msgbody = new System.Text.StringBuilder();
                            msgbody.AppendLine("<html><body>");
                            msgbody.AppendLine("Filename: " + varFilename);
                            msgbody.AppendLine("<p><p>Summary:");
                            msgbody.AppendLine("Your cart " + varBasketName + " was not created"); 
                            msgbody.AppendLine("<p>The destination action supplied was invalid: "+ varDestinationAction ); 
                            
                            
                            msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString() );
                            msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                            
                            msgbody.AppendLine("</body></html>");
                            
                            
                            
                            
                            
                            emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                            emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                            emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                            emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            
                            emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                            emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                            emailMsgComplete(SMTP.From)= varSMTPFrom;
                            emailMsgComplete(SMTP.CC)=varSMTPCC;
                            
                            
                            emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                            
                            emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                            emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                            
                            Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e23cabba-e143-4ad7-b1f3-b660cf135532")]
                        send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("362c2772-78b2-48fd-987b-ab128c360e8d")]
                        terminate "Invalid Destination Action sent"; ;
                    }
                    else if (//varSourceSystem.ToUpper() != "BOOKLIST" && varSourceSystem.ToUpper() != "NEXTREAD" && varSourceSystem.ToUpper() != "EXCELTOOL"
                        
                        varAllowedSourceIndicator == -1)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b0cbb9aa-8d98-4570-a71d-f16473f2bbea")]
                        construct Message_Email, emailMsgComplete
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f8f57216-2a90-4aa2-af35-c880bf8534ef")]
                            transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed2bcdb9-6049-4d96-84fa-60309402062e")]
                            msgbody = new System.Text.StringBuilder();
                            msgbody.AppendLine("<html><body>");
                            msgbody.AppendLine("Filename: " + varFilename);
                            msgbody.AppendLine("<p><p>Summary:");
                            msgbody.AppendLine("Your cart " + varBasketName + " was not created"); 
                            msgbody.AppendLine("<p>The source system supplied was invalid: "+ varSourceSystem ); 
                            
                            msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                            msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                            msgbody.AppendLine("</body></html>");
                            
                            emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                            emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                            emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                            emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            
                            emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                            emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                            emailMsgComplete(SMTP.From)= varSMTPFrom;
                            emailMsgComplete(SMTP.CC)=varSMTPCC;
                            
                            
                            emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                            
                            emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                            emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                            
                            Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cef40b64-788e-437d-ac72-bc60dbcf36b3")]
                        send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("31ef5696-e525-4a32-9cf2-6fd2b8236264")]
                        terminate "Invalid Source System sent..."; ;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c65a9ce5-74df-4ae7-8826-246bcdb08ef8")]
                    if (varArchive2 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7b216e98-9ef1-4d02-a044-7646302dc8a8")]
                        construct MessageArchive2ListCartSchema
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a1d40cf0-89d0-4184-a043-0646996be0ff")]
                            MessageArchive2ListCartSchema = Message_ListCartSchema; 
                            MessageArchive2ListCartSchema(FILE.ReceivedFileName)="Archive2XMLListTransfer"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("562c0b49-b80a-4862-aaee-b8ce67132bb1")]
                        send (Port_SendArchiveListTransferEnhanced.Operation_1, MessageArchive2ListCartSchema);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a8a8f5e8-58d9-44b7-bc7b-fb7e345d7c20")]
                    construct Message_ListCartSchemaIXML
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6c79689d-8a87-4e25-b413-5f9fde483daf")]
                        transform (Message_ListCartSchemaIXML) = BTNextGen.Biztalk.ListTransferCarts.Transform_IXML (Message_ListCartSchema);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("62b34910-1d48-4888-84ed-df481a02bc9e")]
                        xpath(Message_ListCartSchemaIXML,    "/*[local-name()='ListCarts' and namespace-uri()='http://ListTransferCarts.ListCartSchemaIntermediate']/*[local-name()='BasketLineSplitLimit' and namespace-uri()='']") = varBasketLineSplitLimit; 
                        xpath(Message_ListCartSchemaIXML,    "/*[local-name()='ListCarts' and namespace-uri()='http://ListTransferCarts.ListCartSchemaIntermediate']/*[local-name()='BasketLineOverallLimit' and namespace-uri()='']") = varBasketLineOverallLimit; 
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("04631c10-730e-4fca-8c1b-8aaaa3486af6")]
                    construct Message_ToSQL2
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("90db5dfa-0619-4a80-bc25-5264e6845189")]
                        transform (Message_ToSQL2) = BTNextGen.Biztalk.ListTransferCarts.Transform_RequestSQL2 (Message_ListCartSchemaIXML);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("98c19c38-58ca-419e-9a76-a8e30cc2ea40")]
                    if (varArchive3 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("02c30cc0-861e-4a94-b170-4b8140acdaea")]
                        construct Message_Archive3SQLRequest2
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba38c1d0-8759-43b2-84be-3f0cbe783a84")]
                            Message_Archive3SQLRequest2 = Message_ToSQL2; 
                            Message_Archive3SQLRequest2(FILE.ReceivedFileName)="Archive3SQLRequest"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("44f9aaaa-4879-4a5f-899f-1ac086575c4e")]
                        send (Port_ArchiveSQL3.Operation_1, Message_Archive3SQLRequest2);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2fb0deac-077e-4ab0-a1bd-35882ea2024c")]
                    send (Port_SQL2.procListTransferInsertBaskets, Message_ToSQL2);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6d196609-2b5e-4e31-95ee-1d1c7441ade6")]
                    receive (Port_SQL2.procListTransferInsertBaskets, Message_FromSQL2);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b01dc20c-9b60-42f8-851d-7dad85c11158")]
                    if (varArchive4 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b4918ef6-c0fd-4fd8-9949-13a8546a8661")]
                        construct Message_Archive4SQLResponse2
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f278c80-98fa-4873-a319-48294fcc0e70")]
                            Message_Archive4SQLResponse2 = Message_FromSQL2; 
                            Message_Archive4SQLResponse2(FILE.ReceivedFileName)="Archive4SQLResponse"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d720e562-8cac-4fca-a739-e413a13dbec2")]
                        send (Port_ArchiveSQL4.Operation_1, Message_Archive4SQLResponse2);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7198810a-0901-43ba-81e6-1815c606ce80")]
                    construct Message_BasketCount
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a45a40e6-5019-42d4-b7ae-4319f732e2bd")]
                        transform (Message_BasketCount) = BTNextGen.Biztalk.ListTransferCarts.Transform_BasketCount (Message_FromSQL2);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("334c224d-a365-4f9f-adf1-cd725b55b869")]
                    if (varArchive5 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0a9d1222-0c29-47bf-82ae-0106443b6682")]
                        construct MessageArchive5BasketCount
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("206da181-c173-4c4f-a793-1161cf1594d6")]
                            MessageArchive5BasketCount = Message_BasketCount; 
                            MessageArchive5BasketCount(FILE.ReceivedFileName)="Archive5BasketCount"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9fd9d7c1-aa1a-4229-8908-b424d49847d2")]
                        send (Port_ArchiveBasketCount.Operation_1, MessageArchive5BasketCount);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5f602099-8827-4ab0-8ebc-8eb89e49a1ec")]
                    varLineInsertedCount = xpath(Message_BasketCount, "string(//BasketLinesInserted)");
                    varResponse = xpath(Message_BasketCount, "string(//ReturnValue)");
                    varMessage = xpath(Message_BasketCount, "string(//Message)");
                    varBasketGuid = xpath(Message_BasketCount, "string(//BasketOrderFormGuid)");
                    
                    //System.Diagnostics.EventLog.WriteEntry("show me the count", varLineInsertedCount.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("show me the respnse", varResponse.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("show me the message", varMessage.ToString());
                    //System.Diagnostics.EventLog.WriteEntry("show me the host",varSMTPHost.ToString());
                    
                    
                    
                    //varUserID = xpath(Message_ListCartSchema,"string(//DestinationUserID)");
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e1cb13f8-435f-4e9f-82e0-77beeffc33d7")]
                    construct Message_EmailFF
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("212d8b76-002a-4f2c-82db-8d3b14c72e87")]
                        transform (Message_EmailFF) = BTNextGen.Biztalk.ListTransferCarts.Transform_EmailFF (Message_ListCartSchema);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2cb56345-fa9b-4425-b755-d4037a95bdc3")]
                    if (varArchive6 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a96ecf1-7dc0-46f0-a681-5d8e0d27245c")]
                        construct MessageArchive6EmailFF
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5b55ef05-dfdf-4494-8a2c-f929beca93d7")]
                            MessageArchive6EmailFF = Message_EmailFF; 
                            MessageArchive6EmailFF(FILE.ReceivedFileName)="Archive6EmailFF"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e21a5e33-24a9-4fff-987d-d57ff9b7d936")]
                        send (Port_ArchiveEmailFF.Operation_1, MessageArchive6EmailFF);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("eb8bc632-3d2c-4ef2-8076-02cbd358f758")]
                    if (varResponse > 50000 && varResponse < 50040)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f33a8cd0-87eb-4c95-8047-2b58c57fbcc0")]
                        construct Message_Email, emailMsgComplete
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ae4ecb1b-e161-4d21-845d-f5743fbedb0b")]
                            transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("24bc112f-87cc-4cc7-b466-b9ac402dbeaa")]
                            msgbody = new System.Text.StringBuilder();
                            msgbody.AppendLine("<html><body>");
                            msgbody.AppendLine("Filename: " + varFilename);
                            msgbody.AppendLine("<p><p>Summary:");
                            msgbody.AppendLine("Your cart " + varBasketName + " was not created successfully"); 
                            
                            msgbody.AppendLine("<p><p>Reason: " + varMessage);
                            msgbody.AppendLine("</body></html>");
                            
                            //varSMTPHost = "5.0.110.24";
                            //varSMTPFrom = "BTBiztalk@baker-taylor.com";
                            
                            
                            
                            
                            emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                            emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                            emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                            emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            
                            emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                            emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                            emailMsgComplete(SMTP.From)= varSMTPFrom;
                            emailMsgComplete(SMTP.CC)=varSMTPCC;
                            
                            emailMsgComplete(SMTP.Subject)="ListTransfer: UnSuccessful Cart action for " + varUserID;   
                            
                            emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                            emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                            
                            Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a3ffb500-cb89-46e7-a818-7ab4ac112606")]
                        send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f82b1015-ffca-4776-b21e-ee6f9991ae91")]
                        if (varEmailSMTP == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("778bbe71-721a-4cf0-a606-d06af787363c")]
                            send (Port_SendEmail.Operation_1, Message_Email);
                        }
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2360399a-919a-421c-afd9-5aab8341a616")]
                        if (varResponse != 0 )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6989e879-25f7-4233-9bf0-79c33bed210a")]
                            construct Message_Email, emailMsgComplete
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4104f4ac-bbc4-4655-8c05-e4410e6bb02d")]
                                transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ad53bb0d-f7ae-467a-9b12-82355d965814")]
                                msgbody = new System.Text.StringBuilder();
                                msgbody.AppendLine("<html><body>");
                                msgbody.AppendLine("Filename: " + varFilename);
                                msgbody.AppendLine("<p><p>Summary:");
                                msgbody.AppendLine("Your cart " + varBasketName + " was not created successfully"); 
                                
                                msgbody.AppendLine("<p><p>Reason: " + varMessage);
                                msgbody.AppendLine("</body></html>");
                                
                                //varSMTPHost = "5.0.110.24";
                                //varSMTPFrom = "BTBiztalk@baker-taylor.com";
                                
                                
                                
                                
                                emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                                emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                
                                emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                emailMsgComplete(SMTP.From)= varSMTPFrom;
                                emailMsgComplete(SMTP.CC)=varSMTPCCTemp1;
                                
                                emailMsgComplete(SMTP.Subject)="ListTransfer: UnSuccessful Cart action for " + varUserID;   
                                
                                emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                
                                Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varSMTPBiztalk;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a58476c8-59d6-4874-b541-f7e0112df121")]
                            send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e834c8c-1271-4efa-9c78-170fd334b56f")]
                            if (varEmailSMTP == true)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1615b7ea-7804-4854-ba00-4dd28af9b0e3")]
                                send (Port_SendEmail.Operation_1, Message_Email);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("107de40f-f872-4f29-ac7b-313e12a3d1e7")]
                            if (varArchive7 == true)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("669b7487-42e4-40fb-826f-5315264bf872")]
                                construct Message_Archive7EmailFTP
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4db1121a-ef15-41c4-aa10-a72cd9221a0e")]
                                    Message_Archive7EmailFTP = Message_Email; 
                                    Message_Archive7EmailFTP(FILE.ReceivedFileName)="Archive7EmailFTP"; 
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("177b6ffa-b099-4bf8-8640-5e941e7d2f8c")]
                                send (Port_Archive7EmailFTP.Operation_1, Message_Email);
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d36a0949-1c44-4dfb-81d0-bfd4880c698e")]
                            if ((varLineInsertedCount == varLineReceivedCount.ToString()) )
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("84e56b19-2b4a-4ebf-9efb-0a52465b0b12")]
                                construct Message_Email, emailMsgComplete
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ccd48b15-6c22-49aa-b92c-dfd46314ac5d")]
                                    transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4e66b62a-4cce-421e-9664-61b436d5bada")]
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    msgbody.AppendLine("Your cart " + varBasketName2 + " was created successfully in the "); 
                                    msgbody.AppendLine( varUserFolder + "."); 
                                    
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: " + varLineInsertedCount.ToString());
                                    
                                    msgbody.AppendLine("</body></html>");
                                    //varSMTPHost = "5.0.110.24";
                                    //varSMTPFrom = "BTBiztalk@baker-taylor.com";
                                    
                                    
                                    
                                    
                                    emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsgComplete.MessagePart_bodyattachment = Message_Email;  //was message_email
                                    emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsgComplete(SMTP.From)= varSMTPFrom;
                                    emailMsgComplete(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsgComplete(SMTP.Subject)="ListTransfer: Completely Successful Cart action for " + varUserID;   
                                    
                                    emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bedbe771-6154-47ec-b2c4-f925228b7ce7")]
                                send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3cbec473-6497-4a49-977f-4dc7a80daba6")]
                                if (varEmailSMTP == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("60bfc330-6ded-4992-a97c-59d38499a836")]
                                    send (Port_SendEmail.Operation_1, Message_Email);
                                }
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("25821e3e-a6d6-43d1-a17b-c6de7de43925")]
                                construct Message_SQLGET
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c148222a-1efa-45d6-a4f9-3b586347f159")]
                                    transform (Message_SQLGET) = BTNextGen.Biztalk.ListTransferCarts.Transform_SQLGET (Message_FromSQL2);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e20099c5-9eb8-455d-b648-f8c36e903c0d")]
                                send (Port_ArchiveSQLGET.Operation_1, Message_SQLGET);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("58847507-b27a-4b9d-b7aa-0b5295debd68")]
                                send (Port_SQLGET.procListTransferGetLineWarningsLog, Message_SQLGET);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2802bf76-8fe5-4a0a-8b4f-db4fe727b068")]
                                receive (Port_SQLGET.procListTransferGetLineWarningsLog, Message_SQLGETRESPONSE);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b25c78c2-0989-49a5-a702-ddfa9160d815")]
                                send (Port_ArchiveSQLGetResponse.Operation_1, Message_SQLGETRESPONSE);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ec9b7608-8e1a-46e1-b8b1-84d0c62fd015")]
                                construct Message_Email, emailMsg, Message_Warnings
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e57d3f9-95e5-4bd7-a203-6e54e50e81ed")]
                                    transform (Message_Email) = BTNextGen.Biztalk.ListTransferCarts.Transform_Email (Message_ListCartSchema);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("617b9022-fd2f-447a-9187-10e3a2a0a09e")]
                                    transform (Message_Warnings) = BTNextGen.Biztalk.ListTransferCarts.Transform_Warnings (Message_SQLGETRESPONSE);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1dc24a8a-1455-484f-b617-0865248547d7")]
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    
                                    msgbody.AppendLine("Your cart " + varBasketName2 + " was created partially in the ");
                                    msgbody.AppendLine( varUserFolder + "."); 
                                     
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: " + varLineInsertedCount.ToString());
                                    
                                    msgbody.AppendLine("</body></html>");
                                    //varSMTPHost = "5.0.110.24";
                                    //varSMTPFrom = "BTBiztalk@baker-taylor.com";
                                    
                                    
                                    
                                    
                                    emailMsg.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsg.MessagePart_bodyattachment = Message_Email;  //was message_email
                                    emailMsg.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsg.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                      
                                    emailMsg.MessagePart_bodyAttachment2 = Message_Warnings;  //was message_email
                                    emailMsg.MessagePart_bodyAttachment2(MIME.FileName) = varFilename + "_warnings.xml";
                                    emailMsg.MessagePart_bodyAttachment2(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    
                                    emailMsg.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsg(SMTP.From)= varSMTPFrom;
                                    emailMsg(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsg(SMTP.Subject)="ListTransfer: Partially Successful Cart action for " + varUserID; 
                                    emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsg(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailSMTP_ListTransfer(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("971d7ccd-9489-4502-b09b-6b3f8ec68187")]
                                send (Port_SendEmailSMTP_ListTransfer.Operation_1, emailMsg);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ff8112c-2820-431a-98f4-06d56c427207")]
                                if (varEmailSMTP == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7b799f4c-d500-4e80-9756-3aa707c1085e")]
                                    send (Port_SendEmail.Operation_1, Message_Email);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("98f6c29f-6102-41dd-b2ad-f583621a5399")]
                                if (varArchive7 == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9b415133-96c3-4526-824e-6dba594b4777")]
                                    construct Message_Archive7EmailFTP
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("92bfaf11-1d3a-4be5-a248-e5f23077d96b")]
                                        Message_Archive7EmailFTP = Message_Email; 
                                        Message_Archive7EmailFTP(FILE.ReceivedFileName)="Archive7EmailFTP"; 
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("bdb17f55-2b60-40df-aee2-1319ba8d8586")]
                                    send (Port_Archive7EmailFTP.Operation_1, Message_Email);
                                }
                            }
                        }
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("14393532-ee37-4628-9bd9-fdf0324a814f")]
                    catch (System.SystemException ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c5d9585f-3a84-4898-83f3-3aade189e81f")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e5ae1b84-2cf9-4bf0-9e8b-8cec2ca214cf")]
                            
                            
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="Btnextgen.Biztalk.ListTransferCarts2 Exception";
                            FaultMessage.FaultDescription=ex.Message;
                            FaultMessage.FaultCode="3011";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f7752806-8ef9-42d4-bd5c-c4767dc99be2")]
                        send (LT2_FaultPort.Operation_1, FaultMessage);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("70f7ebbc-e4f9-489a-8a4a-dc7d829a15af")]
                        send (Port_SendEmailFail_LT2.Operation_1, FaultMessage);
                    }
                }
            }
        }
    }
}

