#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="23c12fa7-fb11-4444-87c5-59a9ae280cb4" LowerBound="1.1" HigherBound="751.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ListTransferCarts" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="fe0ffeb9-de52-4e6b-915f-6309f23750a2" ParentLink="Module_PortType" LowerBound="8.1" HigherBound="15.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ReceiveFlatFile" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="073ffb95-f15c-4304-9c46-466fcef23e7a" ParentLink="PortType_OperationDeclaration" LowerBound="10.1" HigherBound="14.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="33affc93-e788-4d55-8c02-5f6c5922b0ee" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="12.13" HigherBound="12.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="2db63565-fae7-4927-a372-7823e5841177" ParentLink="Module_PortType" LowerBound="15.1" HigherBound="22.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Archive1_FF" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="1c796869-9d37-42b3-b2d0-2ad7cc10c6d3" ParentLink="PortType_OperationDeclaration" LowerBound="17.1" HigherBound="21.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="ee682dc2-6a57-48b9-b73a-096e908ff1bc" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="19.13" HigherBound="19.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="f1618038-5ec7-491d-8505-a5e935bf7cd4" ParentLink="Module_PortType" LowerBound="22.1" HigherBound="29.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_FaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="a4b2e19c-2a6d-4867-9241-87cd45048e53" ParentLink="PortType_OperationDeclaration" LowerBound="24.1" HigherBound="28.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="74252bdd-cda9-43ce-b433-b4603eb8135d" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="26.13" HigherBound="26.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="515f9dec-7ca9-4bfa-af55-bffcc56b1f38" ParentLink="Module_PortType" LowerBound="29.1" HigherBound="36.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_BusFaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="bdc47471-d53e-4e1d-a4d2-a9130d10e8c4" ParentLink="PortType_OperationDeclaration" LowerBound="31.1" HigherBound="35.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="b2967872-4e4f-4e27-980c-67f8322f0507" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="33.13" HigherBound="33.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="39a5587b-b231-43d7-927f-26e329812c84" ParentLink="Module_PortType" LowerBound="36.1" HigherBound="43.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_BIZFaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="cea47401-08d6-4cbb-b14b-7267d6aace99" ParentLink="PortType_OperationDeclaration" LowerBound="38.1" HigherBound="42.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="8a552a52-bee0-4ee9-9bbf-4198d8de3f42" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="40.13" HigherBound="40.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="b862730f-87b5-424d-895e-514f225d4f53" ParentLink="Module_PortType" LowerBound="43.1" HigherBound="50.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="TS360FTPPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="309e1a46-7ce1-4d8f-9bc7-249a84e1e3a2" ParentLink="PortType_OperationDeclaration" LowerBound="45.1" HigherBound="49.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="898fc311-db14-4b0f-95a5-da813fe2c811" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="47.13" HigherBound="47.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="21ea00ef-1c00-42f8-8471-a2881928e49d" ParentLink="Module_PortType" LowerBound="50.1" HigherBound="57.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="TS3PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="d4926597-1836-470e-bf5f-231a8c559786" ParentLink="PortType_OperationDeclaration" LowerBound="52.1" HigherBound="56.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="e95e98a6-88e2-4209-8ab0-e71d2aa35360" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="54.13" HigherBound="54.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="384cdbc1-ac24-4528-b2b3-35f622d8d1ab" ParentLink="Module_PortType" LowerBound="57.1" HigherBound="64.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="sqlPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="375a253d-270a-415a-9b8f-71c6a55776b6" ParentLink="PortType_OperationDeclaration" LowerBound="59.1" HigherBound="63.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="896d1864-8d4b-4814-8cde-bab28757ee50" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="61.13" HigherBound="61.54">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.VerifyUserSQL.procListTransfer_VerifyUser" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="228504a6-04de-4e4d-9786-14dfbf355f96" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="61.56" HigherBound="61.105">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.VerifyUserSQL.procListTransfer_VerifyUserResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="297736d3-3227-47b7-890f-b79e058509d9" ParentLink="Module_PortType" LowerBound="64.1" HigherBound="71.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendEmail_LT" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="9d5c8261-9980-4915-a952-8a2d52fd2a05" ParentLink="PortType_OperationDeclaration" LowerBound="66.1" HigherBound="70.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="d7850386-1cdc-49cc-90c5-c64c913aea4f" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="68.13" HigherBound="68.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0de22faa-dbe1-452e-a6c2-6de69e7fbfed" ParentLink="Module_PortType" LowerBound="71.1" HigherBound="78.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_TS3PortDynamic" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="3914d632-726f-4161-81f6-2252385331b2" ParentLink="PortType_OperationDeclaration" LowerBound="73.1" HigherBound="77.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="186bf64e-dca4-4cd1-b998-5fb5ae9d6a2b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="75.13" HigherBound="75.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="97e65f2d-7d8c-4a41-8026-68bbe32877ef" ParentLink="Module_PortType" LowerBound="78.1" HigherBound="85.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveFF_FTP" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b86c8e8c-a0f4-4c21-9bc6-7f690b6daf1c" ParentLink="PortType_OperationDeclaration" LowerBound="80.1" HigherBound="84.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="5897df1b-999e-47e8-ba07-86a4a7613013" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="82.13" HigherBound="82.32">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFFEmail" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="6132cd34-fb11-4310-b1da-cc0a06cf9748" ParentLink="Module_PortType" LowerBound="85.1" HigherBound="92.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Archive8_WCFFF" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="89afe9fb-9c28-4b4d-9987-b791cab0688f" ParentLink="PortType_OperationDeclaration" LowerBound="87.1" HigherBound="91.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="ed4903cb-ad3a-4b78-ae86-636446e72c61" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="89.13" HigherBound="89.27">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="97e9ec0a-5f4e-43cb-b17f-1187367a96c2" ParentLink="Module_PortType" LowerBound="92.1" HigherBound="99.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_MessageInput" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="e3a7e6e0-726c-4aec-9930-051a21d4203f" ParentLink="PortType_OperationDeclaration" LowerBound="94.1" HigherBound="98.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="dcedbd90-d733-42e8-85bd-57949cadf461" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="96.13" HigherBound="96.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="38197ba5-e60e-49c4-b4db-e490ff6a093f" ParentLink="Module_PortType" LowerBound="99.1" HigherBound="106.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveMessageInput" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b743d20a-9e62-4b3f-ac0e-d3bbde4598f1" ParentLink="PortType_OperationDeclaration" LowerBound="101.1" HigherBound="105.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="7dd22491-4743-4758-b131-52127e8e4575" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="103.13" HigherBound="103.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="886c548d-fe98-4ccd-b979-93c01bfa271c" ParentLink="Module_PortType" LowerBound="106.1" HigherBound="113.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SqlReq" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4aeb4c01-00b1-4ca5-87e7-b51fda4e70c2" ParentLink="PortType_OperationDeclaration" LowerBound="108.1" HigherBound="112.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="procTS360APIValidateUser" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="e0022804-1b68-47d5-a451-b79f33db29b9" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="110.13" HigherBound="110.56">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUser" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="82898529-f938-44ec-afcd-fabe6bb39942" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="110.58" HigherBound="110.109">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUserResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="d5e4d95e-59fa-4eb4-a2ef-68d8b4979662" ParentLink="Module_ServiceDeclaration" LowerBound="113.1" HigherBound="750.1">
            <om:Property Name="InitializedTransactionType" Value="True" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="OrchestrationListTransfer" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="7f106e7d-5c64-4941-9e38-b9e5fd477eab" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="157.1" HigherBound="158.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="False" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fa7413d8-355c-4c9c-b314-35c19bc7021b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="158.1" HigherBound="159.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e928f619-3249-42a2-8f1f-cb4fca7a07ed" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="159.1" HigherBound="160.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFilename" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8f2180f6-3a5a-4fd8-bbe4-5116ea3db180" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="160.1" HigherBound="161.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLineReceivedCount1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="82f88919-f89d-4860-bec6-c6b651577d1b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="161.1" HigherBound="162.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLineReceivedCount2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="effc12b9-c799-4d08-94ae-2a549fd87858" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="162.1" HigherBound="163.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLineReceivedCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="dd5be5a9-9a6b-4b60-bb25-393d14305972" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="163.1" HigherBound="164.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPHost" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b8e4bde4-af94-41f3-95a4-dc1291237c70" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="164.1" HigherBound="165.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPCC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="aebb9ae0-db2b-4a2a-95ce-c637d2e18b3e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="165.1" HigherBound="166.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPFrom" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7b68ac1e-4d8f-43d6-a582-27e2462b79b1" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="166.1" HigherBound="167.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailAddress" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cbf26e19-dc94-4a17-9cc4-25e6f51f2269" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="167.1" HigherBound="168.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUserID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5d78ac13-1a6f-43ab-8ac5-ba52ef5d5932" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="168.1" HigherBound="169.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailExceptions" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="26aaa6e5-c29c-4be1-a6c6-7110cd6cf85f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="169.1" HigherBound="170.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fce33585-385c-44cd-91bb-73decb1c5d1b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="170.1" HigherBound="171.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varErrorMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6444004a-adea-4052-8781-1a1b9a2bbd5a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="171.1" HigherBound="172.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFilenameLEN" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9573aca3-d7e9-4633-b150-7dc2fea582a5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="172.1" HigherBound="173.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFilenameNOEXT" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="dfc4f9cc-8032-40d8-9df2-d768f56d36af" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="173.1" HigherBound="174.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varFilenameEXT" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c192b838-9af4-497c-9bac-e2e22b9532b5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="174.1" HigherBound="175.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPUser" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="dd1ca323-e2be-42c0-8932-629aec91b243" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="175.1" HigherBound="176.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPPassword" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="966857fd-83a7-4dc1-bbd4-a890103ab107" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="176.1" HigherBound="177.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPRepType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="64f73fdc-7093-44f1-8100-040f1715e9e5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="177.1" HigherBound="178.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPTransportType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9a429ee6-13cb-479e-b4b4-ab5d0180f73f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="178.1" HigherBound="179.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPLogDirectory" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4cc56331-3e83-42b2-a5c2-0cfe81d05b2c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="179.1" HigherBound="180.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPLog" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="37834951-27ea-4ea7-86c6-344707216364" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="180.1" HigherBound="181.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS3FTPAddress" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="66a29926-643f-4545-93bb-e534b387f2b9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="181.1" HigherBound="182.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive8" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="78da03cd-f174-4bca-ae5d-808d2dea1fcd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="182.1" HigherBound="183.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSendFatalTS3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0edca8cd-362d-44b1-b371-4e0e12b1b215" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="183.1" HigherBound="184.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSourceSystem" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b8cb6f76-17cc-4280-ab70-de9eb95efbe2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="184.1" HigherBound="185.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCSGUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="92b4e473-78c3-4e03-9473-6d9a310e3b0e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="185.1" HigherBound="186.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varLogging" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="96cd2f1a-e50d-4ff9-b6f6-11efd7033a6a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="186.1" HigherBound="187.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailAddressCC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d9144661-29bf-4d54-8ea7-16ef7c623aa8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="187.1" HigherBound="188.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPCCTemp1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fd1838f8-879c-467b-9590-0c4fb0411336" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="188.1" HigherBound="189.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPCCTemp2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="324da742-c577-4ad2-b655-0acc5662dc79" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="189.1" HigherBound="190.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUserFolder" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="LongRunningTransaction" OID="395218f7-a6b0-43b1-b93b-8bed9d595315" ParentLink="ServiceDeclaration_Transaction" LowerBound="114.21" HigherBound="114.71">
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Transaction_1" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="01f51f1c-c112-4386-8cb3-68aac76f6158" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="136.1" HigherBound="137.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Email" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="348affa9-c4fc-4e12-a0f0-c59b227b17dc" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="137.1" HigherBound="138.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.MultipartType_emailcomplete" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="emailMsgComplete" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="21d57212-8d6b-4633-af63-7bad8642eabd" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="138.1" HigherBound="139.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_FlatFileOriginal" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d3e524c6-3539-403b-836e-aa25b7411e4e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="139.1" HigherBound="140.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive1FF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="02851d67-5792-4ccc-a92d-5cba7cb0e24b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="140.1" HigherBound="141.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="6d6ec36b-094f-41e8-8029-78c541e904b2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="141.1" HigherBound="142.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ListCartTransferXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="be90354c-6c39-40f1-bfd1-e87bd0d2486c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="142.1" HigherBound="143.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.IProfilesR2_VerifyUserPassword_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="verifyPwdReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="bcbcdd02-4070-415a-8211-c4c54069521c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="143.1" HigherBound="144.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.IProfilesR2_VerifyUserPassword_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="verifyPwdResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d5fb9e83-eb86-4066-a728-f3604f531eff" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="144.1" HigherBound="145.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.VerifyUserSQL.procListTransfer_VerifyUser" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgVerifyUserSqlReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="fd7ac1ff-33ec-4a9a-8035-0f0469e1b1d9" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="145.1" HigherBound="146.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.VerifyUserSQL.procListTransfer_VerifyUserResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgVerifyUserSqlResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="f1f417d3-a851-4159-a175-f792a40896ac" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="146.1" HigherBound="147.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.Copy_of_ListCartSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ListCartTransferXMLEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9f902932-733a-46ab-9cdc-5370ee239b3c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="147.1" HigherBound="148.1">
                <om:Property Name="Type" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_WCFFault" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="8b456265-c99a-405d-96c9-e7944c530abc" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="148.1" HigherBound="149.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive2FF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5fc4e6e3-e3de-47b7-a6d3-8863d9372587" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="149.1" HigherBound="150.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_FlatFileOriginalEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e1ac4d65-6849-4a56-8deb-d60242d81930" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="150.1" HigherBound="151.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive3FF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="fec2b21d-e51e-4982-9b92-2526daed0688" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="151.1" HigherBound="152.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageXMLDummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2410938e-faae-44ab-9a8c-b324b4461bf5" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="152.1" HigherBound="153.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Input" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2133f261-0ef4-4365-a08b-71bb7579a4ae" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="153.1" HigherBound="154.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive1Input" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cfa15903-f65a-4420-b7f9-fa3ad6b744b9" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="154.1" HigherBound="155.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUser" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgVerifyUserEmailSqlReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4e6c97a6-ef04-4403-95b4-1216c0c6c7c1" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="155.1" HigherBound="156.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUserResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgVerifyUserEmailSqlResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="919fb331-85d2-421f-b6c7-bb309d6c568d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="156.1" HigherBound="157.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.TypedProcedure_dbo.procTS360APIValidateUserResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_1" />
                <om:Property Name="Signal" Value="False" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="51036e04-d5b2-469b-9e3e-80d5a7d58706" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="ac799969-19a2-40a2-a698-b99e418d3f6e" ParentLink="ServiceBody_Statement" LowerBound="192.1" HigherBound="226.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_MessageInput" />
                    <om:Property Name="MessageName" Value="Message_Input" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_MessageInput" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="36f103f1-3c03-4156-884b-83bcf2456e2a" ParentLink="ServiceBody_Statement" LowerBound="226.1" HigherBound="748.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="LongRunningTransaction" OID="ba764395-b30e-4bdf-b66e-dd351a325022" ParentLink="Scope_Transaction" LowerBound="227.18" HigherBound="227.56">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Transaction_2" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="3e3895e3-e78a-4026-813a-f48e4007b4eb" ParentLink="ComplexStatement_Statement" LowerBound="231.1" HigherBound="236.1">
                        <om:Property Name="Expression" Value="varFilename = Message_Input(FILE.ReceivedFileName);&#xD;&#xA;varFilename = varFilename.Substring(varFilename.LastIndexOf(@&quot;\&quot;) + 1);&#xD;&#xA;varFilenameEXT = varFilename.Substring(varFilename.LastIndexOf(@&quot;.&quot;) -0);&#xD;&#xA;varFilenameNOEXT = varFilename.Substring(0,varFilename.Length - varFilenameEXT.Length);&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Expression_FileName" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="fe2b8225-5006-42c1-ab14-7b12d840f605" ParentLink="ComplexStatement_Statement" LowerBound="236.1" HigherBound="249.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive1" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="210e0cd9-25f2-44af-9bd5-b3736fda9630" ParentLink="ReallyComplexStatement_Branch" LowerBound="237.21" HigherBound="249.1">
                            <om:Property Name="Expression" Value="varArchive1 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveMessageInput" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="a0afb72a-cca9-461d-90fe-777e07bacda9" ParentLink="ComplexStatement_Statement" LowerBound="239.1" HigherBound="246.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive1FF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="3d38925c-8b27-4fba-83af-4f89768c7694" ParentLink="Construct_MessageRef" LowerBound="240.35" HigherBound="240.56">
                                    <om:Property Name="Ref" Value="Message_Archive1Input" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="bebfa390-bdac-4477-ba83-bbe55b16318e" ParentLink="ComplexStatement_Statement" LowerBound="242.1" HigherBound="245.1">
                                    <om:Property Name="Expression" Value="Message_Archive1Input = Message_Input; &#xD;&#xA;Message_Archive1Input(FILE.ReceivedFileName)=varFilenameNOEXT; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="7ec6e4b4-43db-45fb-99b2-31d5c78434c9" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="248.1">
                                <om:Property Name="PortName" Value="Port_ArchiveMessageINput" />
                                <om:Property Name="MessageName" Value="Message_Archive1Input" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_ArchiveMessage_Input" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="854e1ec2-0998-480e-98ff-c3ff5de77f2b" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="c36337ba-7f42-4a38-9279-9467a1f2b0e5" ParentLink="ComplexStatement_Statement" LowerBound="249.1" HigherBound="257.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_Dummy" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageAssignment" OID="2de61443-edd0-4fd0-9a59-51e109816749" ParentLink="ComplexStatement_Statement" LowerBound="252.1" HigherBound="256.1">
                            <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;Dummy xmlns=&quot;&quot;http://tempuri.org/&quot;&quot;&gt;&lt;CreateLegacyBasketsResult xmlns:a=&quot;&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders&quot;&quot; xmlns:i=&quot;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&quot;&gt;&lt;a:BasketDetailsResponse&gt;&lt;a:ErrorMessage&gt; &lt;/a:ErrorMessage&gt;&lt;a:LegacyBasketId&gt;13759439&lt;/a:LegacyBasketId&gt;&lt;a:LegacySourceSystem&gt;TS3&lt;/a:LegacySourceSystem&gt;&lt;a:LoadStatus&gt;Loaded&lt;/a:LoadStatus&gt;&lt;/a:BasketDetailsResponse&gt;&lt;/CreateLegacyBasketsResult&gt;&lt;/Dummy&gt;&quot;);&#xD;&#xA;Message_FlatFileOriginal = MessageXMLDummy;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="4cb5bffa-cdfe-4814-a929-70d57a4c0c7d" ParentLink="Construct_MessageRef" LowerBound="250.31" HigherBound="250.46">
                            <om:Property Name="Ref" Value="MessageXMLDummy" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="7fbc140c-833a-427f-a7a9-96d643578283" ParentLink="Construct_MessageRef" LowerBound="250.48" HigherBound="250.72">
                            <om:Property Name="Ref" Value="Message_FlatFileOriginal" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="b59233ff-f8f1-4c11-a962-b6b54c18005d" ParentLink="ComplexStatement_Statement" LowerBound="257.1" HigherBound="281.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_Pipeline" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableDeclaration" OID="9542df01-c1b9-447d-9708-dff2685b6a89" ParentLink="Scope_VariableDeclaration" LowerBound="261.1" HigherBound="262.1">
                            <om:Property Name="UseDefaultConstructor" Value="False" />
                            <om:Property Name="Type" Value="Microsoft.XLANGs.Pipeline.ReceivePipelineOutputMessages" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="inMsgxxx" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="AtomicTransaction" OID="22ef0ec1-1876-4540-b40f-8b9d69c766dd" ParentLink="Scope_Transaction" LowerBound="259.26" HigherBound="259.59">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transaction_3" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="4c342463-5bfa-47ab-8af4-4480664e2331" ParentLink="ComplexStatement_Statement" LowerBound="264.1" HigherBound="266.1">
                            <om:Property Name="Expression" Value="inMsgxxx = Microsoft.XLANGs.Pipeline.XLANGPipelineManager.ExecuteReceivePipeline(typeof(ReceivePipelineListTransfer), Message_Input);&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ExecuteRcvPipe" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="While" OID="732ebd4a-e272-41d6-8611-06883ae8e6b7" ParentLink="ComplexStatement_Statement" LowerBound="266.1" HigherBound="279.1">
                            <om:Property Name="Expression" Value="inMsgxxx.MoveNext()&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Loop_inMsg" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="ece5850a-5e54-4093-946c-390839d4b190" ParentLink="ComplexStatement_Statement" LowerBound="270.1" HigherBound="278.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_InputRecord" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="7a904324-ecc9-4833-a8d2-1339fd32f56f" ParentLink="Construct_MessageRef" LowerBound="271.43" HigherBound="271.67">
                                    <om:Property Name="Ref" Value="Message_FlatFileOriginal" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="f232f133-cf2d-4450-862c-6b8aa00d5b53" ParentLink="ComplexStatement_Statement" LowerBound="273.1" HigherBound="277.1">
                                    <om:Property Name="Expression" Value="//Message_FlatFileOriginal = new System.Xml.XmlDocument();&#xD;&#xA;Message_FlatFileOriginal = null;&#xD;&#xA;inMsgxxx.GetCurrent(Message_FlatFileOriginal);" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_5" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="TransactionAttribute" OID="88573deb-21d7-4a9b-b7bf-8a17bc2b5bea" ParentLink="Statement_CLRAttribute" LowerBound="258.1" HigherBound="259.1">
                            <om:Property Name="Batch" Value="True" />
                            <om:Property Name="Retry" Value="True" />
                            <om:Property Name="Timeout" Value="60" />
                            <om:Property Name="Isolation" Value="Serializable" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="51b4e0b4-49b2-4fc5-b676-d4df49ef8aa4" ParentLink="ComplexStatement_Statement" LowerBound="281.1" HigherBound="357.1">
                        <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;varFilename = Message_FlatFileOriginal(FILE.ReceivedFileName);&#xD;&#xA;varArchive1=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive1&quot;));&#xD;&#xA;varArchive8=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Archive8&quot;));&#xD;&#xA;varSMTPHost=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPHost&quot;));&#xD;&#xA;//varSMTPCC=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPCC&quot;));&#xD;&#xA;varSMTPFrom=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPFrom&quot;));&#xD;&#xA;varEmailExceptions=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;EmailExceptions&quot;));&#xD;&#xA;//varTS3FTPUser=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPUser&quot;));&#xD;&#xA;//varTS3FTPPassword=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPPassword&quot;));&#xD;&#xA;//varTS3FTPRepType=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPRepType&quot;));&#xD;&#xA;//varTS3FTPTransportType=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPTransportType&quot;));&#xD;&#xA;//varSendFatalTS3=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SendFatalTS3&quot;));&#xD;&#xA;//varTS3FTPLog=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPLog&quot;));&#xD;&#xA;varLogging=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;Logging&quot;));&#xD;&#xA;&#xD;&#xA;varEmailAddress = xpath(Message_FlatFileOriginal,&quot;string(//email)&quot;);&#xD;&#xA;varEmailAddressCC = xpath(Message_FlatFileOriginal,&quot;string(//emailCC)&quot;);&#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;CC1&quot;, varEmailAddressCC);&#xD;&#xA;&#xD;&#xA;varSMTPCCTemp1=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;SMTPCC&quot;));&#xD;&#xA;// if EmailCC exists, combine with biztalk CC parameters, otherwise just use biztalk CC parameter &#xD;&#xA;if (varEmailAddressCC.Length &gt; 0 ) &#xD;&#xA;{  &#xD;&#xA;    varSMTPCCTemp2 = varEmailAddressCC.Replace(&quot;,&quot;, &quot;;&quot;); &#xD;&#xA;    varSMTPCC=varSMTPCCTemp1 + &quot;;&quot; + varSMTPCCTemp2; &#xD;&#xA;}&#xD;&#xA;else &#xD;&#xA;{&#xD;&#xA;    varSMTPCC=varSMTPCCTemp1;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;CC2&quot;, varSMTPCC);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//if (varTS3FTPLog == true)&#xD;&#xA;// { varTS3FTPLogDirectory=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPLogDirectory&quot;)); }&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//varTS3FTPAddress=(SSO.Utility.SSOClientHelper.Read(&quot;BTNextgen.Biztalk.ListTransfer&quot;,&quot;TS3FTPAddress&quot;));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename&quot;, varFilename);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varFilename = varFilename.Substring(varFilename.LastIndexOf(@&quot;\&quot;) + 1);&#xD;&#xA;varFilenameEXT = varFilename.Substring(varFilename.LastIndexOf(@&quot;.&quot;) -0);&#xD;&#xA;&#xD;&#xA;varFilenameNOEXT = varFilename.Substring(0,varFilename.Length - varFilenameEXT.Length);&#xD;&#xA;varLineReceivedCount1 = System.Convert.ToInt32(xpath(Message_FlatFileOriginal, &quot;count(//ISBN)&quot;));&#xD;&#xA;varLineReceivedCount2 = System.Convert.ToInt32(xpath(Message_FlatFileOriginal, &quot;count(//UPC)&quot;));&#xD;&#xA;varLineReceivedCount = varLineReceivedCount1 + varLineReceivedCount2; &#xD;&#xA;&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Original Filename&quot;, varFilename);&#xD;&#xA;&#xD;&#xA;varSourceSystem = xpath(Message_FlatFileOriginal,&quot;string(//sourcesys)&quot;);&#xD;&#xA;varEmailAddress = xpath(Message_FlatFileOriginal,&quot;string(//email)&quot;);&#xD;&#xA;varUserID = xpath(Message_FlatFileOriginal,&quot;string(//DestUser)&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;, varSourceSystem);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if (varLogging == true)&#xD;&#xA;{&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;, &quot;ListTransfer Start&quot;) ; &#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;, varSourceSystem);&#xD;&#xA;} &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getSSO and Dates" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="6d1ef67d-f5af-4fb5-b750-ee7eb95cdf7e" ParentLink="ComplexStatement_Statement" LowerBound="357.1" HigherBound="372.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Archive8" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="348dc48c-852e-4aa7-a350-f7051b75c262" ParentLink="ReallyComplexStatement_Branch" LowerBound="358.21" HigherBound="372.1">
                            <om:Property Name="Expression" Value="varArchive8 == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveWCFMessageFF" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="e94a1c56-9545-490d-8ca2-8a5c6a076b92" ParentLink="ComplexStatement_Statement" LowerBound="360.1" HigherBound="369.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchive8FF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="f6d0335d-cf89-4709-af4b-5353f0e52a77" ParentLink="Construct_MessageRef" LowerBound="361.35" HigherBound="361.64">
                                    <om:Property Name="Ref" Value="Message_FlatFileOriginalEmail" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="e99c6dfb-ae62-4cc7-a0dc-9d70888545b2" ParentLink="Construct_MessageRef" LowerBound="361.66" HigherBound="361.84">
                                    <om:Property Name="Ref" Value="Message_Archive3FF" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="71d6ba4d-5e40-41e6-b879-7b4b17506cd9" ParentLink="ComplexStatement_Statement" LowerBound="363.1" HigherBound="365.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_WCF2WCFFF" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_WCF2WCFFF" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="MessagePartRef" OID="081735d6-af9d-47a4-a17d-5fbb94aa1f29" ParentLink="Transform_InputMessagePartRef" LowerBound="364.130" HigherBound="364.154">
                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_5" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="e16b41c0-1194-48cd-be44-896ba743c3c7" ParentLink="Transform_OutputMessagePartRef" LowerBound="364.40" HigherBound="364.69">
                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginalEmail" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_6" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="39d809a7-e21c-4057-a562-21c5934c65ba" ParentLink="ComplexStatement_Statement" LowerBound="365.1" HigherBound="368.1">
                                    <om:Property Name="Expression" Value="Message_Archive3FF = Message_FlatFileOriginalEmail;&#xD;&#xA;Message_Archive3FF(FILE.ReceivedFileName)=varFilenameNOEXT; &#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="d42974b5-98ef-4b01-aa68-997b5533deff" ParentLink="ComplexStatement_Statement" LowerBound="369.1" HigherBound="371.1">
                                <om:Property Name="PortName" Value="Port_Archive8_WCFFF" />
                                <om:Property Name="MessageName" Value="Message_Archive3FF" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Archive8FF" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="bdb242ac-c512-4f79-b007-de66ec45cd39" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="91c1edc7-ae9d-4b7b-9815-19493e535dc1" ParentLink="ComplexStatement_Statement" LowerBound="372.1" HigherBound="699.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="TS3orCompass" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="34b45974-a01f-4465-85a0-e76ac36d18f0" ParentLink="ReallyComplexStatement_Branch" LowerBound="373.21" HigherBound="578.1">
                            <om:Property Name="Expression" Value="varSourceSystem.ToUpper() != &quot;COMPASS&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_IFTS3" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="157aabef-506f-4b66-8f7b-300ffde2044b" ParentLink="ComplexStatement_Statement" LowerBound="375.1" HigherBound="383.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyIpROFILES" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="b376c13a-fb3e-40f8-8e08-99ce028c6873" ParentLink="Construct_MessageRef" LowerBound="376.35" HigherBound="376.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="2503d699-3d48-400f-a96e-3e0604b29fdc" ParentLink="Construct_MessageRef" LowerBound="376.52" HigherBound="376.69">
                                    <om:Property Name="Ref" Value="verifyPwdResponse" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="1199fab3-e881-4107-9a8b-5eb3b94af911" ParentLink="ComplexStatement_Statement" LowerBound="378.1" HigherBound="382.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;VerifyUserPasswordResponse xmlns=&quot;&quot;http://tempuri.org/&quot;&quot;&gt;&lt;VerifyUserPasswordResult xmlns:a=&quot;&quot;http://schemas.datacontract.org/2004/07/IProfilesR2&quot;&quot; xmlns:i=&quot;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&quot;&gt;&lt;a:Message/&gt;&lt;a:UserGUID&gt;&lt;/a:UserGUID&gt;&lt;a:VerifyStatus&gt;&lt;/a:VerifyStatus&gt;&lt;/VerifyUserPasswordResult&gt;&lt;/VerifyUserPasswordResponse&gt;&quot;);&#xD;&#xA;verifyPwdResponse.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="2d3adef8-06c3-482d-8afe-3775856e450b" ParentLink="ComplexStatement_Statement" LowerBound="383.1" HigherBound="424.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="LongRunningTransaction" OID="ef42d54a-51a0-4025-967e-92d9c6c12333" ParentLink="Scope_Transaction" LowerBound="384.30" HigherBound="384.68">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transaction_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Construct" OID="af7da33e-4ff8-4852-bc38-d013a3869fc0" ParentLink="ComplexStatement_Statement" LowerBound="388.1" HigherBound="394.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Cons_VerifyPasswordRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="3f9d9664-7796-4e6d-ac35-3fd650099c9b" ParentLink="Construct_MessageRef" LowerBound="389.43" HigherBound="389.55">
                                        <om:Property Name="Ref" Value="verifyPwdReq" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Transform" OID="0d8bb914-6378-4608-a9d5-18a4ad7a40cf" ParentLink="ComplexStatement_Statement" LowerBound="391.1" HigherBound="393.1">
                                        <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransfer_To_VerifyPwdRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Transform_VerifyPwdReq" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="MessagePartRef" OID="6cf594a4-a551-4d69-97bd-b9c0e2aecd0f" ParentLink="Transform_InputMessagePartRef" LowerBound="392.145" HigherBound="392.169">
                                            <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_3" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="40149d1d-524a-4546-ad73-a87dff8e63e6" ParentLink="Transform_OutputMessagePartRef" LowerBound="392.48" HigherBound="392.71">
                                            <om:Property Name="MessageRef" Value="verifyPwdReq" />
                                            <om:Property Name="PartRef" Value="parameters" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_4" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="f885283b-de4d-4a9d-bd91-5e456b26890c" ParentLink="ComplexStatement_Statement" LowerBound="394.1" HigherBound="396.1">
                                    <om:Property Name="PortName" Value="IProfilesR2Port" />
                                    <om:Property Name="MessageName" Value="verifyPwdReq" />
                                    <om:Property Name="OperationName" Value="VerifyUserPassword" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="cfd79cbd-c4d7-4c1b-b661-8a85f4a0cda4" ParentLink="ComplexStatement_Statement" LowerBound="396.1" HigherBound="398.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="IProfilesR2Port" />
                                    <om:Property Name="MessageName" Value="verifyPwdResponse" />
                                    <om:Property Name="OperationName" Value="VerifyUserPassword" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rcv_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="c528fe54-9cf4-41ba-ba6b-c2af3ccc66bd" ParentLink="Scope_Catch" LowerBound="401.1" HigherBound="422.1">
                                    <om:Property Name="ExceptionName" Value="exwcf" />
                                    <om:Property Name="ExceptionType" Value="IProfilesR2Port.VerifyUserPassword.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_WCF" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="c825d8ef-d0c0-432d-a7cc-aeab67ef9de6" ParentLink="Catch_Statement" LowerBound="404.1" HigherBound="421.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructFaultMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="631e0a11-3312-417a-bd13-ca62f0900f04" ParentLink="Construct_MessageRef" LowerBound="405.47" HigherBound="405.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="621e8021-cabb-4de0-a8e1-34fbe0004245" ParentLink="ComplexStatement_Statement" LowerBound="407.1" HigherBound="420.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;xmlDoc = exwcf.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;Btnextgen.Biztalk.ListTransferCarts WCF Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3011&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_3" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="3d8ba282-24c4-41c0-a750-b7ad60bbe8fb" ParentLink="ComplexStatement_Statement" LowerBound="424.1" HigherBound="577.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="VALID USER" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="25ab482a-37b4-4d9f-a3dd-5b3cf1bb5109" ParentLink="ReallyComplexStatement_Branch" LowerBound="425.25" HigherBound="439.1">
                                    <om:Property Name="Expression" Value="verifyPwdResponse.parameters.VerifyUserPasswordResult.VerifyStatus==&quot;Valid&quot;" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="VALID" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="3558019e-4a49-4afd-a5cf-beb9d45e0a13" ParentLink="ComplexStatement_Statement" LowerBound="427.1" HigherBound="436.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructTS360XML" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="c7fb5f1f-9056-4981-a7ad-7ae9b5d97e58" ParentLink="Construct_MessageRef" LowerBound="428.39" HigherBound="428.58">
                                            <om:Property Name="Ref" Value="ListCartTransferXML" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="caacd14c-3a72-47a7-b567-6e1a8164787f" ParentLink="ComplexStatement_Statement" LowerBound="430.1" HigherBound="432.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XML" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="d0f2961e-b409-4e1f-b22f-2a42901c38e0" ParentLink="Transform_InputMessagePartRef" LowerBound="431.131" HigherBound="431.155">
                                                <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_13" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="2c9118c9-03e3-41c1-88e5-498941c97d82" ParentLink="Transform_OutputMessagePartRef" LowerBound="431.44" HigherBound="431.63">
                                                <om:Property Name="MessageRef" Value="ListCartTransferXML" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_14" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="0c37485a-255c-4890-bce4-a225fb174616" ParentLink="ComplexStatement_Statement" LowerBound="432.1" HigherBound="435.1">
                                            <om:Property Name="Expression" Value="ListCartTransferXML.csUserGuid=verifyPwdResponse.parameters.VerifyUserPasswordResult.UserGUID;&#xD;&#xA;ListCartTransferXML(FILE.ReceivedFileName)=varFilename; &#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_2" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="763efbd9-acfa-4a68-88d3-5d4eb3bf1e0d" ParentLink="ComplexStatement_Statement" LowerBound="436.1" HigherBound="438.1">
                                        <om:Property Name="PortName" Value="TS360FTPPort" />
                                        <om:Property Name="MessageName" Value="ListCartTransferXML" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_TS360FTP" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="61084f8b-9957-42fb-aed2-6319664fd184" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Decision" OID="556bcf50-553f-427d-9ca8-e80aa3470222" ParentLink="ComplexStatement_Statement" LowerBound="441.1" HigherBound="576.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="VALID USERID" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="0c05f76d-be68-4ad3-baf1-ccb59b734081" ParentLink="ReallyComplexStatement_Branch" LowerBound="442.29" HigherBound="486.1">
                                            <om:Property Name="Expression" Value="verifyPwdResponse.parameters.VerifyUserPasswordResult.VerifyStatus==&quot;Invalid UserID&quot;" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="INVALID USERID" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Construct" OID="c2b4176c-1299-4ee9-ad26-2440edfba8fa" ParentLink="ComplexStatement_Statement" LowerBound="444.1" HigherBound="483.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="6e16a66e-4c4b-4ada-899f-575a9fba8e8d" ParentLink="Construct_MessageRef" LowerBound="445.43" HigherBound="445.59">
                                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="79be10dd-cd68-41b4-86a2-d188d25aee9e" ParentLink="Construct_MessageRef" LowerBound="445.61" HigherBound="445.85">
                                                    <om:Property Name="Ref" Value="ListCartTransferXMLEmail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="452abc65-e9a6-4f41-899b-225fbcfddb03" ParentLink="ComplexStatement_Statement" LowerBound="447.1" HigherBound="449.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="a2a5ce2a-6a31-4dcc-8578-574390ec7782" ParentLink="Transform_InputMessagePartRef" LowerBound="448.145" HigherBound="448.169">
                                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_7" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="b994f763-6b38-46ce-ad2f-b9ef4cde4832" ParentLink="Transform_OutputMessagePartRef" LowerBound="448.48" HigherBound="448.72">
                                                        <om:Property Name="MessageRef" Value="ListCartTransferXMLEmail" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_8" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="5364bae7-c1fe-4a8c-8506-9dbfbb472567" ParentLink="ComplexStatement_Statement" LowerBound="449.1" HigherBound="482.1">
                                                    <om:Property Name="Expression" Value="varEmailAddress = xpath(ListCartTransferXMLEmail,&quot;string(//UserEmail)&quot;);&#xD;&#xA;varUserID = xpath(ListCartTransferXMLEmail,&quot;string(//DestinationUserID)&quot;);&#xD;&#xA;&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, a error (invalid userid) occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="f19ec0d5-0689-46c0-bbf6-e549b0030571" ParentLink="ComplexStatement_Statement" LowerBound="483.1" HigherBound="485.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="f61ec870-2dcc-4b0d-b7f9-7d361c61f9c0" ParentLink="ReallyComplexStatement_Branch" LowerBound="486.34" HigherBound="530.1">
                                            <om:Property Name="Expression" Value="verifyPwdResponse.parameters.VerifyUserPasswordResult.VerifyStatus==&quot;Invalid Password&quot;" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="INVALID PASSWORD" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Construct" OID="acb9cf1f-41d4-49cb-a9b1-1b7a2535285d" ParentLink="ComplexStatement_Statement" LowerBound="488.1" HigherBound="527.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="6b4b0530-fedd-4cab-a3e3-9d5756e65b3d" ParentLink="Construct_MessageRef" LowerBound="489.43" HigherBound="489.59">
                                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="0fb25da9-997c-4765-8e6d-97d3ad37da42" ParentLink="Construct_MessageRef" LowerBound="489.61" HigherBound="489.85">
                                                    <om:Property Name="Ref" Value="ListCartTransferXMLEmail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="9923c773-c5ab-4add-8fc6-6916c333fedc" ParentLink="ComplexStatement_Statement" LowerBound="491.1" HigherBound="493.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="4edd67d5-b9f7-4f90-9838-36d0a3643967" ParentLink="Transform_InputMessagePartRef" LowerBound="492.145" HigherBound="492.169">
                                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_7" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="72f57a4c-f269-4ba5-b830-a7c36b2c7724" ParentLink="Transform_OutputMessagePartRef" LowerBound="492.48" HigherBound="492.72">
                                                        <om:Property Name="MessageRef" Value="ListCartTransferXMLEmail" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_8" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="ccfe80d5-8e7f-4851-89bd-723f08a5a64c" ParentLink="ComplexStatement_Statement" LowerBound="493.1" HigherBound="526.1">
                                                    <om:Property Name="Expression" Value="varEmailAddress = xpath(ListCartTransferXMLEmail,&quot;string(//UserEmail)&quot;);&#xD;&#xA;varUserID = xpath(ListCartTransferXMLEmail,&quot;string(//DestinationUserID)&quot;);&#xD;&#xA;&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, a error (invalid password) occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="d5e808e2-1908-4a4f-bf1e-2dbe55667aa1" ParentLink="ComplexStatement_Statement" LowerBound="527.1" HigherBound="529.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="2b461dfa-5ffe-4a50-9c52-113317973869" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="INVALID PASSWORD" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="fea26070-cc60-4837-9ae1-21b6bebd3331" ParentLink="ComplexStatement_Statement" LowerBound="532.1" HigherBound="534.1">
                                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;, &quot;WCF Error Occurred validating credentials&quot;);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="LOG ERROR" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="83aedc8e-c17c-4d8d-a12e-011a9415cff7" ParentLink="ComplexStatement_Statement" LowerBound="534.1" HigherBound="573.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="6e7f4182-df4e-4d12-a458-cb24f7b1c7eb" ParentLink="Construct_MessageRef" LowerBound="535.43" HigherBound="535.59">
                                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="c2f33a4d-4fc8-4372-82c6-f18f11846b1a" ParentLink="Construct_MessageRef" LowerBound="535.61" HigherBound="535.85">
                                                    <om:Property Name="Ref" Value="ListCartTransferXMLEmail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="c074f7b9-5d24-4265-989d-54d75586d412" ParentLink="ComplexStatement_Statement" LowerBound="537.1" HigherBound="539.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="443c293d-13be-4d88-9482-cdd60f43db6c" ParentLink="Transform_OutputMessagePartRef" LowerBound="538.48" HigherBound="538.72">
                                                        <om:Property Name="MessageRef" Value="ListCartTransferXMLEmail" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_8" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="6ce11d3b-feea-4bed-8887-aeab95e3da68" ParentLink="Transform_InputMessagePartRef" LowerBound="538.145" HigherBound="538.169">
                                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_7" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="f722c0b2-0444-4c82-90c4-7988b3df3376" ParentLink="ComplexStatement_Statement" LowerBound="539.1" HigherBound="572.1">
                                                    <om:Property Name="Expression" Value="varEmailAddress = xpath(ListCartTransferXMLEmail,&quot;string(//UserEmail)&quot;);&#xD;&#xA;varUserID = xpath(ListCartTransferXMLEmail,&quot;string(//DestinationUserID)&quot;);&#xD;&#xA;&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, a error occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="442ac8e5-9e97-4da8-8e38-c9d5240b05c0" ParentLink="ComplexStatement_Statement" LowerBound="573.1" HigherBound="575.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="94abc75e-8b56-459f-84a7-fd09521748cf" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="AnalystComments" Value="Compass" />
                            <om:Property Name="Name" Value="ElseCompass" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Decision" OID="a3bbc4d6-1d20-4688-bcca-702d294653e7" ParentLink="ComplexStatement_Statement" LowerBound="580.1" HigherBound="698.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CheckUserandEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="383422f6-dabb-491e-9325-a16fd84ab074" ParentLink="ReallyComplexStatement_Branch" LowerBound="581.25" HigherBound="656.1">
                                    <om:Property Name="Expression" Value="varEmailAddress.Length &gt; 0 &amp;&amp; varUserID.Length &gt; 0 " />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_CheckUserandEmail" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="daf17672-9c35-4c7c-830e-3bc62c3156e3" ParentLink="ComplexStatement_Statement" LowerBound="583.1" HigherBound="589.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Cons_msgVerifyUserEmailSqlReq" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Transform" OID="9abc90ba-58a7-45bc-9a6b-7548e79b8cf0" ParentLink="ComplexStatement_Statement" LowerBound="586.1" HigherBound="588.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.Transform_UserEmailSqlReq" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_UserEmailSqlReq" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="47715961-8f75-4df3-b960-5c1e24b3301d" ParentLink="Transform_InputMessagePartRef" LowerBound="587.135" HigherBound="587.159">
                                                <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_11" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="4d6c2fc3-4ec9-4d1f-9ea3-757db95cadb2" ParentLink="Transform_OutputMessagePartRef" LowerBound="587.44" HigherBound="587.68">
                                                <om:Property Name="MessageRef" Value="msgVerifyUserEmailSqlReq" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_12" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="37ff17dd-12ab-41a3-b666-ac120496facb" ParentLink="Construct_MessageRef" LowerBound="584.39" HigherBound="584.63">
                                            <om:Property Name="Ref" Value="msgVerifyUserEmailSqlReq" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="b20778d7-8ac9-4d5a-8407-a95fe3a4474e" ParentLink="ComplexStatement_Statement" LowerBound="589.1" HigherBound="591.1">
                                        <om:Property Name="PortName" Value="Port_SqlReq" />
                                        <om:Property Name="MessageName" Value="msgVerifyUserEmailSqlReq" />
                                        <om:Property Name="OperationName" Value="procTS360APIValidateUser" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Receive" OID="5f849d78-fb2c-49c4-a74f-e59082606b18" ParentLink="ComplexStatement_Statement" LowerBound="591.1" HigherBound="593.1">
                                        <om:Property Name="Activate" Value="False" />
                                        <om:Property Name="PortName" Value="Port_SqlReq" />
                                        <om:Property Name="MessageName" Value="msgVerifyUserEmailSqlResponse" />
                                        <om:Property Name="OperationName" Value="procTS360APIValidateUser" />
                                        <om:Property Name="OperationMessageName" Value="Response" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Receive_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="0e57b405-b44d-471a-8fa8-04d3ebebdedb" ParentLink="ComplexStatement_Statement" LowerBound="593.1" HigherBound="595.1">
                                        <om:Property Name="Expression" Value="varCSGUID=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; " />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="assignvariables" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Decision" OID="d991d04f-2364-4a5a-8471-9b61a6c1df6b" ParentLink="ComplexStatement_Statement" LowerBound="595.1" HigherBound="655.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Decide_1" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="DecisionBranch" OID="66e81dfb-860b-46d2-ba47-87ad1a122e64" ParentLink="ReallyComplexStatement_Branch" LowerBound="596.29" HigherBound="613.1">
                                            <om:Property Name="Expression" Value="varCSGUID != null" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Rule_ValidUser" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Construct" OID="b186148f-7b4b-4cb0-977c-2f14ae32294b" ParentLink="ComplexStatement_Statement" LowerBound="598.1" HigherBound="610.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructTS360XML" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="952094b5-0dc7-443b-b1b0-8956a4edfa72" ParentLink="Construct_MessageRef" LowerBound="599.43" HigherBound="599.62">
                                                    <om:Property Name="Ref" Value="ListCartTransferXML" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="3740c466-8ecd-40fd-846c-7992b710fac8" ParentLink="ComplexStatement_Statement" LowerBound="601.1" HigherBound="603.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XML" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessagePartRef" OID="444f1279-d7e9-4cb1-ac5b-847df26137ca" ParentLink="Transform_OutputMessagePartRef" LowerBound="602.48" HigherBound="602.67">
                                                        <om:Property Name="MessageRef" Value="ListCartTransferXML" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="4156776f-c383-48fb-8ccc-0be4869e02f6" ParentLink="Transform_InputMessagePartRef" LowerBound="602.135" HigherBound="602.159">
                                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="be7ef2f0-ce4d-4c19-a095-d53b4ba561d8" ParentLink="ComplexStatement_Statement" LowerBound="603.1" HigherBound="609.1">
                                                    <om:Property Name="Expression" Value="//ListCartTransferXML.csUserGuid=verifyPwdResponse.parameters.VerifyUserPasswordResult.UserGUID;&#xD;&#xA;//ListCartTransferXML.csUserGuid=xpath(msgVerifyUserEmailSqlResponse,&quot;string(//UserId)&quot;);&#xD;&#xA;ListCartTransferXML.csUserGuid=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; &#xD;&#xA;&#xD;&#xA;ListCartTransferXML(FILE.ReceivedFileName)=varFilename; &#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="456867d7-a11a-44df-a1c3-6cb0364ea508" ParentLink="ComplexStatement_Statement" LowerBound="610.1" HigherBound="612.1">
                                                <om:Property Name="PortName" Value="TS360FTPPort" />
                                                <om:Property Name="MessageName" Value="ListCartTransferXML" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_TS360FTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="d8a09cb2-015c-4043-8524-d2999a949046" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="9e151286-2606-4892-9706-8be41ccdb0df" ParentLink="ComplexStatement_Statement" LowerBound="615.1" HigherBound="617.1">
                                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;, &quot;Invalid Compass Credentials SQL - email or userid invalid&quot;);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="LOG ERROR" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Construct" OID="b1e64fd6-e698-469e-940b-74c7c78c8410" ParentLink="ComplexStatement_Statement" LowerBound="617.1" HigherBound="652.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="8aeaf3bf-e149-4c73-8322-ef0681c96aeb" ParentLink="Construct_MessageRef" LowerBound="618.43" HigherBound="618.59">
                                                    <om:Property Name="Ref" Value="emailMsgComplete" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="c9246cd4-28f8-46e7-be1c-279eaac058d8" ParentLink="Construct_MessageRef" LowerBound="618.61" HigherBound="618.85">
                                                    <om:Property Name="Ref" Value="ListCartTransferXMLEmail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="Transform" OID="9f017cee-9822-49bd-be33-ffd78f80bf38" ParentLink="ComplexStatement_Statement" LowerBound="620.1" HigherBound="622.1">
                                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="7603b4a8-d426-412d-b605-e13f679fddc7" ParentLink="Transform_OutputMessagePartRef" LowerBound="621.48" HigherBound="621.72">
                                                        <om:Property Name="MessageRef" Value="ListCartTransferXMLEmail" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_8" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="f0802ddc-62ed-4c8e-898d-ac33171d2312" ParentLink="Transform_InputMessagePartRef" LowerBound="621.145" HigherBound="621.169">
                                                        <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_7" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="c9160b8f-f88c-405f-be87-ab0cdff41479" ParentLink="ComplexStatement_Statement" LowerBound="622.1" HigherBound="651.1">
                                                    <om:Property Name="Expression" Value="//varEmailAddress = xpath(ListCartTransferXMLEmail,&quot;string(//UserEmail)&quot;);&#xD;&#xA;//varUserID = xpath(ListCartTransferXMLEmail,&quot;string(//DestinationUserID)&quot;);&#xD;&#xA;&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, a error occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="fd1c57ec-956c-4f24-a15d-98cc76b3e336" ParentLink="ComplexStatement_Statement" LowerBound="652.1" HigherBound="654.1">
                                                <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                                <om:Property Name="MessageName" Value="emailMsgComplete" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Send_EmailSMTP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="d400d647-6682-498b-8edc-95b279fe4ad2" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="VariableAssignment" OID="041d2a2b-35b0-4600-99d7-e438818e2d71" ParentLink="ComplexStatement_Statement" LowerBound="658.1" HigherBound="660.1">
                                        <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ListTransferCarts&quot;, &quot;Invalid Compass Credentials - email or userid invalid&quot;);" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="LOG ERROR" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="e6b845e2-da7c-4995-893f-7473e9afae65" ParentLink="ComplexStatement_Statement" LowerBound="660.1" HigherBound="695.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_EmailComplete" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="6efdf016-a794-4be7-a912-86d9e15aaddb" ParentLink="Construct_MessageRef" LowerBound="661.39" HigherBound="661.55">
                                            <om:Property Name="Ref" Value="emailMsgComplete" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="4db79542-02eb-433a-aa2f-d05fdb9523c4" ParentLink="Construct_MessageRef" LowerBound="661.57" HigherBound="661.81">
                                            <om:Property Name="Ref" Value="ListCartTransferXMLEmail" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Transform" OID="a9d79140-39b0-45b2-bcca-5ed760a4016e" ParentLink="ComplexStatement_Statement" LowerBound="663.1" HigherBound="665.1">
                                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Transform_To_TS360XML" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessagePartRef" OID="da1f2f5f-7154-4927-8c53-86aeec4c2de8" ParentLink="Transform_InputMessagePartRef" LowerBound="664.141" HigherBound="664.165">
                                                <om:Property Name="MessageRef" Value="Message_FlatFileOriginal" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_15" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="441c9add-c65a-4391-8d05-e69eb10aa015" ParentLink="Transform_OutputMessagePartRef" LowerBound="664.44" HigherBound="664.68">
                                                <om:Property Name="MessageRef" Value="ListCartTransferXMLEmail" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_16" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="89f5511f-da15-4ed6-9a0e-2b53fbd28d22" ParentLink="ComplexStatement_Statement" LowerBound="665.1" HigherBound="694.1">
                                            <om:Property Name="Expression" Value="//varEmailAddress = xpath(ListCartTransferXMLEmail,&quot;string(//UserEmail)&quot;);&#xD;&#xA;//varUserID = xpath(ListCartTransferXMLEmail,&quot;string(//DestinationUserID)&quot;);&#xD;&#xA;&#xD;&#xA;msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Filename: &quot; + varFilename);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Summary:&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;Your cart was not created, a error occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;p&gt;Number of ISBN/UPCs Received: &quot; + varLineReceivedCount.ToString());&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Number of ISBN/UPCs Inserted: 0&quot; );&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + &quot;.xml&quot;;&#xD;&#xA;emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;&#xD;&#xA;emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsgComplete(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsgComplete(SMTP.CC)=varSMTPCC;&#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.Subject)=&quot;ListTransfer: Invalid Cart data supplied from &quot; + varUserID;   &#xD;&#xA;&#xD;&#xA;emailMsgComplete(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsgComplete(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="3b4276ce-4e1a-4bf8-af31-a6d11eb64a40" ParentLink="ComplexStatement_Statement" LowerBound="695.1" HigherBound="697.1">
                                        <om:Property Name="PortName" Value="Port_SendEmailComplete_LT" />
                                        <om:Property Name="MessageName" Value="emailMsgComplete" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_EmailSMTP" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="8be043bc-8f2b-4795-b59c-cef735da4fdd" ParentLink="Scope_Catch" LowerBound="702.1" HigherBound="725.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.SystemException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_Main" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="3ab82e08-f594-4e0e-b8e7-793b51bad553" ParentLink="Catch_Statement" LowerBound="705.1" HigherBound="720.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructFaultMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="c5d25850-8e17-4aeb-9f1e-fae5d16f14b3" ParentLink="Construct_MessageRef" LowerBound="706.35" HigherBound="706.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="d9360538-2f62-4663-98e8-9be252afd684" ParentLink="ComplexStatement_Statement" LowerBound="708.1" HigherBound="719.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;Btnextgen.Biztalk.ListTransferCarts Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=ex.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3011&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="74cc02f3-9451-40f1-819a-4c11b137f06a" ParentLink="Catch_Statement" LowerBound="720.1" HigherBound="722.1">
                            <om:Property Name="PortName" Value="Port_SendEmailFail_LT" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Email" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Send" OID="fa0a120c-e577-4895-9fc8-7b6dea2d6643" ParentLink="Catch_Statement" LowerBound="722.1" HigherBound="724.1">
                            <om:Property Name="PortName" Value="LT_FaultPort" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Exception" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="e9b143ce-8667-4b00-8903-73c26da7f6f8" ParentLink="Scope_Catch" LowerBound="725.1" HigherBound="746.1">
                        <om:Property Name="ExceptionName" Value="pipe" />
                        <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.Pipeline.XLANGPipelineManagerException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_pipeline" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="fb84e55e-f5a3-47e9-81f8-318cd0cb50f8" ParentLink="Catch_Statement" LowerBound="728.1" HigherBound="743.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructFaultMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="87292999-16a0-4ccd-8b43-a4e1dc4934aa" ParentLink="Construct_MessageRef" LowerBound="729.35" HigherBound="729.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="f4d0f5b0-b21b-4df6-9216-394da7950555" ParentLink="ComplexStatement_Statement" LowerBound="731.1" HigherBound="742.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;Btnextgen.Biztalk.ListTransferCarts Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=pipe.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3011&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="74af6555-9ad9-4f2f-95c8-b73b65d7cf66" ParentLink="Catch_Statement" LowerBound="743.1" HigherBound="745.1">
                            <om:Property Name="PortName" Value="Port_SendEmailFail_LT" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Email" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="311a6060-fdd9-46f0-b640-0e16c8dc35e3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="116.1" HigherBound="118.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_FaultPort" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="LT_FaultPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="1d6c00c6-6f48-4d4c-80ea-7be7d4b3d315" ParentLink="PortDeclaration_CLRAttribute" LowerBound="116.1" HigherBound="117.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="bee09f4b-80d3-4f6b-bd5a-bf06e0e23036" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="118.1" HigherBound="120.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_BIZFaultPort" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="LT_BIZFaultPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="8cb9461b-d1a2-40b9-b7dc-0b1db25ae223" ParentLink="PortDeclaration_CLRAttribute" LowerBound="118.1" HigherBound="119.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="7c73051d-1874-4bcf-8e8c-bdadb03195e9" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="120.1" HigherBound="122.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="36" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.TS360FTPPortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="TS360FTPPort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="01e2fa8d-42a8-4708-9934-7c0bf968d04c" ParentLink="PortDeclaration_CLRAttribute" LowerBound="120.1" HigherBound="121.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="ed2d2b30-d367-4597-82c3-f0f929053702" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="122.1" HigherBound="124.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="10" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.IProfilesR2" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="IProfilesR2Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="836a39a7-e56e-41a2-8241-23abe2e8be25" ParentLink="PortDeclaration_CLRAttribute" LowerBound="122.1" HigherBound="123.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="ecfce2d1-129c-43c1-8d56-8798b0ddc8e6" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="124.1" HigherBound="126.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="52" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_emailsmtp_lt" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendEmailComplete_LT" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="PhysicalBindingAttribute" OID="6b71141e-41f5-4c61-9b6b-e8480389351f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="124.1" HigherBound="125.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="e4f1907a-ee15-42fd-a831-72735db44819" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="126.1" HigherBound="128.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SendEmail_LT" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendEmailFail_LT" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="6894fbb7-2dd0-460a-8ba2-03adaf91ce8e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="126.1" HigherBound="127.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="6cf4dae7-7f48-44c9-b856-79495c0d62ff" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="128.1" HigherBound="130.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_Archive8_WCFFF" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Archive8_WCFFF" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="707adb5f-c479-4ef4-a2b5-338e4f1d2a1e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="128.1" HigherBound="129.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="59ba6f6b-0590-4c88-9aea-2cde1cffdb67" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="130.1" HigherBound="132.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="4" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_MessageInput" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_MessageInput" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="fea88d58-20cb-4b23-8ae4-efaed948189e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="130.1" HigherBound="131.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="78f13d53-142f-432f-a049-d7289152e8c4" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="132.1" HigherBound="134.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_ArchiveMessageInput" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveMessageINput" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="cbf8c133-7ccb-49cd-8934-911c207f2787" ParentLink="PortDeclaration_CLRAttribute" LowerBound="132.1" HigherBound="133.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0bae798b-2475-4c01-900c-4b24d0bd2096" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="134.1" HigherBound="136.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ListTransferCarts.PortType_SqlReq" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SqlReq" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="1a1f44ee-7cae-4cd1-b434-80c58cb4220f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="134.1" HigherBound="135.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="48101231-142d-42ce-8dcc-2781f86b9602" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Fault" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="a4678317-61ab-4b9d-86d0-5f46c578fa50" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Fault" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ListTransferCarts
{
    internal messagetype MultipartType_Fault
    {
        body BTS.soap_envelope_1__1.Fault MessagePart_Fault;
    };
    internal porttype PortType_ReceiveFlatFile
    {
        oneway Operation_1
        {
            ListTransferFF
        };
    };
    internal porttype PortType_Archive1_FF
    {
        oneway Operation_1
        {
            ListTransferFF
        };
    };
    internal porttype PortType_FaultPort
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_BusFaultPort
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_BIZFaultPort
    {
        oneway Operation_1
        {
            ListTransferFF
        };
    };
    internal porttype TS360FTPPortType
    {
        oneway Operation_1
        {
            ListCartSchema
        };
    };
    internal porttype TS3PortType
    {
        oneway Operation_1
        {
            ListTransferFF
        };
    };
    internal porttype sqlPortType
    {
        requestresponse Operation_1
        {
            VerifyUserSQL.procListTransfer_VerifyUser, VerifyUserSQL.procListTransfer_VerifyUserResponse
        };
    };
    internal porttype PortType_SendEmail_LT
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_TS3PortDynamic
    {
        oneway Operation_1
        {
            ListTransferFF
        };
    };
    internal porttype PortType_ArchiveFF_FTP
    {
        oneway Operation_1
        {
            ListTransferFFEmail
        };
    };
    internal porttype PortType_Archive8_WCFFF
    {
        oneway Operation_1
        {
            ListTransferFF
        };
    };
    internal porttype PortType_MessageInput
    {
        oneway Operation_1
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype PortType_ArchiveMessageInput
    {
        oneway Operation_1
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype PortType_SqlReq
    {
        requestresponse procTS360APIValidateUser
        {
            TypedProcedure_dbo.procTS360APIValidateUser, TypedProcedure_dbo.procTS360APIValidateUserResponse
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service longrunning transaction OrchestrationListTransfer
    {
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses PortType_FaultPort LT_FaultPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_BIZFaultPort LT_BIZFaultPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses TS360FTPPortType TS360FTPPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses IProfilesR2 IProfilesR2Port;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_emailsmtp_lt Port_SendEmailComplete_LT;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SendEmail_LT Port_SendEmailFail_LT;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Archive8_WCFFF Port_Archive8_WCFFF;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_MessageInput Port_MessageInput;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveMessageInput Port_ArchiveMessageINput;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SqlReq Port_SqlReq;
        message Copy_of_ListCartSchema Message_Email;
        message MultipartType_emailcomplete emailMsgComplete;
        message ListTransferFF Message_FlatFileOriginal;
        message ListTransferFF Message_Archive1FF;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage FaultMessage;
        message ListCartSchema ListCartTransferXML;
        message IProfilesR2_VerifyUserPassword_InputMessage verifyPwdReq;
        message IProfilesR2_VerifyUserPassword_OutputMessage verifyPwdResponse;
        message VerifyUserSQL.procListTransfer_VerifyUser msgVerifyUserSqlReq;
        message VerifyUserSQL.procListTransfer_VerifyUserResponse msgVerifyUserSqlResponse;
        message Copy_of_ListCartSchema ListCartTransferXMLEmail;
        message BTS.soap_envelope_1__1.Fault Message_WCFFault;
        message ListTransferFF Message_Archive2FF;
        message ListTransferFF Message_FlatFileOriginalEmail;
        message ListTransferFF Message_Archive3FF;
        message System.Xml.XmlDocument MessageXMLDummy;
        message System.Xml.XmlDocument Message_Input;
        message System.Xml.XmlDocument Message_Archive1Input;
        message TypedProcedure_dbo.procTS360APIValidateUser msgVerifyUserEmailSqlReq;
        message TypedProcedure_dbo.procTS360APIValidateUserResponse msgVerifyUserEmailSqlResponse;
        message TypedProcedure_dbo.procTS360APIValidateUserResponse Message_1;
        System.Text.StringBuilder msgbody;
        System.Boolean varArchive1;
        System.String varFilename;
        System.Int32 varLineReceivedCount1;
        System.Int32 varLineReceivedCount2;
        System.Int32 varLineReceivedCount;
        System.String varSMTPHost;
        System.String varSMTPCC;
        System.String varSMTPFrom;
        System.String varEmailAddress;
        System.String varUserID;
        System.Boolean varEmailExceptions;
        System.Xml.XmlDocument xmlDoc;
        System.String varErrorMessage;
        System.Int32 varFilenameLEN;
        System.String varFilenameNOEXT;
        System.String varFilenameEXT;
        System.String varTS3FTPUser;
        System.String varTS3FTPPassword;
        System.String varTS3FTPRepType;
        System.String varTS3FTPTransportType;
        System.String varTS3FTPLogDirectory;
        System.Boolean varTS3FTPLog;
        System.String varTS3FTPAddress;
        System.Boolean varArchive8;
        System.Boolean varSendFatalTS3;
        System.String varSourceSystem;
        System.String varCSGUID;
        System.Boolean varLogging;
        System.String varEmailAddressCC;
        System.String varSMTPCCTemp1;
        System.String varSMTPCCTemp2;
        System.String varUserFolder;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ac799969-19a2-40a2-a698-b99e418d3f6e")]
            activate receive (Port_MessageInput.Operation_1, Message_Input);
            msgbody = new System.Text.StringBuilder();
            varArchive1 = true;
            varFilename = "";
            varLineReceivedCount1 = 0;
            varLineReceivedCount2 = 0;
            varLineReceivedCount = 0;
            varSMTPHost = "";
            varSMTPCC = "";
            varSMTPFrom = "";
            varEmailAddress = "";
            varUserID = "";
            varEmailExceptions = true;
            xmlDoc = new System.Xml.XmlDocument();
            varErrorMessage = "";
            varFilenameNOEXT = "";
            varFilenameEXT = "";
            varTS3FTPUser = "";
            varTS3FTPPassword = "";
            varTS3FTPRepType = "";
            varTS3FTPTransportType = "";
            varTS3FTPLogDirectory = "";
            varTS3FTPLog = false;
            varTS3FTPAddress = "";
            varArchive8 = true;
            varSendFatalTS3 = true;
            varSourceSystem = "";
            varCSGUID = "";
            varLogging = true;
            varEmailAddressCC = "";
            varSMTPCCTemp1 = "";
            varSMTPCCTemp2 = "";
            varUserFolder = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("36f103f1-3c03-4156-884b-83bcf2456e2a")]
            scope longrunning transaction Transaction_2
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e3895e3-e78a-4026-813a-f48e4007b4eb")]
                    varFilename = Message_Input(FILE.ReceivedFileName);
                    varFilename = varFilename.Substring(varFilename.LastIndexOf(@"\") + 1);
                    varFilenameEXT = varFilename.Substring(varFilename.LastIndexOf(@".") -0);
                    varFilenameNOEXT = varFilename.Substring(0,varFilename.Length - varFilenameEXT.Length);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("fe2b8225-5006-42c1-ab14-7b12d840f605")]
                    if (varArchive1 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a0afb72a-cca9-461d-90fe-777e07bacda9")]
                        construct Message_Archive1Input
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bebfa390-bdac-4477-ba83-bbe55b16318e")]
                            Message_Archive1Input = Message_Input; 
                            Message_Archive1Input(FILE.ReceivedFileName)=varFilenameNOEXT; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7ec6e4b4-43db-45fb-99b2-31d5c78434c9")]
                        send (Port_ArchiveMessageINput.Operation_1, Message_Archive1Input);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c36337ba-7f42-4a38-9279-9467a1f2b0e5")]
                    construct MessageXMLDummy, Message_FlatFileOriginal
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2de61443-edd0-4fd0-9a59-51e109816749")]
                        MessageXMLDummy = new System.Xml.XmlDocument();
                        MessageXMLDummy.LoadXml(@"<Dummy xmlns=""http://tempuri.org/""><CreateLegacyBasketsResult xmlns:a=""http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""><a:BasketDetailsResponse><a:ErrorMessage> </a:ErrorMessage><a:LegacyBasketId>13759439</a:LegacyBasketId><a:LegacySourceSystem>TS3</a:LegacySourceSystem><a:LoadStatus>Loaded</a:LoadStatus></a:BasketDetailsResponse></CreateLegacyBasketsResult></Dummy>");
                        Message_FlatFileOriginal = MessageXMLDummy;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b59233ff-f8f1-4c11-a962-b6b54c18005d")]
                    [Microsoft.XLANGs.BaseTypes.Transaction(Retry=true,Batch=true,Timeout=60,TranIsolationLevel=System.Data.IsolationLevel.Serializable)]
                    scope atomic transaction Transaction_3
                    {
                        Microsoft.XLANGs.Pipeline.ReceivePipelineOutputMessages inMsgxxx;
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4c342463-5bfa-47ab-8af4-4480664e2331")]
                            inMsgxxx = Microsoft.XLANGs.Pipeline.XLANGPipelineManager.ExecuteReceivePipeline(typeof(ReceivePipelineListTransfer), Message_Input);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("732ebd4a-e272-41d6-8611-06883ae8e6b7")]
                            while (inMsgxxx.MoveNext()
                                )
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ece5850a-5e54-4093-946c-390839d4b190")]
                                construct Message_FlatFileOriginal
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f232f133-cf2d-4450-862c-6b8aa00d5b53")]
                                    //Message_FlatFileOriginal = new System.Xml.XmlDocument();
                                    Message_FlatFileOriginal = null;
                                    inMsgxxx.GetCurrent(Message_FlatFileOriginal);
                                }
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("51b4e0b4-49b2-4fc5-b676-d4df49ef8aa4")]
                    
                    
                    varFilename = Message_FlatFileOriginal(FILE.ReceivedFileName);
                    varArchive1=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive1"));
                    varArchive8=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Archive8"));
                    varSMTPHost=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPHost"));
                    //varSMTPCC=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPCC"));
                    varSMTPFrom=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPFrom"));
                    varEmailExceptions=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","EmailExceptions"));
                    //varTS3FTPUser=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPUser"));
                    //varTS3FTPPassword=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPPassword"));
                    //varTS3FTPRepType=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPRepType"));
                    //varTS3FTPTransportType=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPTransportType"));
                    //varSendFatalTS3=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SendFatalTS3"));
                    //varTS3FTPLog=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPLog"));
                    varLogging=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","Logging"));
                    
                    varEmailAddress = xpath(Message_FlatFileOriginal,"string(//email)");
                    varEmailAddressCC = xpath(Message_FlatFileOriginal,"string(//emailCC)");
                    
                    //System.Diagnostics.EventLog.WriteEntry("CC1", varEmailAddressCC);
                    
                    varSMTPCCTemp1=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","SMTPCC"));
                    // if EmailCC exists, combine with biztalk CC parameters, otherwise just use biztalk CC parameter 
                    if (varEmailAddressCC.Length > 0 ) 
                    {  
                        varSMTPCCTemp2 = varEmailAddressCC.Replace(",", ";"); 
                        varSMTPCC=varSMTPCCTemp1 + ";" + varSMTPCCTemp2; 
                    }
                    else 
                    {
                        varSMTPCC=varSMTPCCTemp1;
                    }
                    
                    //System.Diagnostics.EventLog.WriteEntry("CC2", varSMTPCC);
                    
                    
                    //if (varTS3FTPLog == true)
                    // { varTS3FTPLogDirectory=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPLogDirectory")); }
                    
                    
                    
                    //varTS3FTPAddress=(SSO.Utility.SSOClientHelper.Read("BTNextgen.Biztalk.ListTransfer","TS3FTPAddress"));
                    
                    
                    
                    
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename", varFilename);
                    
                    
                    varFilename = varFilename.Substring(varFilename.LastIndexOf(@"\") + 1);
                    varFilenameEXT = varFilename.Substring(varFilename.LastIndexOf(@".") -0);
                    
                    varFilenameNOEXT = varFilename.Substring(0,varFilename.Length - varFilenameEXT.Length);
                    varLineReceivedCount1 = System.Convert.ToInt32(xpath(Message_FlatFileOriginal, "count(//ISBN)"));
                    varLineReceivedCount2 = System.Convert.ToInt32(xpath(Message_FlatFileOriginal, "count(//UPC)"));
                    varLineReceivedCount = varLineReceivedCount1 + varLineReceivedCount2; 
                    
                    //System.Diagnostics.EventLog.WriteEntry("Original Filename", varFilename);
                    
                    varSourceSystem = xpath(Message_FlatFileOriginal,"string(//sourcesys)");
                    varEmailAddress = xpath(Message_FlatFileOriginal,"string(//email)");
                    varUserID = xpath(Message_FlatFileOriginal,"string(//DestUser)");
                    //System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts", varSourceSystem);
                    
                    
                    if (varLogging == true)
                    {
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts", "ListTransfer Start") ; 
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts", varSourceSystem);
                    } 
                    
                    
                    
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6d1ef67d-f5af-4fb5-b750-ee7eb95cdf7e")]
                    if (varArchive8 == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e94a1c56-9545-490d-8ca2-8a5c6a076b92")]
                        construct Message_FlatFileOriginalEmail, Message_Archive3FF
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("71d6ba4d-5e40-41e6-b879-7b4b17506cd9")]
                            transform (Message_FlatFileOriginalEmail) = BTNextGen.Biztalk.ListTransferCarts.Transform_WCF2WCFFF (Message_FlatFileOriginal);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("39d809a7-e21c-4057-a562-21c5934c65ba")]
                            Message_Archive3FF = Message_FlatFileOriginalEmail;
                            Message_Archive3FF(FILE.ReceivedFileName)=varFilenameNOEXT; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d42974b5-98ef-4b01-aa68-997b5533deff")]
                        send (Port_Archive8_WCFFF.Operation_1, Message_Archive3FF);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("91c1edc7-ae9d-4b7b-9815-19493e535dc1")]
                    if (varSourceSystem.ToUpper() != "COMPASS")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("157aabef-506f-4b66-8f7b-300ffde2044b")]
                        construct MessageXMLDummy, verifyPwdResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1199fab3-e881-4107-9a8b-5eb3b94af911")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<VerifyUserPasswordResponse xmlns=""http://tempuri.org/""><VerifyUserPasswordResult xmlns:a=""http://schemas.datacontract.org/2004/07/IProfilesR2"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""><a:Message/><a:UserGUID></a:UserGUID><a:VerifyStatus></a:VerifyStatus></VerifyUserPasswordResult></VerifyUserPasswordResponse>");
                            verifyPwdResponse.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2d3adef8-06c3-482d-8afe-3775856e450b")]
                        scope longrunning transaction Transaction_4
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("af7da33e-4ff8-4852-bc38-d013a3869fc0")]
                                construct verifyPwdReq
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0d8bb914-6378-4608-a9d5-18a4ad7a40cf")]
                                    transform (verifyPwdReq.parameters) = BTNextGen.Biztalk.ListTransferCarts.ListTransfer_To_VerifyPwdRequest (Message_FlatFileOriginal);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f885283b-de4d-4a9d-bd91-5e456b26890c")]
                                send (IProfilesR2Port.VerifyUserPassword, verifyPwdReq);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("cfd79cbd-c4d7-4c1b-b661-8a85f4a0cda4")]
                                receive (IProfilesR2Port.VerifyUserPassword, verifyPwdResponse);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c528fe54-9cf4-41ba-ba6b-c2af3ccc66bd")]
                                catch (IProfilesR2Port.VerifyUserPassword.Fault_1 exwcf)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c825d8ef-d0c0-432d-a7cc-aeab67ef9de6")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("621e8021-cabb-4de0-a8e1-34fbe0004245")]
                                        // Create fault exception Message
                                        xmlDoc = exwcf.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="Btnextgen.Biztalk.ListTransferCarts WCF Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3011";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                        
                                        
                                    }
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3d8ba282-24c4-41c0-a750-b7ad60bbe8fb")]
                        if (verifyPwdResponse.parameters.VerifyUserPasswordResult.VerifyStatus=="Valid")
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3558019e-4a49-4afd-a5cf-beb9d45e0a13")]
                            construct ListCartTransferXML
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("caacd14c-3a72-47a7-b567-6e1a8164787f")]
                                transform (ListCartTransferXML) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XML (Message_FlatFileOriginal);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0c37485a-255c-4890-bce4-a225fb174616")]
                                ListCartTransferXML.csUserGuid=verifyPwdResponse.parameters.VerifyUserPasswordResult.UserGUID;
                                ListCartTransferXML(FILE.ReceivedFileName)=varFilename; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("763efbd9-acfa-4a68-88d3-5d4eb3bf1e0d")]
                            send (TS360FTPPort.Operation_1, ListCartTransferXML);
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("556bcf50-553f-427d-9ca8-e80aa3470222")]
                            if (verifyPwdResponse.parameters.VerifyUserPasswordResult.VerifyStatus=="Invalid UserID")
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c2b4176c-1299-4ee9-ad26-2440edfba8fa")]
                                construct emailMsgComplete, ListCartTransferXMLEmail
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("452abc65-e9a6-4f41-899b-225fbcfddb03")]
                                    transform (ListCartTransferXMLEmail) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL (Message_FlatFileOriginal);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5364bae7-c1fe-4a8c-8506-9dbfbb472567")]
                                    varEmailAddress = xpath(ListCartTransferXMLEmail,"string(//UserEmail)");
                                    varUserID = xpath(ListCartTransferXMLEmail,"string(//DestinationUserID)");
                                    
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    msgbody.AppendLine("Your cart was not created, a error (invalid userid) occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot" );
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                    msgbody.AppendLine("</body></html>");
                                    
                                    
                                    
                                    
                                    
                                    emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email
                                    emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsgComplete(SMTP.From)= varSMTPFrom;
                                    emailMsgComplete(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                    
                                    emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f19ec0d5-0689-46c0-bbf6-e549b0030571")]
                                send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                            }
                            else if (verifyPwdResponse.parameters.VerifyUserPasswordResult.VerifyStatus=="Invalid Password")
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("acb9cf1f-41d4-49cb-a9b1-1b7a2535285d")]
                                construct emailMsgComplete, ListCartTransferXMLEmail
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9923c773-c5ab-4add-8fc6-6916c333fedc")]
                                    transform (ListCartTransferXMLEmail) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL (Message_FlatFileOriginal);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ccfe80d5-8e7f-4851-89bd-723f08a5a64c")]
                                    varEmailAddress = xpath(ListCartTransferXMLEmail,"string(//UserEmail)");
                                    varUserID = xpath(ListCartTransferXMLEmail,"string(//DestinationUserID)");
                                    
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    msgbody.AppendLine("Your cart was not created, a error (invalid password) occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot" );
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                    msgbody.AppendLine("</body></html>");
                                    
                                    
                                    
                                    
                                    
                                    emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email
                                    emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsgComplete(SMTP.From)= varSMTPFrom;
                                    emailMsgComplete(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                    
                                    emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d5e808e2-1908-4a4f-bf1e-2dbe55667aa1")]
                                send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("fea26070-cc60-4837-9ae1-21b6bebd3331")]
                                System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts", "WCF Error Occurred validating credentials");
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("83aedc8e-c17c-4d8d-a12e-011a9415cff7")]
                                construct emailMsgComplete, ListCartTransferXMLEmail
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c074f7b9-5d24-4265-989d-54d75586d412")]
                                    transform (ListCartTransferXMLEmail) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL (Message_FlatFileOriginal);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f722c0b2-0444-4c82-90c4-7988b3df3376")]
                                    varEmailAddress = xpath(ListCartTransferXMLEmail,"string(//UserEmail)");
                                    varUserID = xpath(ListCartTransferXMLEmail,"string(//DestinationUserID)");
                                    
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    msgbody.AppendLine("Your cart was not created, a error occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot" );
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                    msgbody.AppendLine("</body></html>");
                                    
                                    
                                    
                                    
                                    
                                    emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email
                                    emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsgComplete(SMTP.From)= varSMTPFrom;
                                    emailMsgComplete(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                    
                                    emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("442ac8e5-9e97-4da8-8e38-c9d5240b05c0")]
                                send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                            }
                        }
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a3bbc4d6-1d20-4688-bcca-702d294653e7")]
                        if (varEmailAddress.Length > 0 && varUserID.Length > 0 )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("daf17672-9c35-4c7c-830e-3bc62c3156e3")]
                            construct msgVerifyUserEmailSqlReq
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9abc90ba-58a7-45bc-9a6b-7548e79b8cf0")]
                                transform (msgVerifyUserEmailSqlReq) = BTNextGen.Biztalk.ListTransferCarts.Transform_UserEmailSqlReq (Message_FlatFileOriginal);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b20778d7-8ac9-4d5a-8407-a95fe3a4474e")]
                            send (Port_SqlReq.procTS360APIValidateUser, msgVerifyUserEmailSqlReq);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5f849d78-fb2c-49c4-a74f-e59082606b18")]
                            receive (Port_SqlReq.procTS360APIValidateUser, msgVerifyUserEmailSqlResponse);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0e57b405-b44d-471a-8fa8-04d3ebebdedb")]
                            varCSGUID=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; 
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d991d04f-2364-4a5a-8471-9b61a6c1df6b")]
                            if (varCSGUID != null)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b186148f-7b4b-4cb0-977c-2f14ae32294b")]
                                construct ListCartTransferXML
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3740c466-8ecd-40fd-846c-7992b710fac8")]
                                    transform (ListCartTransferXML) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XML (Message_FlatFileOriginal);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("be7ef2f0-ce4d-4c19-a095-d53b4ba561d8")]
                                    //ListCartTransferXML.csUserGuid=verifyPwdResponse.parameters.VerifyUserPasswordResult.UserGUID;
                                    //ListCartTransferXML.csUserGuid=xpath(msgVerifyUserEmailSqlResponse,"string(//UserId)");
                                    ListCartTransferXML.csUserGuid=msgVerifyUserEmailSqlResponse.StoredProcedureResultSet0.StoredProcedureResultSet0.UserId; 
                                    
                                    ListCartTransferXML(FILE.ReceivedFileName)=varFilename; 
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("456867d7-a11a-44df-a1c3-6cb0364ea508")]
                                send (TS360FTPPort.Operation_1, ListCartTransferXML);
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9e151286-2606-4892-9706-8be41ccdb0df")]
                                System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts", "Invalid Compass Credentials SQL - email or userid invalid");
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b1e64fd6-e698-469e-940b-74c7c78c8410")]
                                construct emailMsgComplete, ListCartTransferXMLEmail
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f017cee-9822-49bd-be33-ffd78f80bf38")]
                                    transform (ListCartTransferXMLEmail) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL (Message_FlatFileOriginal);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c9160b8f-f88c-405f-be87-ab0cdff41479")]
                                    //varEmailAddress = xpath(ListCartTransferXMLEmail,"string(//UserEmail)");
                                    //varUserID = xpath(ListCartTransferXMLEmail,"string(//DestinationUserID)");
                                    
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("Filename: " + varFilename);
                                    msgbody.AppendLine("<p><p>Summary:");
                                    msgbody.AppendLine("Your cart was not created, a error occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot" );
                                    msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                    msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                    msgbody.AppendLine("</body></html>");
                                    
                                    emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email
                                    emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                    emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    
                                    emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsgComplete(SMTP.From)= varSMTPFrom;
                                    emailMsgComplete(SMTP.CC)=varSMTPCC;
                                    
                                    emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                    
                                    emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("fd1c57ec-956c-4f24-a15d-98cc76b3e336")]
                                send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("041d2a2b-35b0-4600-99d7-e438818e2d71")]
                            System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ListTransferCarts", "Invalid Compass Credentials - email or userid invalid");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e6b845e2-da7c-4995-893f-7473e9afae65")]
                            construct emailMsgComplete, ListCartTransferXMLEmail
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9d79140-39b0-45b2-bcca-5ed760a4016e")]
                                transform (ListCartTransferXMLEmail) = BTNextGen.Biztalk.ListTransferCarts.ListTransferFF_To_TS360XMLEMAIL (Message_FlatFileOriginal);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("89f5511f-da15-4ed6-9a0e-2b53fbd28d22")]
                                //varEmailAddress = xpath(ListCartTransferXMLEmail,"string(//UserEmail)");
                                //varUserID = xpath(ListCartTransferXMLEmail,"string(//DestinationUserID)");
                                
                                msgbody = new System.Text.StringBuilder();
                                msgbody.AppendLine("<html><body>");
                                msgbody.AppendLine("Filename: " + varFilename);
                                msgbody.AppendLine("<p><p>Summary:");
                                msgbody.AppendLine("Your cart was not created, a error occurred when validating system credentials. If this error continues, please Contact Administrator to troubleshoot" );
                                msgbody.AppendLine("<p><p>Number of ISBN/UPCs Received: " + varLineReceivedCount.ToString());
                                msgbody.AppendLine("<p>Number of ISBN/UPCs Inserted: 0" );
                                msgbody.AppendLine("</body></html>");
                                
                                emailMsgComplete.MessagePart_body = new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                emailMsgComplete.MessagePart_bodyattachment = ListCartTransferXMLEmail;  //was message_email
                                emailMsgComplete.MessagePart_bodyattachment(MIME.FileName) = varFilename + ".xml";
                                emailMsgComplete.MessagePart_bodyattachment(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                
                                emailMsgComplete.MessagePart_body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                emailMsgComplete(SMTP.SMTPHost)=varSMTPHost;
                                emailMsgComplete(SMTP.From)= varSMTPFrom;
                                emailMsgComplete(SMTP.CC)=varSMTPCC;
                                
                                emailMsgComplete(SMTP.Subject)="ListTransfer: Invalid Cart data supplied from " + varUserID;   
                                
                                emailMsgComplete(SMTP.EmailBodyTextCharset)="UTF-8";
                                emailMsgComplete(SMTP.MessagePartsAttachments)=2;
                                
                                Port_SendEmailComplete_LT(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3b4276ce-4e1a-4bf8-af31-a6d11eb64a40")]
                            send (Port_SendEmailComplete_LT.Operation_1, emailMsgComplete);
                        }
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8be043bc-8f2b-4795-b59c-cef735da4fdd")]
                    catch (System.SystemException ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ab82e08-f594-4e0e-b8e7-793b51bad553")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d9360538-2f62-4663-98e8-9be252afd684")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="Btnextgen.Biztalk.ListTransferCarts Exception";
                            FaultMessage.FaultDescription=ex.Message;
                            FaultMessage.FaultCode="3011";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("74cc02f3-9451-40f1-819a-4c11b137f06a")]
                        send (Port_SendEmailFail_LT.Operation_1, FaultMessage);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fa0a120c-e577-4895-9fc8-7b6dea2d6643")]
                        send (LT_FaultPort.Operation_1, FaultMessage);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e9b143ce-8667-4b00-8903-73c26da7f6f8")]
                    catch (Microsoft.XLANGs.Pipeline.XLANGPipelineManagerException pipe)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fb84e55e-f5a3-47e9-81f8-318cd0cb50f8")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f4d0f5b0-b21b-4df6-9216-394da7950555")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="Btnextgen.Biztalk.ListTransferCarts Exception";
                            FaultMessage.FaultDescription=pipe.Message;
                            FaultMessage.FaultCode="3011";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("74af6555-9ad9-4f2f-95c8-b73b65d7cf66")]
                        send (Port_SendEmailFail_LT.Operation_1, FaultMessage);
                    }
                }
            }
        }
    }
}

