#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="c6a911f1-5727-4dd4-bd51-574c99603377" LowerBound="1.1" HigherBound="893.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ReconCybersource2" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="ServiceDeclaration" OID="77b61617-b2c8-42c0-95d7-0c69314a11c3" ParentLink="Module_ServiceDeclaration" LowerBound="104.1" HigherBound="892.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="IOrder2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="VariableDeclaration" OID="8a1e6c55-0de5-4f10-905b-c8c80c744651" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="132.1" HigherBound="133.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlQRYRECONCYBERSOURCE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6911b35a-d7b2-426e-a2d3-13e73d4047a9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="133.1" HigherBound="134.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlFLATRECYBERSOURCE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0a6cccd9-b41e-4171-860f-f2c8b0f1d876" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="134.1" HigherBound="135.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5b04d3b9-fe94-4c32-9ec4-87025596c114" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="135.1" HigherBound="136.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1c414e5b-954b-403c-a6d9-338ff1edf48b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="136.1" HigherBound="137.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="09761da3-dd97-41f9-b2df-2a2536f998f4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="137.1" HigherBound="138.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="79fab818-3804-4571-a774-cc29917e178e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="138.1" HigherBound="139.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="141c0d3f-ec77-483d-8cc9-8e2935b02e6f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="139.1" HigherBound="140.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportYear" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fdb79539-2485-43d2-be33-e5f579f6211e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="140.1" HigherBound="141.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportMonth" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fcce2fc1-f65a-42ca-a2e7-dcdda3699bed" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="141.1" HigherBound="142.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportDay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ee28a831-db2d-42ca-a690-b681692b3a1e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="142.1" HigherBound="143.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varReportDate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ef1bf8c2-86b4-4df8-aba5-8a0a5788dd59" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="143.1" HigherBound="144.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5367a5fc-d2f1-433e-91f5-29604f2bfe57" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="144.1" HigherBound="145.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="19a8beb7-6392-4d46-8bb2-34b100771d08" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="145.1" HigherBound="146.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant2Active" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="14a5cec4-f9ca-47db-8fff-78d426714d57" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="146.1" HigherBound="147.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="24b05d17-642e-48d2-889d-6e57f23fef59" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="147.1" HigherBound="148.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="feca4b5b-e17e-469f-b282-902e1253a428" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="148.1" HigherBound="149.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Exception" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="aca0afde-92ac-45b0-b1a2-0f2c7b3bd2ba" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="149.1" HigherBound="150.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varErrorMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="59288593-c5bb-4cbe-b17d-04cb05e5bf09" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="150.1" HigherBound="151.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDaysBack" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2e5af8f1-2c47-4c77-99a1-ae112cc5bc4d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="151.1" HigherBound="152.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDateYesterday2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="85431f45-fb9f-41ae-9384-628fc7ab1479" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="152.1" HigherBound="153.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDateYesterday" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c32e2e5b-c28d-458d-a2e9-d202840664ad" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="153.1" HigherBound="154.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBadDataResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2004b873-dcef-40d0-9e73-e8b2c10bfe38" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="154.1" HigherBound="155.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive3RAW" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="08abcb0d-067d-43ca-8ff2-6a7c8290e501" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="155.1" HigherBound="156.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive2BackupResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d141f31b-3267-41c8-95fa-fe81e66f993b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="156.1" HigherBound="157.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchive1WCF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="70e21e53-e61c-4c0a-95f0-77cc23882e88" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="157.1" HigherBound="158.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sXpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e35b1e95-5094-40d3-b942-2be064fc463a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="158.1" HigherBound="159.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHold" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c79399d3-9c16-4341-a6ba-04756e911b9e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="159.1" HigherBound="160.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="26e15fc7-604e-44e1-a1e2-2718633d30da" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="160.1" HigherBound="161.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int16" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intDaysBack" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a75540fa-d51e-41d7-b413-c1adb264ade2" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="161.1" HigherBound="162.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant3Active" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="dc8d80f1-3ecc-430b-a122-f2606673cde8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="162.1" HigherBound="163.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant4Active" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ccff056d-865b-4001-a873-e6df131cbbe4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="163.1" HigherBound="164.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="48a8fa0f-8cd3-455d-844c-e83218bfbd9c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="164.1" HigherBound="165.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varServer4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="000af7c0-abc0-4560-a039-eae874068521" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="165.1" HigherBound="166.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b16cbd8f-760c-426f-9e3a-5acb159d07e4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="166.1" HigherBound="167.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUser4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b188e40c-c73b-40e8-a7fd-536b18d2d633" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="167.1" HigherBound="168.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ab4a6b0e-1f07-4661-a7f9-7b796b95a639" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="168.1" HigherBound="169.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPassword4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="52cb0981-ed41-4afb-9f49-0f3dc90fb9cd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="169.1" HigherBound="170.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cd1c18b1-acf0-4caa-95d9-f44cf75f57f1" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="170.1" HigherBound="171.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMerchant4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ed4e363e-6c95-4881-8037-9d8731f46d73" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="123.1" HigherBound="124.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageXMLDummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2a8aac49-4a33-42b1-9474-a6a8e6555049" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="124.1" HigherBound="125.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.CyberSourceResponseBackup" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_ResponseBackup" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c3284e0e-2c4b-48b0-b88e-c9324d0ddc86" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="125.1" HigherBound="126.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Response" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="30be977f-fb59-4f47-9c84-62f596ff17ea" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="126.1" HigherBound="127.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Request" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="065aeae5-489d-4465-9361-9cca55740373" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="127.1" HigherBound="128.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.ReconCybersourceDummy" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Dummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="0ff4b297-e493-482f-b880-fbcf2f0f5b5b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="128.1" HigherBound="129.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Flat" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive3_RAWFile" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="fac55c1c-dbf0-4085-b3b9-32c1681ac7df" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="129.1" HigherBound="130.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.CyberSourceResponseBackup" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive2_BackupResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="bd6e8676-bd74-4356-b818-34c0a0429a17" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="130.1" HigherBound="131.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_Archive1_WCF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2e0ac244-b07d-40da-873e-265948ff19b6" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="131.1" HigherBound="132.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="5d818631-dcc3-4981-9a59-17b2d1c12948" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="1ad5eaf9-b31a-4c29-977f-a6aa10c1789e" ParentLink="ServiceBody_Statement" LowerBound="173.1" HigherBound="211.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_Dummy" />
                    <om:Property Name="MessageName" Value="Message_Dummy" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_Dummy" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="3b63966f-149b-4268-8942-0e464a583240" ParentLink="ServiceBody_Statement" LowerBound="211.1" HigherBound="890.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableDeclaration" OID="ed3f1680-8bcc-4637-8f64-9f20f1219b14" ParentLink="Scope_VariableDeclaration" LowerBound="215.1" HigherBound="216.1">
                        <om:Property Name="UseDefaultConstructor" Value="True" />
                        <om:Property Name="Type" Value="System.Text.StringBuilder" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Variable_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="e7cbaf20-a0cf-473a-b3d4-0cb5e4275f05" ParentLink="ComplexStatement_Statement" LowerBound="219.1" HigherBound="260.1">
                        <om:Property Name="Expression" Value="varArchive1WCF=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Archive1WCF&quot;));&#xD;&#xA;varArchive2BackupResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Archive2ResponseBackup&quot;));&#xD;&#xA;varArchive3RAW=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Archive3RAWFile&quot;));&#xD;&#xA;varMerchant1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant1&quot;);                                                                                                               &#xD;&#xA;varServer1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Server1&quot;);  &#xD;&#xA;varUser1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;User1&quot;);  &#xD;&#xA;varPassword1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Password1&quot;);  &#xD;&#xA;varDaysBack=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;DaysBack&quot;);  &#xD;&#xA;&#xD;&#xA;varMerchant2Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant2Active&quot;));&#xD;&#xA;varMerchant2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant2&quot;);                                                                                                               &#xD;&#xA;varServer2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Server2&quot;);  &#xD;&#xA;varUser2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;User2&quot;);  &#xD;&#xA;varPassword2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Password2&quot;);  &#xD;&#xA;&#xD;&#xA;varMerchant3Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant3Active&quot;));&#xD;&#xA;varMerchant3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant3&quot;);                                                                                                               &#xD;&#xA;varServer3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Server3&quot;);  &#xD;&#xA;varUser3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;User3&quot;);  &#xD;&#xA;varPassword3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Password3&quot;); &#xD;&#xA;&#xD;&#xA;varMerchant4Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant4Active&quot;));&#xD;&#xA;varMerchant4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Merchant4&quot;);                                                                                                               &#xD;&#xA;varServer4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Server4&quot;);  &#xD;&#xA;varUser4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;User4&quot;);  &#xD;&#xA;varPassword4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;,&quot;Password4&quot;); &#xD;&#xA;&#xD;&#xA;intDaysBack=System.Convert.ToInt16(varDaysBack);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varDateYesterday = System.DateTime.Now.AddDays(-intDaysBack);&#xD;&#xA;&#xD;&#xA;varReportMonth = System.Convert.ToString(varDateYesterday.Month);&#xD;&#xA;varReportYear = System.Convert.ToString(varDateYesterday.Year);&#xD;&#xA;varReportDay = System.Convert.ToString(varDateYesterday.Day);&#xD;&#xA;&#xD;&#xA;varReportMonth = varReportMonth.PadLeft(2,'0');&#xD;&#xA;varReportDay = varReportDay.PadLeft(2,'0');&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ReconCyberSource2&quot;, &quot;Cybersource &quot; + varReportMonth + &quot;/&quot; + varReportDay + &quot;/&quot; + varReportYear );&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getSSO and Dates" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Construct" OID="3bfda7d6-ba92-46a8-9a00-282ea83f7598" ParentLink="ComplexStatement_Statement" LowerBound="260.1" HigherBound="279.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_WCF" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="78c30de0-e65d-4f97-bb9d-c7a2952443bd" ParentLink="Construct_MessageRef" LowerBound="261.31" HigherBound="261.46">
                            <om:Property Name="Ref" Value="Message_Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="dc88366f-29ee-4eac-8b4e-dc6839801b73" ParentLink="ComplexStatement_Statement" LowerBound="263.1" HigherBound="278.1">
                            <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant1 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword1 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer1 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser1 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;PaymentBatchDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_2" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="4d6c4a7c-49b3-4106-a7b2-a5531df7d30b" ParentLink="ComplexStatement_Statement" LowerBound="279.1" HigherBound="292.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="7da7f3ad-422c-4daa-a11c-6a7d1ee0492a" ParentLink="ReallyComplexStatement_Branch" LowerBound="280.21" HigherBound="292.1">
                            <om:Property Name="Expression" Value="varArchive1WCF == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveWCFMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="7336adbd-8b87-401e-99ae-9dacd6101a8b" ParentLink="ComplexStatement_Statement" LowerBound="282.1" HigherBound="289.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="76fb2f76-5dce-46ee-ab78-d6db23b03785" ParentLink="Construct_MessageRef" LowerBound="283.35" HigherBound="283.55">
                                    <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="c7d7483a-0fbd-4e4c-9c0c-ce3ff2398cbb" ParentLink="ComplexStatement_Statement" LowerBound="285.1" HigherBound="288.1">
                                    <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_WCFRequest&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="9f517328-7bed-47fd-8a97-12e0d77ef1d1" ParentLink="ComplexStatement_Statement" LowerBound="289.1" HigherBound="291.1">
                                <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ArchiveWCF" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="e4dbb6c1-2123-482d-b959-4def153bfdf8" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="edaeccc5-521f-4302-b921-439cb201f02b" ParentLink="ComplexStatement_Statement" LowerBound="292.1" HigherBound="301.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageAssignment" OID="2dfb5b7d-2f2c-41d9-9057-84fe9295197e" ParentLink="ComplexStatement_Statement" LowerBound="295.1" HigherBound="300.1">
                            <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource2.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="968f0f1b-7d79-414d-ae23-1fd801fca3f2" ParentLink="Construct_MessageRef" LowerBound="293.31" HigherBound="293.46">
                            <om:Property Name="Ref" Value="MessageXMLDummy" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="6323d8fa-028e-4f2c-9ede-f0036ba51a76" ParentLink="Construct_MessageRef" LowerBound="293.48" HigherBound="293.64">
                            <om:Property Name="Ref" Value="Message_Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="45a740f3-d1de-4b3e-9fb6-00eb249f7cc8" ParentLink="ComplexStatement_Statement" LowerBound="301.1" HigherBound="337.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_WCF" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Send" OID="2dab6fa2-c7bb-4cdd-a266-9a82b65de119" ParentLink="ComplexStatement_Statement" LowerBound="306.1" HigherBound="308.1">
                            <om:Property Name="PortName" Value="Port_WCF" />
                            <om:Property Name="MessageName" Value="Message_Request" />
                            <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_wcf" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="8a1bdb28-e5b6-4943-af70-d8d88ca686bd" ParentLink="ComplexStatement_Statement" LowerBound="308.1" HigherBound="310.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Port_WCF" />
                            <om:Property Name="MessageName" Value="Message_Response" />
                            <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_wcf" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Catch" OID="ba264281-c390-4998-a499-6551f7537794" ParentLink="Scope_Catch" LowerBound="313.1" HigherBound="335.1">
                            <om:Property Name="ExceptionName" Value="ex2" />
                            <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CatchException_wcf" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="2055b832-3c89-4b6a-a372-f00deddaf828" ParentLink="Catch_Statement" LowerBound="316.1" HigherBound="332.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="6f32e00a-fd0a-4200-abc2-7f61b6398adf" ParentLink="ComplexStatement_Statement" LowerBound="319.1" HigherBound="331.1">
                                    <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_5" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="7e0959b0-a6ea-49b8-8020-304368a1613f" ParentLink="Construct_MessageRef" LowerBound="317.43" HigherBound="317.55">
                                    <om:Property Name="Ref" Value="FaultMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="5fb0870a-1b6e-4b65-bf05-504beafcda4e" ParentLink="Catch_Statement" LowerBound="332.1" HigherBound="334.1">
                                <om:Property Name="PortName" Value="Port_FaultPort" />
                                <om:Property Name="MessageName" Value="FaultMessage" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Fault" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="7aceb70e-65a9-4bc5-93d1-60e3c58c1c00" ParentLink="ComplexStatement_Statement" LowerBound="337.1" HigherBound="343.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_Backup" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Transform" OID="bca60875-549e-44f0-921a-87dc5d2e8aad" ParentLink="ComplexStatement_Statement" LowerBound="340.1" HigherBound="342.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource2.Transform2Backup" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_3" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="MessagePartRef" OID="569d24b0-aade-422a-b14a-4607fca8dee8" ParentLink="Transform_InputMessagePartRef" LowerBound="341.116" HigherBound="341.143">
                                <om:Property Name="MessageRef" Value="Message_Response" />
                                <om:Property Name="PartRef" Value="parameters" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_3" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="5ac37c08-cf45-4891-b71c-b97c0d4d7949" ParentLink="Transform_OutputMessagePartRef" LowerBound="341.36" HigherBound="341.58">
                                <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_4" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageRef" OID="db280c19-f385-4ecf-88b7-5978fc7b245f" ParentLink="Construct_MessageRef" LowerBound="338.31" HigherBound="338.53">
                            <om:Property Name="Ref" Value="Message_ResponseBackup" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="f2eb14de-0678-4e41-ae66-0809f7a225c8" ParentLink="ComplexStatement_Statement" LowerBound="343.1" HigherBound="356.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="97024730-867a-4238-b387-ba5bb89994c1" ParentLink="ReallyComplexStatement_Branch" LowerBound="344.21" HigherBound="356.1">
                            <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveResponseBackup" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="cd8ea7c3-cac8-45ab-a9ec-ebd54cfa43c6" ParentLink="ComplexStatement_Statement" LowerBound="346.1" HigherBound="353.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="e50c3ea5-9aca-4ae9-b23a-c6b44d8c0918" ParentLink="Construct_MessageRef" LowerBound="347.35" HigherBound="347.66">
                                    <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="82aead48-7baf-49ad-8541-3e3219099d51" ParentLink="ComplexStatement_Statement" LowerBound="349.1" HigherBound="352.1">
                                    <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_WCFResponseBackup&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="8272bb9a-107d-435f-987b-044afba17728" ParentLink="ComplexStatement_Statement" LowerBound="353.1" HigherBound="355.1">
                                <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Archive_backup" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="147b7b71-7407-4a3c-a02a-0c30f76f526c" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="4328e5bc-1ed9-4aef-b342-6ca9d04ab8e9" ParentLink="ComplexStatement_Statement" LowerBound="356.1" HigherBound="372.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_ERP" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageAssignment" OID="7eaf0435-0317-4d28-b69b-605056f23131" ParentLink="ComplexStatement_Statement" LowerBound="359.1" HigherBound="371.1">
                            <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Payment Batch Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_1" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="9b3d37a0-3683-45d7-ab67-e7d4792c93d4" ParentLink="Construct_MessageRef" LowerBound="357.31" HigherBound="357.40">
                            <om:Property Name="Ref" Value="Message_1" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="6104e377-347e-454b-a53b-b493dcca362d" ParentLink="ComplexStatement_Statement" LowerBound="372.1" HigherBound="393.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_BadDataResponse" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="82508770-0608-4732-a62b-d40b2c8cd665" ParentLink="ReallyComplexStatement_Branch" LowerBound="373.21" HigherBound="393.1">
                            <om:Property Name="Expression" Value="varBadDataResponse == false" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_1" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Send" OID="cdc28e45-dcfa-436c-83dd-5060781a3744" ParentLink="ComplexStatement_Statement" LowerBound="375.1" HigherBound="377.1">
                                <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_1" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Construct" OID="c119d7e8-9636-4fb4-b5a1-3d153afbb8ba" ParentLink="ComplexStatement_Statement" LowerBound="377.1" HigherBound="390.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="c760ad1b-8c2d-49ad-aee0-3bb1922e3041" ParentLink="Construct_MessageRef" LowerBound="378.35" HigherBound="378.47">
                                    <om:Property Name="Ref" Value="FaultMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="576eff91-eb0a-46dc-8e41-d06831659ef4" ParentLink="ComplexStatement_Statement" LowerBound="380.1" HigherBound="389.1">
                                    <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_5" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="768e97f0-f2d8-4df6-9fde-6afef968e0a9" ParentLink="ComplexStatement_Statement" LowerBound="390.1" HigherBound="392.1">
                                <om:Property Name="PortName" Value="Port_FaultPort" />
                                <om:Property Name="MessageName" Value="FaultMessage" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Fault" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="7f01cbd6-0ba5-424f-b81b-e8e3195a8b30" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="7133e947-f1eb-49d6-b490-3e6957c854f2" ParentLink="ComplexStatement_Statement" LowerBound="393.1" HigherBound="406.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="27ad206e-7421-419b-bb17-2a35b47ef4e7" ParentLink="ReallyComplexStatement_Branch" LowerBound="394.21" HigherBound="406.1">
                            <om:Property Name="Expression" Value="varArchive3RAW == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveRAWFile" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="91a9a55c-8133-47c3-928c-345d057a83cc" ParentLink="ComplexStatement_Statement" LowerBound="396.1" HigherBound="403.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="e0356679-0aca-4865-9225-fcc7f439589a" ParentLink="Construct_MessageRef" LowerBound="397.35" HigherBound="397.59">
                                    <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="3d700402-8275-47ad-a01b-a72dcf45ef68" ParentLink="ComplexStatement_Statement" LowerBound="399.1" HigherBound="402.1">
                                    <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_RAWOutput&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="f228009c-93da-4393-928b-9b0987ec78cd" ParentLink="ComplexStatement_Statement" LowerBound="403.1" HigherBound="405.1">
                                <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Archive_raw" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="b208e869-157a-4802-95f0-58598818b5a9" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Send" OID="14c61638-8c6f-4c61-a72e-26a298ee0bfe" ParentLink="ComplexStatement_Statement" LowerBound="406.1" HigherBound="408.1">
                        <om:Property Name="PortName" Value="Port_RawFile" />
                        <om:Property Name="MessageName" Value="Message_1" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send_RAWFile" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Decision" OID="193f99d1-3871-428f-8501-6cd7834407a7" ParentLink="ComplexStatement_Statement" LowerBound="408.1" HigherBound="560.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Merchant2_Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="14896c87-09af-45f5-b2b9-1953760cea7e" ParentLink="ReallyComplexStatement_Branch" LowerBound="409.21" HigherBound="560.1">
                            <om:Property Name="Expression" Value="varMerchant2Active == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Mechant2_Check" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="d97164d8-7f3f-44fb-b7c3-a9e48599d38c" ParentLink="ComplexStatement_Statement" LowerBound="411.1" HigherBound="430.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="dd392c68-6664-47d1-bfa9-fef3eceb0c98" ParentLink="Construct_MessageRef" LowerBound="412.35" HigherBound="412.50">
                                    <om:Property Name="Ref" Value="Message_Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="8d0d4b32-93f3-4d0c-837c-5ec6baec896a" ParentLink="ComplexStatement_Statement" LowerBound="414.1" HigherBound="429.1">
                                    <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant2 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword2 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer2 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser2 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;PaymentBatchDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="df0e78c3-ae5f-4bd7-85b3-a43e0a559a0a" ParentLink="ComplexStatement_Statement" LowerBound="430.1" HigherBound="443.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="a9bb2ad3-3e1b-4a15-9639-ed5a10e07cf9" ParentLink="ReallyComplexStatement_Branch" LowerBound="431.25" HigherBound="443.1">
                                    <om:Property Name="Expression" Value="varArchive1WCF == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveWCFMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="8692b36d-2c4f-49b8-b60e-00c8800ab93d" ParentLink="ComplexStatement_Statement" LowerBound="433.1" HigherBound="440.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="01760dcd-ecc9-4e90-894b-19ddb4af329a" ParentLink="Construct_MessageRef" LowerBound="434.39" HigherBound="434.59">
                                            <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="00c86c1f-c061-4b5f-aa32-46800a4677b8" ParentLink="ComplexStatement_Statement" LowerBound="436.1" HigherBound="439.1">
                                            <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant2 +&quot;WCFRequest&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="26a85fcd-fa3f-47a9-88be-6a95b0eb2fc1" ParentLink="ComplexStatement_Statement" LowerBound="440.1" HigherBound="442.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                        <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ArchiveWCF" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="db18ca2c-c23d-442c-9090-69357318c9f8" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="59a16eda-b40f-496f-bc86-9f16bcb9e25a" ParentLink="ComplexStatement_Statement" LowerBound="443.1" HigherBound="452.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="75d9d3b7-e28c-43e5-afac-fc837927859c" ParentLink="ComplexStatement_Statement" LowerBound="446.1" HigherBound="451.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="0ba7f57c-2863-4a20-9e1b-976779c4a248" ParentLink="Construct_MessageRef" LowerBound="444.35" HigherBound="444.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="a63bd101-426b-48a5-85a9-0e4f8fb2c0c3" ParentLink="Construct_MessageRef" LowerBound="444.52" HigherBound="444.68">
                                    <om:Property Name="Ref" Value="Message_Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="8643f84f-12b7-4f29-9546-7fe047528264" ParentLink="ComplexStatement_Statement" LowerBound="452.1" HigherBound="488.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Send" OID="1de1948a-e20d-4e95-9751-fc2deadd5b38" ParentLink="ComplexStatement_Statement" LowerBound="457.1" HigherBound="459.1">
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Request" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="515f71ea-a769-40fc-b932-5ebda399b5a1" ParentLink="ComplexStatement_Statement" LowerBound="459.1" HigherBound="461.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Response" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="bd133eb3-44b7-41ca-b189-b569d09b0930" ParentLink="Scope_Catch" LowerBound="464.1" HigherBound="486.1">
                                    <om:Property Name="ExceptionName" Value="ex2" />
                                    <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="a37ae264-9572-4a71-8691-5170f196572a" ParentLink="Catch_Statement" LowerBound="467.1" HigherBound="483.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="05c2a64e-8bf5-4e9a-80ab-a4f21f034647" ParentLink="Construct_MessageRef" LowerBound="468.47" HigherBound="468.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="796cfe52-146f-4da3-ba1c-d5152698e81c" ParentLink="ComplexStatement_Statement" LowerBound="470.1" HigherBound="482.1">
                                            <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="31cc4857-d01b-4b14-b905-a3a319562f17" ParentLink="Catch_Statement" LowerBound="483.1" HigherBound="485.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="dd7cd0f8-f5f8-4daf-a635-5d4ffef78602" ParentLink="ComplexStatement_Statement" LowerBound="488.1" HigherBound="494.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Backup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="ca686ce0-d6e9-4deb-8fb7-c0c9eb93059a" ParentLink="Construct_MessageRef" LowerBound="489.35" HigherBound="489.57">
                                    <om:Property Name="Ref" Value="Message_ResponseBackup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="7c1ed87a-5846-419b-9eea-6eb938dd2d4a" ParentLink="ComplexStatement_Statement" LowerBound="491.1" HigherBound="493.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource2.Transform2Backup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_3" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="3377c0ca-10c9-4fdd-9d37-c129de0308ab" ParentLink="Transform_InputMessagePartRef" LowerBound="492.120" HigherBound="492.147">
                                        <om:Property Name="MessageRef" Value="Message_Response" />
                                        <om:Property Name="PartRef" Value="parameters" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="84038c1f-ee1f-45af-bfd1-68c07d437f6f" ParentLink="Transform_OutputMessagePartRef" LowerBound="492.40" HigherBound="492.62">
                                        <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="f22aaace-246b-48ca-a49b-c295e7f0b182" ParentLink="ComplexStatement_Statement" LowerBound="494.1" HigherBound="507.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="b7c923d7-6cda-4783-85d8-81cb313dcfb2" ParentLink="ReallyComplexStatement_Branch" LowerBound="495.25" HigherBound="507.1">
                                    <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveResponseBackup" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="68f6ff6a-4224-4638-bf1a-743000529eb2" ParentLink="ComplexStatement_Statement" LowerBound="497.1" HigherBound="504.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="cdc3c879-7a1e-4243-a009-b499efb36931" ParentLink="ComplexStatement_Statement" LowerBound="500.1" HigherBound="503.1">
                                            <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant2 +&quot;WCFResponseBackup&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="d51913a4-efd0-40cc-8c2b-cff12162b5b0" ParentLink="Construct_MessageRef" LowerBound="498.39" HigherBound="498.70">
                                            <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="3a783eda-5948-482a-9a9f-23f6a3561c15" ParentLink="ComplexStatement_Statement" LowerBound="504.1" HigherBound="506.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                        <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_backup" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="7d8c6383-5e9c-406a-abe8-861a3726ef4c" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="4acd8cb3-1388-4df3-85dd-00f12e0554a9" ParentLink="ComplexStatement_Statement" LowerBound="507.1" HigherBound="523.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_ERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="71a0a530-68be-4fb2-aa87-138fabf2865c" ParentLink="Construct_MessageRef" LowerBound="508.35" HigherBound="508.44">
                                    <om:Property Name="Ref" Value="Message_1" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="708cdc1b-b070-4383-b0ae-e2d7c85072c2" ParentLink="ComplexStatement_Statement" LowerBound="510.1" HigherBound="522.1">
                                    <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Payment Batch Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="c967ad20-751f-454e-8f3c-68aa82e23b27" ParentLink="ComplexStatement_Statement" LowerBound="523.1" HigherBound="544.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_BadDataResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="d7ec7521-165c-40a0-8d31-ebd568d4e5de" ParentLink="ReallyComplexStatement_Branch" LowerBound="524.25" HigherBound="544.1">
                                    <om:Property Name="Expression" Value="varBadDataResponse == false" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="aa70307c-c9d5-4748-8641-44f1aa3ead54" ParentLink="ComplexStatement_Statement" LowerBound="526.1" HigherBound="528.1">
                                        <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                        <om:Property Name="MessageName" Value="Message_1" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="cb672583-446c-4e64-ad81-abd97b9bb95b" ParentLink="ComplexStatement_Statement" LowerBound="528.1" HigherBound="541.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="b6e28c0d-2f3a-42e3-ac6f-052ec5b98ee7" ParentLink="ComplexStatement_Statement" LowerBound="531.1" HigherBound="540.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="6134f63a-fb68-4e9b-9218-9cfb836cb48c" ParentLink="Construct_MessageRef" LowerBound="529.39" HigherBound="529.51">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="1a3c0ea2-f473-40de-a00a-a5c8a0b35e22" ParentLink="ComplexStatement_Statement" LowerBound="541.1" HigherBound="543.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="3ddefbb3-5855-4e47-974a-df830d2d00cb" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="60cb1573-effa-4839-97ba-c04a229f129b" ParentLink="ComplexStatement_Statement" LowerBound="544.1" HigherBound="546.1">
                                <om:Property Name="PortName" Value="Port_RawFile" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_RAWFile" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="8ce7aac6-87d2-4707-b9e4-d9dd672fe1e7" ParentLink="ComplexStatement_Statement" LowerBound="546.1" HigherBound="559.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="60f60967-bdef-44cd-a36b-2fa25af56db8" ParentLink="ReallyComplexStatement_Branch" LowerBound="547.25" HigherBound="559.1">
                                    <om:Property Name="Expression" Value="varArchive3RAW == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveRAWFile" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="34bac35d-de71-462b-a816-662e02d801d0" ParentLink="ComplexStatement_Statement" LowerBound="549.1" HigherBound="556.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="d85c3f31-cd84-4e57-983c-2082885347e1" ParentLink="ComplexStatement_Statement" LowerBound="552.1" HigherBound="555.1">
                                            <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant2 +&quot;RAWOutput&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="adbe3c72-8f8f-46c8-9a93-5c64939732ff" ParentLink="Construct_MessageRef" LowerBound="550.39" HigherBound="550.63">
                                            <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="b0f2fabb-0bc1-4b3d-90ab-72c7c16ae9f8" ParentLink="ComplexStatement_Statement" LowerBound="556.1" HigherBound="558.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                        <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_raw" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="ff7f09cd-97f4-413c-a935-7333b8a01137" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="09f3b74a-790c-4519-9424-3f1f524ba603" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="f8693274-88da-4873-9fdb-89bcc4f647a8" ParentLink="ComplexStatement_Statement" LowerBound="560.1" HigherBound="712.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Merchant3_Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="5d769920-4a55-4de3-b7a8-048c1a621ea3" ParentLink="ReallyComplexStatement_Branch" LowerBound="561.21" HigherBound="712.1">
                            <om:Property Name="Expression" Value="varMerchant2Active == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Mechant2_Check" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="ac2a703c-17d9-4e88-90f8-03d427637acd" ParentLink="ComplexStatement_Statement" LowerBound="563.1" HigherBound="582.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="bedefb9c-fbcc-45ab-976a-956bbd1a00d2" ParentLink="Construct_MessageRef" LowerBound="564.35" HigherBound="564.50">
                                    <om:Property Name="Ref" Value="Message_Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="9499a42d-a42a-4d70-b94f-7ae8096346e3" ParentLink="ComplexStatement_Statement" LowerBound="566.1" HigherBound="581.1">
                                    <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant3 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword3 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer3 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser3 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;PaymentBatchDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="fca6489c-ee2f-4408-adb6-5f14489b4cf0" ParentLink="ComplexStatement_Statement" LowerBound="582.1" HigherBound="595.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="fb2e6746-d2a5-4cbb-a7a6-48239c52f58d" ParentLink="ReallyComplexStatement_Branch" LowerBound="583.25" HigherBound="595.1">
                                    <om:Property Name="Expression" Value="varArchive1WCF == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveWCFMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="1b53ae8a-62a8-4f5c-b3fe-9d3431d80229" ParentLink="ComplexStatement_Statement" LowerBound="585.1" HigherBound="592.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="bba9b44b-a99f-44f5-ac9b-2fddd79830d3" ParentLink="Construct_MessageRef" LowerBound="586.39" HigherBound="586.59">
                                            <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="fac22b98-800e-46a7-8965-49e01d8a4433" ParentLink="ComplexStatement_Statement" LowerBound="588.1" HigherBound="591.1">
                                            <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant3 +&quot;WCFRequest&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="fdce3e61-d72a-47e6-ab7c-bcea935ae8b2" ParentLink="ComplexStatement_Statement" LowerBound="592.1" HigherBound="594.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                        <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ArchiveWCF" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="12e35cba-9a86-4167-b422-82566e847969" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="c1682127-d090-4a5b-95cd-8220d52cccb8" ParentLink="ComplexStatement_Statement" LowerBound="595.1" HigherBound="604.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="9727749b-91f7-44ed-8ea9-b827cf2927ec" ParentLink="Construct_MessageRef" LowerBound="596.35" HigherBound="596.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="306a9dcb-8f50-4423-9394-b39b060b8065" ParentLink="Construct_MessageRef" LowerBound="596.52" HigherBound="596.68">
                                    <om:Property Name="Ref" Value="Message_Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="4a98bae6-e98a-4e24-8899-fdbe4204da1a" ParentLink="ComplexStatement_Statement" LowerBound="598.1" HigherBound="603.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="c4715781-3403-4465-ba64-856acf838666" ParentLink="ComplexStatement_Statement" LowerBound="604.1" HigherBound="640.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Send" OID="07517c1b-adf2-46a6-a1b2-b5456100db94" ParentLink="ComplexStatement_Statement" LowerBound="609.1" HigherBound="611.1">
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Request" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="06270494-6717-4468-a997-4fc1e8e441cb" ParentLink="ComplexStatement_Statement" LowerBound="611.1" HigherBound="613.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Response" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="35d49c56-abb2-4689-956f-40bd5c224bdf" ParentLink="Scope_Catch" LowerBound="616.1" HigherBound="638.1">
                                    <om:Property Name="ExceptionName" Value="ex2" />
                                    <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="2bb4e64d-4767-48f7-91f2-ba5008643427" ParentLink="Catch_Statement" LowerBound="619.1" HigherBound="635.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="de601a4d-fa5e-42b5-905a-a03cd2fd7224" ParentLink="Construct_MessageRef" LowerBound="620.47" HigherBound="620.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="c003799e-7994-4179-91d1-9518fc4ac37a" ParentLink="ComplexStatement_Statement" LowerBound="622.1" HigherBound="634.1">
                                            <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="8161b68f-a251-4850-abf4-a0134bdf033d" ParentLink="Catch_Statement" LowerBound="635.1" HigherBound="637.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="a2496103-bd00-45fa-aa7b-45349d6e2e08" ParentLink="ComplexStatement_Statement" LowerBound="640.1" HigherBound="646.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Backup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="6c637595-e035-42f5-baa1-a93c1dd78745" ParentLink="Construct_MessageRef" LowerBound="641.35" HigherBound="641.57">
                                    <om:Property Name="Ref" Value="Message_ResponseBackup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="1b504382-c5c0-4ab6-811b-e36777943a68" ParentLink="ComplexStatement_Statement" LowerBound="643.1" HigherBound="645.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource2.Transform2Backup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_3" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="eb40f240-6124-4471-bdb7-2302b7e74c58" ParentLink="Transform_InputMessagePartRef" LowerBound="644.120" HigherBound="644.147">
                                        <om:Property Name="MessageRef" Value="Message_Response" />
                                        <om:Property Name="PartRef" Value="parameters" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="350f8d49-4457-4bf1-9d71-2016ae8e2ac4" ParentLink="Transform_OutputMessagePartRef" LowerBound="644.40" HigherBound="644.62">
                                        <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="f4c483f6-1838-44f7-ad58-8158c4b7f4b7" ParentLink="ComplexStatement_Statement" LowerBound="646.1" HigherBound="659.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="f2c00212-0faf-4964-a20d-0d8f507dfd0f" ParentLink="ReallyComplexStatement_Branch" LowerBound="647.25" HigherBound="659.1">
                                    <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveResponseBackup" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="8e91d61c-bce0-45f1-9925-d83e9df307ad" ParentLink="ComplexStatement_Statement" LowerBound="649.1" HigherBound="656.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="a63c0f0e-fa55-4e10-ac17-ea9c47aee73d" ParentLink="Construct_MessageRef" LowerBound="650.39" HigherBound="650.70">
                                            <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="91aec4c0-eaf5-46c1-89ba-6fe47fdd8268" ParentLink="ComplexStatement_Statement" LowerBound="652.1" HigherBound="655.1">
                                            <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant3 +&quot;WCFResponseBackup&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="25c565c0-fc5c-42f1-9e4b-a6973706126d" ParentLink="ComplexStatement_Statement" LowerBound="656.1" HigherBound="658.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                        <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_backup" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="d4c4e23a-3fd4-48f9-a760-f7bbb26a98b0" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="37153ae5-9758-45ec-bfa1-de3a7b060cc9" ParentLink="ComplexStatement_Statement" LowerBound="659.1" HigherBound="675.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_ERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="dee51511-f867-470a-aa0f-ba48bf68bbb8" ParentLink="ComplexStatement_Statement" LowerBound="662.1" HigherBound="674.1">
                                    <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Payment Batch Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="5b07f1cc-2d3d-489a-9bf0-f6828856bc48" ParentLink="Construct_MessageRef" LowerBound="660.35" HigherBound="660.44">
                                    <om:Property Name="Ref" Value="Message_1" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="9422c13a-09cd-43c3-93ee-1b4557ae55b8" ParentLink="ComplexStatement_Statement" LowerBound="675.1" HigherBound="696.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_BadDataResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="2c0c075b-93fc-43cf-888f-0504524a0945" ParentLink="ReallyComplexStatement_Branch" LowerBound="676.25" HigherBound="696.1">
                                    <om:Property Name="Expression" Value="varBadDataResponse == false" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="b7b4594f-ece2-4ac5-bc34-dc2a2a155989" ParentLink="ComplexStatement_Statement" LowerBound="678.1" HigherBound="680.1">
                                        <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                        <om:Property Name="MessageName" Value="Message_1" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="5d65c682-be87-4785-ac55-1d35aada6d19" ParentLink="ComplexStatement_Statement" LowerBound="680.1" HigherBound="693.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="b6b6fcb4-375d-4cc7-8d5b-77d6b1e536a4" ParentLink="Construct_MessageRef" LowerBound="681.39" HigherBound="681.51">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="a45c0b2d-9bbc-4536-a4a7-401a10564789" ParentLink="ComplexStatement_Statement" LowerBound="683.1" HigherBound="692.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="0efb755b-c556-488b-bf8f-573d9d2db2c8" ParentLink="ComplexStatement_Statement" LowerBound="693.1" HigherBound="695.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="df2ec007-e993-4f44-834d-4100be6adbd6" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="298bb8cf-e0d7-4a92-ac5e-e99a04493a66" ParentLink="ComplexStatement_Statement" LowerBound="696.1" HigherBound="698.1">
                                <om:Property Name="PortName" Value="Port_RawFile" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_RAWFile" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="fda94ae7-8e63-43a8-aa83-0e9d6c783974" ParentLink="ComplexStatement_Statement" LowerBound="698.1" HigherBound="711.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="c68b2cfe-44e2-4b4e-8198-dd6ef95024f1" ParentLink="ReallyComplexStatement_Branch" LowerBound="699.25" HigherBound="711.1">
                                    <om:Property Name="Expression" Value="varArchive3RAW == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveRAWFile" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="190a3a90-595f-489d-a6cf-3a1afcfa2db7" ParentLink="ComplexStatement_Statement" LowerBound="701.1" HigherBound="708.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="616efe62-9f09-4ebe-ab18-f6c4ddd38f2f" ParentLink="ComplexStatement_Statement" LowerBound="704.1" HigherBound="707.1">
                                            <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant3 +&quot;RAWOutput&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="fffa6195-cd93-42b9-962b-cdce19e463db" ParentLink="Construct_MessageRef" LowerBound="702.39" HigherBound="702.63">
                                            <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="ab2a28a9-cbee-4a5c-bb37-6e5823669c04" ParentLink="ComplexStatement_Statement" LowerBound="708.1" HigherBound="710.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                        <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_raw" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="217b2ad1-b174-428f-946b-d3661b0078e3" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="a47b51f4-caab-43f9-938a-61d2e950ce44" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="97a094c7-d879-4048-9f6d-fc08567061c0" ParentLink="ComplexStatement_Statement" LowerBound="712.1" HigherBound="864.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_Merchant4_Processing" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="92136356-e457-40d7-9a1b-80ceef7cccc6" ParentLink="ReallyComplexStatement_Branch" LowerBound="713.21" HigherBound="864.1">
                            <om:Property Name="Expression" Value="varMerchant4Active == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_Mechant2_Check" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="6d6e42d7-91b8-4f09-a231-ce36d2b0c58a" ParentLink="ComplexStatement_Statement" LowerBound="715.1" HigherBound="734.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="fe927ef6-b0b4-4f33-89b8-36a19402befb" ParentLink="Construct_MessageRef" LowerBound="716.35" HigherBound="716.50">
                                    <om:Property Name="Ref" Value="Message_Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="4d3d3476-d4a7-4d30-9052-7739ca0a3c86" ParentLink="ComplexStatement_Statement" LowerBound="718.1" HigherBound="733.1">
                                    <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;//sHold = &quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;reportRequest&gt;&lt;CyberSourceMerchantId&gt;idehao&lt;/CyberSourceMerchantId&gt;&lt;CyberSourcePassword&gt;Password345&lt;/CyberSourcePassword&gt;&lt;CyberSourceServerName&gt;ebctest.cybersource.com/ebctest&lt;/CyberSourceServerName&gt;&lt;CyberSourceUserName&gt;Selfj&lt;/CyberSourceUserName&gt;&lt;Day&gt;01&lt;/Day&gt;&lt;Month&gt;10&lt;/Month&gt;&lt;ReportFormat&gt;csv&lt;/ReportFormat&gt;&lt;ReportName&gt;PaymentBatchDetailReport&lt;/ReportName&gt;&lt;Year&gt;2011&lt;/Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;xmlQRYRECONCYBERSOURCE.LoadXml(&quot;&lt;GetCyberSourceReport xmlns=\&quot;http://tempuri.org/\&quot; xmlns:btn=\&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\&quot; &gt;&lt;reportRequest&gt;&lt;btn:CyberSourceMerchantId&gt;&quot; + varMerchant4 + &quot;&lt;/btn:CyberSourceMerchantId&gt;&lt;btn:CyberSourcePassword&gt;&quot; + varPassword4 + &quot;&lt;/btn:CyberSourcePassword&gt;&lt;btn:CyberSourceServerName&gt;&quot; + varServer4 + &quot;&lt;/btn:CyberSourceServerName&gt;&lt;btn:CyberSourceUserName&gt;&quot; + varUser4 + &quot;&lt;/btn:CyberSourceUserName&gt;&lt;btn:Day&gt;&quot; + varReportDay + &quot;&lt;/btn:Day&gt;&lt;btn:Month&gt;&quot; + varReportMonth + &quot;&lt;/btn:Month&gt;&lt;btn:ReportFormat&gt;csv&lt;/btn:ReportFormat&gt;&lt;btn:ReportName&gt;PaymentBatchDetailReport&lt;/btn:ReportName&gt;&lt;btn:Year&gt;&quot; + varReportYear + &quot;&lt;/btn:Year&gt;&lt;/reportRequest&gt;&lt;/GetCyberSourceReport&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Message_Request.parameters = xmlQRYRECONCYBERSOURCE;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_2" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="458fa54e-5081-4763-81fe-86b30cec133a" ParentLink="ComplexStatement_Statement" LowerBound="734.1" HigherBound="747.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveWCFMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="b299f4d4-9a4e-4469-89a1-f1e0b37927f2" ParentLink="ReallyComplexStatement_Branch" LowerBound="735.25" HigherBound="747.1">
                                    <om:Property Name="Expression" Value="varArchive1WCF == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveWCFMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="0b8511c3-8c68-4a55-8a16-39438b3df3fe" ParentLink="ComplexStatement_Statement" LowerBound="737.1" HigherBound="744.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveWCFMessage" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="3fce072f-7795-4e2e-9460-a2b188efcb8b" ParentLink="Construct_MessageRef" LowerBound="738.39" HigherBound="738.59">
                                            <om:Property Name="Ref" Value="Message_Archive1_WCF" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="c990e39e-769f-41b4-89ee-3c556dfc8d4b" ParentLink="ComplexStatement_Statement" LowerBound="740.1" HigherBound="743.1">
                                            <om:Property Name="Expression" Value="Message_Archive1_WCF = Message_Request; &#xD;&#xA;Message_Archive1_WCF(FILE.ReceivedFileName)=&quot;Archive1_&quot; + varMerchant4 + &quot;WCFRequest&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="55200123-06f1-4a62-989c-9f93c74d8f9c" ParentLink="ComplexStatement_Statement" LowerBound="744.1" HigherBound="746.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveWCF" />
                                        <om:Property Name="MessageName" Value="Message_Archive1_WCF" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ArchiveWCF" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="c48cd482-e09f-41fa-9ba7-7046b917a0f5" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="41d5fc9d-679f-4de1-bfc6-9804c7816999" ParentLink="ComplexStatement_Statement" LowerBound="747.1" HigherBound="756.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructDummy_MessageReplyCybersource" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="1805046c-ecf3-4ed6-b470-43248eccae2d" ParentLink="Construct_MessageRef" LowerBound="748.35" HigherBound="748.50">
                                    <om:Property Name="Ref" Value="MessageXMLDummy" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="879a3d1b-72f2-4ed5-89a5-0cb913139b25" ParentLink="Construct_MessageRef" LowerBound="748.52" HigherBound="748.68">
                                    <om:Property Name="Ref" Value="Message_Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="6a293a49-125c-423b-bc2e-d7d0a69a23b2" ParentLink="ComplexStatement_Statement" LowerBound="750.1" HigherBound="755.1">
                                    <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;GetCyberSourceReponse xmlns:ns0=&quot;&quot;http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse&quot;&quot;&gt;&lt;GetCyberSourceResponseResult&gt;xxx&lt;/GetCyberSourceResponseResult&gt;&lt;/GetCyberSourceReponse&gt;&quot;);&#xD;&#xA;&#xD;&#xA;Message_Response.parameters = MessageXMLDummy;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Scope" OID="f39f3c46-6c16-490b-ac1a-f7f6712af7a9" ParentLink="ComplexStatement_Statement" LowerBound="756.1" HigherBound="792.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Scope_WCF" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Send" OID="3ff2c66a-b057-4f17-95b7-a57c50606a49" ParentLink="ComplexStatement_Statement" LowerBound="761.1" HigherBound="763.1">
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Request" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="0b59d225-f287-4055-9c07-3ebf85ccb0b1" ParentLink="ComplexStatement_Statement" LowerBound="763.1" HigherBound="765.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="Port_WCF" />
                                    <om:Property Name="MessageName" Value="Message_Response" />
                                    <om:Property Name="OperationName" Value="GetCyberSourceReport" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="45eac211-ceb4-44cd-b935-25ba36d78fc9" ParentLink="Scope_Catch" LowerBound="768.1" HigherBound="790.1">
                                    <om:Property Name="ExceptionName" Value="ex2" />
                                    <om:Property Name="ExceptionType" Value="Port_WCF.GetCyberSourceReport.Fault_1" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CatchException_wcf" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="d771fc0e-30b6-4bc0-aa8c-facf0915d65a" ParentLink="Catch_Statement" LowerBound="771.1" HigherBound="787.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="e78fad14-bbef-42da-a9ef-b72651c6b7dd" ParentLink="Construct_MessageRef" LowerBound="772.47" HigherBound="772.59">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="0180a52a-4924-45cc-8e07-35425c4578d2" ParentLink="ComplexStatement_Statement" LowerBound="774.1" HigherBound="786.1">
                                            <om:Property Name="Expression" Value="// Create fault &#xD;&#xA;xmlDoc = ex2.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="09e2a6f8-1333-4b48-9142-7ea6cc96aa53" ParentLink="Catch_Statement" LowerBound="787.1" HigherBound="789.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="3979488a-5c00-4554-8bec-261cc262ef69" ParentLink="ComplexStatement_Statement" LowerBound="792.1" HigherBound="798.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Backup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="50b9e2b6-b194-43c2-8aec-b92ab97e0b99" ParentLink="Construct_MessageRef" LowerBound="793.35" HigherBound="793.57">
                                    <om:Property Name="Ref" Value="Message_ResponseBackup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Transform" OID="91b52b73-92cf-4546-ac1a-bf0bd718756c" ParentLink="ComplexStatement_Statement" LowerBound="795.1" HigherBound="797.1">
                                    <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource2.Transform2Backup" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Transform_3" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="f1c1a333-c363-432b-aa4e-e267cdf4728b" ParentLink="Transform_InputMessagePartRef" LowerBound="796.120" HigherBound="796.147">
                                        <om:Property Name="MessageRef" Value="Message_Response" />
                                        <om:Property Name="PartRef" Value="parameters" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_1" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="684e885a-84d4-4b40-adf1-f27183722faa" ParentLink="Transform_OutputMessagePartRef" LowerBound="796.40" HigherBound="796.62">
                                        <om:Property Name="MessageRef" Value="Message_ResponseBackup" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_2" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="c87f3c2f-788b-4bb7-ba6a-ddf575121417" ParentLink="ComplexStatement_Statement" LowerBound="798.1" HigherBound="811.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveResponseBackup" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="c47132a9-029c-4f0d-96cc-ad234fa0043e" ParentLink="ReallyComplexStatement_Branch" LowerBound="799.25" HigherBound="811.1">
                                    <om:Property Name="Expression" Value="varArchive2BackupResponse == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveResponseBackup" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="ade2969a-6115-4ab4-bd8e-35da6cf42498" ParentLink="ComplexStatement_Statement" LowerBound="801.1" HigherBound="808.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveResponseBackup" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="08478ff9-0d2b-4025-809d-fc69d9717dba" ParentLink="Construct_MessageRef" LowerBound="802.39" HigherBound="802.70">
                                            <om:Property Name="Ref" Value="Message_Archive2_BackupResponse" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="3a4fd236-c1c6-46be-ad81-876844b25745" ParentLink="ComplexStatement_Statement" LowerBound="804.1" HigherBound="807.1">
                                            <om:Property Name="Expression" Value="Message_Archive2_BackupResponse = Message_ResponseBackup; &#xD;&#xA;Message_Archive2_BackupResponse(FILE.ReceivedFileName)=&quot;Archive2_&quot; + varMerchant4 + &quot;WCFResponseBackup&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="54e86a4b-a24a-40fa-8689-08426a337e9f" ParentLink="ComplexStatement_Statement" LowerBound="808.1" HigherBound="810.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveBackup" />
                                        <om:Property Name="MessageName" Value="Message_Archive2_BackupResponse" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_backup" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="8bf76721-f604-4c36-8ccf-e17604715085" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="1bbe7efd-7ed0-4275-ba71-7ce845b15fca" ParentLink="ComplexStatement_Statement" LowerBound="811.1" HigherBound="827.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_ERP" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="08c4f328-1dbc-4455-955c-cc8673330dbd" ParentLink="ComplexStatement_Statement" LowerBound="814.1" HigherBound="826.1">
                                    <om:Property Name="Expression" Value="sXpath = xpath(Message_ResponseBackup,&quot;string(//CyberSourceResponseResult)&quot;);&#xD;&#xA;//Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); &#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, sXpath));&#xD;&#xA;Variable_1 = new System.Text.StringBuilder();&#xD;&#xA;Variable_1.AppendLine(sXpath); &#xD;&#xA;Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());&#xD;&#xA;varBadDataResponse = sXpath.StartsWith(&quot;Payment Batch Detail Report&quot;);&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;Orchestration Debug&quot;, System.String.Format(&quot;The Value = {0}&quot;, varBadDataResponse));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="51fc8087-f23b-4c61-9f94-4bd6a7d4cab1" ParentLink="Construct_MessageRef" LowerBound="812.35" HigherBound="812.44">
                                    <om:Property Name="Ref" Value="Message_1" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Decision" OID="cc51b73b-0bde-40cc-ac0a-4504b4edfa66" ParentLink="ComplexStatement_Statement" LowerBound="827.1" HigherBound="848.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_BadDataResponse" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="e491e37d-4818-46d7-a08c-3f403dfdfd0a" ParentLink="ReallyComplexStatement_Branch" LowerBound="828.25" HigherBound="848.1">
                                    <om:Property Name="Expression" Value="varBadDataResponse == false" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Rule_1" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Send" OID="221a4a2d-74a2-44f1-b15a-b0e4eda2d608" ParentLink="ComplexStatement_Statement" LowerBound="830.1" HigherBound="832.1">
                                        <om:Property Name="PortName" Value="Port_EmailBadDataResponse" />
                                        <om:Property Name="MessageName" Value="Message_1" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="Construct" OID="918bf57c-507a-41f7-9e9c-9f09fd41f962" ParentLink="ComplexStatement_Statement" LowerBound="832.1" HigherBound="845.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageRef" OID="7cf256b0-1623-47e6-a973-0c799ca8db36" ParentLink="Construct_MessageRef" LowerBound="833.39" HigherBound="833.51">
                                            <om:Property Name="Ref" Value="FaultMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="9d2df6c4-1275-4531-8318-64f4a7f09115" ParentLink="ComplexStatement_Statement" LowerBound="835.1" HigherBound="844.1">
                                            <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=&quot;Bad Data Response from Cybersource&quot;;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_5" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="daf7654c-59ab-437a-8b73-130d7a9a9051" ParentLink="ComplexStatement_Statement" LowerBound="845.1" HigherBound="847.1">
                                        <om:Property Name="PortName" Value="Port_FaultPort" />
                                        <om:Property Name="MessageName" Value="FaultMessage" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Fault" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="0817a47c-db87-4e7b-9d8b-9f6faa7d2bb6" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="d96b56aa-e0d5-4f14-8378-b10269c7a763" ParentLink="ComplexStatement_Statement" LowerBound="848.1" HigherBound="850.1">
                                <om:Property Name="PortName" Value="Port_RawFile" />
                                <om:Property Name="MessageName" Value="Message_1" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_RAWFile" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Decision" OID="b28c5aa3-fd44-4a0e-940c-9e91ee83d2e1" ParentLink="ComplexStatement_Statement" LowerBound="850.1" HigherBound="863.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Decide_ArchiveRAWFile" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="98dfaa44-2095-4493-9832-344b3c8104fa" ParentLink="ReallyComplexStatement_Branch" LowerBound="851.25" HigherBound="863.1">
                                    <om:Property Name="Expression" Value="varArchive3RAW == true" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ArchiveRAWFile" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="0ec5f889-e0eb-457d-91b4-b60840c0e185" ParentLink="ComplexStatement_Statement" LowerBound="853.1" HigherBound="860.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructArchiveRAWFile" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="90610d15-7173-44d5-bbeb-88ee926554cb" ParentLink="ComplexStatement_Statement" LowerBound="856.1" HigherBound="859.1">
                                            <om:Property Name="Expression" Value="Message_Archive3_RAWFile = Message_1; &#xD;&#xA;Message_Archive3_RAWFile(FILE.ReceivedFileName)=&quot;Archive3_&quot; + varMerchant4 +&quot;RAWOutput&quot;; " />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="f53a8301-d094-491e-b138-03c57b7fff23" ParentLink="Construct_MessageRef" LowerBound="854.39" HigherBound="854.63">
                                            <om:Property Name="Ref" Value="Message_Archive3_RAWFile" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="a53b0f1b-0185-47b0-97f2-4a4cec06ccf6" ParentLink="ComplexStatement_Statement" LowerBound="860.1" HigherBound="862.1">
                                        <om:Property Name="PortName" Value="Port_ArchiveRAW" />
                                        <om:Property Name="MessageName" Value="Message_Archive3_RAWFile" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Archive_raw" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="340396d0-908a-4a4d-accd-ddde29fac692" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="985afc88-dd8e-4a32-854e-d3c296cf3a99" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Terminate" OID="554b2f97-0f6f-40f3-a889-33d976b9e807" ParentLink="ComplexStatement_Statement" LowerBound="864.1" HigherBound="866.1">
                        <om:Property Name="ErrorMessage" Value="&quot;test&quot;;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Terminate_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="MessageDeclaration" OID="cb6bd781-4670-41a1-80b0-2b99b3a0e146" ParentLink="Scope_MessageDeclaration" LowerBound="214.1" HigherBound="215.1">
                        <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Flat" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Message_1" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Catch" OID="daeff7f2-a891-48a4-ab1a-6b4c55820fcb" ParentLink="Scope_Catch" LowerBound="869.1" HigherBound="888.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.SystemException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_Main" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="1b5476ba-f10b-41f4-b573-0da298227ba4" ParentLink="Catch_Statement" LowerBound="872.1" HigherBound="885.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_Fault" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="d6c46063-d44d-4b3a-9c90-7eb8deec66e2" ParentLink="Construct_MessageRef" LowerBound="873.35" HigherBound="873.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="298c6f9d-2ced-471f-8ddc-b449ec2c85fb" ParentLink="ComplexStatement_Statement" LowerBound="875.1" HigherBound="884.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ReconCybersource2 Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=ex.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3004&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_5" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="88247e6c-9405-4478-9b10-a9e2f662383c" ParentLink="Catch_Statement" LowerBound="885.1" HigherBound="887.1">
                            <om:Property Name="PortName" Value="Port_FaultPort" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Fault" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="0b26c370-1f76-438e-aaab-a269b3b2bcb3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="107.1" HigherBound="109.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_Dummyx" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Dummy" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="2a326a07-c22e-43f5-a432-aeb9735a5800" ParentLink="PortDeclaration_CLRAttribute" LowerBound="107.1" HigherBound="108.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a8179579-4203-471a-acbf-2d74dd019977" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="109.1" HigherBound="111.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_WCF" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="1c4349d4-5bfb-4375-8e64-15ea94a8cc95" ParentLink="PortDeclaration_CLRAttribute" LowerBound="109.1" HigherBound="110.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="c930390b-d5d3-478d-830b-8486e9778bca" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="111.1" HigherBound="113.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_Archive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveWCF" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="31d0067d-d2cd-4cc3-ae6e-6edea6ed499d" ParentLink="PortDeclaration_CLRAttribute" LowerBound="111.1" HigherBound="112.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="41dda88d-9460-441e-a8e2-737c2864b0a8" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="113.1" HigherBound="115.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_ERP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveBackup" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="81e1b709-2df7-48e4-836c-ef4036b8951b" ParentLink="PortDeclaration_CLRAttribute" LowerBound="113.1" HigherBound="114.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a8e2ae03-3f98-4050-9aa0-91696d8fc468" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="115.1" HigherBound="117.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_2" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_RawFile" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="dffb963a-9e6d-41ab-985c-361b711bc499" ParentLink="PortDeclaration_CLRAttribute" LowerBound="115.1" HigherBound="116.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="ea337d3a-e46b-44e5-a780-dcf526fb5a83" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="117.1" HigherBound="119.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_ArchiveRAW" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveRAW" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="f7b82310-647d-4a03-8c07-18951279f0cc" ParentLink="PortDeclaration_CLRAttribute" LowerBound="117.1" HigherBound="118.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="a5391062-cf58-4eca-bb3d-cdc6c01af364" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="119.1" HigherBound="121.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_FaultPort" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_FaultPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="4143a923-3188-46fd-9546-f22f3a9c086f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="119.1" HigherBound="120.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="219721f1-8993-4fb8-85ce-ae5eced03001" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="121.1" HigherBound="123.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ReconCybersource2.PortType_EmailBadDataResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_EmailBadDataResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="3c5e4a89-4b41-41b1-a411-8c092cbf2dab" ParentLink="PortDeclaration_CLRAttribute" LowerBound="121.1" HigherBound="122.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="a8399486-c60f-4ab0-bd88-cb37b3548390" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Flat" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="ca482654-288e-4690-ae99-38a130806cf3" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="0c210d52-d00e-4832-8ab0-fa438937f3f8" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Fault" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="02b5beea-c826-424a-ae10-05ff0ed87473" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Fault" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="b2625562-2039-4ba5-acbf-1f04ee90b32e" ParentLink="Module_MessageType" LowerBound="12.1" HigherBound="16.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:message name=&quot;IOrdersService_GetCyberSourceReport_OutputMessage&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrdersService_GetCyberSourceReport_OutputMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="PartDeclaration" OID="49164654-2f87-4716-b44e-82d2e73544c3" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="14.1" HigherBound="15.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.IOrder_tempuri_org.GetCyberSourceReportResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:part name=&quot;parameters&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="parameters" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="c8b4f87f-5219-4cca-89c7-d2367d0d8793" ParentLink="Module_MessageType" LowerBound="16.1" HigherBound="20.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:message name=&quot;IOrdersService_GetCyberSourceReport_InputMessage&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrdersService_GetCyberSourceReport_InputMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="PartDeclaration" OID="ef02ea5f-d1f4-4c0c-86ea-25d89139e06f" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="18.1" HigherBound="19.1">
                <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ReconCybersource.IOrder_tempuri_org.GetCyberSourceReport" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:part name=&quot;parameters&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="parameters" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="16ec51bd-bcfc-4d7e-b0f2-6b379ad338cb" ParentLink="Module_PortType" LowerBound="20.1" HigherBound="27.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="AnalystComments" Value="&lt;wsdl:portType name=&quot;IOrdersService&quot;/&gt;&#xD;&#xA;" />
            <om:Property Name="Name" Value="IOrdersService" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="af8330a9-2e59-4efb-b16c-353f31672cb3" ParentLink="PortType_OperationDeclaration" LowerBound="22.1" HigherBound="26.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="AnalystComments" Value="&lt;wsdl:operation name=&quot;GetCyberSourceReport&quot;/&gt;&#xD;&#xA;" />
                <om:Property Name="Name" Value="GetCyberSourceReport" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="02f803d8-9930-4380-ab11-bf661a7dde7c" ParentLink="OperationDeclaration_FaultMessageRef" LowerBound="24.114" HigherBound="24.143">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Fault" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Fault_1" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="8d25434c-a541-4d01-bf5e-1f34bb70589c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="24.13" HigherBound="24.61">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="&lt;wsdl:input message=&quot;http://tempuri.org/:IOrdersService_GetCyberSourceReport_InputMessage&quot;/&gt;&#xD;&#xA;Action=&quot;http://tempuri.org/IOrdersService/GetCyberSourceReport&quot;&#xD;&#xA;" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="faded44f-1088-44cd-beb6-cd8efa0aa084" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="24.63" HigherBound="24.112">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="AnalystComments" Value="&lt;wsdl:output message=&quot;http://tempuri.org/:IOrdersService_GetCyberSourceReport_OutputMessage&quot;/&gt;&#xD;&#xA;Action=&quot;http://tempuri.org/IOrdersService/GetCyberSourceReportResponse&quot;&#xD;&#xA;" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="4fe4f8a5-39ea-41ec-ad49-781b15636863" ParentLink="Module_PortType" LowerBound="27.1" HigherBound="34.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_FaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="5ecbf7c8-e98c-4c98-8f85-d6a935a030b5" ParentLink="PortType_OperationDeclaration" LowerBound="29.1" HigherBound="33.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="59027033-6c33-45c7-b056-b9518cafb999" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="31.13" HigherBound="31.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="7d028d85-ebd3-44d5-bb94-737ea9e4981f" ParentLink="Module_PortType" LowerBound="34.1" HigherBound="41.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_4" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="64a82bc8-7b55-4a05-a28d-c16f5ee22a46" ParentLink="PortType_OperationDeclaration" LowerBound="36.1" HigherBound="40.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="fa321abb-7c6d-4248-ac57-bbdd7961b07d" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="38.13" HigherBound="38.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="07426ba2-966e-4ade-9ff9-61adfdda6ab5" ParentLink="Module_PortType" LowerBound="41.1" HigherBound="48.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ERP" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="38d185f2-822f-438d-ade4-d2b54874a699" ParentLink="PortType_OperationDeclaration" LowerBound="43.1" HigherBound="47.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="dfd4b149-f636-4c33-ac40-6c7306c69a45" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="45.13" HigherBound="45.38">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.CyberSourceResponseBackup" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="762d5051-ba3f-4cb1-ac7c-66089569fe70" ParentLink="Module_PortType" LowerBound="48.1" HigherBound="55.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_EmailBadDataResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b7c9d968-44be-46ad-a1fb-061387165b6b" ParentLink="PortType_OperationDeclaration" LowerBound="50.1" HigherBound="54.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="4a5f54ea-c7ea-4c57-a991-a2fd46a0981c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="52.13" HigherBound="52.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="92050a8f-433c-462c-82e7-b1618b407d43" ParentLink="Module_PortType" LowerBound="55.1" HigherBound="62.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Dummyx" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="0b6fb446-2096-4a7b-bce8-9c219c85f6e1" ParentLink="PortType_OperationDeclaration" LowerBound="57.1" HigherBound="61.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="6ee5097e-a7b6-486f-ab5c-7ec19a9c4814" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="59.13" HigherBound="59.34">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.ReconCybersourceDummy" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="beb96e35-3221-4c6d-8f20-4bc5cfda6bde" ParentLink="Module_PortType" LowerBound="62.1" HigherBound="69.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveRAW" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="09267464-e999-4e0a-a8d1-66cfd91aa71e" ParentLink="PortType_OperationDeclaration" LowerBound="64.1" HigherBound="68.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="081f52d6-1308-4c49-a808-27c635a41d1e" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="66.13" HigherBound="66.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="d1f8ea91-c74f-4c08-8f32-68dd2ac9258d" ParentLink="Module_PortType" LowerBound="69.1" HigherBound="76.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_3" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="67636286-4f31-4768-bf92-0659b5a71223" ParentLink="PortType_OperationDeclaration" LowerBound="71.1" HigherBound="75.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="52880037-82bf-4381-87d9-7dc5bc2e2102" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="73.13" HigherBound="73.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="da8bd329-38e9-4eb6-b5ab-5b902eb521a4" ParentLink="Module_PortType" LowerBound="76.1" HigherBound="83.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveOut" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f967215f-fdfa-450f-aa40-5c483af7e121" ParentLink="PortType_OperationDeclaration" LowerBound="78.1" HigherBound="82.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="a33ac3a1-d82b-40fb-9b91-8228b88ff997" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="80.13" HigherBound="80.62">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="095f27c1-506c-4b09-bc7f-72619b640243" ParentLink="Module_PortType" LowerBound="83.1" HigherBound="90.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Archive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c3b34d34-a7ec-4eea-9ce1-e93bead51870" ParentLink="PortType_OperationDeclaration" LowerBound="85.1" HigherBound="89.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="2c246ca6-e068-4d8d-b8a5-ff8e053b7593" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="87.13" HigherBound="87.61">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.IOrdersService_GetCyberSourceReport_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="1443d6be-f02c-426c-b79c-7c7d6befd435" ParentLink="Module_PortType" LowerBound="90.1" HigherBound="97.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="d690bd77-292d-4052-b90b-94d89eba01d0" ParentLink="PortType_OperationDeclaration" LowerBound="92.1" HigherBound="96.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="6a3a3b9b-6fdb-4c48-9fea-f48d1fac53fb" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="94.13" HigherBound="94.31">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.MultipartType_Flat" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="37e2dcc0-c1a4-4f44-8463-17d67cdc2b12" ParentLink="Module_PortType" LowerBound="97.1" HigherBound="104.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_1" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="8af07447-6819-4195-8716-5024db589496" ParentLink="PortType_OperationDeclaration" LowerBound="99.1" HigherBound="103.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0ffcf960-7abb-4dac-b1f8-a1833669a493" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="101.13" HigherBound="101.42">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ReconCybersource2.FlatFileSchemaCybersourceBody" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ReconCybersource2
{
    internal messagetype MultipartType_Flat
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_Body;
    };
    internal messagetype MultipartType_Fault
    {
        body BTS.soap_envelope_1__1.Fault MessagePart_Fault;
    };
    internal messagetype IOrdersService_GetCyberSourceReport_OutputMessage
    {
        body BTNextGen.Biztalk.ReconCybersource.IOrder_tempuri_org.GetCyberSourceReportResponse parameters;
    };
    internal messagetype IOrdersService_GetCyberSourceReport_InputMessage
    {
        body BTNextGen.Biztalk.ReconCybersource.IOrder_tempuri_org.GetCyberSourceReport parameters;
    };
    internal porttype IOrdersService
    {
        requestresponse GetCyberSourceReport
        {
            IOrdersService_GetCyberSourceReport_InputMessage, IOrdersService_GetCyberSourceReport_OutputMessage, Fault_1 = MultipartType_Fault
        };
    };
    internal porttype PortType_FaultPort
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_4
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    internal porttype PortType_ERP
    {
        oneway Operation_1
        {
            CyberSourceResponseBackup
        };
    };
    internal porttype PortType_EmailBadDataResponse
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    internal porttype PortType_Dummyx
    {
        oneway Operation_1
        {
            ReconCybersourceDummy
        };
    };
    internal porttype PortType_ArchiveRAW
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    internal porttype PortType_3
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    internal porttype PortType_ArchiveOut
    {
        oneway Operation_1
        {
            IOrdersService_GetCyberSourceReport_OutputMessage
        };
    };
    internal porttype PortType_Archive
    {
        oneway Operation_1
        {
            IOrdersService_GetCyberSourceReport_InputMessage
        };
    };
    internal porttype PortType_2
    {
        oneway Operation_1
        {
            MultipartType_Flat
        };
    };
    internal porttype PortType_1
    {
        oneway Operation_1
        {
            FlatFileSchemaCybersourceBody
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service IOrder2
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_Dummyx Port_Dummy;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses IOrdersService Port_WCF;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Archive Port_ArchiveWCF;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ERP Port_ArchiveBackup;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_2 Port_RawFile;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveRAW Port_ArchiveRAW;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses PortType_FaultPort Port_FaultPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_EmailBadDataResponse Port_EmailBadDataResponse;
        message System.Xml.XmlDocument MessageXMLDummy;
        message CyberSourceResponseBackup Message_ResponseBackup;
        message IOrdersService_GetCyberSourceReport_OutputMessage Message_Response;
        message IOrdersService_GetCyberSourceReport_InputMessage Message_Request;
        message ReconCybersourceDummy Message_Dummy;
        message MultipartType_Flat Message_Archive3_RAWFile;
        message CyberSourceResponseBackup Message_Archive2_BackupResponse;
        message IOrdersService_GetCyberSourceReport_InputMessage Message_Archive1_WCF;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage FaultMessage;
        System.Xml.XmlDocument xmlQRYRECONCYBERSOURCE;
        System.Xml.XmlDocument xmlFLATRECYBERSOURCE;
        System.Xml.XmlDocument xmlDoc;
        System.String varUser2;
        System.String varUser1;
        System.String varServer2;
        System.String varServer1;
        System.String varReportYear;
        System.String varReportMonth;
        System.String varReportDay;
        System.String varReportDate;
        System.String varPassword2;
        System.String varPassword1;
        System.Boolean varMerchant2Active;
        System.String varMerchant2;
        System.String varMerchant1;
        System.Exception varException;
        System.String varErrorMessage;
        System.String varDaysBack;
        System.DateTime varDateYesterday2;
        System.DateTime varDateYesterday;
        System.Boolean varBadDataResponse;
        System.Boolean varArchive3RAW;
        System.Boolean varArchive2BackupResponse;
        System.Boolean varArchive1WCF;
        System.String sXpath;
        System.String sHold;
        System.Text.StringBuilder msgbody;
        System.Int16 intDaysBack;
        System.Boolean varMerchant3Active;
        System.Boolean varMerchant4Active;
        System.String varServer3;
        System.String varServer4;
        System.String varUser3;
        System.String varUser4;
        System.String varPassword3;
        System.String varPassword4;
        System.String varMerchant3;
        System.String varMerchant4;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1ad5eaf9-b31a-4c29-977f-a6aa10c1789e")]
            activate receive (Port_Dummy.Operation_1, Message_Dummy);
            xmlQRYRECONCYBERSOURCE = new System.Xml.XmlDocument();
            xmlFLATRECYBERSOURCE = new System.Xml.XmlDocument();
            xmlDoc = new System.Xml.XmlDocument();
            varUser2 = "";
            varUser1 = "";
            varServer2 = "";
            varServer1 = "";
            varReportYear = "";
            varReportMonth = "";
            varReportDay = "";
            varReportDate = "";
            varPassword2 = "";
            varPassword1 = "";
            varMerchant2Active = true;
            varMerchant2 = "";
            varMerchant1 = "";
            varException = new System.Exception();
            varErrorMessage = "";
            varDaysBack = "";
            varBadDataResponse = true;
            varArchive3RAW = true;
            varArchive2BackupResponse = true;
            varArchive1WCF = true;
            sXpath = "";
            sHold = "";
            msgbody = new System.Text.StringBuilder();
            varMerchant3Active = true;
            varMerchant4Active = true;
            varServer3 = "";
            varServer4 = "";
            varUser3 = "";
            varUser4 = "";
            varPassword3 = "";
            varPassword4 = "";
            varMerchant3 = "";
            varMerchant4 = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3b63966f-149b-4268-8942-0e464a583240")]
            scope
            {
                message MultipartType_Flat Message_1;
                System.Text.StringBuilder Variable_1;
                body
                {
                    Variable_1 = new System.Text.StringBuilder();
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e7cbaf20-a0cf-473a-b3d4-0cb5e4275f05")]
                    varArchive1WCF=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Archive1WCF"));
                    varArchive2BackupResponse=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Archive2ResponseBackup"));
                    varArchive3RAW=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Archive3RAWFile"));
                    varMerchant1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant1");                                                                                                               
                    varServer1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Server1");  
                    varUser1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","User1");  
                    varPassword1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Password1");  
                    varDaysBack=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","DaysBack");  
                    
                    varMerchant2Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant2Active"));
                    varMerchant2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant2");                                                                                                               
                    varServer2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Server2");  
                    varUser2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","User2");  
                    varPassword2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Password2");  
                    
                    varMerchant3Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant3Active"));
                    varMerchant3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant3");                                                                                                               
                    varServer3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Server3");  
                    varUser3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","User3");  
                    varPassword3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Password3"); 
                    
                    varMerchant4Active=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant4Active"));
                    varMerchant4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Merchant4");                                                                                                               
                    varServer4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Server4");  
                    varUser4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","User4");  
                    varPassword4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ReconCyberSource2","Password4"); 
                    
                    intDaysBack=System.Convert.ToInt16(varDaysBack);
                    
                    
                    varDateYesterday = System.DateTime.Now.AddDays(-intDaysBack);
                    
                    varReportMonth = System.Convert.ToString(varDateYesterday.Month);
                    varReportYear = System.Convert.ToString(varDateYesterday.Year);
                    varReportDay = System.Convert.ToString(varDateYesterday.Day);
                    
                    varReportMonth = varReportMonth.PadLeft(2,'0');
                    varReportDay = varReportDay.PadLeft(2,'0');
                    
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ReconCyberSource2", "Cybersource " + varReportMonth + "/" + varReportDay + "/" + varReportYear );
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3bfda7d6-ba92-46a8-9a00-282ea83f7598")]
                    construct Message_Request
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("dc88366f-29ee-4eac-8b4e-dc6839801b73")]
                        //For Testing... 
                        //varCurrentYear = "2013"; 
                        //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                        //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                        //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                        
                        
                        //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                        
                        xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant1 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword1 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer1 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser1 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>PaymentBatchDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                        
                        
                        
                        Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4d6c4a7c-49b3-4106-a7b2-a5531df7d30b")]
                    if (varArchive1WCF == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7336adbd-8b87-401e-99ae-9dacd6101a8b")]
                        construct Message_Archive1_WCF
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c7d7483a-0fbd-4e4c-9c0c-ce3ff2398cbb")]
                            Message_Archive1_WCF = Message_Request; 
                            Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_WCFRequest"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f517328-7bed-47fd-8a97-12e0d77ef1d1")]
                        send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("edaeccc5-521f-4302-b921-439cb201f02b")]
                    construct MessageXMLDummy, Message_Response
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2dfb5b7d-2f2c-41d9-9057-84fe9295197e")]
                        MessageXMLDummy = new System.Xml.XmlDocument();
                        MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource2.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                        
                        Message_Response.parameters = MessageXMLDummy;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("45a740f3-d1de-4b3e-9fb6-00eb249f7cc8")]
                    scope
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2dab6fa2-c7bb-4cdd-a266-9a82b65de119")]
                            send (Port_WCF.GetCyberSourceReport, Message_Request);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a1bdb28-e5b6-4943-af70-d8d88ca686bd")]
                            receive (Port_WCF.GetCyberSourceReport, Message_Response);
                        }
                        exceptions
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba264281-c390-4998-a499-6551f7537794")]
                            catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2055b832-3c89-4b6a-a372-f00deddaf828")]
                                construct FaultMessage
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6f32e00a-fd0a-4200-abc2-7f61b6398adf")]
                                    // Create fault 
                                    xmlDoc = ex2.MessagePart_Fault;
                                    varErrorMessage = xmlDoc.OuterXml;
                                    // Create fault exception Message
                                    FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                    
                                    // Assign Properties
                                    FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                    FaultMessage.FaultDescription=varErrorMessage;
                                    FaultMessage.FaultCode="3004";
                                    FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5fb0870a-1b6e-4b65-bf05-504beafcda4e")]
                                send (Port_FaultPort.Operation_1, FaultMessage);
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7aceb70e-65a9-4bc5-93d1-60e3c58c1c00")]
                    construct Message_ResponseBackup
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bca60875-549e-44f0-921a-87dc5d2e8aad")]
                        transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource2.Transform2Backup (Message_Response.parameters);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f2eb14de-0678-4e41-ae66-0809f7a225c8")]
                    if (varArchive2BackupResponse == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cd8ea7c3-cac8-45ab-a9ec-ebd54cfa43c6")]
                        construct Message_Archive2_BackupResponse
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("82aead48-7baf-49ad-8541-3e3219099d51")]
                            Message_Archive2_BackupResponse = Message_ResponseBackup; 
                            Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_WCFResponseBackup"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8272bb9a-107d-435f-987b-044afba17728")]
                        send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4328e5bc-1ed9-4aef-b342-6ca9d04ab8e9")]
                    construct Message_1
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7eaf0435-0317-4d28-b69b-605056f23131")]
                        sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                        //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                        //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                        Variable_1 = new System.Text.StringBuilder();
                        Variable_1.AppendLine(sXpath); 
                        Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                        varBadDataResponse = sXpath.StartsWith("Payment Batch Detail Report");
                        //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                        
                        
                        
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6104e377-347e-454b-a53b-b493dcca362d")]
                    if (varBadDataResponse == false)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cdc28e45-dcfa-436c-83dd-5060781a3744")]
                        send (Port_EmailBadDataResponse.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c119d7e8-9636-4fb4-b5a1-3d153afbb8ba")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("576eff91-eb0a-46dc-8e41-d06831659ef4")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                            FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                            FaultMessage.FaultCode="3004";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("768e97f0-f2d8-4df6-9fde-6afef968e0a9")]
                        send (Port_FaultPort.Operation_1, FaultMessage);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7133e947-f1eb-49d6-b490-3e6957c854f2")]
                    if (varArchive3RAW == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("91a9a55c-8133-47c3-928c-345d057a83cc")]
                        construct Message_Archive3_RAWFile
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3d700402-8275-47ad-a01b-a72dcf45ef68")]
                            Message_Archive3_RAWFile = Message_1; 
                            Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_RAWOutput"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f228009c-93da-4393-928b-9b0987ec78cd")]
                        send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("14c61638-8c6f-4c61-a72e-26a298ee0bfe")]
                    send (Port_RawFile.Operation_1, Message_1);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("193f99d1-3871-428f-8501-6cd7834407a7")]
                    if (varMerchant2Active == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d97164d8-7f3f-44fb-b7c3-a9e48599d38c")]
                        construct Message_Request
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8d0d4b32-93f3-4d0c-837c-5ec6baec896a")]
                            //For Testing... 
                            //varCurrentYear = "2013"; 
                            //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                            
                            
                            //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                            
                            xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant2 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword2 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer2 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser2 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>PaymentBatchDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                            
                            
                            
                            Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("df0e78c3-ae5f-4bd7-85b3-a43e0a559a0a")]
                        if (varArchive1WCF == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8692b36d-2c4f-49b8-b60e-00c8800ab93d")]
                            construct Message_Archive1_WCF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("00c86c1f-c061-4b5f-aa32-46800a4677b8")]
                                Message_Archive1_WCF = Message_Request; 
                                Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant2 +"WCFRequest"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("26a85fcd-fa3f-47a9-88be-6a95b0eb2fc1")]
                            send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("59a16eda-b40f-496f-bc86-9f16bcb9e25a")]
                        construct MessageXMLDummy, Message_Response
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("75d9d3b7-e28c-43e5-afac-fc837927859c")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                            
                            Message_Response.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8643f84f-12b7-4f29-9546-7fe047528264")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1de1948a-e20d-4e95-9751-fc2deadd5b38")]
                                send (Port_WCF.GetCyberSourceReport, Message_Request);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("515f71ea-a769-40fc-b932-5ebda399b5a1")]
                                receive (Port_WCF.GetCyberSourceReport, Message_Response);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd133eb3-44b7-41ca-b189-b569d09b0930")]
                                catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a37ae264-9572-4a71-8691-5170f196572a")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("796cfe52-146f-4da3-ba1c-d5152698e81c")]
                                        // Create fault 
                                        xmlDoc = ex2.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        // Create fault exception Message
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3004";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("31cc4857-d01b-4b14-b905-a3a319562f17")]
                                    send (Port_FaultPort.Operation_1, FaultMessage);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("dd7cd0f8-f5f8-4daf-a635-5d4ffef78602")]
                        construct Message_ResponseBackup
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7c1ed87a-5846-419b-9eea-6eb938dd2d4a")]
                            transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource2.Transform2Backup (Message_Response.parameters);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f22aaace-246b-48ca-a49b-c295e7f0b182")]
                        if (varArchive2BackupResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("68f6ff6a-4224-4638-bf1a-743000529eb2")]
                            construct Message_Archive2_BackupResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("cdc3c879-7a1e-4243-a009-b499efb36931")]
                                Message_Archive2_BackupResponse = Message_ResponseBackup; 
                                Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant2 +"WCFResponseBackup"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3a783eda-5948-482a-9a9f-23f6a3561c15")]
                            send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4acd8cb3-1388-4df3-85dd-00f12e0554a9")]
                        construct Message_1
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("708cdc1b-b070-4383-b0ae-e2d7c85072c2")]
                            sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                            //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                            Variable_1 = new System.Text.StringBuilder();
                            Variable_1.AppendLine(sXpath); 
                            Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                            varBadDataResponse = sXpath.StartsWith("Payment Batch Detail Report");
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c967ad20-751f-454e-8f3c-68aa82e23b27")]
                        if (varBadDataResponse == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("aa70307c-c9d5-4748-8641-44f1aa3ead54")]
                            send (Port_EmailBadDataResponse.Operation_1, Message_1);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb672583-446c-4e64-ad81-abd97b9bb95b")]
                            construct FaultMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b6e28c0d-2f3a-42e3-ac6f-052ec5b98ee7")]
                                // Create fault exception Message
                                FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                
                                // Assign Properties
                                FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                                FaultMessage.FaultCode="3004";
                                FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1a3c0ea2-f473-40de-a00a-a5c8a0b35e22")]
                            send (Port_FaultPort.Operation_1, FaultMessage);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("60cb1573-effa-4839-97ba-c04a229f129b")]
                        send (Port_RawFile.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8ce7aac6-87d2-4707-b9e4-d9dd672fe1e7")]
                        if (varArchive3RAW == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("34bac35d-de71-462b-a816-662e02d801d0")]
                            construct Message_Archive3_RAWFile
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d85c3f31-cd84-4e57-983c-2082885347e1")]
                                Message_Archive3_RAWFile = Message_1; 
                                Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant2 +"RAWOutput"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b0f2fabb-0bc1-4b3d-90ab-72c7c16ae9f8")]
                            send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f8693274-88da-4873-9fdb-89bcc4f647a8")]
                    if (varMerchant2Active == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ac2a703c-17d9-4e88-90f8-03d427637acd")]
                        construct Message_Request
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9499a42d-a42a-4d70-b94f-7ae8096346e3")]
                            //For Testing... 
                            //varCurrentYear = "2013"; 
                            //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                            
                            
                            //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                            
                            xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant3 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword3 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer3 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser3 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>PaymentBatchDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                            
                            
                            
                            Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fca6489c-ee2f-4408-adb6-5f14489b4cf0")]
                        if (varArchive1WCF == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b53ae8a-62a8-4f5c-b3fe-9d3431d80229")]
                            construct Message_Archive1_WCF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("fac22b98-800e-46a7-8965-49e01d8a4433")]
                                Message_Archive1_WCF = Message_Request; 
                                Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant3 +"WCFRequest"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fdce3e61-d72a-47e6-ab7c-bcea935ae8b2")]
                            send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c1682127-d090-4a5b-95cd-8220d52cccb8")]
                        construct MessageXMLDummy, Message_Response
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a98bae6-e98a-4e24-8899-fdbe4204da1a")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                            
                            Message_Response.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c4715781-3403-4465-ba64-856acf838666")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("07517c1b-adf2-46a6-a1b2-b5456100db94")]
                                send (Port_WCF.GetCyberSourceReport, Message_Request);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("06270494-6717-4468-a997-4fc1e8e441cb")]
                                receive (Port_WCF.GetCyberSourceReport, Message_Response);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("35d49c56-abb2-4689-956f-40bd5c224bdf")]
                                catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2bb4e64d-4767-48f7-91f2-ba5008643427")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c003799e-7994-4179-91d1-9518fc4ac37a")]
                                        // Create fault 
                                        xmlDoc = ex2.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        // Create fault exception Message
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3004";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8161b68f-a251-4850-abf4-a0134bdf033d")]
                                    send (Port_FaultPort.Operation_1, FaultMessage);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a2496103-bd00-45fa-aa7b-45349d6e2e08")]
                        construct Message_ResponseBackup
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b504382-c5c0-4ab6-811b-e36777943a68")]
                            transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource2.Transform2Backup (Message_Response.parameters);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f4c483f6-1838-44f7-ad58-8158c4b7f4b7")]
                        if (varArchive2BackupResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8e91d61c-bce0-45f1-9925-d83e9df307ad")]
                            construct Message_Archive2_BackupResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("91aec4c0-eaf5-46c1-89ba-6fe47fdd8268")]
                                Message_Archive2_BackupResponse = Message_ResponseBackup; 
                                Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant3 +"WCFResponseBackup"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("25c565c0-fc5c-42f1-9e4b-a6973706126d")]
                            send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("37153ae5-9758-45ec-bfa1-de3a7b060cc9")]
                        construct Message_1
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("dee51511-f867-470a-aa0f-ba48bf68bbb8")]
                            sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                            //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                            Variable_1 = new System.Text.StringBuilder();
                            Variable_1.AppendLine(sXpath); 
                            Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                            varBadDataResponse = sXpath.StartsWith("Payment Batch Detail Report");
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9422c13a-09cd-43c3-93ee-1b4557ae55b8")]
                        if (varBadDataResponse == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b7b4594f-ece2-4ac5-bc34-dc2a2a155989")]
                            send (Port_EmailBadDataResponse.Operation_1, Message_1);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5d65c682-be87-4785-ac55-1d35aada6d19")]
                            construct FaultMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a45c0b2d-9bbc-4536-a4a7-401a10564789")]
                                // Create fault exception Message
                                FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                
                                // Assign Properties
                                FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                                FaultMessage.FaultCode="3004";
                                FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0efb755b-c556-488b-bf8f-573d9d2db2c8")]
                            send (Port_FaultPort.Operation_1, FaultMessage);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("298bb8cf-e0d7-4a92-ac5e-e99a04493a66")]
                        send (Port_RawFile.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fda94ae7-8e63-43a8-aa83-0e9d6c783974")]
                        if (varArchive3RAW == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("190a3a90-595f-489d-a6cf-3a1afcfa2db7")]
                            construct Message_Archive3_RAWFile
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("616efe62-9f09-4ebe-ab18-f6c4ddd38f2f")]
                                Message_Archive3_RAWFile = Message_1; 
                                Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant3 +"RAWOutput"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ab2a28a9-cbee-4a5c-bb37-6e5823669c04")]
                            send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("97a094c7-d879-4048-9f6d-fc08567061c0")]
                    if (varMerchant4Active == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6d6e42d7-91b8-4f09-a231-ce36d2b0c58a")]
                        construct Message_Request
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4d3d3476-d4a7-4d30-9052-7739ca0a3c86")]
                            //For Testing... 
                            //varCurrentYear = "2013"; 
                            //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                            //sHold = "<GetCyberSourceReport xmlns=\"http://tempuri.org/\"><reportRequest><CyberSourceMerchantId>idehao</CyberSourceMerchantId><CyberSourcePassword>Password345</CyberSourcePassword><CyberSourceServerName>ebctest.cybersource.com/ebctest</CyberSourceServerName><CyberSourceUserName>Selfj</CyberSourceUserName><Day>01</Day><Month>10</Month><ReportFormat>csv</ReportFormat><ReportName>PaymentBatchDetailReport</ReportName><Year>2011</Year></reportRequest></GetCyberSourceReport>";
                            
                            
                            //xmlQRYRECONCYBERSOURCE.LoadXml(@sHold); 
                            
                            xmlQRYRECONCYBERSOURCE.LoadXml("<GetCyberSourceReport xmlns=\"http://tempuri.org/\" xmlns:btn=\"http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders\" ><reportRequest><btn:CyberSourceMerchantId>" + varMerchant4 + "</btn:CyberSourceMerchantId><btn:CyberSourcePassword>" + varPassword4 + "</btn:CyberSourcePassword><btn:CyberSourceServerName>" + varServer4 + "</btn:CyberSourceServerName><btn:CyberSourceUserName>" + varUser4 + "</btn:CyberSourceUserName><btn:Day>" + varReportDay + "</btn:Day><btn:Month>" + varReportMonth + "</btn:Month><btn:ReportFormat>csv</btn:ReportFormat><btn:ReportName>PaymentBatchDetailReport</btn:ReportName><btn:Year>" + varReportYear + "</btn:Year></reportRequest></GetCyberSourceReport>");
                            
                            
                            
                            Message_Request.parameters = xmlQRYRECONCYBERSOURCE;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("458fa54e-5081-4763-81fe-86b30cec133a")]
                        if (varArchive1WCF == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0b8511c3-8c68-4a55-8a16-39438b3df3fe")]
                            construct Message_Archive1_WCF
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c990e39e-769f-41b4-89ee-3c556dfc8d4b")]
                                Message_Archive1_WCF = Message_Request; 
                                Message_Archive1_WCF(FILE.ReceivedFileName)="Archive1_" + varMerchant4 + "WCFRequest"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("55200123-06f1-4a62-989c-9f93c74d8f9c")]
                            send (Port_ArchiveWCF.Operation_1, Message_Archive1_WCF);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("41d5fc9d-679f-4de1-bfc6-9804c7816999")]
                        construct MessageXMLDummy, Message_Response
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6a293a49-125c-423b-bc2e-d7d0a69a23b2")]
                            MessageXMLDummy = new System.Xml.XmlDocument();
                            MessageXMLDummy.LoadXml(@"<GetCyberSourceReponse xmlns:ns0=""http://BTNextGen.Biztalk.ReconCybersource.GetCyberSourceResponse""><GetCyberSourceResponseResult>xxx</GetCyberSourceResponseResult></GetCyberSourceReponse>");
                            
                            Message_Response.parameters = MessageXMLDummy;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f39f3c46-6c16-490b-ac1a-f7f6712af7a9")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ff2c66a-b057-4f17-95b7-a57c50606a49")]
                                send (Port_WCF.GetCyberSourceReport, Message_Request);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0b59d225-f287-4055-9c07-3ebf85ccb0b1")]
                                receive (Port_WCF.GetCyberSourceReport, Message_Response);
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("45eac211-ceb4-44cd-b935-25ba36d78fc9")]
                                catch (Port_WCF.GetCyberSourceReport.Fault_1 ex2)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d771fc0e-30b6-4bc0-aa8c-facf0915d65a")]
                                    construct FaultMessage
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0180a52a-4924-45cc-8e07-35425c4578d2")]
                                        // Create fault 
                                        xmlDoc = ex2.MessagePart_Fault;
                                        varErrorMessage = xmlDoc.OuterXml;
                                        // Create fault exception Message
                                        FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                        
                                        // Assign Properties
                                        FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                        FaultMessage.FaultDescription=varErrorMessage;
                                        FaultMessage.FaultCode="3004";
                                        FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("09e2a6f8-1333-4b48-9142-7ea6cc96aa53")]
                                    send (Port_FaultPort.Operation_1, FaultMessage);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3979488a-5c00-4554-8bec-261cc262ef69")]
                        construct Message_ResponseBackup
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("91b52b73-92cf-4546-ac1a-bf0bd718756c")]
                            transform (Message_ResponseBackup) = BTNextGen.Biztalk.ReconCybersource2.Transform2Backup (Message_Response.parameters);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c87f3c2f-788b-4bb7-ba6a-ddf575121417")]
                        if (varArchive2BackupResponse == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ade2969a-6115-4ab4-bd8e-35da6cf42498")]
                            construct Message_Archive2_BackupResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3a4fd236-c1c6-46be-ad81-876844b25745")]
                                Message_Archive2_BackupResponse = Message_ResponseBackup; 
                                Message_Archive2_BackupResponse(FILE.ReceivedFileName)="Archive2_" + varMerchant4 + "WCFResponseBackup"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("54e86a4b-a24a-40fa-8689-08426a337e9f")]
                            send (Port_ArchiveBackup.Operation_1, Message_Archive2_BackupResponse);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1bbe7efd-7ed0-4275-ba71-7ce845b15fca")]
                        construct Message_1
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("08c4f328-1dbc-4455-955c-cc8673330dbd")]
                            sXpath = xpath(Message_ResponseBackup,"string(//CyberSourceResponseResult)");
                            //Message_FlatFile2 = xpath(Message_ResponseBackup,sXpath); 
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", sXpath));
                            Variable_1 = new System.Text.StringBuilder();
                            Variable_1.AppendLine(sXpath); 
                            Message_1.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(Variable_1.ToString());
                            varBadDataResponse = sXpath.StartsWith("Payment Batch Detail Report");
                            //System.Diagnostics.EventLog.WriteEntry("Orchestration Debug", System.String.Format("The Value = {0}", varBadDataResponse));
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cc51b73b-0bde-40cc-ac0a-4504b4edfa66")]
                        if (varBadDataResponse == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("221a4a2d-74a2-44f1-b15a-b0e4eda2d608")]
                            send (Port_EmailBadDataResponse.Operation_1, Message_1);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("918bf57c-507a-41f7-9e9c-9f09fd41f962")]
                            construct FaultMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9d2df6c4-1275-4531-8318-64f4a7f09115")]
                                // Create fault exception Message
                                FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                
                                // Assign Properties
                                FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource Exception";
                                FaultMessage.FaultDescription="Bad Data Response from Cybersource";
                                FaultMessage.FaultCode="3004";
                                FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("daf7654c-59ab-437a-8b73-130d7a9a9051")]
                            send (Port_FaultPort.Operation_1, FaultMessage);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d96b56aa-e0d5-4f14-8378-b10269c7a763")]
                        send (Port_RawFile.Operation_1, Message_1);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b28c5aa3-fd44-4a0e-940c-9e91ee83d2e1")]
                        if (varArchive3RAW == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0ec5f889-e0eb-457d-91b4-b60840c0e185")]
                            construct Message_Archive3_RAWFile
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("90610d15-7173-44d5-bbeb-88ee926554cb")]
                                Message_Archive3_RAWFile = Message_1; 
                                Message_Archive3_RAWFile(FILE.ReceivedFileName)="Archive3_" + varMerchant4 +"RAWOutput"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a53b0f1b-0185-47b0-97f2-4a4cec06ccf6")]
                            send (Port_ArchiveRAW.Operation_1, Message_Archive3_RAWFile);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("554b2f97-0f6f-40f3-a889-33d976b9e807")]
                    terminate "test";;
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("daeff7f2-a891-48a4-ab1a-6b4c55820fcb")]
                    catch (System.SystemException ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b5476ba-f10b-41f4-b573-0da298227ba4")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("298c6f9d-2ced-471f-8ddc-b449ec2c85fb")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="BTNextGen.Biztalk.ReconCybersource2 Exception";
                            FaultMessage.FaultDescription=ex.Message;
                            FaultMessage.FaultCode="3004";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("88247e6c-9405-4478-9b10-a9e2f662383c")]
                        send (Port_FaultPort.Operation_1, FaultMessage);
                    }
                }
            }
        }
    }
}

