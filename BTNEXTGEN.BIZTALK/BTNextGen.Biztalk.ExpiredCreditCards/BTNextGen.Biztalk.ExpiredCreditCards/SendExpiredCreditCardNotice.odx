#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="ed24e215-674c-4282-8e40-7735d214c479" LowerBound="1.1" HigherBound="828.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="BTNextGen.Biztalk.ExpiredCreditCards" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="6d6fcbef-10fd-47af-a263-7b0eacdb2d8a" ParentLink="Module_PortType" LowerBound="12.1" HigherBound="19.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ReceiveAllCreditCardsPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="0d2422ef-2b45-48e7-9b1e-e361866e8b4c" ParentLink="PortType_OperationDeclaration" LowerBound="14.1" HigherBound="18.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="39dc0df5-a8ab-4a09-8287-a0dbd85faed6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="16.13" HigherBound="16.64">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="fe9fa468-0afe-469d-80b9-7f57a8c26eb0" ParentLink="Module_PortType" LowerBound="19.1" HigherBound="26.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ProfilesQueryResponse" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="3987d408-85fa-44c7-927d-ec1ffdadf889" ParentLink="PortType_OperationDeclaration" LowerBound="21.1" HigherBound="25.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="2a158f6d-f4a4-4ed5-9613-71cf8e27d972" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="23.66" HigherBound="23.152">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="6240b144-e7fe-442a-b126-9c72037bbe99" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="23.13" HigherBound="23.64">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0c688796-51b5-48f6-8805-52abbbf40e61" ParentLink="Module_PortType" LowerBound="26.1" HigherBound="33.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_1" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="dc33acab-a340-4c13-be1d-69f1072ae57a" ParentLink="PortType_OperationDeclaration" LowerBound="28.1" HigherBound="32.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0ac2a762-6bfb-4054-aa0d-887f18323d26" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="30.13" HigherBound="30.42">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchembSingle" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="727d823b-e2c4-4f6c-a7d3-76991f9f1015" ParentLink="Module_PortType" LowerBound="33.1" HigherBound="40.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ReceiveDummy" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c5dc290b-817d-418b-94be-5b661f1f341e" ParentLink="PortType_OperationDeclaration" LowerBound="35.1" HigherBound="39.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="8beb14a0-d818-4ac5-acd7-203449513c60" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="37.13" HigherBound="37.64">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="9f401f8d-1d81-4c65-ab9b-8d88a8c4bdb1" ParentLink="Module_PortType" LowerBound="40.1" HigherBound="47.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveQueryResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4474e9d5-9bbb-41d5-a1eb-34efdc361a72" ParentLink="PortType_OperationDeclaration" LowerBound="42.1" HigherBound="46.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="a00b395b-5d98-4d88-83e8-4f8b2648e488" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="44.13" HigherBound="44.99">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="066bcd19-5fde-43ba-abab-57cc78d2794e" ParentLink="Module_PortType" LowerBound="47.1" HigherBound="54.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveCReditCardMessage" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="adc70f34-7df3-4f90-b3fa-e5fedc835a4d" ParentLink="PortType_OperationDeclaration" LowerBound="49.1" HigherBound="53.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="381fbbe1-5b8b-4a6c-8d1b-963af3e98431" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="51.13" HigherBound="51.36">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchema" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="3d387414-d72a-4b70-a9ed-a4610c6663f1" ParentLink="Module_PortType" LowerBound="54.1" HigherBound="61.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveProfileQuery" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c21acdbc-bd24-4b19-93bc-dd528f4f9dbc" ParentLink="PortType_OperationDeclaration" LowerBound="56.1" HigherBound="60.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="49268c1b-4e36-44b3-bdea-d4bd7fa11d05" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="58.13" HigherBound="58.64">
                    <om:Property Name="Ref" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="8efb12ea-be39-4122-9e4f-8570abc02497" ParentLink="Module_PortType" LowerBound="61.1" HigherBound="68.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SMTP_ExpiredCards" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f0643c4b-cbee-4e25-8ba0-aee11da2e46e" ParentLink="PortType_OperationDeclaration" LowerBound="63.1" HigherBound="67.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="0185406c-a692-457a-88f8-1f1a1abd9a99" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="65.13" HigherBound="65.32">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.MultipartType_Email" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="60f703e0-fd4f-42fd-9306-87f1818c9580" ParentLink="Module_PortType" LowerBound="68.1" HigherBound="75.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveProfilesUpdateRequest" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="25ca6cfa-7dc2-4f58-a484-d2729a748303" ParentLink="PortType_OperationDeclaration" LowerBound="70.1" HigherBound="74.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="35910b49-0364-455b-9ae0-40e6325c097a" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="72.13" HigherBound="72.56">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile_UpdatePartialProfile_InputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="854855b9-3bb6-4c3a-8ce0-f0aaead95fcf" ParentLink="Module_PortType" LowerBound="75.1" HigherBound="82.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveProfilesUpdateResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="da018261-02c2-4f46-a2e2-412a7557dd4b" ParentLink="PortType_OperationDeclaration" LowerBound="77.1" HigherBound="81.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="c6930a4a-4ae1-4cc8-82d9-f9da777e0caa" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="79.13" HigherBound="79.57">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile_UpdatePartialProfile_OutputMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="2c7092ef-a346-4b9b-ba68-6547894552ac" ParentLink="Module_PortType" LowerBound="82.1" HigherBound="89.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendExpiredCardQuery" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="080cb094-ef0a-4f4b-90f3-51a2277f6d58" ParentLink="PortType_OperationDeclaration" LowerBound="84.1" HigherBound="88.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="ea64e2a9-1c8c-4f36-8467-d7f789b8b39c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="86.13" HigherBound="86.49">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.IProfile_tempuri_org.GetExpiredCards" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="6479d886-b052-4693-919b-7aecf7c83a56" ParentLink="Module_PortType" LowerBound="89.1" HigherBound="96.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_2" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="65224e78-0ec4-448a-8e5e-e05ea8dd54ec" ParentLink="PortType_OperationDeclaration" LowerBound="91.1" HigherBound="95.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="78405632-3ab4-4ac1-9903-fa4b5bb626df" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="93.13" HigherBound="93.57">
                    <om:Property Name="Ref" Value="BTNextGen.Biztalk.ExpiredCreditCards.IProfile_tempuri_org.GetExpiredCardsResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="1b508899-441c-48ec-a065-0df1f96c1a22" ParentLink="Module_PortType" LowerBound="96.1" HigherBound="103.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_FaultPort" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="573a2b0c-f100-45cd-9127-8d98dbde8436" ParentLink="PortType_OperationDeclaration" LowerBound="98.1" HigherBound="102.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="e06f5759-a4a5-48a7-88db-fb96dddce676" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="100.13" HigherBound="100.82">
                    <om:Property Name="Ref" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="35612978-5964-48cb-9b2c-61570c976c56" ParentLink="Module_ServiceDeclaration" LowerBound="103.1" HigherBound="827.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendExpiredCreditCardNotice" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="VariableDeclaration" OID="510f9655-ef79-44a4-9987-a6238af05010" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="148.1" HigherBound="149.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sXpath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="37064d74-a48b-4fa3-9449-c168d883c825" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="149.1" HigherBound="150.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentDay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0b578136-727e-4a9f-ab62-a825fa40082f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="150.1" HigherBound="151.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentMonth" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4e332d60-5ade-4a8f-852f-0597041f773c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="151.1" HigherBound="152.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentYear" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7efbdd0c-c289-4245-8cce-d66f2ef43be8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="152.1" HigherBound="153.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentEOM" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b737decc-8517-4302-807a-b8c70cb8e582" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="153.1" HigherBound="154.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentDIFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="53da51d8-be98-4c60-90a3-39141c2a550f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="154.1" HigherBound="155.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCurrentDIFF" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2a868b77-6331-4d16-977a-7a53094cc9e6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="155.1" HigherBound="156.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="nRecordCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2f9a8769-bcc4-4c16-a67a-722513caba24" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="156.1" HigherBound="157.1">
                <om:Property Name="InitialValue" Value="1" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="nLoopCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fa0aa8df-e76d-4cfa-bf2d-ffeaab5dfcb6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="157.1" HigherBound="158.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCreditCardIDForeign" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="62fad01a-a3f9-4fdb-ae3d-6a38e590e55c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="158.1" HigherBound="159.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlQRYProfileUserObject" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ce0c617a-51a6-4d45-b824-ed670fd101ba" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="159.1" HigherBound="160.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sHold" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="71e79577-29a5-4917-84e7-9bdecc7b52e0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="160.1" HigherBound="161.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveExpiredRequestCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="96bd93c9-0c64-4770-b0eb-ac3796187691" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="161.1" HigherBound="162.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveExpiredResponseCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a2586d61-d3f9-40cc-b61b-6337263b028f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="162.1" HigherBound="163.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveProfilesResponseFiltered" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1aff9153-3775-4c57-8055-f696c9a92956" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="163.1" HigherBound="164.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveCreditCardSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="acc17eed-388b-493e-8642-3ad99cdd2aec" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="164.1" HigherBound="165.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBTARContact" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="bd832c3e-6155-4694-b92a-df1f523b22fe" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="165.1" HigherBound="166.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS360Name" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6fffd144-5de6-496f-ac3b-2b5cf556bbde" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="166.1" HigherBound="167.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varUserFirstName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8f777fbc-b424-45cf-8422-5cd835774e99" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="167.1" HigherBound="168.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCreditCardAlias" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="69e78773-91ec-4e11-81ee-7cb5e80e18e6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="168.1" HigherBound="169.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCreditCardLast4Digits" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f6ce27be-3f2d-44f8-a2d1-86bd113d18ab" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="169.1" HigherBound="170.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varEmailAddress" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3084c4b4-3e34-4e35-88d7-834e488c1439" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="170.1" HigherBound="171.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTesting" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="fe36a85a-c9ad-4ce3-948b-2a3edad7b874" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="171.1" HigherBound="172.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPFrom" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7b4722c8-b4c1-45d0-b27e-94f1b8bb8c5f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="172.1" HigherBound="173.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varSMTPHost" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4e2db9f3-ad9e-490a-a9ce-558c4dcadf58" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="173.1" HigherBound="174.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="cb18ae05-fafb-45f3-8798-07456211a08c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="174.1" HigherBound="175.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varTS360Logo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f4348372-e563-4d89-acf1-12d23fce769a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="175.1" HigherBound="176.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="17680e9e-ee8c-44eb-9f46-2a9540629c80" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="176.1" HigherBound="177.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBiztalkAdmin" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f5cf0a9c-4ced-4beb-9cc9-65cf88ce9c8d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="177.1" HigherBound="178.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varNotificationStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8d348874-bfad-4fdd-94fb-2692ae529fb4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="178.1" HigherBound="179.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varNotificationMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4644490e-84e1-4cfc-81fd-7650852b786b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="179.1" HigherBound="180.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.DateTime" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="intCurrentDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1a58ade7-140b-4551-b11c-45fb3d468367" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="180.1" HigherBound="181.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCurrentDateTime" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="bea72472-1f95-48df-9040-a4b566cc180e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="181.1" HigherBound="182.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCreditCardIDPrimary" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9b187df1-cb4c-43bf-8672-783473363deb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="182.1" HigherBound="183.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlUPDProfileCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7112a005-417b-4d31-9bce-716eabfe1505" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="183.1" HigherBound="184.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveProfilesUpdateRequestCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="62f8a1c6-db6b-429e-aa3b-81779e121b83" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="184.1" HigherBound="185.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveProfilesUpdateResponseCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="667f33d6-1768-42af-a1f0-28fd1083fc62" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="185.1" HigherBound="186.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCurrentYear" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="47fa8f21-58ee-4bd6-97e2-37f17ab9213d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="186.1" HigherBound="187.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlQRYProfileCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7b7e50c0-d12a-4d38-8be5-98c8eb546b75" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="187.1" HigherBound="188.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExpiredOnDays1" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6433fd67-bbde-4a14-b806-49bc355ff60d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="188.1" HigherBound="189.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExpiredOnDays2" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2b1e6573-fbb8-45c7-9823-951c86075d7e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="189.1" HigherBound="190.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExpiredOnDays3" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="153018ab-c5c9-47f9-9b77-d5329e88eecf" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="190.1" HigherBound="191.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExpiredOnDays4" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b5d3f51c-cf3f-475b-a826-ff961b841310" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="191.1" HigherBound="192.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCurrentMonth" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="71d30f9e-46ce-45a8-a35a-28b0e4b1176b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="192.1" HigherBound="193.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlQRYEXPIREDCARD" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b27df926-a412-4857-95aa-81ca8fb69fbe" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="193.1" HigherBound="194.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varErrorMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5b28dee8-1d87-4b6d-a5a9-c67d51a5b1fb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="194.1" HigherBound="195.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d8b3f5b4-b128-4a7a-963a-0703c7912c98" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="195.1" HigherBound="196.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varNoticeNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7a87b9c1-2978-48d1-a7d6-d3c025144542" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="196.1" HigherBound="197.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varBAM" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4304e00e-6e27-44e4-b2c3-395ee696440f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="197.1" HigherBound="198.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varActivityName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9d6fd4cb-523b-47b8-8e7d-fc03579e7f4b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="198.1" HigherBound="199.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varActivityID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="95c914e6-621d-4731-9ed5-38915f26e4de" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="199.1" HigherBound="200.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Guid" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varGUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f2ab1d1f-a362-4098-a881-2554e8f758b9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="200.1" HigherBound="201.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varAccountNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="42225282-49e3-4aa2-ad28-bfd06ebd8096" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="124.1" HigherBound="125.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive6ProfilesResponseUserObject" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ab2cc498-a813-4dff-b405-9549b2881eda" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="125.1" HigherBound="126.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive5ProfilesRequestUserObject" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e2bedfae-57c0-450e-8163-07a93a9b1647" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="126.1" HigherBound="127.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ProfilesQueryResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="8884c4bc-2cf3-4f0d-9baa-32d99bbdcbce" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="127.1" HigherBound="128.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ProfilesQuery" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cb995ec3-361f-4bc6-a7fd-5cd32f480646" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="128.1" HigherBound="129.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageCreditCards" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="fb31ec9c-289a-429f-9f43-f88121a42f23" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="129.1" HigherBound="130.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchembSingle" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageCreditCardxSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="b5a9ab5c-da80-4081-9333-eb00abfa75ef" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="130.1" HigherBound="131.1">
                <om:Property Name="Type" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageEmail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e8afdbb1-8491-4475-b010-eb19120ef822" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="131.1" HigherBound="132.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IProfile_tempuri_org.GetExpiredCards" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive1ExpiredRequestCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="271f6a39-2663-4dd1-9314-1e0c89248b92" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="132.1" HigherBound="133.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IProfile_tempuri_org.GetExpiredCardsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive2ExpiredResponseCreditCard" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="dd3f572a-e642-4832-929c-8f2c01e8fa0a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="133.1" HigherBound="134.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchema" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive3MessageCreditCards" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="397177a8-ad08-490c-b1f4-c5b82a899f80" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="134.1" HigherBound="135.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchembSingle" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive4MessageCreditCardsSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e6b4ed87-d906-4d15-b714-e8342fffa004" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="135.1" HigherBound="136.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.MultipartType_Email" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="emailMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="23f704a4-9238-4cab-9ca9-93a1594bc0e8" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="136.1" HigherBound="137.1">
                <om:Property Name="Type" Value="BTNextGen.BizTalk.CS.Profiles.Schemas.BTProfile" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageCreditCardsBTProfile" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="93fb2f0c-fca8-4541-8102-8d5c91606014" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="137.1" HigherBound="138.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageCreditCardsStaging" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e401703b-6d2a-4d98-924e-00e5d97f185c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="138.1" HigherBound="139.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile_UpdatePartialProfile_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageUpdateProfileWCFRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="72faa19f-8b02-4ae7-b317-7c77965ca048" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="139.1" HigherBound="140.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile_UpdatePartialProfile_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageUpdateProfilesWCFResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4108ccb5-d040-4014-86aa-61d00210d59d" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="140.1" HigherBound="141.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile_UpdatePartialProfile_InputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive7ProfilesUpdateRequestCC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="16afc9c8-2d75-4781-a28d-59d8df3bd98b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="141.1" HigherBound="142.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile_UpdatePartialProfile_OutputMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive8ProfilesUpdateResponseCC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="ecf24c47-be97-4e6e-ac11-690d77d85dab" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="142.1" HigherBound="143.1">
                <om:Property Name="Type" Value="Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="FaultMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9b40e152-98e5-4225-b4d9-e4a22b35d7b0" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="143.1" HigherBound="144.1">
                <om:Property Name="Type" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Message_WCFFaultPort" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9667bb94-91da-462e-aec2-37c79fcad546" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="144.1" HigherBound="145.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IProfile_tempuri_org.GetExpiredCards" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ExpiredCardQuery" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e0c21aa9-aee7-4534-b9f2-7e832428be1c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="145.1" HigherBound="146.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IProfile_tempuri_org.GetExpiredCardsResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ExpiredCardResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c2c69014-ab80-43e6-b528-070641d512fe" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="146.1" HigherBound="147.1">
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.ExpiredCreditCardSchemaX" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageCreditCardsX" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="25b932e2-2513-473e-9d49-0069519440ce" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="147.1" HigherBound="148.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessageXMLDummy" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="1066e407-53af-4441-ba19-9da3d638664e" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="ca55994e-c530-49ae-a4c8-9495a1f7d283" ParentLink="ServiceBody_Statement" LowerBound="203.1" HigherBound="251.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="ReceiveDummy" />
                    <om:Property Name="MessageName" Value="ProfilesQuery" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="ReceiveShapeAllCreditCards" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="b65e8140-654a-404d-a516-6f3b98a96b4d" ParentLink="ServiceBody_Statement" LowerBound="251.1" HigherBound="825.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableAssignment" OID="40e4abca-1389-4d78-80b8-fcc982f40b99" ParentLink="ComplexStatement_Statement" LowerBound="256.1" HigherBound="296.1">
                        <om:Property Name="Expression" Value="varArchiveExpiredRequestCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ArchiveExpiredRequestCreditCard&quot;));&#xD;&#xA;varArchiveExpiredResponseCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ArchiveExpiredResponseCreditCard&quot;)); &#xD;&#xA;varArchiveProfilesResponseFiltered=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ArchiveProfilesResponseFiltered&quot;)); &#xD;&#xA;varArchiveCreditCardSingle=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ArchiveCreditCardSingle&quot;)); &#xD;&#xA;varArchiveProfilesUpdateRequestCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ArchiveProfilesUpdateRequestCreditCard&quot;));&#xD;&#xA;varArchiveProfilesUpdateResponseCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ArchiveProfilesUpdateResponseCreditCard&quot;));&#xD;&#xA;varTS360Name=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;TS360Name&quot;); &#xD;&#xA;varTesting=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;Testing&quot;));&#xD;&#xA;varBAM=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;BAM&quot;));&#xD;&#xA;varSMTPFrom=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;SMTPFrom&quot;);                                                                                                                                                                                                                              &#xD;&#xA;//varSMTPUsername=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;SMTPUsername&quot;);                                                                                                               &#xD;&#xA;//varSMTPPassword=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;SMTPPassword&quot;);                                                                                                               &#xD;&#xA;varSMTPHost=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;SMTPHost&quot;);                                                                                                               &#xD;&#xA;varBTARContact=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;BTARContact&quot;);                                                                                                               &#xD;&#xA;varTS360Logo=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;TS360Logo&quot;);                                                                                                                &#xD;&#xA;varBiztalkAdmin=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;BiztalkAdmin&quot;); &#xD;&#xA;varExpiredOnDays1=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ExpiredOnDays1&quot;);&#xD;&#xA;varExpiredOnDays2=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ExpiredOnDays2&quot;);&#xD;&#xA;varExpiredOnDays3=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ExpiredOnDays3&quot;);&#xD;&#xA;varExpiredOnDays4=SSO.Utility.SSOClientHelper.Read(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,&quot;ExpiredOnDays4&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;intCurrentDay = System.DateTime.Today.Day;&#xD;&#xA;intCurrentMonth = System.DateTime.Today.Month; &#xD;&#xA;intCurrentYear = System.DateTime.Today.Year; &#xD;&#xA;intCurrentEOM = System.DateTime.DaysInMonth(intCurrentYear,intCurrentMonth);&#xD;&#xA;intCurrentDIFF = (intCurrentEOM - intCurrentDay); &#xD;&#xA;intCurrentDateTime  = System.DateTime.Now; &#xD;&#xA;varCurrentDIFF = System.Convert.ToString(intCurrentDIFF);&#xD;&#xA;varNotificationMessage = &quot;Credit Card is about to expire in &quot; + varCurrentDIFF + &quot; days.&quot;; &#xD;&#xA;varCurrentDateTime = System.Convert.ToString(intCurrentDateTime); &#xD;&#xA;varCurrentYear = System.Convert.ToString(intCurrentYear); &#xD;&#xA;varCurrentMonth = System.Convert.ToString(intCurrentMonth); &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;,varCurrentDIFF );&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getSSO and Dates" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Decision" OID="c29db252-c5c8-4177-9476-2990f6b27e7f" ParentLink="ComplexStatement_Statement" LowerBound="296.1" HigherBound="323.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_CheckVariance" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="369a8364-b6d6-4115-9793-47e52f22863d" ParentLink="ReallyComplexStatement_Branch" LowerBound="297.21" HigherBound="316.1">
                            <om:Property Name="Expression" Value="(varCurrentDIFF == varExpiredOnDays1) | (varCurrentDIFF == varExpiredOnDays2) | (varCurrentDIFF == varExpiredOnDays3) |  (varCurrentDIFF == varExpiredOnDays4) " />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Rule_CheckVariance" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="911a68d8-8f43-486e-857f-42bb4c5feaa9" ParentLink="ComplexStatement_Statement" LowerBound="299.1" HigherBound="315.1">
                                <om:Property Name="Expression" Value="varNoticeNumber = &quot;0&quot;;&#xD;&#xA;if (varCurrentDIFF == varExpiredOnDays1) &#xD;&#xA;{&#xD;&#xA;varNoticeNumber = &quot;1&quot;; &#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (varCurrentDIFF == varExpiredOnDays2)&#xD;&#xA;{&#xD;&#xA;varNoticeNumber = &quot;2&quot;; &#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (varCurrentDIFF == varExpiredOnDays3)&#xD;&#xA;{&#xD;&#xA;varNoticeNumber = &quot;3&quot;;&#xD;&#xA;}" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Expression_1" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="5848a390-3bc9-4bdb-aa45-208d89a73bc3" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="VariableAssignment" OID="02f2ca48-bcd7-41dd-a023-72e304cbe354" ParentLink="ComplexStatement_Statement" LowerBound="318.1" HigherBound="320.1">
                                <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;BTNextGen.Biztalk.ExpiredCreditCards&quot;, &quot;OK - not date to check for expired cards&quot; );" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Expression_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="63d98912-cd10-4c44-834e-5a8c0e3c05c7" ParentLink="ComplexStatement_Statement" LowerBound="320.1" HigherBound="322.1">
                                <om:Property Name="ErrorMessage" Value="&quot;Process OK - not date to check for expired cards&quot;;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate_Process" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="4b479251-53f4-44d1-90e4-349faaa696a0" ParentLink="ComplexStatement_Statement" LowerBound="323.1" HigherBound="335.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_ExpiredQuery" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="c6a7d3d9-88b9-4aa1-8dba-a59be8084120" ParentLink="Construct_MessageRef" LowerBound="324.31" HigherBound="324.47">
                            <om:Property Name="Ref" Value="ExpiredCardQuery" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="f657c2a7-4db9-4521-957f-18303e0074d6" ParentLink="ComplexStatement_Statement" LowerBound="326.1" HigherBound="334.1">
                            <om:Property Name="Expression" Value="//For Testing... &#xD;&#xA;//varCurrentYear = &quot;2013&quot;; &#xD;&#xA;//sHold = &quot;&lt;CommerceServerProfilesQuery ProfileType=\&quot;CreditCard\&quot;&gt;&lt;CLAUSE OPER=\&quot;equal\&quot; xmlns=\&quot;http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\&quot;&gt;&lt;PROPERTY ID=\&quot;expiration_year\&quot; MULTIVAL=\&quot;False\&quot; TYPE=\&quot;Number\&quot;/&gt;&lt;IMMED-VAL TYPE=\&quot;String\&quot;&gt;&lt;VALUE&gt;&quot; + varCurrentYear + &quot;&lt;/VALUE&gt;&lt;/IMMED-VAL&gt;&lt;/CLAUSE&gt;&lt;/CommerceServerProfilesQuery&gt;&quot;; &#xD;&#xA;sHold = &quot;&lt;GetExpiredCards xmlns=\&quot;http://tempuri.org/\&quot;&gt;&lt;currentYear&gt;&quot; + varCurrentYear + &quot;&lt;/currentYear&gt;&lt;month&gt;&quot; + varCurrentMonth + &quot;&lt;/month&gt;&lt;isPrimaryCard&gt;true&lt;/isPrimaryCard&gt;&lt;/GetExpiredCards&gt;&quot;;&#xD;&#xA;xmlQRYEXPIREDCARD.LoadXml(@sHold); &#xD;&#xA;&#xD;&#xA;ExpiredCardQuery = xmlQRYEXPIREDCARD;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="acb6e524-dc2b-4417-a854-ab008bf03bbe" ParentLink="ComplexStatement_Statement" LowerBound="335.1" HigherBound="348.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveExpiredQuery" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="8acae91f-9348-4ba8-87f0-b25154a2814c" ParentLink="ReallyComplexStatement_Branch" LowerBound="336.21" HigherBound="348.1">
                            <om:Property Name="Expression" Value="varArchiveExpiredRequestCreditCard == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveProfilesQuery" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="bd7f8419-4eb0-434d-bc2a-1596ec911d18" ParentLink="ComplexStatement_Statement" LowerBound="338.1" HigherBound="345.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="adbc9d64-2aca-4ed6-8dae-219b24dbb619" ParentLink="Construct_MessageRef" LowerBound="339.35" HigherBound="339.67">
                                    <om:Property Name="Ref" Value="Archive1ExpiredRequestCreditCard" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="4e58f662-1dd6-4a44-937f-3d804b6b20b5" ParentLink="ComplexStatement_Statement" LowerBound="341.1" HigherBound="344.1">
                                    <om:Property Name="Expression" Value="Archive1ExpiredRequestCreditCard = ExpiredCardQuery; &#xD;&#xA;Archive1ExpiredRequestCreditCard(FILE.ReceivedFileName)=&quot;Archive1ExpiredRequestCreditCard&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="b37e83db-113e-4189-b933-f84dd3f139fd" ParentLink="ComplexStatement_Statement" LowerBound="345.1" HigherBound="347.1">
                                <om:Property Name="PortName" Value="Port_SendArchivedQuery" />
                                <om:Property Name="MessageName" Value="Archive1ExpiredRequestCreditCard" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Archive" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="22d5e542-a7bc-4e33-8b0d-9329c9f1d16b" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="bff70dad-8e89-4f68-928b-561db6b78920" ParentLink="ComplexStatement_Statement" LowerBound="348.1" HigherBound="357.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructDummy_MessageReplyCommerceBackup" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="18ac4b9b-b25c-43d8-b395-45d90f6b8cb1" ParentLink="Construct_MessageRef" LowerBound="349.31" HigherBound="349.46">
                            <om:Property Name="Ref" Value="MessageXMLDummy" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="4c67f473-3842-4a17-a988-563b3dfeff3a" ParentLink="Construct_MessageRef" LowerBound="349.48" HigherBound="349.67">
                            <om:Property Name="Ref" Value="ExpiredCardResponse" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="eca527f5-34d6-4872-a9d3-152dadecc653" ParentLink="ComplexStatement_Statement" LowerBound="351.1" HigherBound="356.1">
                            <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;Dummy xmlns=&quot;&quot;http://tempuri.org/&quot;&quot;&gt;&lt;CreateLegacyBasketsResult xmlns:a=&quot;&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders&quot;&quot; xmlns:i=&quot;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&quot;&gt;&lt;a:BasketDetailsResponse&gt;&lt;a:ErrorMessage&gt; &lt;/a:ErrorMessage&gt;&lt;a:LegacyBasketId&gt;13759439&lt;/a:LegacyBasketId&gt;&lt;a:LegacySourceSystem&gt;TS3&lt;/a:LegacySourceSystem&gt;&lt;a:LoadStatus&gt;Loaded&lt;/a:LoadStatus&gt;&lt;/a:BasketDetailsResponse&gt;&lt;/CreateLegacyBasketsResult&gt;&lt;/Dummy&gt;&quot;);&#xD;&#xA;&#xD;&#xA;ExpiredCardResponse = MessageXMLDummy;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="5cbe080d-aeba-4a70-a524-99b286d40956" ParentLink="ComplexStatement_Statement" LowerBound="357.1" HigherBound="392.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_GetExpiredCards" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Send" OID="380a12cf-4435-401a-a9a8-cab38ea863bd" ParentLink="ComplexStatement_Statement" LowerBound="362.1" HigherBound="364.1">
                            <om:Property Name="PortName" Value="Port_UpdateProfiles" />
                            <om:Property Name="MessageName" Value="ExpiredCardQuery" />
                            <om:Property Name="OperationName" Value="GetExpiredCards" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_ExpiredQuery" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="66fa16d8-5f5e-4a1b-bcd8-be8cca6ba7cf" ParentLink="ComplexStatement_Statement" LowerBound="364.1" HigherBound="366.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="Port_UpdateProfiles" />
                            <om:Property Name="MessageName" Value="ExpiredCardResponse" />
                            <om:Property Name="OperationName" Value="GetExpiredCards" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_ExpiredResponse" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Catch" OID="cb28fbc0-ef40-4793-96ff-dd468f7ad903" ParentLink="Scope_Catch" LowerBound="369.1" HigherBound="390.1">
                            <om:Property Name="ExceptionName" Value="GetExpiredCardsFault" />
                            <om:Property Name="ExceptionType" Value="Port_UpdateProfiles.GetExpiredCards.Fault_1" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CatchException_GetExpiredCards" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="4f084087-7e91-4908-8614-a0fc278fc781" ParentLink="Catch_Statement" LowerBound="372.1" HigherBound="387.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="f748957d-909c-4fd1-83ff-a5b83948f367" ParentLink="Construct_MessageRef" LowerBound="373.43" HigherBound="373.55">
                                    <om:Property Name="Ref" Value="FaultMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="5792459f-97d7-4f8b-a29c-c5763f87008a" ParentLink="ComplexStatement_Statement" LowerBound="375.1" HigherBound="386.1">
                                    <om:Property Name="Expression" Value="xmlDoc = GetExpiredCardsFault.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ExpiredCreditCard Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3003&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_5" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="01666826-b3c3-458b-9b08-b8e32023b84d" ParentLink="Catch_Statement" LowerBound="387.1" HigherBound="389.1">
                                <om:Property Name="PortName" Value="Port_FaultPort" />
                                <om:Property Name="MessageName" Value="FaultMessage" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Fault" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="151b4de0-5e0f-4619-a3bc-a2c4644afd0d" ParentLink="ComplexStatement_Statement" LowerBound="392.1" HigherBound="405.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Decide_ArchiveProfilesResponse" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="b04123ec-e990-48c7-b607-946a8118fe6e" ParentLink="ReallyComplexStatement_Branch" LowerBound="393.21" HigherBound="405.1">
                            <om:Property Name="Expression" Value="varArchiveExpiredResponseCreditCard == true" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ArchiveProfilesResponse" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Construct" OID="4f4c849b-98a7-4e85-9d3a-9d5585e37a7a" ParentLink="ComplexStatement_Statement" LowerBound="395.1" HigherBound="402.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="79e26a90-50e1-4fa0-b5bb-d7bde2ee35f4" ParentLink="Construct_MessageRef" LowerBound="396.35" HigherBound="396.68">
                                    <om:Property Name="Ref" Value="Archive2ExpiredResponseCreditCard" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="73a76f50-6d6d-4c28-ab0a-e6b22a551249" ParentLink="ComplexStatement_Statement" LowerBound="398.1" HigherBound="401.1">
                                    <om:Property Name="Expression" Value="Archive2ExpiredResponseCreditCard = ExpiredCardResponse; &#xD;&#xA;Archive2ExpiredResponseCreditCard(FILE.ReceivedFileName)=&quot;Archive2ExpiredResponseCreditCard&quot;; " />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="833799b4-ca7c-4f52-9735-2763a193b59e" ParentLink="ComplexStatement_Statement" LowerBound="402.1" HigherBound="404.1">
                                <om:Property Name="PortName" Value="Port_ReceiveArchive" />
                                <om:Property Name="MessageName" Value="Archive2ExpiredResponseCreditCard" />
                                <om:Property Name="OperationName" Value="Operation_1" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Archive" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="25ab5e82-2098-424d-aae8-ae441e095783" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Construct" OID="ef3a5724-c027-4bd1-a858-a2cdfcdba28f" ParentLink="ComplexStatement_Statement" LowerBound="405.1" HigherBound="411.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructMessage_1" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="f5496532-f523-49ad-97c7-3a4e2d3706c5" ParentLink="Construct_MessageRef" LowerBound="406.31" HigherBound="406.50">
                            <om:Property Name="Ref" Value="MessageCreditCardsX" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Transform" OID="199ed070-6b4f-4951-950b-524c86c8a327" ParentLink="ComplexStatement_Statement" LowerBound="408.1" HigherBound="410.1">
                            <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ExpiredCreditCards.Transform_Adjust" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Transform_1" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessagePartRef" OID="22a37ca1-5e40-46ab-b3b7-be6fbe35d840" ParentLink="Transform_InputMessagePartRef" LowerBound="409.114" HigherBound="409.133">
                                <om:Property Name="MessageRef" Value="ExpiredCardResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessagePartRef" OID="f6fe80b5-c85f-41b4-986b-ab57c65bf544" ParentLink="Transform_OutputMessagePartRef" LowerBound="409.36" HigherBound="409.55">
                                <om:Property Name="MessageRef" Value="MessageCreditCardsX" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="f16b689b-f8c3-48bc-8774-b14992cbab87" ParentLink="ComplexStatement_Statement" LowerBound="411.1" HigherBound="413.1">
                        <om:Property Name="Expression" Value="nRecordCount = System.Convert.ToInt32(xpath(MessageCreditCardsX, &quot;count(//CreditCardData)&quot;));&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="getRecordCount" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="While" OID="23c731fc-ea85-4da0-94c0-b41aba99f760" ParentLink="ComplexStatement_Statement" LowerBound="413.1" HigherBound="789.1">
                        <om:Property Name="Expression" Value="nLoopCount &lt;= nRecordCount" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Loop_1" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="97cb3a2a-3812-4ed6-a8ef-dcf3ea0deccb" ParentLink="ComplexStatement_Statement" LowerBound="416.1" HigherBound="428.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructSingleMessage" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="99274c06-275f-4bca-9096-d840ef805fde" ParentLink="Construct_MessageRef" LowerBound="417.35" HigherBound="417.59">
                                <om:Property Name="Ref" Value="MessageCreditCardxSingle" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="053d0ed9-2b27-4941-964b-aad35eabce76" ParentLink="ComplexStatement_Statement" LowerBound="419.1" HigherBound="427.1">
                                <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;sXpath = System.String.Format(&quot;//CreditCardData[{0}]&quot;,nLoopCount);&#xD;&#xA;MessageCreditCardxSingle = xpath(MessageCreditCardsX,sXpath); &#xD;&#xA;                          &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_2" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="a9254970-1236-4881-9aa3-589ef38d7c8c" ParentLink="ComplexStatement_Statement" LowerBound="428.1" HigherBound="440.1">
                            <om:Property Name="Expression" Value="//CreditCardIDFlag = false; &#xD;&#xA;varCreditCardIDForeign = xpath(MessageCreditCardxSingle,&quot;string(//cardcontactuser)&quot;);&#xD;&#xA;varCreditCardIDPrimary = xpath(MessageCreditCardxSingle, &quot;string(//id)&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//if (CreditCardID.Length &gt; 0) &#xD;&#xA;//{&#xD;&#xA;//CreditCardIDFlag = true;&#xD;&#xA;//}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ExtractCCID" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="805ae88c-2e27-4c1e-b21d-48ef2b69ca0c" ParentLink="ComplexStatement_Statement" LowerBound="440.1" HigherBound="453.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ArchiveMessageCreditCardsSingle" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="b229bc4c-498e-4656-a004-45a9f61cf080" ParentLink="ReallyComplexStatement_Branch" LowerBound="441.25" HigherBound="453.1">
                                <om:Property Name="Expression" Value="varArchiveCreditCardSingle == true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ArchiveProfilesSingleCCRecord" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="0082bee8-f4e9-49d4-a704-a2f39aa1043c" ParentLink="ComplexStatement_Statement" LowerBound="443.1" HigherBound="450.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="77a98000-7902-46ee-a931-d5d2c5c34244" ParentLink="ComplexStatement_Statement" LowerBound="446.1" HigherBound="449.1">
                                        <om:Property Name="Expression" Value="Archive4MessageCreditCardsSingle = MessageCreditCardxSingle; &#xD;&#xA;Archive4MessageCreditCardsSingle(FILE.ReceivedFileName)=&quot;Archive3MessageCreditCardsSingle&quot;; " />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_1" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="bf9e465f-4bef-4681-ad07-b948685dc542" ParentLink="Construct_MessageRef" LowerBound="444.39" HigherBound="444.71">
                                        <om:Property Name="Ref" Value="Archive4MessageCreditCardsSingle" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="e278cc79-8452-4d1d-8b93-5242cb382372" ParentLink="ComplexStatement_Statement" LowerBound="450.1" HigherBound="452.1">
                                    <om:Property Name="PortName" Value="Port_ArchiveSingleMessage" />
                                    <om:Property Name="MessageName" Value="Archive4MessageCreditCardsSingle" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="f319f99c-7a9b-4ee2-b20e-c77b2ead23b0" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="2a9c9d0f-e66a-491c-89a2-aa84335f5d07" ParentLink="ComplexStatement_Statement" LowerBound="453.1" HigherBound="462.1">
                            <om:Property Name="Expression" Value="varUserFirstName = xpath(MessageCreditCardxSingle,&quot;string(//firstname)&quot;);&#xD;&#xA;&#xD;&#xA;varCreditCardAlias = xpath(MessageCreditCardxSingle,&quot;string(//alias)&quot;);&#xD;&#xA;varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,&quot;string(//last4digits)&quot;);&#xD;&#xA;varEmailAddress = xpath(MessageCreditCardxSingle,&quot;string(//emailaddress)&quot;);&#xD;&#xA;varAccountNumber = xpath(MessageCreditCardxSingle,&quot;string(//erpaccountid)&quot;);&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="gatherEmailVariables" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="d0f7e491-7668-4e46-9b7f-2f1da840a5ba" ParentLink="ComplexStatement_Statement" LowerBound="462.1" HigherBound="488.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="BAM" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="189d4d06-4fff-490f-b86f-0bd2022608c8" ParentLink="ReallyComplexStatement_Branch" LowerBound="463.25" HigherBound="488.1">
                                <om:Property Name="Expression" Value="varBAM" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="YES" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="e206e8a4-c8ad-4207-b001-68df74fc86fd" ParentLink="ComplexStatement_Statement" LowerBound="465.1" HigherBound="487.1">
                                    <om:Property Name="Expression" Value="// set bam variables&#xD;&#xA;varActivityName= &quot;ExpiredCreditCards&quot;;&#xD;&#xA;varGUID = System.Guid.NewGuid();&#xD;&#xA;varActivityID= varGUID.ToString()+ &quot;_&quot;+ System.DateTime.Now.ToString();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.BeginActivity(varActivityName, varActivityID);&#xD;&#xA;Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(varActivityName,varActivityID,&#xD;&#xA;&quot;Alias&quot;,varCreditCardAlias,&#xD;&#xA;&quot;DateCreated&quot;,System.DateTime.Now.ToString(),&#xD;&#xA;&quot;EmailAddress&quot;, varEmailAddress,&#xD;&#xA;&quot;ExpirationMonth&quot;, varCurrentMonth,&#xD;&#xA;&quot;ExpirationYear&quot;,  varCurrentYear,&#xD;&#xA;&quot;ID_CreditCards&quot;, varCreditCardIDPrimary,&#xD;&#xA;&quot;ID_UserObjects&quot;,varCreditCardIDForeign,&#xD;&#xA;&quot;Last4Digits&quot;,varCreditCardLast4Digits);&#xD;&#xA;Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.EndActivity(varActivityName, varActivityID);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Bam Tracking" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="3787c75b-6b97-4f77-aaf4-8e22878cd798" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="525a205a-49d9-4841-bbb0-4d3d5a5d09a7" ParentLink="ComplexStatement_Statement" LowerBound="488.1" HigherBound="786.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CheckCCID" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="6d4463bc-4c6c-4197-865d-4fd8eac64a88" ParentLink="ReallyComplexStatement_Branch" LowerBound="489.25" HigherBound="748.1">
                                <om:Property Name="Expression" Value="varCreditCardIDForeign.Length &gt; 0  " />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CheckCCIDLength" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Decision" OID="a3531d8d-14a4-44d2-892c-8cc8cc9886b7" ParentLink="ComplexStatement_Statement" LowerBound="491.1" HigherBound="747.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CheckEmailAddress" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="8b6f4590-2bf8-4930-9561-92db42fe1736" ParentLink="ReallyComplexStatement_Branch" LowerBound="492.29" HigherBound="709.1">
                                        <om:Property Name="Expression" Value="varEmailAddress.Length &gt; 0 " />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="CheckEmailLength" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Decision" OID="b4463b6a-0d3a-4543-a0f6-ccf87d7f76fd" ParentLink="ComplexStatement_Statement" LowerBound="494.1" HigherBound="708.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="CheckAccountNumber" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="DecisionBranch" OID="3ab98784-92d2-48d9-8693-43796bae6520" ParentLink="ReallyComplexStatement_Branch" LowerBound="495.33" HigherBound="670.1">
                                                <om:Property Name="Expression" Value="varAccountNumber.Length &gt; 0  " />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="CheckAccountExists" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="Construct" OID="aaa306cf-faa0-463e-9dc3-e8863f49eb6b" ParentLink="ComplexStatement_Statement" LowerBound="497.1" HigherBound="539.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="ConstructMessageEmailCust" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageRef" OID="8fa16b23-6e13-4df3-adfa-d6fb5f6c9fbd" ParentLink="Construct_MessageRef" LowerBound="498.47" HigherBound="498.55">
                                                        <om:Property Name="Ref" Value="emailMsg" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessageAssignment" OID="91c8487c-e1f7-46a8-89a6-0a72ed16dc8e" ParentLink="ComplexStatement_Statement" LowerBound="500.1" HigherBound="538.1">
                                                        <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;img src=&quot; +  varTS360Logo +   &quot;&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Dear &quot; + varUserFirstName + &quot;,&quot; +   &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Your primary credit card &quot; + varCreditCardAlias + &quot; ending in &quot; + varCreditCardLast4Digits + &quot; is about to expire in &quot; + varCurrentDIFF + &quot; days.  If your&lt;br /&gt;organization intends to place orders with this card in the near future, please login to &quot; + varTS360Name + &quot; and &lt;br /&gt;update your credit card expiration date to avoid any delays with future orders through &quot; + varTS360Name + &quot;.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;We appreciate your business.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Thanks&lt;br /&gt;Billing Team&lt;br /&gt;&quot; + varTS360Name + &quot;&lt;br /&gt;&quot; + varBTARContact + &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//xmlDoc=TmpMsg;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;//emailMsg.attachment=xmlDoc;&#xD;&#xA;//emailMsg.attachment(MIME.FileName)= faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.Application)+&quot;_&quot; +faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.FaultCode)+&quot;.xml&quot;; &#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varTS360Name + &quot; Payment Notification&quot;; &#xD;&#xA;&#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Send" OID="3766d4f8-86ee-4a97-9cbf-f22f788398eb" ParentLink="ComplexStatement_Statement" LowerBound="539.1" HigherBound="541.1">
                                                    <om:Property Name="PortName" Value="Port_SMTP_ExpiredCards" />
                                                    <om:Property Name="MessageName" Value="emailMsg" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Send_ExpiredCreditCardAlert" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="Construct" OID="0f7efdad-7b65-40c0-a2f7-484b63603253" ParentLink="ComplexStatement_Statement" LowerBound="541.1" HigherBound="583.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="ConstructMessageEmailAR" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageRef" OID="15dc0ff4-d147-494a-b098-2061f1ead058" ParentLink="Construct_MessageRef" LowerBound="542.47" HigherBound="542.55">
                                                        <om:Property Name="Ref" Value="emailMsg" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessageAssignment" OID="6df7990a-19d2-4e7d-89bf-94566a052167" ParentLink="ComplexStatement_Statement" LowerBound="544.1" HigherBound="582.1">
                                                        <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;img src=&quot; +  varTS360Logo +   &quot;&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Dear &quot; + &quot;B&amp;T AR Team&quot; + &quot;,&quot; +   &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;This primary credit card &quot; + varCreditCardAlias + &quot; ending in &quot; + varCreditCardLast4Digits + &quot; is about to expire in &quot; + varCurrentDIFF + &quot; days. &lt;br /&gt;&lt;br /&gt; The account number(s) associated with this credit card are:&lt;br /&gt;&lt;br /&gt; &quot; + varAccountNumber + &quot;&lt;br /&gt;&lt;br /&gt;The organization has been notified via a separate email to update their credit card expiration date&lt;br /&gt; to avoid any delays with future orders through &quot; + varTS360Name + &quot;. &lt;br /&gt;&lt;br /&gt;The customer email notified is: &quot; + varEmailAddress + &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Thanks&lt;br /&gt;Biztalk IT Team&lt;br /&gt;&quot; + varTS360Name + &quot;&lt;br /&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//xmlDoc=TmpMsg;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;//emailMsg.attachment=xmlDoc;&#xD;&#xA;//emailMsg.attachment(MIME.FileName)= faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.Application)+&quot;_&quot; +faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.FaultCode)+&quot;.xml&quot;; &#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varTS360Name + &quot; Payment Notification AR&quot;; &#xD;&#xA;//emailMsg(SMTP.CC)=varSMTPCC;&#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varBTARContact;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Send" OID="0920915a-c457-46af-a5e0-b2c044b393b1" ParentLink="ComplexStatement_Statement" LowerBound="583.1" HigherBound="585.1">
                                                    <om:Property Name="PortName" Value="Port_SMTP_ExpiredCards" />
                                                    <om:Property Name="MessageName" Value="emailMsg" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Send_ExpiredCreditCardAlert" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="Construct" OID="f69be0ff-601c-4b59-826d-3f0cf3c678e7" ParentLink="ComplexStatement_Statement" LowerBound="585.1" HigherBound="599.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Construct_UpdateProfile" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageRef" OID="4a0db694-019f-4cdd-bb37-1a5d27d2b75c" ParentLink="Construct_MessageRef" LowerBound="586.47" HigherBound="586.74">
                                                        <om:Property Name="Ref" Value="MessageCreditCardsBTProfile" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessageAssignment" OID="ec1d25f1-4497-41f4-8b2c-6ac829779bce" ParentLink="ComplexStatement_Statement" LowerBound="588.1" HigherBound="598.1">
                                                        <om:Property Name="Expression" Value="xmlUPDProfileCreditCard.LoadXml(&quot;&lt;ProfileDocument&gt;&lt;CreditCard&gt;&lt;BTNextGen&gt;&lt;notification_status&gt;&lt;/notification_status&gt;&lt;date_last_preemptive_notification&gt;&lt;/date_last_preemptive_notification&gt;&lt;/BTNextGen&gt;&lt;GeneralInfo&gt;&lt;id&gt;&lt;/id&gt;&lt;/GeneralInfo&gt;&lt;/CreditCard&gt;&lt;/ProfileDocument&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;MessageCreditCardsBTProfile=xmlUPDProfileCreditCard;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;xpath(MessageCreditCardsBTProfile,&quot;/*[local-name()='ProfileDocument' and namespace-uri()='']/*[local-name()='CreditCard' and namespace-uri()='']/*[local-name()='GeneralInfo' and namespace-uri()='']/*[local-name()='id' and namespace-uri()='']&quot;)= varCreditCardIDPrimary;  &#xD;&#xA;xpath(MessageCreditCardsBTProfile,&quot;/*[local-name()='ProfileDocument' and namespace-uri()='']/*[local-name()='CreditCard' and namespace-uri()='']/*[local-name()='BTNextGen' and namespace-uri()='']/*[local-name()='date_last_preemptive_notification' and namespace-uri()='']&quot;)= varCurrentDateTime;&#xD;&#xA;xpath(MessageCreditCardsBTProfile,&quot;/*[local-name()='ProfileDocument' and namespace-uri()='']/*[local-name()='CreditCard' and namespace-uri()='']/*[local-name()='BTNextGen' and namespace-uri()='']/*[local-name()='notification_status' and namespace-uri()='']&quot;)= varNoticeNumber;" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="Load Profile XML" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Construct" OID="1c37958f-bfdb-4527-ac82-fdf6d2a1295f" ParentLink="ComplexStatement_Statement" LowerBound="599.1" HigherBound="608.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Construct_WcfRequest" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageRef" OID="4a30d820-cfb8-4a91-9eb3-63538610ace5" ParentLink="Construct_MessageRef" LowerBound="600.47" HigherBound="600.77">
                                                        <om:Property Name="Ref" Value="MessageUpdateProfileWCFRequest" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="Transform" OID="cce725aa-05d6-42fc-b13e-5bafdce184ca" ParentLink="ComplexStatement_Statement" LowerBound="602.1" HigherBound="604.1">
                                                        <om:Property Name="ClassName" Value="BTNextGen.Biztalk.ExpiredCreditCards.TransformXML_2_UpdateProfiles" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Transform_4" />
                                                        <om:Property Name="Signal" Value="False" />
                                                        <om:Element Type="MessagePartRef" OID="918e4d49-e17b-4e9c-9598-b1b41ab90d50" ParentLink="Transform_InputMessagePartRef" LowerBound="603.165" HigherBound="603.192">
                                                            <om:Property Name="MessageRef" Value="MessageCreditCardsBTProfile" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="MessagePartReference_3" />
                                                            <om:Property Name="Signal" Value="False" />
                                                        </om:Element>
                                                        <om:Element Type="MessagePartRef" OID="5b0df8e8-3551-470a-aa69-430346d6e202" ParentLink="Transform_OutputMessagePartRef" LowerBound="603.52" HigherBound="603.93">
                                                            <om:Property Name="MessageRef" Value="MessageUpdateProfileWCFRequest" />
                                                            <om:Property Name="PartRef" Value="parameters" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="MessagePartReference_4" />
                                                            <om:Property Name="Signal" Value="False" />
                                                        </om:Element>
                                                    </om:Element>
                                                    <om:Element Type="MessageAssignment" OID="4aca8328-fa98-4e1d-9297-3336cdf2dcd0" ParentLink="ComplexStatement_Statement" LowerBound="604.1" HigherBound="607.1">
                                                        <om:Property Name="Expression" Value="MessageUpdateProfileWCFRequest.parameters.profileKey=varCreditCardIDPrimary;&#xD;&#xA;MessageUpdateProfileWCFRequest.parameters.profileObjectName=&quot;CreditCard&quot;;" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="assign key properties" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Scope" OID="78e07d2d-000f-462a-9938-44d0ed624b2f" ParentLink="ComplexStatement_Statement" LowerBound="608.1" HigherBound="669.1">
                                                    <om:Property Name="InitializedTransactionType" Value="True" />
                                                    <om:Property Name="IsSynchronized" Value="False" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Scope_UpdateCreditCard" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="Decision" OID="b95f1d49-b8cc-4972-a1c7-47dbb5cabefa" ParentLink="ComplexStatement_Statement" LowerBound="613.1" HigherBound="626.1">
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Decide_ArchiveProfilesUpdateREQCC" />
                                                        <om:Property Name="Signal" Value="True" />
                                                        <om:Element Type="DecisionBranch" OID="e61aec61-8a22-4272-a6a7-fc5a838f473a" ParentLink="ReallyComplexStatement_Branch" LowerBound="614.45" HigherBound="626.1">
                                                            <om:Property Name="Expression" Value="varArchiveProfilesUpdateRequestCreditCard == true" />
                                                            <om:Property Name="IsGhostBranch" Value="True" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="ArchiveProfilesQuery" />
                                                            <om:Property Name="Signal" Value="False" />
                                                            <om:Element Type="Construct" OID="697ee5c6-0c26-4a04-917c-b12e7f437800" ParentLink="ComplexStatement_Statement" LowerBound="616.1" HigherBound="623.1">
                                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                                <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                                                <om:Property Name="Signal" Value="True" />
                                                                <om:Element Type="MessageAssignment" OID="4b80f1a2-2409-4148-b450-47477e78534a" ParentLink="ComplexStatement_Statement" LowerBound="619.1" HigherBound="622.1">
                                                                    <om:Property Name="Expression" Value="Archive7ProfilesUpdateRequestCC = MessageUpdateProfileWCFRequest; &#xD;&#xA;Archive7ProfilesUpdateRequestCC(FILE.ReceivedFileName)=&quot;Archive4ProfilesUpdateRequestCC&quot;; " />
                                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                                    <om:Property Name="Signal" Value="False" />
                                                                </om:Element>
                                                                <om:Element Type="MessageRef" OID="51cf5723-5d01-4f08-b935-7ad4ba511815" ParentLink="Construct_MessageRef" LowerBound="617.59" HigherBound="617.90">
                                                                    <om:Property Name="Ref" Value="Archive7ProfilesUpdateRequestCC" />
                                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                                    <om:Property Name="Signal" Value="False" />
                                                                </om:Element>
                                                            </om:Element>
                                                            <om:Element Type="Send" OID="273553dd-04d7-42d8-bd9b-b49bf7c57b1f" ParentLink="ComplexStatement_Statement" LowerBound="623.1" HigherBound="625.1">
                                                                <om:Property Name="PortName" Value="Port_ArchiveProfilesUpdateRequest" />
                                                                <om:Property Name="MessageName" Value="Archive7ProfilesUpdateRequestCC" />
                                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                                <om:Property Name="Name" Value="Send_Archive" />
                                                                <om:Property Name="Signal" Value="True" />
                                                            </om:Element>
                                                        </om:Element>
                                                        <om:Element Type="DecisionBranch" OID="0c6f13ce-8186-4405-97a9-8b502aac00e2" ParentLink="ReallyComplexStatement_Branch">
                                                            <om:Property Name="IsGhostBranch" Value="True" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="Else" />
                                                            <om:Property Name="Signal" Value="False" />
                                                        </om:Element>
                                                    </om:Element>
                                                    <om:Element Type="Send" OID="00cd7eab-9cca-41f5-883f-067b6929311c" ParentLink="ComplexStatement_Statement" LowerBound="626.1" HigherBound="628.1">
                                                        <om:Property Name="PortName" Value="Port_UpdateProfiles" />
                                                        <om:Property Name="MessageName" Value="MessageUpdateProfileWCFRequest" />
                                                        <om:Property Name="OperationName" Value="UpdatePartialProfile" />
                                                        <om:Property Name="OperationMessageName" Value="Request" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Send_WCFUpdate" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                    <om:Element Type="Receive" OID="95b313f6-e4bc-4e4d-8370-4c47af1688aa" ParentLink="ComplexStatement_Statement" LowerBound="628.1" HigherBound="630.1">
                                                        <om:Property Name="Activate" Value="False" />
                                                        <om:Property Name="PortName" Value="Port_UpdateProfiles" />
                                                        <om:Property Name="MessageName" Value="MessageUpdateProfilesWCFResponse" />
                                                        <om:Property Name="OperationName" Value="UpdatePartialProfile" />
                                                        <om:Property Name="OperationMessageName" Value="Response" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Receive_WCFUpdate" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                    <om:Element Type="Decision" OID="e28fde69-1336-40c0-a4a7-d7c70612d652" ParentLink="ComplexStatement_Statement" LowerBound="630.1" HigherBound="643.1">
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Decide_ArchiveProfilesUpdateRESCC" />
                                                        <om:Property Name="Signal" Value="True" />
                                                        <om:Element Type="DecisionBranch" OID="c0d3f113-6853-49af-b16b-8fbe8e60c3d7" ParentLink="ReallyComplexStatement_Branch" LowerBound="631.45" HigherBound="643.1">
                                                            <om:Property Name="Expression" Value="varArchiveProfilesUpdateResponseCreditCard == true" />
                                                            <om:Property Name="IsGhostBranch" Value="True" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="ArchiveProfilesResponse" />
                                                            <om:Property Name="Signal" Value="False" />
                                                            <om:Element Type="Construct" OID="ff75e837-02aa-4cd4-b5cf-90ad44a5e4a6" ParentLink="ComplexStatement_Statement" LowerBound="633.1" HigherBound="640.1">
                                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                                <om:Property Name="Name" Value="ConstructArchiveMessage" />
                                                                <om:Property Name="Signal" Value="True" />
                                                                <om:Element Type="MessageRef" OID="6c559974-6d75-4402-b1c4-3d689564ecde" ParentLink="Construct_MessageRef" LowerBound="634.59" HigherBound="634.91">
                                                                    <om:Property Name="Ref" Value="Archive8ProfilesUpdateResponseCC" />
                                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                                    <om:Property Name="Signal" Value="False" />
                                                                </om:Element>
                                                                <om:Element Type="MessageAssignment" OID="f3a7065d-c02e-4f57-b185-8b0bbcb23d00" ParentLink="ComplexStatement_Statement" LowerBound="636.1" HigherBound="639.1">
                                                                    <om:Property Name="Expression" Value="Archive8ProfilesUpdateResponseCC = MessageUpdateProfilesWCFResponse; &#xD;&#xA;Archive8ProfilesUpdateResponseCC(FILE.ReceivedFileName)=&quot;Archive5ProfilesUpdateResponseCC&quot;; " />
                                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                                    <om:Property Name="Name" Value="MessageAssignment_1" />
                                                                    <om:Property Name="Signal" Value="False" />
                                                                </om:Element>
                                                            </om:Element>
                                                            <om:Element Type="Send" OID="27648a41-3414-4a3d-a5db-233bc1988e59" ParentLink="ComplexStatement_Statement" LowerBound="640.1" HigherBound="642.1">
                                                                <om:Property Name="PortName" Value="Port_ArchiveProfilesUpdateResponse" />
                                                                <om:Property Name="MessageName" Value="Archive8ProfilesUpdateResponseCC" />
                                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                                <om:Property Name="Name" Value="Send_Archive" />
                                                                <om:Property Name="Signal" Value="True" />
                                                            </om:Element>
                                                        </om:Element>
                                                        <om:Element Type="DecisionBranch" OID="9195f131-0345-4930-bc60-c06ceea5db1f" ParentLink="ReallyComplexStatement_Branch">
                                                            <om:Property Name="IsGhostBranch" Value="True" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="Else" />
                                                            <om:Property Name="Signal" Value="False" />
                                                        </om:Element>
                                                    </om:Element>
                                                    <om:Element Type="Catch" OID="6e715fce-b671-4b41-9f1f-67eba52ecfad" ParentLink="Scope_Catch" LowerBound="646.1" HigherBound="667.1">
                                                        <om:Property Name="ExceptionName" Value="updatefaultwcf" />
                                                        <om:Property Name="ExceptionType" Value="Port_UpdateProfiles.UpdatePartialProfile.Fault_" />
                                                        <om:Property Name="IsFaultMessage" Value="False" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="CatchException_UpdateCreditCard" />
                                                        <om:Property Name="Signal" Value="True" />
                                                        <om:Element Type="Construct" OID="1f81b828-170e-404e-84cc-4d052fb221e9" ParentLink="Catch_Statement" LowerBound="649.1" HigherBound="664.1">
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="ConstructMessage_Fault" />
                                                            <om:Property Name="Signal" Value="True" />
                                                            <om:Element Type="MessageRef" OID="81cdb1a0-39f6-4c35-8a4d-497ebffcbb03" ParentLink="Construct_MessageRef" LowerBound="650.59" HigherBound="650.71">
                                                                <om:Property Name="Ref" Value="FaultMessage" />
                                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                                <om:Property Name="Signal" Value="False" />
                                                            </om:Element>
                                                            <om:Element Type="MessageAssignment" OID="c835b2f3-409c-4975-8660-b773fe45e06b" ParentLink="ComplexStatement_Statement" LowerBound="652.1" HigherBound="663.1">
                                                                <om:Property Name="Expression" Value="xmlDoc = updatefaultwcf.MessagePart_Fault;&#xD;&#xA;varErrorMessage = xmlDoc.OuterXml;&#xD;&#xA;// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ExpiredCreditCard Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=varErrorMessage;&#xD;&#xA;FaultMessage.FaultCode=&quot;3003&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                                <om:Property Name="Name" Value="MessageAssignment_5" />
                                                                <om:Property Name="Signal" Value="True" />
                                                            </om:Element>
                                                        </om:Element>
                                                        <om:Element Type="Send" OID="47049f3e-22b9-4f6d-9ad1-10df6fa7cf07" ParentLink="Catch_Statement" LowerBound="664.1" HigherBound="666.1">
                                                            <om:Property Name="PortName" Value="Port_FaultPort" />
                                                            <om:Property Name="MessageName" Value="FaultMessage" />
                                                            <om:Property Name="OperationName" Value="Operation_1" />
                                                            <om:Property Name="OperationMessageName" Value="Request" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Name" Value="Send_Fault" />
                                                            <om:Property Name="Signal" Value="True" />
                                                        </om:Element>
                                                    </om:Element>
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="669d489b-6bf0-463e-9156-d31ffa774e47" ParentLink="ReallyComplexStatement_Branch">
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Else" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="VariableAssignment" OID="85102271-ef42-45eb-88a5-246b02ffcdf2" ParentLink="ComplexStatement_Statement" LowerBound="672.1" HigherBound="680.1">
                                                    <om:Property Name="Expression" Value="varID = xpath(MessageCreditCardxSingle,&quot;string(//id)&quot;);&#xD;&#xA;//varpaymentgroupid = xpath(MessageCreditCardxSingle,&quot;string(//paymentgroupid)&quot;);&#xD;&#xA;varCreditCardAlias = xpath(MessageCreditCardxSingle,&quot;string(//alias)&quot;);&#xD;&#xA;varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,&quot;string(//last4digits)&quot;);&#xD;&#xA;varEmailAddress = varBiztalkAdmin;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="gatherEmailVariables" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="Construct" OID="626e38c0-5c75-4c74-881f-7b4721651d23" ParentLink="ComplexStatement_Statement" LowerBound="680.1" HigherBound="705.1">
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="ConstructMessageEmail" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="MessageRef" OID="50a5658d-3214-4631-9a44-3f6a5bdd9f0e" ParentLink="Construct_MessageRef" LowerBound="681.47" HigherBound="681.55">
                                                        <om:Property Name="Ref" Value="emailMsg" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessageAssignment" OID="babeeb87-0cca-4fa1-86ee-d8d79e68a34b" ParentLink="ComplexStatement_Statement" LowerBound="683.1" HigherBound="704.1">
                                                        <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Dear Biztalk Administrator,&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;This primary credit card &quot; + varCreditCardAlias + &quot; ending in &quot; + varCreditCardLast4Digits + &quot; is about to expire. The customer &lt;br /&gt;will not be contacted directly because the card is not associated to an account.&lt;br /&gt;Please login to &quot; + varTS360Name + &quot; and confirm.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;creditcardid:&quot; + varID + &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Thanks&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varTS360Name + &quot; Payment Notification Card Not Associated to an account&quot;; &#xD;&#xA;//emailMsg(SMTP.CC)=varBTARContact; &#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varBiztalkAdmin;&#xD;&#xA;" />
                                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="Send" OID="fe88011d-55f3-4f6a-8ffb-e3f87ddd2ea2" ParentLink="ComplexStatement_Statement" LowerBound="705.1" HigherBound="707.1">
                                                    <om:Property Name="PortName" Value="Port_SMTP_ExpiredCards" />
                                                    <om:Property Name="MessageName" Value="emailMsg" />
                                                    <om:Property Name="OperationName" Value="Operation_1" />
                                                    <om:Property Name="OperationMessageName" Value="Request" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="Send_ExpiredCreditCardAlert" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="e30db3b4-08ca-48bf-9478-211ebfe9ec00" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="4a22f942-6d92-4a16-9e6a-8bcc573b7457" ParentLink="ComplexStatement_Statement" LowerBound="711.1" HigherBound="719.1">
                                            <om:Property Name="Expression" Value="varID = xpath(MessageCreditCardxSingle,&quot;string(//id)&quot;);&#xD;&#xA;//varpaymentgroupid = xpath(MessageCreditCardxSingle,&quot;string(//paymentgroupid)&quot;);&#xD;&#xA;varCreditCardAlias = xpath(MessageCreditCardxSingle,&quot;string(//alias)&quot;);&#xD;&#xA;varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,&quot;string(//last4digits)&quot;);&#xD;&#xA;varEmailAddress = varBiztalkAdmin;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="gatherEmailVariables" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="a6329d6d-002a-4100-bc6f-8a8907f54ee7" ParentLink="ComplexStatement_Statement" LowerBound="719.1" HigherBound="744.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ConstructMessageEmail" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="449c8fb6-ba6b-48e1-bb36-7d808671fc6b" ParentLink="Construct_MessageRef" LowerBound="720.43" HigherBound="720.51">
                                                <om:Property Name="Ref" Value="emailMsg" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="e6e09872-098d-4023-85f2-ac72fb2abda8" ParentLink="ComplexStatement_Statement" LowerBound="722.1" HigherBound="743.1">
                                                <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Dear Biztalk Administrator,&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;This primary credit card &quot; + varCreditCardAlias + &quot; ending in &quot; + varCreditCardLast4Digits + &quot; is about to expire. The customer &lt;br /&gt;cannot be contacted directly because no email address exists.&lt;br /&gt;Please login to &quot; + varTS360Name + &quot; and confirm.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;creditcardid:&quot; + varID + &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Thanks&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varTS360Name + &quot; Payment Notification No Email Address&quot;; &#xD;&#xA;emailMsg(SMTP.CC)=varBTARContact; &#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varBiztalkAdmin;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_3" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="4be5ee90-e730-46d0-b955-17c4e07a0f26" ParentLink="ComplexStatement_Statement" LowerBound="744.1" HigherBound="746.1">
                                            <om:Property Name="PortName" Value="Port_SMTP_ExpiredCards" />
                                            <om:Property Name="MessageName" Value="emailMsg" />
                                            <om:Property Name="OperationName" Value="Operation_1" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_ExpiredCreditCardAlert" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="23929f32-20e2-4b88-9236-8e8cd12868fb" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="3345233a-7719-4640-8a76-6f9cffec5717" ParentLink="ComplexStatement_Statement" LowerBound="750.1" HigherBound="758.1">
                                    <om:Property Name="Expression" Value="varID = xpath(MessageCreditCardxSingle,&quot;string(//id)&quot;);&#xD;&#xA;//varpaymentgroupid = xpath(MessageCreditCardxSingle,&quot;string(//paymentgroupid)&quot;);&#xD;&#xA;varCreditCardAlias = xpath(MessageCreditCardxSingle,&quot;string(//alias)&quot;);&#xD;&#xA;varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,&quot;string(//last4digits)&quot;);&#xD;&#xA;varEmailAddress = varBiztalkAdmin;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varEmailAddress;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="gatherEmailVariables" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Construct" OID="e3ae4682-9faf-4670-b05f-fee865208884" ParentLink="ComplexStatement_Statement" LowerBound="758.1" HigherBound="783.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructMessageEmail" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="5c8b664e-9142-4ad1-b351-0f370c67796d" ParentLink="Construct_MessageRef" LowerBound="759.39" HigherBound="759.47">
                                        <om:Property Name="Ref" Value="emailMsg" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="89bb8faa-e0ee-46e5-86a6-19d2b4773927" ParentLink="ComplexStatement_Statement" LowerBound="761.1" HigherBound="782.1">
                                        <om:Property Name="Expression" Value="msgbody = new System.Text.StringBuilder();&#xD;&#xA;msgbody.AppendLine(&quot;&lt;html&gt;&lt;body&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Dear Biztalk Administrator,&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;This primary credit card &quot; + varCreditCardAlias + &quot; ending in &quot; + varCreditCardLast4Digits + &quot; is about to expire. The customer &lt;br /&gt;cannot be contacted directly because no credit card id exists to point to the User Object.&lt;br /&gt;Please login to &quot; + varTS360Name + &quot; and check the tables for constraint issues.&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;&lt;b&gt;creditcardid:&quot; + varID + &quot;&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;msgbody.AppendLine(&quot;&lt;p&gt;Thanks&lt;/p&gt;&lt;p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;msgbody.AppendLine(&quot;&lt;/body&gt;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());&#xD;&#xA;emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)=&quot;text/html&quot;;&#xD;&#xA;emailMsg(SMTP.SMTPHost)=varSMTPHost;&#xD;&#xA;emailMsg(SMTP.From)= varSMTPFrom;&#xD;&#xA;emailMsg(SMTP.Subject)=varTS360Name + &quot; Payment Notification No UserObject&quot;; &#xD;&#xA;emailMsg(SMTP.CC)=varBTARContact; &#xD;&#xA;emailMsg(SMTP.EmailBodyTextCharset)=&quot;UTF-8&quot;;&#xD;&#xA;emailMsg(SMTP.MessagePartsAttachments)=2;&#xD;&#xA;&#xD;&#xA;Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)=&quot;mailto:&quot; + varBiztalkAdmin;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_3" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="53f87b24-f530-4233-88b3-25bc6554d999" ParentLink="ComplexStatement_Statement" LowerBound="783.1" HigherBound="785.1">
                                    <om:Property Name="PortName" Value="Port_SMTP_ExpiredCards" />
                                    <om:Property Name="MessageName" Value="emailMsg" />
                                    <om:Property Name="OperationName" Value="Operation_1" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_ExpiredCreditCardAlert" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="dd254f8b-a710-4d94-a7ba-ff514cce8fbd" ParentLink="ComplexStatement_Statement" LowerBound="786.1" HigherBound="788.1">
                            <om:Property Name="Expression" Value="nLoopCount = nLoopCount + 1; " />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="AddToCounter" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Terminate" OID="6041b725-dcf7-4a42-afd3-8ca3c3f55f67" ParentLink="ComplexStatement_Statement" LowerBound="789.1" HigherBound="791.1">
                        <om:Property Name="ErrorMessage" Value="&quot;Testing&quot;;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Terminate_1" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Construct" OID="034d864f-d93d-4d9a-bd12-1b743c7037da" ParentLink="ComplexStatement_Statement" LowerBound="791.1" HigherBound="801.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="ConstructDummy_MessageReplyCommerceBackup" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="MessageRef" OID="f6bb701e-8d12-4c6a-a2ae-b3e300235d96" ParentLink="Construct_MessageRef" LowerBound="792.31" HigherBound="792.63">
                            <om:Property Name="Ref" Value="MessageUpdateProfilesWCFResponse" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="0b25dea5-d393-4c5a-a474-8697e210aa2c" ParentLink="Construct_MessageRef" LowerBound="792.65" HigherBound="792.80">
                            <om:Property Name="Ref" Value="MessageXMLDummy" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageRef" OID="752c2fac-2f8b-4b74-b7c6-c03287b79c12" ParentLink="Construct_MessageRef" LowerBound="792.82" HigherBound="792.101">
                            <om:Property Name="Ref" Value="ExpiredCardResponse" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageAssignment" OID="0108e9ca-477e-4ad5-b2ed-aac4e845ca3b" ParentLink="ComplexStatement_Statement" LowerBound="794.1" HigherBound="800.1">
                            <om:Property Name="Expression" Value="MessageXMLDummy = new System.Xml.XmlDocument();&#xD;&#xA;MessageXMLDummy.LoadXml(@&quot;&lt;Dummy xmlns=&quot;&quot;http://tempuri.org/&quot;&quot;&gt;&lt;CreateLegacyBasketsResult xmlns:a=&quot;&quot;http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders&quot;&quot; xmlns:i=&quot;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&quot;&gt;&lt;a:BasketDetailsResponse&gt;&lt;a:ErrorMessage&gt; &lt;/a:ErrorMessage&gt;&lt;a:LegacyBasketId&gt;13759439&lt;/a:LegacyBasketId&gt;&lt;a:LegacySourceSystem&gt;TS3&lt;/a:LegacySourceSystem&gt;&lt;a:LoadStatus&gt;Loaded&lt;/a:LoadStatus&gt;&lt;/a:BasketDetailsResponse&gt;&lt;/CreateLegacyBasketsResult&gt;&lt;/Dummy&gt;&quot;);&#xD;&#xA;MessageUpdateProfilesWCFResponse.parameters = MessageXMLDummy; &#xD;&#xA;&#xD;&#xA;ExpiredCardResponse = MessageXMLDummy;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="False" />
                            <om:Property Name="Name" Value="MessageAssignment_4" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="ca01ec92-67a1-40f3-826a-2246d584b9b8" ParentLink="Scope_Catch" LowerBound="804.1" HigherBound="823.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.SystemException" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CatchException_Main" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="a8408c01-9dea-46ec-baf8-4c7b6459240e" ParentLink="Catch_Statement" LowerBound="807.1" HigherBound="820.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructMessage_Fault" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageRef" OID="cff05a06-dbe7-4a92-9cab-682169f3f4c1" ParentLink="Construct_MessageRef" LowerBound="808.35" HigherBound="808.47">
                                <om:Property Name="Ref" Value="FaultMessage" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="1470d2b9-aa4b-4871-a798-03a3f3d5b6c4" ParentLink="ComplexStatement_Statement" LowerBound="810.1" HigherBound="819.1">
                                <om:Property Name="Expression" Value="// Create fault exception Message&#xD;&#xA;FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();&#xD;&#xA;&#xD;&#xA;// Assign Properties&#xD;&#xA;FaultMessage.FailureCategory=&quot;BTNextGen.Biztalk.ExpiredCreditCard Exception&quot;;&#xD;&#xA;FaultMessage.FaultDescription=ex.Message;&#xD;&#xA;FaultMessage.FaultCode=&quot;3003&quot;;&#xD;&#xA;FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_5" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="4b20fc4e-e475-4d55-8ad8-512ac2126e5e" ParentLink="Catch_Statement" LowerBound="820.1" HigherBound="822.1">
                            <om:Property Name="PortName" Value="Port_FaultPort" />
                            <om:Property Name="MessageName" Value="FaultMessage" />
                            <om:Property Name="OperationName" Value="Operation_1" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_Fault" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="9484978e-d68f-4604-a278-e448b5e46738" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="106.1" HigherBound="108.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_1" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveSingleMessage" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="5890314c-ba30-4ca7-941f-7bcdd87dc462" ParentLink="PortDeclaration_CLRAttribute" LowerBound="106.1" HigherBound="107.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="dbb39a72-4355-4d41-951f-a08da0576e37" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="108.1" HigherBound="110.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_ReceiveDummy" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ReceiveDummy" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="608b2137-70d5-4e8b-97c1-080222f3f554" ParentLink="PortDeclaration_CLRAttribute" LowerBound="108.1" HigherBound="109.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="1d273ef9-86ce-4199-8410-7bcffc8f9514" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="110.1" HigherBound="112.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="93" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_SMTP_ExpiredCards" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SMTP_ExpiredCards" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="PhysicalBindingAttribute" OID="f923ad05-bda8-4d9b-8d4b-b943ab2d26d4" ParentLink="PortDeclaration_CLRAttribute" LowerBound="110.1" HigherBound="111.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.PassThruTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="53b12910-038b-40dd-9baa-f07729663574" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="112.1" HigherBound="114.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.IIProfile" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_UpdateProfiles" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="c589dfac-6906-4133-b4ea-d41f28f48806" ParentLink="PortDeclaration_CLRAttribute" LowerBound="112.1" HigherBound="113.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="3fd90865-d896-40c5-94e9-bd3dbd1169f6" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="114.1" HigherBound="116.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="219" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_ArchiveProfilesUpdateRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveProfilesUpdateRequest" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="77ad00c9-9d11-4d03-98a1-eb3f13ef4234" ParentLink="PortDeclaration_CLRAttribute" LowerBound="114.1" HigherBound="115.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="5d4de74a-8869-44c3-904b-07e1980d13b6" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="116.1" HigherBound="118.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_ArchiveProfilesUpdateResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ArchiveProfilesUpdateResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="66d092c5-e7ef-4b24-bb8f-f5479130dd74" ParentLink="PortDeclaration_CLRAttribute" LowerBound="116.1" HigherBound="117.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="343b170c-61f3-4281-b6f1-ad4b29966b5f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="118.1" HigherBound="120.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_SendExpiredCardQuery" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendArchivedQuery" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="91fc6873-ea14-4f99-a0fd-3a2e0340418e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="118.1" HigherBound="119.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="392cd20b-e182-4584-bc19-e2d4e548b4b0" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="120.1" HigherBound="122.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_2" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ReceiveArchive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="383d21be-38c3-47c8-89a4-6a7aa0388d83" ParentLink="PortDeclaration_CLRAttribute" LowerBound="120.1" HigherBound="121.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="9721883f-e0d8-42ca-984f-3cdb4fdbc188" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="122.1" HigherBound="124.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="BTNextGen.Biztalk.ExpiredCreditCards.PortType_FaultPort" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_FaultPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="1cb2daa3-d3b4-4678-997c-25d986f2b696" ParentLink="PortDeclaration_CLRAttribute" LowerBound="122.1" HigherBound="123.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="a38683ea-c07f-4126-bbb7-9197a8a49032" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Email" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="52ecc69a-9545-4992-89cf-f2d244135e5d" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="6299e5dd-a03e-43d6-95d3-50812cf8f11f" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Fault" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="66fe90c0-0e58-4c4d-8ae6-87317bd34bdf" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="BTS.soap_envelope_1__1.Fault" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Fault" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module BTNextGen.Biztalk.ExpiredCreditCards
{
    internal messagetype MultipartType_Email
    {
        body Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessagePart_Body;
    };
    internal messagetype MultipartType_Fault
    {
        body BTS.soap_envelope_1__1.Fault MessagePart_Fault;
    };
    internal porttype ReceiveAllCreditCardsPortType
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery
        };
    };
    internal porttype PortType_ProfilesQueryResponse
    {
        requestresponse Operation_1
        {
            BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery, BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList
        };
    };
    internal porttype PortType_1
    {
        oneway Operation_1
        {
            ExpiredCreditCardSchembSingle
        };
    };
    internal porttype PortType_ReceiveDummy
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery
        };
    };
    internal porttype PortType_ArchiveQueryResponse
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList
        };
    };
    internal porttype PortType_ArchiveCReditCardMessage
    {
        oneway Operation_1
        {
            ExpiredCreditCardSchema
        };
    };
    internal porttype PortType_ArchiveProfileQuery
    {
        oneway Operation_1
        {
            BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery
        };
    };
    internal porttype PortType_SMTP_ExpiredCards
    {
        oneway Operation_1
        {
            MultipartType_Email
        };
    };
    internal porttype PortType_ArchiveProfilesUpdateRequest
    {
        oneway Operation_1
        {
            IIProfile_UpdatePartialProfile_InputMessage
        };
    };
    internal porttype PortType_ArchiveProfilesUpdateResponse
    {
        oneway Operation_1
        {
            IIProfile_UpdatePartialProfile_OutputMessage
        };
    };
    internal porttype PortType_SendExpiredCardQuery
    {
        oneway Operation_1
        {
            IProfile_tempuri_org.GetExpiredCards
        };
    };
    internal porttype PortType_2
    {
        oneway Operation_1
        {
            IProfile_tempuri_org.GetExpiredCardsResponse
        };
    };
    internal porttype PortType_FaultPort
    {
        oneway Operation_1
        {
            Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service SendExpiredCreditCardNotice
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_1 Port_ArchiveSingleMessage;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_ReceiveDummy ReceiveDummy;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.PassThruTransmit))]
        port uses dynamic PortType_SMTP_ExpiredCards Port_SMTP_ExpiredCards;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses IIProfile Port_UpdateProfiles;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveProfilesUpdateRequest Port_ArchiveProfilesUpdateRequest;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveProfilesUpdateResponse Port_ArchiveProfilesUpdateResponse;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SendExpiredCardQuery Port_SendArchivedQuery;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_2 Port_ReceiveArchive;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port uses PortType_FaultPort Port_FaultPort;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList Archive6ProfilesResponseUserObject;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery Archive5ProfilesRequestUserObject;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQueryResponseMessage.ProfileDocumentList ProfilesQueryResponse;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.ProfilesQuery ProfilesQuery;
        message ExpiredCreditCardSchema MessageCreditCards;
        message ExpiredCreditCardSchembSingle MessageCreditCardxSingle;
        message Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString MessageEmail;
        message IProfile_tempuri_org.GetExpiredCards Archive1ExpiredRequestCreditCard;
        message IProfile_tempuri_org.GetExpiredCardsResponse Archive2ExpiredResponseCreditCard;
        message ExpiredCreditCardSchema Archive3MessageCreditCards;
        message ExpiredCreditCardSchembSingle Archive4MessageCreditCardsSingle;
        message MultipartType_Email emailMsg;
        message BTNextGen.BizTalk.CS.Profiles.Schemas.BTProfile MessageCreditCardsBTProfile;
        message System.Xml.XmlDocument MessageCreditCardsStaging;
        message IIProfile_UpdatePartialProfile_InputMessage MessageUpdateProfileWCFRequest;
        message IIProfile_UpdatePartialProfile_OutputMessage MessageUpdateProfilesWCFResponse;
        message IIProfile_UpdatePartialProfile_InputMessage Archive7ProfilesUpdateRequestCC;
        message IIProfile_UpdatePartialProfile_OutputMessage Archive8ProfilesUpdateResponseCC;
        message Microsoft.Practices.ESB.ExceptionHandling.Schemas.Faults.FaultMessage FaultMessage;
        message BTS.soap_envelope_1__1.Fault Message_WCFFaultPort;
        message IProfile_tempuri_org.GetExpiredCards ExpiredCardQuery;
        message IProfile_tempuri_org.GetExpiredCardsResponse ExpiredCardResponse;
        message ExpiredCreditCardSchemaX MessageCreditCardsX;
        message System.Xml.XmlDocument MessageXMLDummy;
        System.String sXpath;
        System.Int32 intCurrentDay;
        System.Int32 intCurrentMonth;
        System.Int32 intCurrentYear;
        System.Int32 intCurrentEOM;
        System.Int32 intCurrentDIFF;
        System.String varCurrentDIFF;
        System.Int32 nRecordCount;
        System.Int32 nLoopCount;
        System.String varCreditCardIDForeign;
        System.Xml.XmlDocument xmlQRYProfileUserObject;
        System.String sHold;
        System.Boolean varArchiveExpiredRequestCreditCard;
        System.Boolean varArchiveExpiredResponseCreditCard;
        System.Boolean varArchiveProfilesResponseFiltered;
        System.Boolean varArchiveCreditCardSingle;
        System.String varBTARContact;
        System.String varTS360Name;
        System.String varUserFirstName;
        System.String varCreditCardAlias;
        System.String varCreditCardLast4Digits;
        System.String varEmailAddress;
        System.Boolean varTesting;
        System.String varSMTPFrom;
        System.String varSMTPHost;
        System.Text.StringBuilder msgbody;
        System.String varTS360Logo;
        System.String varID;
        System.String varBiztalkAdmin;
        System.String varNotificationStatus;
        System.String varNotificationMessage;
        System.DateTime intCurrentDateTime;
        System.String varCurrentDateTime;
        System.String varCreditCardIDPrimary;
        System.Xml.XmlDocument xmlUPDProfileCreditCard;
        System.Boolean varArchiveProfilesUpdateRequestCreditCard;
        System.Boolean varArchiveProfilesUpdateResponseCreditCard;
        System.String varCurrentYear;
        System.Xml.XmlDocument xmlQRYProfileCreditCard;
        System.String varExpiredOnDays1;
        System.String varExpiredOnDays2;
        System.String varExpiredOnDays3;
        System.String varExpiredOnDays4;
        System.String varCurrentMonth;
        System.Xml.XmlDocument xmlQRYEXPIREDCARD;
        System.String varErrorMessage;
        System.Xml.XmlDocument xmlDoc;
        System.String varNoticeNumber;
        System.Boolean varBAM;
        System.String varActivityName;
        System.String varActivityID;
        System.Guid varGUID;
        System.String varAccountNumber;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ca55994e-c530-49ae-a4c8-9495a1f7d283")]
            activate receive (ReceiveDummy.Operation_1, ProfilesQuery);
            sXpath = "";
            varCurrentDIFF = "";
            nRecordCount = 0;
            nLoopCount = 1;
            varCreditCardIDForeign = "";
            xmlQRYProfileUserObject = new System.Xml.XmlDocument();
            sHold = "";
            varArchiveExpiredRequestCreditCard = true;
            varArchiveExpiredResponseCreditCard = true;
            varArchiveProfilesResponseFiltered = true;
            varArchiveCreditCardSingle = true;
            varBTARContact = "";
            varTS360Name = "";
            varUserFirstName = "";
            varCreditCardAlias = "";
            varCreditCardLast4Digits = "";
            varEmailAddress = "";
            varTesting = true;
            varSMTPFrom = "";
            varSMTPHost = "";
            msgbody = new System.Text.StringBuilder();
            varTS360Logo = "";
            varID = "";
            varBiztalkAdmin = "";
            varNotificationStatus = "";
            varNotificationMessage = "";
            varCurrentDateTime = "";
            varCreditCardIDPrimary = "";
            xmlUPDProfileCreditCard = new System.Xml.XmlDocument();
            varArchiveProfilesUpdateRequestCreditCard = true;
            varArchiveProfilesUpdateResponseCreditCard = true;
            varCurrentYear = "";
            xmlQRYProfileCreditCard = new System.Xml.XmlDocument();
            varExpiredOnDays1 = "";
            varExpiredOnDays2 = "";
            varExpiredOnDays3 = "";
            varExpiredOnDays4 = "";
            varCurrentMonth = "";
            xmlQRYEXPIREDCARD = new System.Xml.XmlDocument();
            varErrorMessage = "";
            xmlDoc = new System.Xml.XmlDocument();
            varNoticeNumber = "";
            varBAM = true;
            varActivityName = "";
            varActivityID = "";
            varAccountNumber = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b65e8140-654a-404d-a516-6f3b98a96b4d")]
            scope
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("40e4abca-1389-4d78-80b8-fcc982f40b99")]
                    varArchiveExpiredRequestCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ArchiveExpiredRequestCreditCard"));
                    varArchiveExpiredResponseCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ArchiveExpiredResponseCreditCard")); 
                    varArchiveProfilesResponseFiltered=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ArchiveProfilesResponseFiltered")); 
                    varArchiveCreditCardSingle=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ArchiveCreditCardSingle")); 
                    varArchiveProfilesUpdateRequestCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ArchiveProfilesUpdateRequestCreditCard"));
                    varArchiveProfilesUpdateResponseCreditCard=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ArchiveProfilesUpdateResponseCreditCard"));
                    varTS360Name=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","TS360Name"); 
                    varTesting=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","Testing"));
                    varBAM=System.Convert.ToBoolean(SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","BAM"));
                    varSMTPFrom=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","SMTPFrom");                                                                                                                                                                                                                              
                    //varSMTPUsername=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","SMTPUsername");                                                                                                               
                    //varSMTPPassword=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","SMTPPassword");                                                                                                               
                    varSMTPHost=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","SMTPHost");                                                                                                               
                    varBTARContact=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","BTARContact");                                                                                                               
                    varTS360Logo=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","TS360Logo");                                                                                                                
                    varBiztalkAdmin=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","BiztalkAdmin"); 
                    varExpiredOnDays1=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ExpiredOnDays1");
                    varExpiredOnDays2=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ExpiredOnDays2");
                    varExpiredOnDays3=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ExpiredOnDays3");
                    varExpiredOnDays4=SSO.Utility.SSOClientHelper.Read("BTNextGen.Biztalk.ExpiredCreditCards","ExpiredOnDays4");
                    
                    
                    intCurrentDay = System.DateTime.Today.Day;
                    intCurrentMonth = System.DateTime.Today.Month; 
                    intCurrentYear = System.DateTime.Today.Year; 
                    intCurrentEOM = System.DateTime.DaysInMonth(intCurrentYear,intCurrentMonth);
                    intCurrentDIFF = (intCurrentEOM - intCurrentDay); 
                    intCurrentDateTime  = System.DateTime.Now; 
                    varCurrentDIFF = System.Convert.ToString(intCurrentDIFF);
                    varNotificationMessage = "Credit Card is about to expire in " + varCurrentDIFF + " days."; 
                    varCurrentDateTime = System.Convert.ToString(intCurrentDateTime); 
                    varCurrentYear = System.Convert.ToString(intCurrentYear); 
                    varCurrentMonth = System.Convert.ToString(intCurrentMonth); 
                    
                    
                    
                    
                    System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredCreditCards",varCurrentDIFF );
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c29db252-c5c8-4177-9476-2990f6b27e7f")]
                    if ((varCurrentDIFF == varExpiredOnDays1) | (varCurrentDIFF == varExpiredOnDays2) | (varCurrentDIFF == varExpiredOnDays3) |  (varCurrentDIFF == varExpiredOnDays4) )
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("911a68d8-8f43-486e-857f-42bb4c5feaa9")]
                        varNoticeNumber = "0";
                        if (varCurrentDIFF == varExpiredOnDays1) 
                        {
                        varNoticeNumber = "1"; 
                        }
                        
                        if (varCurrentDIFF == varExpiredOnDays2)
                        {
                        varNoticeNumber = "2"; 
                        }
                        
                        if (varCurrentDIFF == varExpiredOnDays3)
                        {
                        varNoticeNumber = "3";
                        }
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("02f2ca48-bcd7-41dd-a023-72e304cbe354")]
                        System.Diagnostics.EventLog.WriteEntry("BTNextGen.Biztalk.ExpiredCreditCards", "OK - not date to check for expired cards" );
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("63d98912-cd10-4c44-834e-5a8c0e3c05c7")]
                        terminate "Process OK - not date to check for expired cards";;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4b479251-53f4-44d1-90e4-349faaa696a0")]
                    construct ExpiredCardQuery
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f657c2a7-4db9-4521-957f-18303e0074d6")]
                        //For Testing... 
                        //varCurrentYear = "2013"; 
                        //sHold = "<CommerceServerProfilesQuery ProfileType=\"CreditCard\"><CLAUSE OPER=\"equal\" xmlns=\"http://schemas.microsoft.com/CommerceServer/2004/02/Expressions\"><PROPERTY ID=\"expiration_year\" MULTIVAL=\"False\" TYPE=\"Number\"/><IMMED-VAL TYPE=\"String\"><VALUE>" + varCurrentYear + "</VALUE></IMMED-VAL></CLAUSE></CommerceServerProfilesQuery>"; 
                        sHold = "<GetExpiredCards xmlns=\"http://tempuri.org/\"><currentYear>" + varCurrentYear + "</currentYear><month>" + varCurrentMonth + "</month><isPrimaryCard>true</isPrimaryCard></GetExpiredCards>";
                        xmlQRYEXPIREDCARD.LoadXml(@sHold); 
                        
                        ExpiredCardQuery = xmlQRYEXPIREDCARD;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("acb6e524-dc2b-4417-a854-ab008bf03bbe")]
                    if (varArchiveExpiredRequestCreditCard == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd7f8419-4eb0-434d-bc2a-1596ec911d18")]
                        construct Archive1ExpiredRequestCreditCard
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4e58f662-1dd6-4a44-937f-3d804b6b20b5")]
                            Archive1ExpiredRequestCreditCard = ExpiredCardQuery; 
                            Archive1ExpiredRequestCreditCard(FILE.ReceivedFileName)="Archive1ExpiredRequestCreditCard"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b37e83db-113e-4189-b933-f84dd3f139fd")]
                        send (Port_SendArchivedQuery.Operation_1, Archive1ExpiredRequestCreditCard);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("bff70dad-8e89-4f68-928b-561db6b78920")]
                    construct MessageXMLDummy, ExpiredCardResponse
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("eca527f5-34d6-4872-a9d3-152dadecc653")]
                        MessageXMLDummy = new System.Xml.XmlDocument();
                        MessageXMLDummy.LoadXml(@"<Dummy xmlns=""http://tempuri.org/""><CreateLegacyBasketsResult xmlns:a=""http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""><a:BasketDetailsResponse><a:ErrorMessage> </a:ErrorMessage><a:LegacyBasketId>13759439</a:LegacyBasketId><a:LegacySourceSystem>TS3</a:LegacySourceSystem><a:LoadStatus>Loaded</a:LoadStatus></a:BasketDetailsResponse></CreateLegacyBasketsResult></Dummy>");
                        
                        ExpiredCardResponse = MessageXMLDummy;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5cbe080d-aeba-4a70-a524-99b286d40956")]
                    scope
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("380a12cf-4435-401a-a9a8-cab38ea863bd")]
                            send (Port_UpdateProfiles.GetExpiredCards, ExpiredCardQuery);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("66fa16d8-5f5e-4a1b-bcd8-be8cca6ba7cf")]
                            receive (Port_UpdateProfiles.GetExpiredCards, ExpiredCardResponse);
                        }
                        exceptions
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb28fbc0-ef40-4793-96ff-dd468f7ad903")]
                            catch (Port_UpdateProfiles.GetExpiredCards.Fault_1 GetExpiredCardsFault)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f084087-7e91-4908-8614-a0fc278fc781")]
                                construct FaultMessage
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5792459f-97d7-4f8b-a29c-c5763f87008a")]
                                    xmlDoc = GetExpiredCardsFault.MessagePart_Fault;
                                    varErrorMessage = xmlDoc.OuterXml;
                                    // Create fault exception Message
                                    FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                    
                                    // Assign Properties
                                    FaultMessage.FailureCategory="BTNextGen.Biztalk.ExpiredCreditCard Exception";
                                    FaultMessage.FaultDescription=varErrorMessage;
                                    FaultMessage.FaultCode="3003";
                                    FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("01666826-b3c3-458b-9b08-b8e32023b84d")]
                                send (Port_FaultPort.Operation_1, FaultMessage);
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("151b4de0-5e0f-4619-a3bc-a2c4644afd0d")]
                    if (varArchiveExpiredResponseCreditCard == true)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f4c849b-98a7-4e85-9d3a-9d5585e37a7a")]
                        construct Archive2ExpiredResponseCreditCard
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("73a76f50-6d6d-4c28-ab0a-e6b22a551249")]
                            Archive2ExpiredResponseCreditCard = ExpiredCardResponse; 
                            Archive2ExpiredResponseCreditCard(FILE.ReceivedFileName)="Archive2ExpiredResponseCreditCard"; 
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("833799b4-ca7c-4f52-9735-2763a193b59e")]
                        send (Port_ReceiveArchive.Operation_1, Archive2ExpiredResponseCreditCard);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ef3a5724-c027-4bd1-a858-a2cdfcdba28f")]
                    construct MessageCreditCardsX
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("199ed070-6b4f-4951-950b-524c86c8a327")]
                        transform (MessageCreditCardsX) = BTNextGen.Biztalk.ExpiredCreditCards.Transform_Adjust (ExpiredCardResponse);
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f16b689b-f8c3-48bc-8774-b14992cbab87")]
                    nRecordCount = System.Convert.ToInt32(xpath(MessageCreditCardsX, "count(//CreditCardData)"));
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("23c731fc-ea85-4da0-94c0-b41aba99f760")]
                    while (nLoopCount <= nRecordCount)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("97cb3a2a-3812-4ed6-a8ef-dcf3ea0deccb")]
                        construct MessageCreditCardxSingle
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("053d0ed9-2b27-4941-964b-aad35eabce76")]
                            
                            
                            sXpath = System.String.Format("//CreditCardData[{0}]",nLoopCount);
                            MessageCreditCardxSingle = xpath(MessageCreditCardsX,sXpath); 
                                                      
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9254970-1236-4881-9aa3-589ef38d7c8c")]
                        //CreditCardIDFlag = false; 
                        varCreditCardIDForeign = xpath(MessageCreditCardxSingle,"string(//cardcontactuser)");
                        varCreditCardIDPrimary = xpath(MessageCreditCardxSingle, "string(//id)");
                        
                        
                        //if (CreditCardID.Length > 0) 
                        //{
                        //CreditCardIDFlag = true;
                        //}
                        
                        
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("805ae88c-2e27-4c1e-b21d-48ef2b69ca0c")]
                        if (varArchiveCreditCardSingle == true)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0082bee8-f4e9-49d4-a704-a2f39aa1043c")]
                            construct Archive4MessageCreditCardsSingle
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("77a98000-7902-46ee-a931-d5d2c5c34244")]
                                Archive4MessageCreditCardsSingle = MessageCreditCardxSingle; 
                                Archive4MessageCreditCardsSingle(FILE.ReceivedFileName)="Archive3MessageCreditCardsSingle"; 
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e278cc79-8452-4d1d-8b93-5242cb382372")]
                            send (Port_ArchiveSingleMessage.Operation_1, Archive4MessageCreditCardsSingle);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2a9c9d0f-e66a-491c-89a2-aa84335f5d07")]
                        varUserFirstName = xpath(MessageCreditCardxSingle,"string(//firstname)");
                        
                        varCreditCardAlias = xpath(MessageCreditCardxSingle,"string(//alias)");
                        varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,"string(//last4digits)");
                        varEmailAddress = xpath(MessageCreditCardxSingle,"string(//emailaddress)");
                        varAccountNumber = xpath(MessageCreditCardxSingle,"string(//erpaccountid)");
                        
                        Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d0f7e491-7668-4e46-9b7f-2f1da840a5ba")]
                        if (varBAM)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e206e8a4-c8ad-4207-b001-68df74fc86fd")]
                            // set bam variables
                            varActivityName= "ExpiredCreditCards";
                            varGUID = System.Guid.NewGuid();
                            varActivityID= varGUID.ToString()+ "_"+ System.DateTime.Now.ToString();
                            
                            
                            
                            Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.BeginActivity(varActivityName, varActivityID);
                            Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.UpdateActivity(varActivityName,varActivityID,
                            "Alias",varCreditCardAlias,
                            "DateCreated",System.DateTime.Now.ToString(),
                            "EmailAddress", varEmailAddress,
                            "ExpirationMonth", varCurrentMonth,
                            "ExpirationYear",  varCurrentYear,
                            "ID_CreditCards", varCreditCardIDPrimary,
                            "ID_UserObjects",varCreditCardIDForeign,
                            "Last4Digits",varCreditCardLast4Digits);
                            Microsoft.BizTalk.Bam.EventObservation.OrchestrationEventStream.EndActivity(varActivityName, varActivityID);
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("525a205a-49d9-4841-bbb0-4d3d5a5d09a7")]
                        if (varCreditCardIDForeign.Length > 0  )
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a3531d8d-14a4-44d2-892c-8cc8cc9886b7")]
                            if (varEmailAddress.Length > 0 )
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b4463b6a-0d3a-4543-a0f6-ccf87d7f76fd")]
                                if (varAccountNumber.Length > 0  )
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("aaa306cf-faa0-463e-9dc3-e8863f49eb6b")]
                                    construct emailMsg
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("91c8487c-e1f7-46a8-89a6-0a72ed16dc8e")]
                                        msgbody = new System.Text.StringBuilder();
                                        msgbody.AppendLine("<html><body>");
                                        msgbody.AppendLine("<img src=" +  varTS360Logo +   ">");
                                        msgbody.AppendLine("<p>Dear " + varUserFirstName + "," +   "</p><p>");
                                        msgbody.AppendLine("<p>Your primary credit card " + varCreditCardAlias + " ending in " + varCreditCardLast4Digits + " is about to expire in " + varCurrentDIFF + " days.  If your<br />organization intends to place orders with this card in the near future, please login to " + varTS360Name + " and <br />update your credit card expiration date to avoid any delays with future orders through " + varTS360Name + ".</p><p>");
                                        msgbody.AppendLine("<p>We appreciate your business.</p><p>");
                                        msgbody.AppendLine("<p>Thanks<br />Billing Team<br />" + varTS360Name + "<br />" + varBTARContact + "</p><p>");
                                        
                                        
                                        msgbody.AppendLine("</body></html>");
                                        
                                        //xmlDoc=TmpMsg;
                                        emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                        //emailMsg.attachment=xmlDoc;
                                        //emailMsg.attachment(MIME.FileName)= faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.Application)+"_" +faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.FaultCode)+".xml"; 
                                        emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                        emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                        emailMsg(SMTP.From)= varSMTPFrom;
                                        emailMsg(SMTP.Subject)=varTS360Name + " Payment Notification"; 
                                        
                                        emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                        emailMsg(SMTP.MessagePartsAttachments)=2;
                                        
                                        Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3766d4f8-86ee-4a97-9cbf-f22f788398eb")]
                                    send (Port_SMTP_ExpiredCards.Operation_1, emailMsg);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0f7efdad-7b65-40c0-a2f7-484b63603253")]
                                    construct emailMsg
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6df7990a-19d2-4e7d-89bf-94566a052167")]
                                        msgbody = new System.Text.StringBuilder();
                                        msgbody.AppendLine("<html><body>");
                                        msgbody.AppendLine("<img src=" +  varTS360Logo +   ">");
                                        msgbody.AppendLine("<p>Dear " + "B&T AR Team" + "," +   "</p><p>");
                                        msgbody.AppendLine("<p>This primary credit card " + varCreditCardAlias + " ending in " + varCreditCardLast4Digits + " is about to expire in " + varCurrentDIFF + " days. <br /><br /> The account number(s) associated with this credit card are:<br /><br /> " + varAccountNumber + "<br /><br />The organization has been notified via a separate email to update their credit card expiration date<br /> to avoid any delays with future orders through " + varTS360Name + ". <br /><br />The customer email notified is: " + varEmailAddress + "</p><p>");
                                        
                                        msgbody.AppendLine("<p>Thanks<br />Biztalk IT Team<br />" + varTS360Name + "<br />");
                                        
                                        
                                        msgbody.AppendLine("</body></html>");
                                        
                                        //xmlDoc=TmpMsg;
                                        emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                        //emailMsg.attachment=xmlDoc;
                                        //emailMsg.attachment(MIME.FileName)= faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.Application)+"_" +faultMessage(Microsoft.Practices.ESB.ExceptionHandling.Schemas.Property.FaultCode)+".xml"; 
                                        emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                        emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                        emailMsg(SMTP.From)= varSMTPFrom;
                                        emailMsg(SMTP.Subject)=varTS360Name + " Payment Notification AR"; 
                                        //emailMsg(SMTP.CC)=varSMTPCC;
                                        emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                        emailMsg(SMTP.MessagePartsAttachments)=2;
                                        
                                        Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varBTARContact;
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0920915a-c457-46af-a5e0-b2c044b393b1")]
                                    send (Port_SMTP_ExpiredCards.Operation_1, emailMsg);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f69be0ff-601c-4b59-826d-3f0cf3c678e7")]
                                    construct MessageCreditCardsBTProfile
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ec1d25f1-4497-41f4-8b2c-6ac829779bce")]
                                        xmlUPDProfileCreditCard.LoadXml("<ProfileDocument><CreditCard><BTNextGen><notification_status></notification_status><date_last_preemptive_notification></date_last_preemptive_notification></BTNextGen><GeneralInfo><id></id></GeneralInfo></CreditCard></ProfileDocument>");
                                        
                                        
                                        MessageCreditCardsBTProfile=xmlUPDProfileCreditCard;
                                        
                                        
                                        xpath(MessageCreditCardsBTProfile,"/*[local-name()='ProfileDocument' and namespace-uri()='']/*[local-name()='CreditCard' and namespace-uri()='']/*[local-name()='GeneralInfo' and namespace-uri()='']/*[local-name()='id' and namespace-uri()='']")= varCreditCardIDPrimary;  
                                        xpath(MessageCreditCardsBTProfile,"/*[local-name()='ProfileDocument' and namespace-uri()='']/*[local-name()='CreditCard' and namespace-uri()='']/*[local-name()='BTNextGen' and namespace-uri()='']/*[local-name()='date_last_preemptive_notification' and namespace-uri()='']")= varCurrentDateTime;
                                        xpath(MessageCreditCardsBTProfile,"/*[local-name()='ProfileDocument' and namespace-uri()='']/*[local-name()='CreditCard' and namespace-uri()='']/*[local-name()='BTNextGen' and namespace-uri()='']/*[local-name()='notification_status' and namespace-uri()='']")= varNoticeNumber;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1c37958f-bfdb-4527-ac82-fdf6d2a1295f")]
                                    construct MessageUpdateProfileWCFRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cce725aa-05d6-42fc-b13e-5bafdce184ca")]
                                        transform (MessageUpdateProfileWCFRequest.parameters) = BTNextGen.Biztalk.ExpiredCreditCards.TransformXML_2_UpdateProfiles (MessageCreditCardsBTProfile);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4aca8328-fa98-4e1d-9297-3336cdf2dcd0")]
                                        MessageUpdateProfileWCFRequest.parameters.profileKey=varCreditCardIDPrimary;
                                        MessageUpdateProfileWCFRequest.parameters.profileObjectName="CreditCard";
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("78e07d2d-000f-462a-9938-44d0ed624b2f")]
                                    scope
                                    {
                                        body
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b95f1d49-b8cc-4972-a1c7-47dbb5cabefa")]
                                            if (varArchiveProfilesUpdateRequestCreditCard == true)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("697ee5c6-0c26-4a04-917c-b12e7f437800")]
                                                construct Archive7ProfilesUpdateRequestCC
                                                {
                                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4b80f1a2-2409-4148-b450-47477e78534a")]
                                                    Archive7ProfilesUpdateRequestCC = MessageUpdateProfileWCFRequest; 
                                                    Archive7ProfilesUpdateRequestCC(FILE.ReceivedFileName)="Archive4ProfilesUpdateRequestCC"; 
                                                }
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("273553dd-04d7-42d8-bd9b-b49bf7c57b1f")]
                                                send (Port_ArchiveProfilesUpdateRequest.Operation_1, Archive7ProfilesUpdateRequestCC);
                                            }
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("00cd7eab-9cca-41f5-883f-067b6929311c")]
                                            send (Port_UpdateProfiles.UpdatePartialProfile, MessageUpdateProfileWCFRequest);
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("95b313f6-e4bc-4e4d-8370-4c47af1688aa")]
                                            receive (Port_UpdateProfiles.UpdatePartialProfile, MessageUpdateProfilesWCFResponse);
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e28fde69-1336-40c0-a4a7-d7c70612d652")]
                                            if (varArchiveProfilesUpdateResponseCreditCard == true)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ff75e837-02aa-4cd4-b5cf-90ad44a5e4a6")]
                                                construct Archive8ProfilesUpdateResponseCC
                                                {
                                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f3a7065d-c02e-4f57-b185-8b0bbcb23d00")]
                                                    Archive8ProfilesUpdateResponseCC = MessageUpdateProfilesWCFResponse; 
                                                    Archive8ProfilesUpdateResponseCC(FILE.ReceivedFileName)="Archive5ProfilesUpdateResponseCC"; 
                                                }
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("27648a41-3414-4a3d-a5db-233bc1988e59")]
                                                send (Port_ArchiveProfilesUpdateResponse.Operation_1, Archive8ProfilesUpdateResponseCC);
                                            }
                                        }
                                        exceptions
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6e715fce-b671-4b41-9f1f-67eba52ecfad")]
                                            catch (Port_UpdateProfiles.UpdatePartialProfile.Fault_ updatefaultwcf)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1f81b828-170e-404e-84cc-4d052fb221e9")]
                                                construct FaultMessage
                                                {
                                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c835b2f3-409c-4975-8660-b773fe45e06b")]
                                                    xmlDoc = updatefaultwcf.MessagePart_Fault;
                                                    varErrorMessage = xmlDoc.OuterXml;
                                                    // Create fault exception Message
                                                    FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                                                    
                                                    // Assign Properties
                                                    FaultMessage.FailureCategory="BTNextGen.Biztalk.ExpiredCreditCard Exception";
                                                    FaultMessage.FaultDescription=varErrorMessage;
                                                    FaultMessage.FaultCode="3003";
                                                    FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                                                }
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("47049f3e-22b9-4f6d-9ad1-10df6fa7cf07")]
                                                send (Port_FaultPort.Operation_1, FaultMessage);
                                            }
                                        }
                                    }
                                }
                                else 
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("85102271-ef42-45eb-88a5-246b02ffcdf2")]
                                    varID = xpath(MessageCreditCardxSingle,"string(//id)");
                                    //varpaymentgroupid = xpath(MessageCreditCardxSingle,"string(//paymentgroupid)");
                                    varCreditCardAlias = xpath(MessageCreditCardxSingle,"string(//alias)");
                                    varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,"string(//last4digits)");
                                    varEmailAddress = varBiztalkAdmin;
                                    
                                    Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("626e38c0-5c75-4c74-881f-7b4721651d23")]
                                    construct emailMsg
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("babeeb87-0cca-4fa1-86ee-d8d79e68a34b")]
                                        msgbody = new System.Text.StringBuilder();
                                        msgbody.AppendLine("<html><body>");
                                        msgbody.AppendLine("<p>Dear Biztalk Administrator,</p><p>");
                                        msgbody.AppendLine("<p>This primary credit card " + varCreditCardAlias + " ending in " + varCreditCardLast4Digits + " is about to expire. The customer <br />will not be contacted directly because the card is not associated to an account.<br />Please login to " + varTS360Name + " and confirm.</p><p>");
                                        msgbody.AppendLine("<p><b>creditcardid:" + varID + "</p><p>");
                                        msgbody.AppendLine("<p>Thanks</p><p>");
                                        
                                        
                                        msgbody.AppendLine("</body></html>");
                                        
                                        emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                        emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                        emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                        emailMsg(SMTP.From)= varSMTPFrom;
                                        emailMsg(SMTP.Subject)=varTS360Name + " Payment Notification Card Not Associated to an account"; 
                                        //emailMsg(SMTP.CC)=varBTARContact; 
                                        emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                        emailMsg(SMTP.MessagePartsAttachments)=2;
                                        
                                        Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varBiztalkAdmin;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("fe88011d-55f3-4f6a-8ffb-e3f87ddd2ea2")]
                                    send (Port_SMTP_ExpiredCards.Operation_1, emailMsg);
                                }
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a22f942-6d92-4a16-9e6a-8bcc573b7457")]
                                varID = xpath(MessageCreditCardxSingle,"string(//id)");
                                //varpaymentgroupid = xpath(MessageCreditCardxSingle,"string(//paymentgroupid)");
                                varCreditCardAlias = xpath(MessageCreditCardxSingle,"string(//alias)");
                                varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,"string(//last4digits)");
                                varEmailAddress = varBiztalkAdmin;
                                
                                Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a6329d6d-002a-4100-bc6f-8a8907f54ee7")]
                                construct emailMsg
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e6e09872-098d-4023-85f2-ac72fb2abda8")]
                                    msgbody = new System.Text.StringBuilder();
                                    msgbody.AppendLine("<html><body>");
                                    msgbody.AppendLine("<p>Dear Biztalk Administrator,</p><p>");
                                    msgbody.AppendLine("<p>This primary credit card " + varCreditCardAlias + " ending in " + varCreditCardLast4Digits + " is about to expire. The customer <br />cannot be contacted directly because no email address exists.<br />Please login to " + varTS360Name + " and confirm.</p><p>");
                                    msgbody.AppendLine("<p><b>creditcardid:" + varID + "</p><p>");
                                    msgbody.AppendLine("<p>Thanks</p><p>");
                                    
                                    
                                    msgbody.AppendLine("</body></html>");
                                    
                                    emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                    emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                    emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                    emailMsg(SMTP.From)= varSMTPFrom;
                                    emailMsg(SMTP.Subject)=varTS360Name + " Payment Notification No Email Address"; 
                                    emailMsg(SMTP.CC)=varBTARContact; 
                                    emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                    emailMsg(SMTP.MessagePartsAttachments)=2;
                                    
                                    Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varBiztalkAdmin;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4be5ee90-e730-46d0-b955-17c4e07a0f26")]
                                send (Port_SMTP_ExpiredCards.Operation_1, emailMsg);
                            }
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3345233a-7719-4640-8a76-6f9cffec5717")]
                            varID = xpath(MessageCreditCardxSingle,"string(//id)");
                            //varpaymentgroupid = xpath(MessageCreditCardxSingle,"string(//paymentgroupid)");
                            varCreditCardAlias = xpath(MessageCreditCardxSingle,"string(//alias)");
                            varCreditCardLast4Digits = xpath(MessageCreditCardxSingle,"string(//last4digits)");
                            varEmailAddress = varBiztalkAdmin;
                            
                            Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varEmailAddress;
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e3ae4682-9faf-4670-b05f-fee865208884")]
                            construct emailMsg
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("89bb8faa-e0ee-46e5-86a6-19d2b4773927")]
                                msgbody = new System.Text.StringBuilder();
                                msgbody.AppendLine("<html><body>");
                                msgbody.AppendLine("<p>Dear Biztalk Administrator,</p><p>");
                                msgbody.AppendLine("<p>This primary credit card " + varCreditCardAlias + " ending in " + varCreditCardLast4Digits + " is about to expire. The customer <br />cannot be contacted directly because no credit card id exists to point to the User Object.<br />Please login to " + varTS360Name + " and check the tables for constraint issues.</p><p>");
                                msgbody.AppendLine("<p><b>creditcardid:" + varID + "</p><p>");
                                msgbody.AppendLine("<p>Thanks</p><p>");
                                
                                
                                msgbody.AppendLine("</body></html>");
                                
                                emailMsg.MessagePart_Body= new Microsoft.Samples.BizTalk.XlangCustomFormatters.RawString(msgbody.ToString());
                                emailMsg.MessagePart_Body(Microsoft.XLANGs.BaseTypes.ContentType)="text/html";
                                emailMsg(SMTP.SMTPHost)=varSMTPHost;
                                emailMsg(SMTP.From)= varSMTPFrom;
                                emailMsg(SMTP.Subject)=varTS360Name + " Payment Notification No UserObject"; 
                                emailMsg(SMTP.CC)=varBTARContact; 
                                emailMsg(SMTP.EmailBodyTextCharset)="UTF-8";
                                emailMsg(SMTP.MessagePartsAttachments)=2;
                                
                                Port_SMTP_ExpiredCards(Microsoft.XLANGs.BaseTypes.Address)="mailto:" + varBiztalkAdmin;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("53f87b24-f530-4233-88b3-25bc6554d999")]
                            send (Port_SMTP_ExpiredCards.Operation_1, emailMsg);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("dd254f8b-a710-4d94-a7ba-ff514cce8fbd")]
                        nLoopCount = nLoopCount + 1; 
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6041b725-dcf7-4a42-afd3-8ca3c3f55f67")]
                    terminate "Testing";;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("034d864f-d93d-4d9a-bd12-1b743c7037da")]
                    construct MessageUpdateProfilesWCFResponse, MessageXMLDummy, ExpiredCardResponse
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0108e9ca-477e-4ad5-b2ed-aac4e845ca3b")]
                        MessageXMLDummy = new System.Xml.XmlDocument();
                        MessageXMLDummy.LoadXml(@"<Dummy xmlns=""http://tempuri.org/""><CreateLegacyBasketsResult xmlns:a=""http://schemas.datacontract.org/2004/07/BTNextGen.Services.IOrders"" xmlns:i=""http://www.w3.org/2001/XMLSchema-instance""><a:BasketDetailsResponse><a:ErrorMessage> </a:ErrorMessage><a:LegacyBasketId>13759439</a:LegacyBasketId><a:LegacySourceSystem>TS3</a:LegacySourceSystem><a:LoadStatus>Loaded</a:LoadStatus></a:BasketDetailsResponse></CreateLegacyBasketsResult></Dummy>");
                        MessageUpdateProfilesWCFResponse.parameters = MessageXMLDummy; 
                        
                        ExpiredCardResponse = MessageXMLDummy;
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ca01ec92-67a1-40f3-826a-2246d584b9b8")]
                    catch (System.SystemException ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a8408c01-9dea-46ec-baf8-4c7b6459240e")]
                        construct FaultMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1470d2b9-aa4b-4871-a798-03a3f3d5b6c4")]
                            // Create fault exception Message
                            FaultMessage= Microsoft.Practices.ESB.ExceptionHandling.ExceptionMgmt.CreateFaultMessage();
                            
                            // Assign Properties
                            FaultMessage.FailureCategory="BTNextGen.Biztalk.ExpiredCreditCard Exception";
                            FaultMessage.FaultDescription=ex.Message;
                            FaultMessage.FaultCode="3003";
                            FaultMessage.FaultSeverity= Microsoft.Practices.ESB.ExceptionHandling.FaultSeverity.Severe;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4b20fc4e-e475-4d55-8ad8-512ac2126e5e")]
                        send (Port_FaultPort.Operation_1, FaultMessage);
                    }
                }
            }
        }
    }
}

